(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Ipfs = factory()}(typeof self !== 'undefined' ? self : this, function () {
var Ipfs=(()=>{var Hhe=Object.create;var t4=Object.defineProperty;var $he=Object.getOwnPropertyDescriptor;var Ghe=Object.getOwnPropertyNames;var Whe=Object.getPrototypeOf,jhe=Object.prototype.hasOwnProperty;var Bd=(t=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(t,{get:(e,r)=>(typeof require!="undefined"?require:e)[r]}):t)(function(t){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')});var $e=(t,e)=>()=>(t&&(e=t(t=0)),e);var x=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),_t=(t,e)=>{for(var r in e)t4(t,r,{get:e[r],enumerable:!0})},Fk=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ghe(e))!jhe.call(t,i)&&i!==r&&t4(t,i,{get:()=>e[i],enumerable:!(n=$he(e,i))||n.enumerable});return t};var E=(t,e,r)=>(r=t!=null?Hhe(Whe(t)):{},Fk(e||!t||!t.__esModule?t4(r,"default",{value:t,enumerable:!0}):r,t)),cr=t=>Fk(t4({},"__esModule",{value:!0}),t);var qk=x(r4=>{"use strict";c();r4.byteLength=Qhe;r4.toByteArray=Zhe;r4.fromByteArray=tde;var oa=[],Do=[],Yhe=typeof Uint8Array<"u"?Uint8Array:Array,tv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Tf=0,Kk=tv.length;Tf<Kk;++Tf)oa[Tf]=tv[Tf],Do[tv.charCodeAt(Tf)]=Tf;var Tf,Kk;Do["-".charCodeAt(0)]=62;Do["_".charCodeAt(0)]=63;function Vk(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function Qhe(t){var e=Vk(t),r=e[0],n=e[1];return(r+n)*3/4-n}function Xhe(t,e,r){return(e+r)*3/4-r}function Zhe(t){var e,r=Vk(t),n=r[0],i=r[1],o=new Yhe(Xhe(t,n,i)),s=0,a=i>0?n-4:n,l;for(l=0;l<a;l+=4)e=Do[t.charCodeAt(l)]<<18|Do[t.charCodeAt(l+1)]<<12|Do[t.charCodeAt(l+2)]<<6|Do[t.charCodeAt(l+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Do[t.charCodeAt(l)]<<2|Do[t.charCodeAt(l+1)]>>4,o[s++]=e&255),i===1&&(e=Do[t.charCodeAt(l)]<<10|Do[t.charCodeAt(l+1)]<<4|Do[t.charCodeAt(l+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function Jhe(t){return oa[t>>18&63]+oa[t>>12&63]+oa[t>>6&63]+oa[t&63]}function ede(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(Jhe(n));return i.join("")}function tde(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(ede(t,s,s+o>a?a:s+o));return n===1?(e=t[r-1],i.push(oa[e>>2]+oa[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(oa[e>>10]+oa[e>>4&63]+oa[e<<2&63]+"=")),i.join("")}});var zk=x(rv=>{c();rv.read=function(t,e,r,n,i){var o,s,a=i*8-n-1,l=(1<<a)-1,u=l>>1,f=-7,h=r?i-1:0,p=r?-1:1,d=t[e+h];for(h+=p,o=d&(1<<-f)-1,d>>=-f,f+=a;f>0;o=o*256+t[e+h],h+=p,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=n;f>0;s=s*256+t[e+h],h+=p,f-=8);if(o===0)o=1-u;else{if(o===l)return s?NaN:(d?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-u}return(d?-1:1)*s*Math.pow(2,o-n)};rv.write=function(t,e,r,n,i,o){var s,a,l,u=o*8-i-1,f=(1<<u)-1,h=f>>1,p=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,m=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),s+h>=1?e+=p/l:e+=p*Math.pow(2,1-h),e*l>=2&&(s++,l/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s=s+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+d]=a&255,d+=m,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+d]=s&255,d+=m,s/=256,u-=8);t[r+d-m]|=g*128}});var bi=x(Kd=>{"use strict";c();var nv=qk(),Ud=zk(),Hk=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Kd.Buffer=H;Kd.SlowBuffer=ade;Kd.INSPECT_MAX_BYTES=50;var n4=2147483647;Kd.kMaxLength=n4;H.TYPED_ARRAY_SUPPORT=rde();!H.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function rde(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(H.prototype,"parent",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.buffer}});Object.defineProperty(H.prototype,"offset",{enumerable:!0,get:function(){if(!!H.isBuffer(this))return this.byteOffset}});function ac(t){if(t>n4)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,H.prototype),e}function H(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return av(t)}return jk(t,e,r)}H.poolSize=8192;function jk(t,e,r){if(typeof t=="string")return ide(t,e);if(ArrayBuffer.isView(t))return ode(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(sa(t,ArrayBuffer)||t&&sa(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(sa(t,SharedArrayBuffer)||t&&sa(t.buffer,SharedArrayBuffer)))return ov(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return H.from(n,e,r);let i=sde(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return H.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}H.from=function(t,e,r){return jk(t,e,r)};Object.setPrototypeOf(H.prototype,Uint8Array.prototype);Object.setPrototypeOf(H,Uint8Array);function Yk(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function nde(t,e,r){return Yk(t),t<=0?ac(t):e!==void 0?typeof r=="string"?ac(t).fill(e,r):ac(t).fill(e):ac(t)}H.alloc=function(t,e,r){return nde(t,e,r)};function av(t){return Yk(t),ac(t<0?0:cv(t)|0)}H.allocUnsafe=function(t){return av(t)};H.allocUnsafeSlow=function(t){return av(t)};function ide(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!H.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=Qk(t,e)|0,n=ac(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function iv(t){let e=t.length<0?0:cv(t.length)|0,r=ac(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function ode(t){if(sa(t,Uint8Array)){let e=new Uint8Array(t);return ov(e.buffer,e.byteOffset,e.byteLength)}return iv(t)}function ov(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,H.prototype),n}function sde(t){if(H.isBuffer(t)){let e=cv(t.length)|0,r=ac(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||uv(t.length)?ac(0):iv(t);if(t.type==="Buffer"&&Array.isArray(t.data))return iv(t.data)}function cv(t){if(t>=n4)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n4.toString(16)+" bytes");return t|0}function ade(t){return+t!=t&&(t=0),H.alloc(+t)}H.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==H.prototype};H.compare=function(e,r){if(sa(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),sa(r,Uint8Array)&&(r=H.from(r,r.offset,r.byteLength)),!H.isBuffer(e)||!H.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};H.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};H.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return H.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=H.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){let s=e[n];if(sa(s,Uint8Array))o+s.length>i.length?(H.isBuffer(s)||(s=H.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(H.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function Qk(t,e){if(H.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||sa(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return sv(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return oD(t).length;default:if(i)return n?-1:sv(t).length;e=(""+e).toLowerCase(),i=!0}}H.byteLength=Qk;function cde(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return wde(this,e,r);case"utf8":case"utf-8":return Zk(this,e,r);case"ascii":return gde(this,e,r);case"latin1":case"binary":return yde(this,e,r);case"base64":return pde(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ede(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}H.prototype._isBuffer=!0;function Af(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}H.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)Af(this,r,r+1);return this};H.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)Af(this,r,r+3),Af(this,r+1,r+2);return this};H.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)Af(this,r,r+7),Af(this,r+1,r+6),Af(this,r+2,r+5),Af(this,r+3,r+4);return this};H.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?Zk(this,0,e):cde.apply(this,arguments)};H.prototype.toLocaleString=H.prototype.toString;H.prototype.equals=function(e){if(!H.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:H.compare(this,e)===0};H.prototype.inspect=function(){let e="",r=Kd.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};Hk&&(H.prototype[Hk]=H.prototype.inspect);H.prototype.compare=function(e,r,n,i,o){if(sa(e,Uint8Array)&&(e=H.from(e,e.offset,e.byteLength)),!H.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,a=n-r,l=Math.min(s,a),u=this.slice(i,o),f=e.slice(r,n);for(let h=0;h<l;++h)if(u[h]!==f[h]){s=u[h],a=f[h];break}return s<a?-1:a<s?1:0};function Xk(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,uv(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=H.from(e,n)),H.isBuffer(e))return e.length===0?-1:$k(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):$k(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function $k(t,e,r,n,i){let o=1,s=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,a/=2,r/=2}function l(f,h){return o===1?f[h]:f.readUInt16BE(h*o)}let u;if(i){let f=-1;for(u=r;u<s;u++)if(l(t,u)===l(e,f===-1?0:u-f)){if(f===-1&&(f=u),u-f+1===a)return f*o}else f!==-1&&(u-=u-f),f=-1}else for(r+a>s&&(r=s-a),u=r;u>=0;u--){let f=!0;for(let h=0;h<a;h++)if(l(t,u+h)!==l(e,h)){f=!1;break}if(f)return u}return-1}H.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};H.prototype.indexOf=function(e,r,n){return Xk(this,e,r,n,!0)};H.prototype.lastIndexOf=function(e,r,n){return Xk(this,e,r,n,!1)};function lde(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(e.substr(s*2,2),16);if(uv(a))return s;t[r+s]=a}return s}function ude(t,e,r,n){return i4(sv(e,t.length-r),t,r,n)}function fde(t,e,r,n){return i4(Sde(e),t,r,n)}function hde(t,e,r,n){return i4(oD(e),t,r,n)}function dde(t,e,r,n){return i4(xde(e,t.length-r),t,r,n)}H.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return lde(this,e,r,n);case"utf8":case"utf-8":return ude(this,e,r,n);case"ascii":case"latin1":case"binary":return fde(this,e,r,n);case"base64":return hde(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return dde(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};H.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function pde(t,e,r){return e===0&&r===t.length?nv.fromByteArray(t):nv.fromByteArray(t.slice(e,r))}function Zk(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){let l,u,f,h;switch(a){case 1:o<128&&(s=o);break;case 2:l=t[i+1],(l&192)===128&&(h=(o&31)<<6|l&63,h>127&&(s=h));break;case 3:l=t[i+1],u=t[i+2],(l&192)===128&&(u&192)===128&&(h=(o&15)<<12|(l&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:l=t[i+1],u=t[i+2],f=t[i+3],(l&192)===128&&(u&192)===128&&(f&192)===128&&(h=(o&15)<<18|(l&63)<<12|(u&63)<<6|f&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return mde(n)}var Gk=4096;function mde(t){let e=t.length;if(e<=Gk)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=Gk));return r}function gde(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function yde(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function wde(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=e;o<r;++o)i+=Rde[t[o]];return i}function Ede(t,e,r){let n=t.slice(e,r),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}H.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,H.prototype),i};function kn(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}H.prototype.readUintLE=H.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||kn(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return i};H.prototype.readUintBE=H.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||kn(e,r,this.length);let i=this[e+--r],o=1;for(;r>0&&(o*=256);)i+=this[e+--r]*o;return i};H.prototype.readUint8=H.prototype.readUInt8=function(e,r){return e=e>>>0,r||kn(e,1,this.length),this[e]};H.prototype.readUint16LE=H.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||kn(e,2,this.length),this[e]|this[e+1]<<8};H.prototype.readUint16BE=H.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||kn(e,2,this.length),this[e]<<8|this[e+1]};H.prototype.readUint32LE=H.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};H.prototype.readUint32BE=H.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};H.prototype.readBigUInt64LE=Tl(function(e){e=e>>>0,Fd(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&_m(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});H.prototype.readBigUInt64BE=Tl(function(e){e=e>>>0,Fd(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&_m(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});H.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||kn(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};H.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||kn(e,r,this.length);let i=r,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};H.prototype.readInt8=function(e,r){return e=e>>>0,r||kn(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};H.prototype.readInt16LE=function(e,r){e=e>>>0,r||kn(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};H.prototype.readInt16BE=function(e,r){e=e>>>0,r||kn(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};H.prototype.readInt32LE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};H.prototype.readInt32BE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};H.prototype.readBigInt64LE=Tl(function(e){e=e>>>0,Fd(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&_m(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});H.prototype.readBigInt64BE=Tl(function(e){e=e>>>0,Fd(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&_m(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});H.prototype.readFloatLE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),Ud.read(this,e,!0,23,4)};H.prototype.readFloatBE=function(e,r){return e=e>>>0,r||kn(e,4,this.length),Ud.read(this,e,!1,23,4)};H.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||kn(e,8,this.length),Ud.read(this,e,!0,52,8)};H.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||kn(e,8,this.length),Ud.read(this,e,!1,52,8)};function Di(t,e,r,n,i,o){if(!H.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}H.prototype.writeUintLE=H.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;Di(this,e,r,n,a,0)}let o=1,s=0;for(this[r]=e&255;++s<n&&(o*=256);)this[r+s]=e/o&255;return r+n};H.prototype.writeUintBE=H.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;Di(this,e,r,n,a,0)}let o=n-1,s=1;for(this[r+o]=e&255;--o>=0&&(s*=256);)this[r+o]=e/s&255;return r+n};H.prototype.writeUint8=H.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,1,255,0),this[r]=e&255,r+1};H.prototype.writeUint16LE=H.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};H.prototype.writeUint16BE=H.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};H.prototype.writeUint32LE=H.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};H.prototype.writeUint32BE=H.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function Jk(t,e,r,n,i){iD(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,r}function eD(t,e,r,n,i){iD(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o=o>>8,t[r+6]=o,o=o>>8,t[r+5]=o,o=o>>8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s=s>>8,t[r+2]=s,s=s>>8,t[r+1]=s,s=s>>8,t[r]=s,r+8}H.prototype.writeBigUInt64LE=Tl(function(e,r=0){return Jk(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeBigUInt64BE=Tl(function(e,r=0){return eD(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});H.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let l=Math.pow(2,8*n-1);Di(this,e,r,n,l-1,-l)}let o=0,s=1,a=0;for(this[r]=e&255;++o<n&&(s*=256);)e<0&&a===0&&this[r+o-1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};H.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let l=Math.pow(2,8*n-1);Di(this,e,r,n,l-1,-l)}let o=n-1,s=1,a=0;for(this[r+o]=e&255;--o>=0&&(s*=256);)e<0&&a===0&&this[r+o+1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};H.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};H.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};H.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};H.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};H.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||Di(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};H.prototype.writeBigInt64LE=Tl(function(e,r=0){return Jk(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});H.prototype.writeBigInt64BE=Tl(function(e,r=0){return eD(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function tD(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function rD(t,e,r,n,i){return e=+e,r=r>>>0,i||tD(t,e,r,4,34028234663852886e22,-34028234663852886e22),Ud.write(t,e,r,n,23,4),r+4}H.prototype.writeFloatLE=function(e,r,n){return rD(this,e,r,!0,n)};H.prototype.writeFloatBE=function(e,r,n){return rD(this,e,r,!1,n)};function nD(t,e,r,n,i){return e=+e,r=r>>>0,i||tD(t,e,r,8,17976931348623157e292,-17976931348623157e292),Ud.write(t,e,r,n,52,8),r+8}H.prototype.writeDoubleLE=function(e,r,n){return nD(this,e,r,!0,n)};H.prototype.writeDoubleBE=function(e,r,n){return nD(this,e,r,!1,n)};H.prototype.copy=function(e,r,n,i){if(!H.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o};H.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!H.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=r;o<n;++o)this[o]=e;else{let s=H.isBuffer(e)?e:H.from(e,i),a=s.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=s[o%a]}return this};var Md={};function lv(t,e,r){Md[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}lv("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);lv("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);lv("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=Wk(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=Wk(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function Wk(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function bde(t,e,r){Fd(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&_m(e,t.length-(r+1))}function iD(t,e,r,n,i,o){if(t>r||t<e){let s=typeof e=="bigint"?"n":"",a;throw o>3?e===0||e===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${e}${s} and <= ${r}${s}`,new Md.ERR_OUT_OF_RANGE("value",a,t)}bde(n,i,o)}function Fd(t,e){if(typeof t!="number")throw new Md.ERR_INVALID_ARG_TYPE(e,"number",t)}function _m(t,e,r){throw Math.floor(t)!==t?(Fd(t,r),new Md.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Md.ERR_BUFFER_OUT_OF_BOUNDS:new Md.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var _de=/[^+/0-9A-Za-z-_]/g;function vde(t){if(t=t.split("=")[0],t=t.trim().replace(_de,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function sv(t,e){e=e||1/0;let r,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function Sde(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function xde(t,e){let r,n,i,o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function oD(t){return nv.toByteArray(vde(t))}function i4(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function sa(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function uv(t){return t!==t}var Rde=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Tl(t){return typeof BigInt>"u"?Tde:t}function Tde(){throw new Error("BigInt not supported")}});var uD=x((nOe,lD)=>{c();var Jr=lD.exports={},aa,ca;function fv(){throw new Error("setTimeout has not been defined")}function hv(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?aa=setTimeout:aa=fv}catch{aa=fv}try{typeof clearTimeout=="function"?ca=clearTimeout:ca=hv}catch{ca=hv}})();function sD(t){if(aa===setTimeout)return setTimeout(t,0);if((aa===fv||!aa)&&setTimeout)return aa=setTimeout,setTimeout(t,0);try{return aa(t,0)}catch{try{return aa.call(null,t,0)}catch{return aa.call(this,t,0)}}}function Ade(t){if(ca===clearTimeout)return clearTimeout(t);if((ca===hv||!ca)&&clearTimeout)return ca=clearTimeout,clearTimeout(t);try{return ca(t)}catch{try{return ca.call(null,t)}catch{return ca.call(this,t)}}}var cc=[],Vd=!1,If,o4=-1;function Ide(){!Vd||!If||(Vd=!1,If.length?cc=If.concat(cc):o4=-1,cc.length&&aD())}function aD(){if(!Vd){var t=sD(Ide);Vd=!0;for(var e=cc.length;e;){for(If=cc,cc=[];++o4<e;)If&&If[o4].run();o4=-1,e=cc.length}If=null,Vd=!1,Ade(t)}}Jr.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];cc.push(new cD(t,e)),cc.length===1&&!Vd&&sD(aD)};function cD(t,e){this.fun=t,this.array=e}cD.prototype.run=function(){this.fun.apply(null,this.array)};Jr.title="browser";Jr.browser=!0;Jr.env={};Jr.argv=[];Jr.version="";Jr.versions={};function lc(){}Jr.on=lc;Jr.addListener=lc;Jr.once=lc;Jr.off=lc;Jr.removeListener=lc;Jr.removeAllListeners=lc;Jr.emit=lc;Jr.prependListener=lc;Jr.prependOnceListener=lc;Jr.listeners=function(t){return[]};Jr.binding=function(t){throw new Error("process.binding is not supported")};Jr.cwd=function(){return"/"};Jr.chdir=function(t){throw new Error("process.chdir is not supported")};Jr.umask=function(){return 0}});var Buffer,process,c=$e(()=>{({Buffer}=bi()),process=uD()});var dv=x((oOe,fD)=>{"use strict";c();fD.exports=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;let e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}});var mv=x((mD,gD)=>{"use strict";c();var s4=dv(),{hasOwnProperty:dD}=Object.prototype,{propertyIsEnumerable:Cde}=Object,qd=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),Pde=mD,hD={concatArrays:!1,ignoreUndefined:!1},a4=t=>{let e=[];for(let r in t)dD.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(t);for(let n of r)Cde.call(t,n)&&e.push(n)}return e};function zd(t){return Array.isArray(t)?Nde(t):s4(t)?kde(t):t}function Nde(t){let e=t.slice(0,0);return a4(t).forEach(r=>{qd(e,r,zd(t[r]))}),e}function kde(t){let e=Object.getPrototypeOf(t)===null?Object.create(null):{};return a4(t).forEach(r=>{qd(e,r,zd(t[r]))}),e}var pD=(t,e,r,n)=>(r.forEach(i=>{typeof e[i]>"u"&&n.ignoreUndefined||(i in t&&t[i]!==Object.getPrototypeOf(t)?qd(t,i,pv(t[i],e[i],n)):qd(t,i,zd(e[i])))}),t),Dde=(t,e,r)=>{let n=t.slice(0,0),i=0;return[t,e].forEach(o=>{let s=[];for(let a=0;a<o.length;a++)!dD.call(o,a)||(s.push(String(a)),o===t?qd(n,i++,o[a]):qd(n,i++,zd(o[a])));n=pD(n,o,a4(o).filter(a=>!s.includes(a)),r)}),n};function pv(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?Dde(t,e,r):!s4(e)||!s4(t)?zd(e):pD(t,e,a4(e),r)}gD.exports=function(...t){let e=pv(zd(hD),this!==Pde&&this||{},hD),r={_:{}};for(let n of t)if(n!==void 0){if(!s4(n))throw new TypeError("`"+n+"` is not an Option Object");r=pv(r,{_:n},e)}return r._}});var gv=x((aOe,wD)=>{c();function Ode(){return typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&!!process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0}wD.exports=Ode});var l4=x((cOe,ED)=>{"use strict";c();var Lde=gv(),c4=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,vm=Lde(),Bde=c4&&!vm,Mde=vm&&!c4,Ude=vm&&c4,Fde=typeof Bd=="function"&&typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!vm,Kde=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,Vde=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env.NODE_ENV==="test",qde=typeof navigator<"u"&&navigator.product==="ReactNative";ED.exports={isTest:Vde,isElectron:vm,isElectronMain:Mde,isElectronRenderer:Ude,isNode:Fde,isBrowser:Bde,isWebWorker:Kde,isEnvWithDom:c4,isReactNative:qde}});var yv=x((lOe,bD)=>{c();var Hd=1e3,$d=Hd*60,Gd=$d*60,Cf=Gd*24,zde=Cf*7,Hde=Cf*365.25;bD.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return $de(t);if(r==="number"&&isFinite(t))return e.long?Wde(t):Gde(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function $de(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!!e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*Hde;case"weeks":case"week":case"w":return r*zde;case"days":case"day":case"d":return r*Cf;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Gd;case"minutes":case"minute":case"mins":case"min":case"m":return r*$d;case"seconds":case"second":case"secs":case"sec":case"s":return r*Hd;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function Gde(t){var e=Math.abs(t);return e>=Cf?Math.round(t/Cf)+"d":e>=Gd?Math.round(t/Gd)+"h":e>=$d?Math.round(t/$d)+"m":e>=Hd?Math.round(t/Hd)+"s":t+"ms"}function Wde(t){var e=Math.abs(t);return e>=Cf?u4(t,e,Cf,"day"):e>=Gd?u4(t,e,Gd,"hour"):e>=$d?u4(t,e,$d,"minute"):e>=Hd?u4(t,e,Hd,"second"):t+" ms"}function u4(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var vD=x((uOe,_D)=>{c();function jde(t){r.debug=r,r.default=r,r.coerce=l,r.disable=o,r.enable=i,r.enabled=s,r.humanize=yv(),r.destroy=u,Object.keys(t).forEach(f=>{r[f]=t[f]}),r.names=[],r.skips=[],r.formatters={};function e(f){let h=0;for(let p=0;p<f.length;p++)h=(h<<5)-h+f.charCodeAt(p),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=e;function r(f){let h,p=null,d,m;function g(...y){if(!g.enabled)return;let w=g,b=Number(new Date),v=b-(h||b);w.diff=v,w.prev=h,w.curr=b,h=b,y[0]=r.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");let S=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,(I,A)=>{if(I==="%%")return"%";S++;let L=r.formatters[A];if(typeof L=="function"){let q=y[S];I=L.call(w,q),y.splice(S,1),S--}return I}),r.formatArgs.call(w,y),(w.log||r.log).apply(w,y)}return g.namespace=f,g.useColors=r.useColors(),g.color=r.selectColor(f),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(d!==r.namespaces&&(d=r.namespaces,m=r.enabled(f)),m),set:y=>{p=y}}),typeof r.init=="function"&&r.init(g),g}function n(f,h){let p=r(this.namespace+(typeof h>"u"?":":h)+f);return p.log=this.log,p}function i(f){r.save(f),r.namespaces=f,r.names=[],r.skips=[];let h,p=(typeof f=="string"?f:"").split(/[\s,]+/),d=p.length;for(h=0;h<d;h++)!p[h]||(f=p[h].replace(/\*/g,".*?"),f[0]==="-"?r.skips.push(new RegExp("^"+f.slice(1)+"$")):r.names.push(new RegExp("^"+f+"$")))}function o(){let f=[...r.names.map(a),...r.skips.map(a).map(h=>"-"+h)].join(",");return r.enable(""),f}function s(f){if(f[f.length-1]==="*")return!0;let h,p;for(h=0,p=r.skips.length;h<p;h++)if(r.skips[h].test(f))return!1;for(h=0,p=r.names.length;h<p;h++)if(r.names[h].test(f))return!0;return!1}function a(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}function l(f){return f instanceof Error?f.stack||f.message:f}function u(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}_D.exports=jde});var Oi=x((Xi,f4)=>{c();Xi.formatArgs=Qde;Xi.save=Xde;Xi.load=Zde;Xi.useColors=Yde;Xi.storage=Jde();Xi.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Xi.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Yde(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function Qde(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+f4.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),t.splice(n,0,e)}Xi.log=console.debug||console.log||(()=>{});function Xde(t){try{t?Xi.storage.setItem("debug",t):Xi.storage.removeItem("debug")}catch{}}function Zde(){let t;try{t=Xi.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function Jde(){try{return localStorage}catch{}}f4.exports=vD()(Xi);var{formatters:epe}=f4.exports;epe.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});function tpe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,l=t.charAt(0),u=Math.log(a)/Math.log(256),f=Math.log(256)/Math.log(a);function h(m){if(m instanceof Uint8Array||(ArrayBuffer.isView(m)?m=new Uint8Array(m.buffer,m.byteOffset,m.byteLength):Array.isArray(m)&&(m=Uint8Array.from(m))),!(m instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(m.length===0)return"";for(var g=0,y=0,w=0,b=m.length;w!==b&&m[w]===0;)w++,g++;for(var v=(b-w)*f+1>>>0,S=new Uint8Array(v);w!==b;){for(var R=m[w],I=0,A=v-1;(R!==0||I<y)&&A!==-1;A--,I++)R+=256*S[A]>>>0,S[A]=R%a>>>0,R=R/a>>>0;if(R!==0)throw new Error("Non-zero carry");y=I,w++}for(var L=v-y;L!==v&&S[L]===0;)L++;for(var q=l.repeat(g);L<v;++L)q+=t.charAt(S[L]);return q}function p(m){if(typeof m!="string")throw new TypeError("Expected String");if(m.length===0)return new Uint8Array;var g=0;if(m[g]!==" "){for(var y=0,w=0;m[g]===l;)y++,g++;for(var b=(m.length-g)*u+1>>>0,v=new Uint8Array(b);m[g];){var S=r[m.charCodeAt(g)];if(S===255)return;for(var R=0,I=b-1;(S!==0||R<w)&&I!==-1;I--,R++)S+=a*v[I]>>>0,v[I]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");w=R,g++}if(m[g]!==" "){for(var A=b-w;A!==b&&v[A]===0;)A++;for(var L=new Uint8Array(y+(b-A)),q=y;A!==b;)L[q++]=v[A++];return L}}}function d(m){var g=p(m);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:p,decode:d}}var rpe,npe,SD,xD=$e(()=>{c();rpe=tpe,npe=rpe,SD=npe});var Wd={};_t(Wd,{coerce:()=>Oo,empty:()=>RD,equals:()=>wv,fromHex:()=>ope,fromString:()=>Ev,isBinary:()=>spe,toHex:()=>ipe,toString:()=>bv});var RD,ipe,ope,wv,Oo,spe,Ev,bv,Al=$e(()=>{c();RD=new Uint8Array(0),ipe=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),""),ope=t=>{let e=t.match(/../g);return e?new Uint8Array(e.map(r=>parseInt(r,16))):RD},wv=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Oo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},spe=t=>t instanceof ArrayBuffer||ArrayBuffer.isView(t),Ev=t=>new TextEncoder().encode(t),bv=t=>new TextDecoder().decode(t)});var _v,vv,Sv,TD,xv,h4,Il,ape,cpe,qr,la=$e(()=>{c();xD();Al();_v=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},vv=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseDecode=n}decode(e){if(typeof e=="string")switch(e[0]){case this.prefix:return this.baseDecode(e.slice(1));default:throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`)}else throw Error("Can only multibase decode strings")}or(e){return TD(this,e)}},Sv=class{constructor(e){this.decoders=e}or(e){return TD(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},TD=(t,e)=>new Sv({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),xv=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new _v(e,r,n),this.decoder=new vv(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},h4=({name:t,prefix:e,encode:r,decode:n})=>new xv(t,e,r,n),Il=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=SD(r,e);return h4({prefix:t,name:e,encode:n,decode:o=>Oo(i(o))})},ape=(t,e,r,n)=>{let i={};for(let f=0;f<e.length;++f)i[e[f]]=f;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,l=0,u=0;for(let f=0;f<o;++f){let h=i[t[f]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|h,a+=r,a>=8&&(a-=8,s[u++]=255&l>>a)}if(a>=r||255&l<<8-a)throw new SyntaxError("Unexpected end of data");return s},cpe=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let l=0;l<t.length;++l)for(a=a<<8|t[l],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},qr=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>h4({prefix:e,name:t,encode(i){return cpe(i,n,r)},decode(i){return ape(i,n,r,t)}})});var jd={};_t(jd,{base58btc:()=>Oe,base58flickr:()=>lpe});var Oe,lpe,en=$e(()=>{c();la();Oe=Il({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),lpe=Il({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});var Sm={};_t(Sm,{base32:()=>xt,base32hex:()=>fpe,base32hexpad:()=>dpe,base32hexpadupper:()=>ppe,base32hexupper:()=>hpe,base32pad:()=>Tv,base32padupper:()=>upe,base32upper:()=>Rv,base32z:()=>mpe});var xt,Rv,Tv,upe,fpe,hpe,dpe,ppe,mpe,si=$e(()=>{c();la();xt=qr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rv=qr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Tv=qr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),upe=qr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),fpe=qr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hpe=qr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),dpe=qr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ppe=qr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),mpe=qr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})});var d4={};_t(d4,{base64:()=>ua,base64pad:()=>gpe,base64url:()=>xm,base64urlpad:()=>ype});var ua,gpe,xm,ype,Cl=$e(()=>{c();la();ua=qr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),gpe=qr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xm=qr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ype=qr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});var V=x((vOe,ID)=>{"use strict";c();function AD(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function wpe(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return AD(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),AD(new i,r)}}ID.exports=wpe});var PD=x((SOe,CD)=>{"use strict";c();CD.exports=Epe;function Epe(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(a,l){r[n]=function(f){if(o)if(o=!1,f)l(f);else{for(var h=new Array(arguments.length-1),p=0;p<h.length;)h[p++]=arguments[p];a.apply(null,h)}};try{t.apply(e||null,r)}catch(u){o&&(o=!1,l(u))}})}});var OD=x(DD=>{"use strict";c();var p4=DD;p4.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var Yd=new Array(64),kD=new Array(123);for(ys=0;ys<64;)kD[Yd[ys]=ys<26?ys+65:ys<52?ys+71:ys<62?ys-4:ys-59|43]=ys++;var ys;p4.encode=function(e,r,n){for(var i=null,o=[],s=0,a=0,l;r<n;){var u=e[r++];switch(a){case 0:o[s++]=Yd[u>>2],l=(u&3)<<4,a=1;break;case 1:o[s++]=Yd[l|u>>4],l=(u&15)<<2,a=2;break;case 2:o[s++]=Yd[l|u>>6],o[s++]=Yd[u&63],a=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return a&&(o[s++]=Yd[l],o[s++]=61,a===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var ND="invalid encoding";p4.decode=function(e,r,n){for(var i=n,o=0,s,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&o>1)break;if((l=kD[l])===void 0)throw Error(ND);switch(o){case 0:s=l,o=1;break;case 1:r[n++]=s<<2|(l&48)>>4,s=l,o=2;break;case 2:r[n++]=(s&15)<<4|(l&60)>>2,s=l,o=3;break;case 3:r[n++]=(s&3)<<6|l,o=0;break}}if(o===1)throw Error(ND);return n-i};p4.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var BD=x((ROe,LD)=>{"use strict";c();LD.exports=m4;function m4(){this._listeners={}}m4.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};m4.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};m4.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var zD=x((TOe,qD)=>{"use strict";c();qD.exports=MD(MD);function MD(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(l,u,f){e[0]=l,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3]}function o(l,u,f){e[0]=l,u[f]=r[3],u[f+1]=r[2],u[f+2]=r[1],u[f+3]=r[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i;function s(l,u){return r[0]=l[u],r[1]=l[u+1],r[2]=l[u+2],r[3]=l[u+3],e[0]}function a(l,u){return r[3]=l[u],r[2]=l[u+1],r[1]=l[u+2],r[0]=l[u+3],e[0]}t.readFloatLE=n?s:a,t.readFloatBE=n?a:s}():function(){function e(n,i,o,s){var a=i<0?1:0;if(a&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((a<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((a<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var l=Math.floor(Math.log(i)/Math.LN2),u=Math.round(i*Math.pow(2,-l)*8388608)&8388607;n((a<<31|l+127<<23|u)>>>0,o,s)}}t.writeFloatLE=e.bind(null,UD),t.writeFloatBE=e.bind(null,FD);function r(n,i,o){var s=n(i,o),a=(s>>31)*2+1,l=s>>>23&255,u=s&8388607;return l===255?u?NaN:a*(1/0):l===0?a*1401298464324817e-60*u:a*Math.pow(2,l-150)*(u+8388608)}t.readFloatLE=r.bind(null,KD),t.readFloatBE=r.bind(null,VD)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(l,u,f){e[0]=l,u[f]=r[0],u[f+1]=r[1],u[f+2]=r[2],u[f+3]=r[3],u[f+4]=r[4],u[f+5]=r[5],u[f+6]=r[6],u[f+7]=r[7]}function o(l,u,f){e[0]=l,u[f]=r[7],u[f+1]=r[6],u[f+2]=r[5],u[f+3]=r[4],u[f+4]=r[3],u[f+5]=r[2],u[f+6]=r[1],u[f+7]=r[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i;function s(l,u){return r[0]=l[u],r[1]=l[u+1],r[2]=l[u+2],r[3]=l[u+3],r[4]=l[u+4],r[5]=l[u+5],r[6]=l[u+6],r[7]=l[u+7],e[0]}function a(l,u){return r[7]=l[u],r[6]=l[u+1],r[5]=l[u+2],r[4]=l[u+3],r[3]=l[u+4],r[2]=l[u+5],r[1]=l[u+6],r[0]=l[u+7],e[0]}t.readDoubleLE=n?s:a,t.readDoubleBE=n?a:s}():function(){function e(n,i,o,s,a,l){var u=s<0?1:0;if(u&&(s=-s),s===0)n(0,a,l+i),n(1/s>0?0:2147483648,a,l+o);else if(isNaN(s))n(0,a,l+i),n(2146959360,a,l+o);else if(s>17976931348623157e292)n(0,a,l+i),n((u<<31|2146435072)>>>0,a,l+o);else{var f;if(s<22250738585072014e-324)f=s/5e-324,n(f>>>0,a,l+i),n((u<<31|f/4294967296)>>>0,a,l+o);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),f=s*Math.pow(2,-h),n(f*4503599627370496>>>0,a,l+i),n((u<<31|h+1023<<20|f*1048576&1048575)>>>0,a,l+o)}}}t.writeDoubleLE=e.bind(null,UD,0,4),t.writeDoubleBE=e.bind(null,FD,4,0);function r(n,i,o,s,a){var l=n(s,a+i),u=n(s,a+o),f=(u>>31)*2+1,h=u>>>20&2047,p=4294967296*(u&1048575)+l;return h===2047?p?NaN:f*(1/0):h===0?f*5e-324*p:f*Math.pow(2,h-1075)*(p+4503599627370496)}t.readDoubleLE=r.bind(null,KD,0,4),t.readDoubleBE=r.bind(null,VD,4,0)}(),t}function UD(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function FD(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function KD(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function VD(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var HD=x((exports,module)=>{"use strict";c();module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var GD=x($D=>{"use strict";c();var Av=$D;Av.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Av.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var o=null,s=[],a=0,l;r<n;)l=e[r++],l<128?s[a++]=l:l>191&&l<224?s[a++]=(l&31)<<6|e[r++]&63:l>239&&l<365?(l=((l&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[a++]=55296+(l>>10),s[a++]=56320+(l&1023)):s[a++]=(l&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0);return o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};Av.write=function(e,r,n){for(var i=n,o,s,a=0;a<e.length;++a)o=e.charCodeAt(a),o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++a,r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128);return n-i}});var jD=x((IOe,WD)=>{"use strict";c();WD.exports=bpe;function bpe(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(l){if(l<1||l>i)return t(l);s+l>n&&(o=t(n),s=0);var u=e.call(o,s,s+=l);return s&7&&(s=(s|7)+1),u}}});var QD=x((COe,YD)=>{"use strict";c();YD.exports=Dn;var Rm=Nl();function Dn(t,e){this.lo=t>>>0,this.hi=e>>>0}var Pf=Dn.zero=new Dn(0,0);Pf.toNumber=function(){return 0};Pf.zzEncode=Pf.zzDecode=function(){return this};Pf.length=function(){return 1};var _pe=Dn.zeroHash="\0\0\0\0\0\0\0\0";Dn.fromNumber=function(e){if(e===0)return Pf;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Dn(n,i)};Dn.from=function(e){if(typeof e=="number")return Dn.fromNumber(e);if(Rm.isString(e))if(Rm.Long)e=Rm.Long.fromString(e);else return Dn.fromNumber(parseInt(e,10));return e.low||e.high?new Dn(e.low>>>0,e.high>>>0):Pf};Dn.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};Dn.prototype.toLong=function(e){return Rm.Long?new Rm.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var Pl=String.prototype.charCodeAt;Dn.fromHash=function(e){return e===_pe?Pf:new Dn((Pl.call(e,0)|Pl.call(e,1)<<8|Pl.call(e,2)<<16|Pl.call(e,3)<<24)>>>0,(Pl.call(e,4)|Pl.call(e,5)<<8|Pl.call(e,6)<<16|Pl.call(e,7)<<24)>>>0)};Dn.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Dn.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Dn.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Dn.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Nl=x(Iv=>{"use strict";c();var Ie=Iv;Ie.asPromise=PD();Ie.base64=OD();Ie.EventEmitter=BD();Ie.float=zD();Ie.inquire=HD();Ie.utf8=GD();Ie.pool=jD();Ie.LongBits=QD();Ie.isNode=Boolean(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);Ie.global=Ie.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||Iv;Ie.emptyArray=Object.freeze?Object.freeze([]):[];Ie.emptyObject=Object.freeze?Object.freeze({}):{};Ie.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};Ie.isString=function(e){return typeof e=="string"||e instanceof String};Ie.isObject=function(e){return e&&typeof e=="object"};Ie.isset=Ie.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};Ie.Buffer=function(){try{var t=Ie.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();Ie._Buffer_from=null;Ie._Buffer_allocUnsafe=null;Ie.newBuffer=function(e){return typeof e=="number"?Ie.Buffer?Ie._Buffer_allocUnsafe(e):new Ie.Array(e):Ie.Buffer?Ie._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};Ie.Array=typeof Uint8Array<"u"?Uint8Array:Array;Ie.Long=Ie.global.dcodeIO&&Ie.global.dcodeIO.Long||Ie.global.Long||Ie.inquire("long");Ie.key2Re=/^true|false|0|1$/;Ie.key32Re=/^-?(?:0|[1-9][0-9]*)$/;Ie.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;Ie.longToHash=function(e){return e?Ie.LongBits.from(e).toHash():Ie.LongBits.zeroHash};Ie.longFromHash=function(e,r){var n=Ie.LongBits.fromHash(e);return Ie.Long?Ie.Long.fromBits(n.lo,n.hi,r):n.toNumber(Boolean(r))};function XD(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}Ie.merge=XD;Ie.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function ZD(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&XD(this,n)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}Ie.newError=ZD;Ie.ProtocolError=ZD("ProtocolError");Ie.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(r[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};Ie.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};Ie.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};Ie._configure=function(){var t=Ie.Buffer;if(!t){Ie._Buffer_from=Ie._Buffer_allocUnsafe=null;return}Ie._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},Ie._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Lv=x((NOe,rO)=>{"use strict";c();rO.exports=Bt;var Lo=Nl(),Cv,g4=Lo.LongBits,JD=Lo.base64,eO=Lo.utf8;function Tm(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function Nv(){}function vpe(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function Bt(){this.len=0,this.head=new Tm(Nv,0,0),this.tail=this.head,this.states=null}var tO=function(){return Lo.Buffer?function(){return(Bt.create=function(){return new Cv})()}:function(){return new Bt}};Bt.create=tO();Bt.alloc=function(e){return new Lo.Array(e)};Lo.Array!==Array&&(Bt.alloc=Lo.pool(Bt.alloc,Lo.Array.prototype.subarray));Bt.prototype._push=function(e,r,n){return this.tail=this.tail.next=new Tm(e,r,n),this.len+=r,this};function kv(t,e,r){e[r]=t&255}function Spe(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Dv(t,e){this.len=t,this.next=void 0,this.val=e}Dv.prototype=Object.create(Tm.prototype);Dv.prototype.fn=Spe;Bt.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Dv((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};Bt.prototype.int32=function(e){return e<0?this._push(Ov,10,g4.fromNumber(e)):this.uint32(e)};Bt.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ov(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}Bt.prototype.uint64=function(e){var r=g4.from(e);return this._push(Ov,r.length(),r)};Bt.prototype.int64=Bt.prototype.uint64;Bt.prototype.sint64=function(e){var r=g4.from(e).zzEncode();return this._push(Ov,r.length(),r)};Bt.prototype.bool=function(e){return this._push(kv,1,e?1:0)};function Pv(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}Bt.prototype.fixed32=function(e){return this._push(Pv,4,e>>>0)};Bt.prototype.sfixed32=Bt.prototype.fixed32;Bt.prototype.fixed64=function(e){var r=g4.from(e);return this._push(Pv,4,r.lo)._push(Pv,4,r.hi)};Bt.prototype.sfixed64=Bt.prototype.fixed64;Bt.prototype.float=function(e){return this._push(Lo.float.writeFloatLE,4,e)};Bt.prototype.double=function(e){return this._push(Lo.float.writeDoubleLE,8,e)};var xpe=Lo.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};Bt.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(kv,1,0);if(Lo.isString(e)){var n=Bt.alloc(r=JD.length(e));JD.decode(e,n,0),e=n}return this.uint32(r)._push(xpe,r,e)};Bt.prototype.string=function(e){var r=eO.length(e);return r?this.uint32(r)._push(eO.write,r,e):this._push(kv,1,0)};Bt.prototype.fork=function(){return this.states=new vpe(this),this.head=this.tail=new Tm(Nv,0,0),this.len=0,this};Bt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Tm(Nv,0,0),this.len=0),this};Bt.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};Bt.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};Bt._configure=function(t){Cv=t,Bt.create=tO(),Cv._configure()}});var oO=x((kOe,iO)=>{"use strict";c();iO.exports=ha;var nO=Lv();(ha.prototype=Object.create(nO.prototype)).constructor=ha;var kl=Nl();function ha(){nO.call(this)}ha._configure=function(){ha.alloc=kl._Buffer_allocUnsafe,ha.writeBytesBuffer=kl.Buffer&&kl.Buffer.prototype instanceof Uint8Array&&kl.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};ha.prototype.bytes=function(e){kl.isString(e)&&(e=kl._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ha.writeBytesBuffer,r,e),this};function Rpe(t,e,r){t.length<40?kl.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ha.prototype.string=function(e){var r=kl.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Rpe,r,e),this};ha._configure()});var Uv=x((DOe,uO)=>{"use strict";c();uO.exports=tn;var da=Nl(),Mv,cO=da.LongBits,Tpe=da.utf8;function ws(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function tn(t){this.buf=t,this.pos=0,this.len=t.length}var sO=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new tn(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new tn(e);throw Error("illegal buffer")},lO=function(){return da.Buffer?function(r){return(tn.create=function(i){return da.Buffer.isBuffer(i)?new Mv(i):sO(i)})(r)}:sO};tn.create=lO();tn.prototype._slice=da.Array.prototype.subarray||da.Array.prototype.slice;tn.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,ws(this,10);return e}}();tn.prototype.int32=function(){return this.uint32()|0};tn.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Bv(){var t=new cO(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw ws(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw ws(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}tn.prototype.bool=function(){return this.uint32()!==0};function y4(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}tn.prototype.fixed32=function(){if(this.pos+4>this.len)throw ws(this,4);return y4(this.buf,this.pos+=4)};tn.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ws(this,4);return y4(this.buf,this.pos+=4)|0};function aO(){if(this.pos+8>this.len)throw ws(this,8);return new cO(y4(this.buf,this.pos+=4),y4(this.buf,this.pos+=4))}tn.prototype.float=function(){if(this.pos+4>this.len)throw ws(this,4);var e=da.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};tn.prototype.double=function(){if(this.pos+8>this.len)throw ws(this,4);var e=da.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};tn.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw ws(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};tn.prototype.string=function(){var e=this.bytes();return Tpe.read(e,0,e.length)};tn.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw ws(this,e);this.pos+=e}else do if(this.pos>=this.len)throw ws(this);while(this.buf[this.pos++]&128);return this};tn.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};tn._configure=function(t){Mv=t,tn.create=lO(),Mv._configure();var e=da.Long?"toLong":"toNumber";da.merge(tn.prototype,{int64:function(){return Bv.call(this)[e](!1)},uint64:function(){return Bv.call(this)[e](!0)},sint64:function(){return Bv.call(this).zzDecode()[e](!1)},fixed64:function(){return aO.call(this)[e](!0)},sfixed64:function(){return aO.call(this)[e](!1)}})}});var pO=x((OOe,dO)=>{"use strict";c();dO.exports=Nf;var hO=Uv();(Nf.prototype=Object.create(hO.prototype)).constructor=Nf;var fO=Nl();function Nf(t){hO.call(this,t)}Nf._configure=function(){fO.Buffer&&(Nf.prototype._slice=fO.Buffer.prototype.slice)};Nf.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Nf._configure()});var gO=x((LOe,mO)=>{"use strict";c();mO.exports=Am;var Fv=Nl();(Am.prototype=Object.create(Fv.EventEmitter.prototype)).constructor=Am;function Am(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Fv.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}Am.prototype.rpcCall=function t(e,r,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return Fv.asPromise(t,s,e,r,n,i);if(!s.rpcImpl){setTimeout(function(){o(Error("already ended"))},0);return}try{return s.rpcImpl(e,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(l,u){if(l)return s.emit("error",l,e),o(l);if(u===null){s.end(!0);return}if(!(u instanceof n))try{u=n[s.responseDelimited?"decodeDelimited":"decode"](u)}catch(f){return s.emit("error",f,e),o(f)}return s.emit("data",u,e),o(null,u)})}catch(a){s.emit("error",a,e),setTimeout(function(){o(a)},0);return}};Am.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var wO=x(yO=>{"use strict";c();var Ape=yO;Ape.Service=gO()});var bO=x((MOe,EO)=>{"use strict";c();EO.exports={}});var SO=x(vO=>{"use strict";c();var Li=vO;Li.build="minimal";Li.Writer=Lv();Li.BufferWriter=oO();Li.Reader=Uv();Li.BufferReader=pO();Li.util=Nl();Li.rpc=wO();Li.roots=bO();Li.configure=_O;function _O(){Li.util._configure(),Li.Writer._configure(Li.BufferWriter),Li.Reader._configure(Li.BufferReader)}_O()});var pa=x((FOe,xO)=>{"use strict";c();xO.exports=SO()});function NO(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Dpe;)e[r++]=t&255|CO,t/=128;for(;t&kpe;)e[r++]=t&255|CO,t>>>=7;return e[r]=t|0,NO.bytes=r-n+1,e}function Vv(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw Vv.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&PO)<<i:(s&PO)*Math.pow(2,i),i+=7}while(s>=Lpe);return Vv.bytes=o-n,r}var Ppe,CO,Npe,kpe,Dpe,Ope,Lpe,PO,Bpe,Mpe,Upe,Fpe,Kpe,Vpe,qpe,zpe,Hpe,$pe,Gpe,Wpe,Im,kO=$e(()=>{c();Ppe=NO,CO=128,Npe=127,kpe=~Npe,Dpe=Math.pow(2,31);Ope=Vv,Lpe=128,PO=127;Bpe=Math.pow(2,7),Mpe=Math.pow(2,14),Upe=Math.pow(2,21),Fpe=Math.pow(2,28),Kpe=Math.pow(2,35),Vpe=Math.pow(2,42),qpe=Math.pow(2,49),zpe=Math.pow(2,56),Hpe=Math.pow(2,63),$pe=function(t){return t<Bpe?1:t<Mpe?2:t<Upe?3:t<Fpe?4:t<Kpe?5:t<Vpe?6:t<qpe?7:t<zpe?8:t<Hpe?9:10},Gpe={encode:Ppe,decode:Ope,encodingLength:$pe},Wpe=Gpe,Im=Wpe});var Cm,Xd,Zd,b4=$e(()=>{c();kO();Cm=t=>[Im.decode(t),Im.decode.bytes],Xd=(t,e,r=0)=>(Im.encode(t,e,r),e),Zd=t=>Im.encodingLength(t)});var xn={};_t(xn,{Digest:()=>kf,create:()=>Es,decode:()=>wr,equals:()=>qv});var Es,wr,qv,kf,On=$e(()=>{c();Al();b4();Es=(t,e)=>{let r=e.byteLength,n=Zd(t),i=n+Zd(r),o=new Uint8Array(i+r);return Xd(t,o,0),Xd(r,o,n),o.set(e,i),new kf(t,r,e,o)},wr=t=>{let e=Oo(t),[r,n]=Cm(e),[i,o]=Cm(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new kf(r,i,s,e)},qv=(t,e)=>t===e?!0:t.code===e.code&&t.size===e.size&&wv(t.bytes,e.bytes),kf=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}}});var Nm={};_t(Nm,{CID:()=>T});var T,jpe,Ype,Qpe,Pm,Xpe,DO,OO,_4,v4,Zpe,Jpe,e0e,te=$e(()=>{c();b4();On();en();si();Al();T=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:v4,byteLength:v4,code:_4,version:_4,multihash:_4,bytes:_4,_baseCache:v4,asCID:v4})}toV0(){switch(this.version){case 0:return this;default:{let{code:e,multihash:r}=this;if(e!==Pm)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Xpe)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return T.createV0(r)}}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=Es(e,r);return T.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&qv(this.multihash,e.multihash)}toString(e){let{bytes:r,version:n,_baseCache:i}=this;switch(n){case 0:return Ype(r,i,e||Oe.encoder);default:return Qpe(r,i,e||xt.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return Jpe(/^0\.0/,e0e),!!(e&&(e[OO]||e.asCID===e))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof T)return e;if(e!=null&&e.asCID===e){let{version:r,code:n,multihash:i,bytes:o}=e;return new T(r,n,i,o||DO(r,n,i.bytes))}else if(e!=null&&e[OO]===!0){let{version:r,multihash:n,code:i}=e,o=wr(n);return T.create(r,i,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");switch(e){case 0:{if(r!==Pm)throw new Error(`Version 0 CID must use dag-pb (code: ${Pm}) block encoding`);return new T(e,r,n,n.bytes)}case 1:{let i=DO(e,r,n.bytes);return new T(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return T.create(0,Pm,e)}static createV1(e,r){return T.create(1,e,r)}static decode(e){let[r,n]=T.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=T.inspectBytes(e),n=r.size-r.multihashSize,i=Oo(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new kf(r.multihashCode,r.digestSize,o,i);return[r.version===0?T.createV0(s):T.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,p]=Cm(e.subarray(r));return r+=p,h},i=n(),o=Pm;if(i===18?(i=0,r=0):i===1&&(o=n()),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),l=n(),u=r+l,f=u-s;return{version:i,codec:o,multihashCode:a,digestSize:l,multihashSize:f,size:u}}static parse(e,r){let[n,i]=jpe(e,r),o=T.decode(i);return o._baseCache.set(n,e),o}},jpe=(t,e)=>{switch(t[0]){case"Q":{let r=e||Oe;return[Oe.prefix,r.decode(`${Oe.prefix}${t}`)]}case Oe.prefix:{let r=e||Oe;return[Oe.prefix,r.decode(t)]}case xt.prefix:{let r=e||xt;return[xt.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},Ype=(t,e,r)=>{let{prefix:n}=r;if(n!==Oe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},Qpe=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},Pm=112,Xpe=18,DO=(t,e,r)=>{let n=Zd(t),i=n+Zd(e),o=new Uint8Array(i+r.byteLength);return Xd(t,o,0),Xd(e,o,n),o.set(r,i),o},OO=Symbol.for("@ipld/js-cid/CID"),_4={writable:!1,configurable:!1,enumerable:!0},v4={writable:!1,enumerable:!1,configurable:!1},Zpe="0.0.0-dev",Jpe=(t,e)=>{if(t.test(Zpe))console.warn(e);else throw new Error(e)},e0e=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`});function $O(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(h0e.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(p0e(t))return"Buffer";let r=m0e(t);return r||"Object"}function p0e(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function m0e(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(d0e.includes(e))return e}var h0e,d0e,GO=$e(()=>{c();h0e=["string","number","bigint","symbol"],d0e=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"]});var O,Q,_i=$e(()=>{c();O=class{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};O.uint=new O(0,"uint",!0);O.negint=new O(1,"negint",!0);O.bytes=new O(2,"bytes",!0);O.string=new O(3,"string",!0);O.array=new O(4,"array",!1);O.map=new O(5,"map",!1);O.tag=new O(6,"tag",!1);O.float=new O(7,"float",!0);O.false=new O(7,"false",!0);O.true=new O(7,"true",!0);O.null=new O(7,"null",!0);O.undefined=new O(7,"undefined",!0);O.break=new O(7,"break",!0);Q=class{constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}});function x4(t){return ep&&globalThis.Buffer.isBuffer(t)}function Dm(t){return t instanceof Uint8Array?x4(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}function JO(t,e){if(x4(t)&&x4(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function WO(t,e=1/0){let r,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function jO(t,e,r){let n=[];for(;e<r;){let i=t[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=r){let a,l,u,f;switch(s){case 1:i<128&&(o=i);break;case 2:a=t[e+1],(a&192)===128&&(f=(i&31)<<6|a&63,f>127&&(o=f));break;case 3:a=t[e+1],l=t[e+2],(a&192)===128&&(l&192)===128&&(f=(i&15)<<12|(a&63)<<6|l&63,f>2047&&(f<55296||f>57343)&&(o=f));break;case 4:a=t[e+1],l=t[e+2],u=t[e+3],(a&192)===128&&(l&192)===128&&(u&192)===128&&(f=(i&15)<<18|(a&63)<<12|(l&63)<<6|u&63,f>65535&&f<1114112&&(o=f))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return Gv(n)}function Gv(t){let e=t.length;if(e<=YO)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=YO));return r}var ep,g0e,y0e,QO,R4,ma,tp,XO,ZO,YO,Ol=$e(()=>{c();ep=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",g0e=new TextDecoder,y0e=new TextEncoder;QO=ep?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):jO(t,e,r):(t,e,r)=>r-e>64?g0e.decode(t.subarray(e,r)):jO(t,e,r),R4=ep?t=>t.length>64?globalThis.Buffer.from(t):WO(t):t=>t.length>64?y0e.encode(t):WO(t),ma=t=>Uint8Array.from(t),tp=ep?(t,e,r)=>x4(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),XO=ep?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Dm(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),n=0;for(let i of t)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},ZO=ep?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);YO=4096});var w0e,Om,eL=$e(()=>{c();Ol();w0e=256,Om=class{constructor(e=w0e){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=r.length-(this.maxCursor-this.cursor)-1;r.set(e,i)}else{if(r){let i=r.length-(this.maxCursor-this.cursor)-1;i<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=ZO(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=tp(n,0,this.cursor)}else r=XO(this.chunks,this.cursor);return e&&this.reset(),r}}});function pc(t,e,r){if(t.length-e<r)throw new Error(`${xe} not enough data for type`)}var xe,dc,Lm,Zi=$e(()=>{c();xe="CBOR decode error:",dc="CBOR encode error:",Lm=[];Lm[23]=1;Lm[24]=2;Lm[25]=3;Lm[26]=5;Lm[27]=9});function Ji(t,e,r){pc(t,e,1);let n=t[e];if(r.strict===!0&&n<Bn[0])throw new Error(`${xe} integer encoded in more bytes than necessary (strict decode)`);return n}function eo(t,e,r){pc(t,e,2);let n=t[e]<<8|t[e+1];if(r.strict===!0&&n<Bn[1])throw new Error(`${xe} integer encoded in more bytes than necessary (strict decode)`);return n}function to(t,e,r){pc(t,e,4);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<Bn[2])throw new Error(`${xe} integer encoded in more bytes than necessary (strict decode)`);return n}function ro(t,e,r){pc(t,e,8);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&o<Bn[3])throw new Error(`${xe} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(r.allowBigInt===!0)return o;throw new Error(`${xe} integers outside of the safe integer range are not supported`)}function tL(t,e,r,n){return new Q(O.uint,Ji(t,e+1,n),2)}function rL(t,e,r,n){return new Q(O.uint,eo(t,e+1,n),3)}function nL(t,e,r,n){return new Q(O.uint,to(t,e+1,n),5)}function iL(t,e,r,n){return new Q(O.uint,ro(t,e+1,n),9)}function Bo(t,e){return Jn(t,0,e.value)}function Jn(t,e,r){if(r<Bn[0]){let n=Number(r);t.push([e|n])}else if(r<Bn[1]){let n=Number(r);t.push([e|24,n])}else if(r<Bn[2]){let n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<Bn[3]){let n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<Bn[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,t.push(i)}else throw new Error(`${xe} encountered BigInt larger than allowable range`)}}var Bn,ga=$e(()=>{c();_i();Zi();Bn=[24,256,65536,4294967296,BigInt("18446744073709551616")];Bo.encodedSize=function(e){return Jn.encodedSize(e.value)};Jn.encodedSize=function(e){return e<Bn[0]?1:e<Bn[1]?2:e<Bn[2]?3:e<Bn[3]?5:9};Bo.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0}});function oL(t,e,r,n){return new Q(O.negint,-1-Ji(t,e+1,n),2)}function sL(t,e,r,n){return new Q(O.negint,-1-eo(t,e+1,n),3)}function aL(t,e,r,n){return new Q(O.negint,-1-to(t,e+1,n),5)}function lL(t,e,r,n){let i=ro(t,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new Q(O.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${xe} integers outside of the safe integer range are not supported`);return new Q(O.negint,Wv-BigInt(i),9)}function T4(t,e){let r=e.value,n=typeof r=="bigint"?r*Wv-cL:r*-1-1;Jn(t,e.type.majorEncoded,n)}var Wv,cL,jv=$e(()=>{c();_i();ga();Zi();Wv=BigInt(-1),cL=BigInt(1);T4.encodedSize=function(e){let r=e.value,n=typeof r=="bigint"?r*Wv-cL:r*-1-1;return n<Bn[0]?1:n<Bn[1]?2:n<Bn[2]?3:n<Bn[3]?5:9};T4.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0}});function Bm(t,e,r,n){pc(t,e,r+n);let i=tp(t,e+r,e+r+n);return new Q(O.bytes,i,r+n)}function uL(t,e,r,n){return Bm(t,e,1,r)}function fL(t,e,r,n){return Bm(t,e,2,Ji(t,e+1,n))}function hL(t,e,r,n){return Bm(t,e,3,eo(t,e+1,n))}function dL(t,e,r,n){return Bm(t,e,5,to(t,e+1,n))}function pL(t,e,r,n){let i=ro(t,e+1,n);if(typeof i=="bigint")throw new Error(`${xe} 64-bit integer bytes lengths not supported`);return Bm(t,e,9,i)}function A4(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===O.string?R4(t.value):t.value),t.encodedBytes}function rp(t,e){let r=A4(e);Jn(t,e.type.majorEncoded,r.length),t.push(r)}function b0e(t,e){return t.length<e.length?-1:t.length>e.length?1:JO(t,e)}var I4=$e(()=>{c();_i();Zi();ga();Ol();rp.encodedSize=function(e){let r=A4(e);return Jn.encodedSize(r.length)+r.length};rp.compareTokens=function(e,r){return b0e(A4(e),A4(r))}});function Mm(t,e,r,n,i){let o=r+n;pc(t,e,o);let s=new Q(O.string,QO(t,e+r,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=tp(t,e+r,e+o)),s}function mL(t,e,r,n){return Mm(t,e,1,r,n)}function gL(t,e,r,n){return Mm(t,e,2,Ji(t,e+1,n),n)}function yL(t,e,r,n){return Mm(t,e,3,eo(t,e+1,n),n)}function wL(t,e,r,n){return Mm(t,e,5,to(t,e+1,n),n)}function EL(t,e,r,n){let i=ro(t,e+1,n);if(typeof i=="bigint")throw new Error(`${xe} 64-bit integer string lengths not supported`);return Mm(t,e,9,i,n)}var bL,Yv=$e(()=>{c();_i();Zi();ga();I4();Ol();bL=rp});function np(t,e,r,n){return new Q(O.array,n,r)}function _L(t,e,r,n){return np(t,e,1,r)}function vL(t,e,r,n){return np(t,e,2,Ji(t,e+1,n))}function SL(t,e,r,n){return np(t,e,3,eo(t,e+1,n))}function xL(t,e,r,n){return np(t,e,5,to(t,e+1,n))}function RL(t,e,r,n){let i=ro(t,e+1,n);if(typeof i=="bigint")throw new Error(`${xe} 64-bit integer array lengths not supported`);return np(t,e,9,i)}function TL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${xe} indefinite length items not allowed`);return np(t,e,1,1/0)}function C4(t,e){Jn(t,O.array.majorEncoded,e.value)}var Qv=$e(()=>{c();_i();ga();Zi();C4.compareTokens=Bo.compareTokens;C4.encodedSize=function(e){return Jn.encodedSize(e.value)}});function ip(t,e,r,n){return new Q(O.map,n,r)}function AL(t,e,r,n){return ip(t,e,1,r)}function IL(t,e,r,n){return ip(t,e,2,Ji(t,e+1,n))}function CL(t,e,r,n){return ip(t,e,3,eo(t,e+1,n))}function PL(t,e,r,n){return ip(t,e,5,to(t,e+1,n))}function NL(t,e,r,n){let i=ro(t,e+1,n);if(typeof i=="bigint")throw new Error(`${xe} 64-bit integer map lengths not supported`);return ip(t,e,9,i)}function kL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${xe} indefinite length items not allowed`);return ip(t,e,1,1/0)}function P4(t,e){Jn(t,O.map.majorEncoded,e.value)}var Xv=$e(()=>{c();_i();ga();Zi();P4.compareTokens=Bo.compareTokens;P4.encodedSize=function(e){return Jn.encodedSize(e.value)}});function DL(t,e,r,n){return new Q(O.tag,r,1)}function OL(t,e,r,n){return new Q(O.tag,Ji(t,e+1,n),2)}function LL(t,e,r,n){return new Q(O.tag,eo(t,e+1,n),3)}function BL(t,e,r,n){return new Q(O.tag,to(t,e+1,n),5)}function ML(t,e,r,n){return new Q(O.tag,ro(t,e+1,n),9)}function N4(t,e){Jn(t,O.tag.majorEncoded,e.value)}var Zv=$e(()=>{c();_i();ga();N4.compareTokens=Bo.compareTokens;N4.encodedSize=function(e){return Jn.encodedSize(e.value)}});function UL(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${xe} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new Q(O.null,null,1):new Q(O.undefined,void 0,1)}function FL(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${xe} indefinite length items not allowed`);return new Q(O.break,void 0,1)}function Jv(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${xe} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${xe} Infinity values are not supported`)}return new Q(O.float,t,e)}function KL(t,e,r,n){return Jv(e9(t,e+1),3,n)}function VL(t,e,r,n){return Jv(t9(t,e+1),5,n)}function qL(t,e,r,n){return Jv(GL(t,e+1),9,n)}function k4(t,e,r){let n=e.value;if(n===!1)t.push([O.float.majorEncoded|T0e]);else if(n===!0)t.push([O.float.majorEncoded|A0e]);else if(n===null)t.push([O.float.majorEncoded|I0e]);else if(n===void 0)t.push([O.float.majorEncoded|C0e]);else{let i,o=!1;(!r||r.float64!==!0)&&(HL(n),i=e9(bs,1),n===i||Number.isNaN(n)?(bs[0]=249,t.push(bs.slice(0,3)),o=!0):($L(n),i=t9(bs,1),n===i&&(bs[0]=250,t.push(bs.slice(0,5)),o=!0))),o||(P0e(n),i=GL(bs,1),bs[0]=251,t.push(bs.slice(0,9)))}}function HL(t){if(t===1/0)Mo.setUint16(0,31744,!1);else if(t===-1/0)Mo.setUint16(0,64512,!1);else if(Number.isNaN(t))Mo.setUint16(0,32256,!1);else{Mo.setFloat32(0,t);let e=Mo.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)Mo.setUint16(0,31744,!1);else if(r===0)Mo.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?Mo.setUint16(0,0):i<-14?Mo.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):Mo.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function e9(t,e){if(t.length-e<2)throw new Error(`${xe} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,r&32768?-o:o}function $L(t){Mo.setFloat32(0,t,!1)}function t9(t,e){if(t.length-e<4)throw new Error(`${xe} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function P0e(t){Mo.setFloat64(0,t,!1)}function GL(t,e){if(t.length-e<8)throw new Error(`${xe} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}var T0e,A0e,I0e,C0e,zL,Mo,bs,r9=$e(()=>{c();_i();Zi();ga();T0e=20,A0e=21,I0e=22,C0e=23;k4.encodedSize=function(e,r){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){HL(n);let i=e9(bs,1);if(n===i||Number.isNaN(n))return 3;if($L(n),i=t9(bs,1),n===i)return 5}return 9};zL=new ArrayBuffer(9),Mo=new DataView(zL,1),bs=new Uint8Array(zL,0);k4.compareTokens=Bo.compareTokens});function Kt(t,e,r){throw new Error(`${xe} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function D4(t){return()=>{throw new Error(`${xe} ${t}`)}}function WL(t){switch(t.type){case O.false:return ma([244]);case O.true:return ma([245]);case O.null:return ma([246]);case O.bytes:return t.value.length?void 0:ma([64]);case O.string:return t.value===""?ma([96]):void 0;case O.array:return t.value===0?ma([128]):void 0;case O.map:return t.value===0?ma([160]):void 0;case O.uint:return t.value<24?ma([Number(t.value)]):void 0;case O.negint:if(t.value>=-24)return ma([31-Number(t.value)])}}var ie,_s,n9=$e(()=>{c();_i();ga();jv();I4();Yv();Qv();Xv();Zv();r9();Zi();Ol();ie=[];for(let t=0;t<=23;t++)ie[t]=Kt;ie[24]=tL;ie[25]=rL;ie[26]=nL;ie[27]=iL;ie[28]=Kt;ie[29]=Kt;ie[30]=Kt;ie[31]=Kt;for(let t=32;t<=55;t++)ie[t]=Kt;ie[56]=oL;ie[57]=sL;ie[58]=aL;ie[59]=lL;ie[60]=Kt;ie[61]=Kt;ie[62]=Kt;ie[63]=Kt;for(let t=64;t<=87;t++)ie[t]=uL;ie[88]=fL;ie[89]=hL;ie[90]=dL;ie[91]=pL;ie[92]=Kt;ie[93]=Kt;ie[94]=Kt;ie[95]=D4("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)ie[t]=mL;ie[120]=gL;ie[121]=yL;ie[122]=wL;ie[123]=EL;ie[124]=Kt;ie[125]=Kt;ie[126]=Kt;ie[127]=D4("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)ie[t]=_L;ie[152]=vL;ie[153]=SL;ie[154]=xL;ie[155]=RL;ie[156]=Kt;ie[157]=Kt;ie[158]=Kt;ie[159]=TL;for(let t=160;t<=183;t++)ie[t]=AL;ie[184]=IL;ie[185]=CL;ie[186]=PL;ie[187]=NL;ie[188]=Kt;ie[189]=Kt;ie[190]=Kt;ie[191]=kL;for(let t=192;t<=215;t++)ie[t]=DL;ie[216]=OL;ie[217]=LL;ie[218]=BL;ie[219]=ML;ie[220]=Kt;ie[221]=Kt;ie[222]=Kt;ie[223]=Kt;for(let t=224;t<=243;t++)ie[t]=D4("simple values are not supported");ie[244]=Kt;ie[245]=Kt;ie[246]=Kt;ie[247]=UL;ie[248]=D4("simple values are not supported");ie[249]=KL;ie[250]=VL;ie[251]=qL;ie[252]=Kt;ie[253]=Kt;ie[254]=Kt;ie[255]=FL;_s=[];for(let t=0;t<24;t++)_s[t]=new Q(O.uint,t,1);for(let t=-1;t>=-24;t--)_s[31-t]=new Q(O.negint,t,1);_s[64]=new Q(O.bytes,new Uint8Array(0),1);_s[96]=new Q(O.string,"",1);_s[128]=new Q(O.array,0,1);_s[160]=new Q(O.map,0,1);_s[244]=new Q(O.false,!1,1);_s[245]=new Q(O.true,!0,1);_s[246]=new Q(O.null,null,1)});function D0e(){let t=[];return t[O.uint.major]=Bo,t[O.negint.major]=T4,t[O.bytes.major]=rp,t[O.string.major]=bL,t[O.array.major]=C4,t[O.map.major]=P4,t[O.tag.major]=N4,t[O.float.major]=k4,t}function O4(t,e={},r){let n=$O(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||Bl[n];if(typeof i=="function"){let s=i(t,n,e,r);if(s!=null)return s}let o=Bl[n];if(!o)throw new Error(`${dc} unsupported type: ${n}`);return o(t,n,e,r)}function O0e(t,e){e.mapSorter&&t.sort(e.mapSorter)}function L0e(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);let i=r.type.major,o=jL[i].compareTokens(r,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function YL(t,e,r,n){if(Array.isArray(e))for(let i of e)YL(t,i,r,n);else r[e.type.major](t,e,n)}function o9(t,e,r){let n=O4(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){let i=r.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,r),a=new Om(s);if(o(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Dm(a.chunks[0])}}return i9.reset(),YL(i9,n,e,r),i9.toBytes(!0)}function no(t,e){return e=Object.assign({},k0e,e),o9(t,jL,e)}var k0e,jL,i9,op,Ll,Bl,s9=$e(()=>{c();GO();_i();eL();Zi();n9();Ol();ga();jv();I4();Yv();Qv();Xv();Zv();r9();k0e={float64:!1,mapSorter:L0e,quickEncodeToken:WL};jL=D0e(),i9=new Om,op=class{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${dc} object contains circular references`);return new op(r,e)}},Ll={null:new Q(O.null,null),undefined:new Q(O.undefined,void 0),true:new Q(O.true,!0),false:new Q(O.false,!1),emptyArray:new Q(O.array,0),emptyMap:new Q(O.map,0)},Bl={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Q(O.float,t):t>=0?new Q(O.uint,t):new Q(O.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new Q(O.uint,t):new Q(O.negint,t)},Uint8Array(t,e,r,n){return new Q(O.bytes,t)},string(t,e,r,n){return new Q(O.string,t)},boolean(t,e,r,n){return t?Ll.true:Ll.false},null(t,e,r,n){return Ll.null},undefined(t,e,r,n){return Ll.undefined},ArrayBuffer(t,e,r,n){return new Q(O.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new Q(O.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[Ll.emptyArray,new Q(O.break)]:Ll.emptyArray;n=op.createCheck(n,t);let i=[],o=0;for(let s of t)i[o++]=O4(s,r,n);return r.addBreakTokens?[new Q(O.array,t.length),i,new Q(O.break)]:[new Q(O.array,t.length),i]},Object(t,e,r,n){let i=e!=="Object",o=i?t.keys():Object.keys(t),s=i?t.size:o.length;if(!s)return r.addBreakTokens===!0?[Ll.emptyMap,new Q(O.break)]:Ll.emptyMap;n=op.createCheck(n,t);let a=[],l=0;for(let u of o)a[l++]=[O4(u,r,n),O4(i?t.get(u):t[u],r,n)];return O0e(a,r),r.addBreakTokens?[new Q(O.map,s),a,new Q(O.break)]:[new Q(O.map,s),a]}};Bl.Map=Bl.Object;Bl.Buffer=Bl.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Bl[`${t}Array`]=Bl.DataView});function M0e(t,e,r){let n=[];for(let i=0;i<t.value;i++){let o=Fm(e,r);if(o===L4){if(t.value===1/0)break;throw new Error(`${xe} got unexpected break to lengthed array`)}if(o===Um)throw new Error(`${xe} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=o}return n}function U0e(t,e,r){let n=r.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<t.value;s++){let a=Fm(e,r);if(a===L4){if(t.value===1/0)break;throw new Error(`${xe} got unexpected break to lengthed map`)}if(a===Um)throw new Error(`${xe} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${xe} non-string keys not supported (got ${typeof a})`);let l=Fm(e,r);if(l===Um)throw new Error(`${xe} found map but not enough entries (got ${s} [no value], expected ${t.value})`);n?o.set(a,l):i[a]=l}return n?o:i}function Fm(t,e){if(t.done())return Um;let r=t.next();if(r.type===O.break)return L4;if(r.type.terminal)return r.value;if(r.type===O.array)return M0e(r,t,e);if(r.type===O.map)return U0e(r,t,e);if(r.type===O.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let n=Fm(t,e);return e.tags[r.value](n)}throw new Error(`${xe} tag not supported (${r.value})`)}throw new Error("unsupported")}function Mn(t,e){if(!(t instanceof Uint8Array))throw new Error(`${xe} data to decode must be a Uint8Array`);e=Object.assign({},B0e,e);let r=e.tokenizer||new a9(t,e),n=Fm(r,e);if(n===Um)throw new Error(`${xe} did not find any content to decode`);if(n===L4)throw new Error(`${xe} got unexpected break`);if(!r.done())throw new Error(`${xe} too many terminals, data makes no sense`);return n}var B0e,a9,Um,L4,c9=$e(()=>{c();Zi();_i();n9();B0e={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},a9=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=_s[e];if(r===void 0){let n=ie[e];if(!n)throw new Error(`${xe} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;r=n(this.data,this.pos,i,this.options)}return this.pos+=r.encodedLength,r}},Um=Symbol.for("DONE"),L4=Symbol.for("BREAK")});var Of=$e(()=>{c();s9();c9();_i()});var sp,u9,B4=$e(()=>{c();On();sp=({name:t,code:e,encode:r})=>new u9(t,e,r),u9=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?Es(this.code,r):r.then(n=>Es(this.code,n))}else throw Error("Unknown type, must be binary type")}}});var ap=$e(()=>{c();te();b4();Al();B4();On()});var y9=x(up=>{"use strict";c();Object.defineProperty(up,"__esModule",{value:!0});up.fromBase64url=up.toBase64url=void 0;var eB=(Cl(),cr(d4));function t1e(t){return eB.base64url.encode(t).slice(1)}up.toBase64url=t1e;function r1e(t){return eB.base64url.decode(`u${t}`)}up.fromBase64url=r1e});var tB=x(E9=>{"use strict";c();Object.defineProperty(E9,"__esModule",{value:!0});var Mf=y9(),w9=(te(),cr(Nm));function n1e(t){let[e,r,n]=t;return{payload:r,signatures:[{protected:e,signature:n}],link:w9.CID.decode(Mf.fromBase64url(r))}}function i1e(t){let e={signature:Mf.fromBase64url(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=Mf.fromBase64url(t.protected)),e}function o1e(t){let e=Mf.fromBase64url(t.payload);try{w9.CID.decode(e)}catch{throw new Error("Not a valid DagJWS")}return{payload:e,signatures:t.signatures.map(i1e)}}function s1e(t){let e={signature:Mf.toBase64url(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=Mf.toBase64url(t.protected)),e}function a1e(t){let e={payload:Mf.toBase64url(t.payload),signatures:t.signatures.map(s1e)};return e.link=w9.CID.decode(new Uint8Array(t.payload)),e}E9.default={fromSplit:n1e,encode:o1e,decode:a1e}});var rB=x(b9=>{"use strict";c();Object.defineProperty(b9,"__esModule",{value:!0});var Uo=y9();function c1e(t){let[e,r,n,i,o]=t,s={ciphertext:i,iv:n,protected:e,tag:o};return r&&(s.recipients=[{encrypted_key:r}]),s}function l1e(t){let e={};return t.encrypted_key&&(e.encrypted_key=Uo.fromBase64url(t.encrypted_key)),t.header&&(e.header=t.header),e}function u1e(t){let e={ciphertext:Uo.fromBase64url(t.ciphertext),protected:Uo.fromBase64url(t.protected),iv:Uo.fromBase64url(t.iv),tag:Uo.fromBase64url(t.tag)};return t.aad&&(e.aad=Uo.fromBase64url(t.aad)),t.recipients&&(e.recipients=t.recipients.map(l1e)),t.unprotected&&(e.unprotected=t.unprotected),e}function f1e(t){let e={};return t.encrypted_key&&(e.encrypted_key=Uo.toBase64url(t.encrypted_key)),t.header&&(e.header=t.header),e}function h1e(t){let e={ciphertext:Uo.toBase64url(t.ciphertext),protected:Uo.toBase64url(t.protected),iv:Uo.toBase64url(t.iv),tag:Uo.toBase64url(t.tag)};return t.aad&&(e.aad=Uo.toBase64url(t.aad)),t.recipients&&(e.recipients=t.recipients.map(f1e)),t.unprotected&&(e.unprotected=t.unprotected),e}b9.default={fromSplit:c1e,decode:h1e,encode:u1e}});var oB={};_t(oB,{code:()=>E1e,decode:()=>_1e,encode:()=>b1e,name:()=>w1e});function d1e(t){if(t.asCID!==t)return null;let e=T.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Q(O.tag,nB),new Q(O.bytes,r)]}function p1e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function m1e(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function y1e(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return T.decode(t.subarray(1))}var nB,g1e,iB,w1e,E1e,b1e,_1e,sB=$e(()=>{c();Of();te();nB=42;g1e={float64:!0,typeEncoders:{Object:d1e,undefined:p1e,number:m1e}};iB={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};iB.tags[nB]=y1e;w1e="dag-cbor",E1e=113,b1e=t=>no(t,g1e),_1e=t=>Mn(t,iB)});var S9=x(fn=>{"use strict";c();var v1e=fn&&fn.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),S1e=fn&&fn.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),x1e=fn&&fn.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&v1e(e,t,r);return S1e(e,t),e},aB=fn&&fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fn,"__esModule",{value:!0});fn.decode=fn.encode=fn.toGeneral=fn.code=fn.name=void 0;var _9=aB(tB()),v9=aB(rB()),cB=x1e((sB(),cr(oB)));fn.name="dag-jose";fn.code=133;function lB(t){return"payload"in t&&typeof t.payload=="string"&&"signatures"in t&&Array.isArray(t.signatures)}function R1e(t){return"payload"in t&&t.payload instanceof Uint8Array&&"signatures"in t&&Array.isArray(t.signatures)}function T1e(t){return"ciphertext"in t&&t.ciphertext instanceof Uint8Array&&"iv"in t&&t.iv instanceof Uint8Array&&"protected"in t&&t.protected instanceof Uint8Array&&"tag"in t&&t.tag instanceof Uint8Array}function uB(t){return"ciphertext"in t&&typeof t.ciphertext=="string"&&"iv"in t&&typeof t.iv=="string"&&"protected"in t&&typeof t.protected=="string"&&"tag"in t&&typeof t.tag=="string"}function fB(t){if(typeof t=="string"){let e=t.split(".");if(e.length===3)return _9.default.fromSplit(e);if(e.length===5)return v9.default.fromSplit(e);throw new Error("Not a valid JOSE string")}if(lB(t)||uB(t))return t;throw new Error("Not a valid unencoded JOSE object")}fn.toGeneral=fB;function A1e(t){typeof t=="string"&&(t=fB(t));let e;if(lB(t))e=_9.default.encode(t);else if(uB(t))e=v9.default.encode(t);else throw new Error("Not a valid JOSE object");return new Uint8Array(cB.encode(e))}fn.encode=A1e;function I1e(t){let e;try{e=cB.decode(t)}catch{throw new Error("Not a valid DAG-JOSE object")}if(R1e(e))return _9.default.decode(e);if(T1e(e))return v9.default.decode(e);throw new Error("Not a valid DAG-JOSE object")}fn.decode=I1e});var x9={};_t(x9,{identity:()=>hn});var hB,C1e,dB,P1e,hn,gc=$e(()=>{c();Al();On();hB=0,C1e="identity",dB=Oo,P1e=t=>Es(hB,dB(t)),hn={code:hB,name:C1e,encode:dB,digest:P1e}});var R9={};_t(R9,{identity:()=>N1e});var N1e,pB=$e(()=>{c();la();Al();N1e=h4({prefix:"\0",name:"identity",encode:t=>bv(t),decode:t=>Ev(t)})});var T9={};_t(T9,{base2:()=>k1e});var k1e,mB=$e(()=>{c();la();k1e=qr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})});var A9={};_t(A9,{base8:()=>D1e});var D1e,gB=$e(()=>{c();la();D1e=qr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})});var I9={};_t(I9,{base10:()=>O1e});var O1e,yB=$e(()=>{c();la();O1e=Il({prefix:"9",name:"base10",alphabet:"0123456789"})});var C9={};_t(C9,{base16:()=>L1e,base16upper:()=>B1e});var L1e,B1e,wB=$e(()=>{c();la();L1e=qr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),B1e=qr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});var P9={};_t(P9,{base36:()=>fp,base36upper:()=>M1e});var fp,M1e,M4=$e(()=>{c();la();fp=Il({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),M1e=Il({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})});var N9={};_t(N9,{sha256:()=>Be,sha512:()=>U1e});var EB,Be,U1e,zr=$e(()=>{c();B4();EB=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Be=sp({name:"sha2-256",code:18,encode:EB("SHA-256")}),U1e=sp({name:"sha2-512",code:19,encode:EB("SHA-512")})});var Bi={};_t(Bi,{code:()=>Un,decode:()=>V1e,encode:()=>K1e,name:()=>F1e});var F1e,Un,K1e,V1e,Fo=$e(()=>{c();Al();F1e="raw",Un=85,K1e=t=>Oo(t),V1e=t=>Oo(t)});var U4={};_t(U4,{code:()=>k9,decode:()=>G1e,encode:()=>$1e,name:()=>H1e});var q1e,z1e,H1e,k9,$1e,G1e,D9=$e(()=>{c();q1e=new TextEncoder,z1e=new TextDecoder,H1e="json",k9=512,$1e=t=>q1e.encode(JSON.stringify(t)),G1e=t=>JSON.parse(z1e.decode(t))});var ya,F4,K4,Vm=$e(()=>{c();pB();mB();gB();yB();wB();si();M4();en();Cl();zr();gc();Fo();D9();ap();ya={...R9,...T9,...A9,...I9,...C9,...Sm,...P9,...jd,...d4},F4={...N9,...x9},K4={raw:Bi,json:U4}});function _B(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var bB,L9,W1e,V4,B9=$e(()=>{c();Vm();bB=_B("utf8","u",t=>{let e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),L9=_B("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),W1e={utf8:bB,"utf-8":bB,hex:ya.base16,latin1:L9,ascii:L9,binary:L9,...ya},V4=W1e});var M9={};_t(M9,{fromString:()=>U});function U(t,e="utf8"){let r=V4[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}var Ae=$e(()=>{c();B9()});var xB=x((KBe,SB)=>{"use strict";c();var vB="[a-fA-F\\d:]",Ml=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${vB})|(?<=${vB})(?=\\s|$))`:"",xs="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",dn="[a-fA-F\\d]{1,4}",q4=`
(?:
(?:${dn}:){7}(?:${dn}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${dn}:){6}(?:${xs}|:${dn}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${dn}:){5}(?::${xs}|(?::${dn}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${dn}:){4}(?:(?::${dn}){0,1}:${xs}|(?::${dn}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${dn}:){3}(?:(?::${dn}){0,2}:${xs}|(?::${dn}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${dn}:){2}(?:(?::${dn}){0,3}:${xs}|(?::${dn}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${dn}:){1}(?:(?::${dn}){0,4}:${xs}|(?::${dn}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${dn}){0,5}:${xs}|(?::${dn}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),j1e=new RegExp(`(?:^${xs}$)|(?:^${q4}$)`),Y1e=new RegExp(`^${xs}$`),Q1e=new RegExp(`^${q4}$`),U9=t=>t&&t.exact?j1e:new RegExp(`(?:${Ml(t)}${xs}${Ml(t)})|(?:${Ml(t)}${q4}${Ml(t)})`,"g");U9.v4=t=>t&&t.exact?Y1e:new RegExp(`${Ml(t)}${xs}${Ml(t)}`,"g");U9.v6=t=>t&&t.exact?Q1e:new RegExp(`${Ml(t)}${q4}${Ml(t)}`,"g");SB.exports=U9});var TB=x((VBe,RB)=>{"use strict";c();var F9=xB(),hp=t=>F9({exact:!0}).test(t);hp.v4=t=>F9.v4({exact:!0}).test(t);hp.v6=t=>F9.v6({exact:!0}).test(t);hp.version=t=>hp(t)?hp.v4(t)?4:6:void 0;RB.exports=hp});var dp={};_t(dp,{toString:()=>F});function F(t,e="utf8"){let r=V4[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var Re=$e(()=>{c();B9()});var NB=x((zBe,PB)=>{"use strict";c();var V9=TB(),{toString:AB}=(Re(),cr(dp)),X1e=V9,K9=V9.v4,IB=V9.v6,CB=function(t,e,r){r=~~r;let n;if(K9(t))n=e||new Uint8Array(r+4),t.split(/\./g).map(function(i){n[r++]=parseInt(i,10)&255});else if(IB(t)){let i=t.split(":",8),o;for(o=0;o<i.length;o++){let s=K9(i[o]),a;s&&(a=CB(i[o]),i[o]=AB(a.slice(0,2),"base16")),a&&++o<8&&i.splice(o,0,AB(a.slice(2,4),"base16"))}if(i[0]==="")for(;i.length<8;)i.unshift("0");else if(i[i.length-1]==="")for(;i.length<8;)i.push("0");else if(i.length<8){for(o=0;o<i.length&&i[o]!=="";o++);let s=[o,"1"];for(o=9-i.length;o>0;o--)s.push("0");i.splice.apply(i,s)}for(n=e||new Uint8Array(r+16),o=0;o<i.length;o++){let s=parseInt(i[o],16);n[r++]=s>>8&255,n[r++]=s&255}}if(!n)throw Error("Invalid ip address: "+t);return n},Z1e=function(t,e,r){e=~~e,r=r||t.length-e;let n=[],i,o=new DataView(t.buffer);if(r===4){for(let s=0;s<r;s++)n.push(t[e+s]);i=n.join(".")}else if(r===16){for(let s=0;s<r;s+=2)n.push(o.getUint16(e+s).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};PB.exports={isIP:X1e,isV4:K9,isV6:IB,toBytes:CB,toString:Z1e}});var z4=x((HBe,DB)=>{"use strict";c();function Mi(t){if(typeof t=="number"){if(Mi.codes[t])return Mi.codes[t];throw new Error("no protocol with code: "+t)}else if(typeof t=="string"){if(Mi.names[t])return Mi.names[t];throw new Error("no protocol with name: "+t)}throw new Error("invalid protocol id type: "+t)}var Ko=-1;Mi.lengthPrefixedVarSize=Ko;Mi.V=Ko;Mi.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Ko,"ip6zone"],[53,Ko,"dns","resolvable"],[54,Ko,"dns4","resolvable"],[55,Ko,"dns6","resolvable"],[56,Ko,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Ko,"unix",!1,"path"],[421,Ko,"ipfs"],[421,Ko,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Ko,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,Ko,"memory"]];Mi.names={};Mi.codes={};Mi.table.map(t=>{let e=kB.apply(null,t);return Mi.codes[e.code]=e,Mi.names[e.name]=e,null});Mi.object=kB;function kB(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}DB.exports=Mi});var BB=x(($Be,LB)=>{c();LB.exports=q9;var OB=128,J1e=127,eme=~J1e,tme=Math.pow(2,31);function q9(t,e,r){if(Number.MAX_SAFE_INTEGER&&t>Number.MAX_SAFE_INTEGER)throw q9.bytes=0,new RangeError("Could not encode varint");e=e||[],r=r||0;for(var n=r;t>=tme;)e[r++]=t&255|OB,t/=128;for(;t&eme;)e[r++]=t&255|OB,t>>>=7;return e[r]=t|0,q9.bytes=r-n+1,e}});var FB=x((GBe,UB)=>{c();UB.exports=z9;var rme=128,MB=127;function z9(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a||i>49)throw z9.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&MB)<<i:(s&MB)*Math.pow(2,i),i+=7}while(s>=rme);return z9.bytes=o-n,r}});var VB=x((WBe,KB)=>{c();var nme=Math.pow(2,7),ime=Math.pow(2,14),ome=Math.pow(2,21),sme=Math.pow(2,28),ame=Math.pow(2,35),cme=Math.pow(2,42),lme=Math.pow(2,49),ume=Math.pow(2,56),fme=Math.pow(2,63);KB.exports=function(t){return t<nme?1:t<ime?2:t<ome?3:t<sme?4:t<ame?5:t<cme?6:t<lme?7:t<ume?8:t<fme?9:10}});var ai=x((jBe,qB)=>{c();qB.exports={encode:BB(),decode:FB(),encodingLength:VB()}});var qm={};_t(qm,{concat:()=>Pe});function Pe(t,e){e||(e=t.reduce((i,o)=>i+o.length,0));let r=new Uint8Array(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}var Pr=$e(()=>{c()});var QB=x((YBe,YB)=>{"use strict";c();var H4=NB(),$B=z4(),{CID:hme}=(te(),cr(Nm)),{base32:GB}=(si(),cr(Sm)),{base58btc:dme}=(en(),cr(jd)),pme=(On(),cr(xn)),pp=ai(),{toString:$4}=(Re(),cr(dp)),{fromString:WB}=(Ae(),cr(M9)),{concat:G4}=(Pr(),cr(qm));YB.exports=zm;function zm(t,e){return e instanceof Uint8Array?zm.toString(t,e):zm.toBytes(t,e)}zm.toString=function(e,r){switch($B(e).code){case 4:case 41:return mme(r);case 6:case 273:case 33:case 132:return jB(r).toString();case 53:case 54:case 55:case 56:case 400:case 777:return yme(r);case 421:return Eme(r);case 444:return HB(r);case 445:return HB(r);default:return $4(r,"base16")}};zm.toBytes=function(e,r){switch($B(e).code){case 4:return zB(r);case 41:return zB(r);case 6:case 273:case 33:case 132:return H9(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 777:return gme(r);case 421:return wme(r);case 444:return bme(r);case 445:return _me(r);default:return WB(r,"base16")}};function zB(t){if(!H4.isIP(t))throw new Error("invalid ip address");return H4.toBytes(t)}function mme(t){let e=H4.toString(t);if(!e||!H4.isIP(e))throw new Error("invalid ip address");return e}function H9(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function jB(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function gme(t){let e=WB(t),r=Uint8Array.from(pp.encode(e.length));return G4([r,e],r.length+e.length)}function yme(t){let e=pp.decode(t);if(t=t.slice(pp.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return $4(t)}function wme(t){let e;t[0]==="Q"||t[0]==="1"?e=pme.decode(dme.decode(`z${t}`)).bytes:e=hme.parse(t).multihash.bytes;let r=Uint8Array.from(pp.encode(e.length));return G4([r,e],r.length+e.length)}function Eme(t){let e=pp.decode(t),r=t.slice(pp.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return $4(r,"base58btc")}function bme(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==16)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion address.");let r=GB.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=H9(n);return G4([r,i],r.length+i.length)}function _me(t){let e=t.split(":");if(e.length!==2)throw new Error("failed to parse onion addr: "+e+" does not contain a port number");if(e[0].length!==56)throw new Error("failed to parse onion addr: "+e[0]+" not a Tor onion3 address.");let r=GB.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=H9(n);return G4([r,i],r.length+i.length)}function HB(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=$4(e,"base32"),i=jB(r);return n+":"+i}});var cM=x((QBe,aM)=>{"use strict";c();var ZB=QB(),$9=z4(),Hm=ai(),{concat:XB}=(Pr(),cr(qm)),{toString:vme}=(Re(),cr(dp));aM.exports={stringToStringTuples:JB,stringTuplesToString:eM,tuplesToStringTuples:rM,stringTuplesToTuples:tM,bytesToTuples:G9,tuplesToBytes:nM,bytesToString:Sme,stringToBytes:oM,fromString:xme,fromBytes:sM,validateBytes:W9,isValidBytes:Rme,cleanPath:W4,ParseError:j9,protoFromTuple:$m,sizeForAddr:iM};function JB(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],o=$9(i);if(o.size===0){e.push([i]);continue}if(n++,n>=r.length)throw j9("invalid address: "+t);if(o.path){e.push([i,W4(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function eM(t){let e=[];return t.map(r=>{let n=$m(r);return e.push(n.name),r.length>1&&e.push(r[1]),null}),W4(e.join("/"))}function tM(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=$m(e);return e.length>1?[r.code,ZB.toBytes(r.code,e[1])]:[r.code]})}function rM(t){return t.map(e=>{let r=$m(e);return e[1]?[r.code,ZB.toString(r.code,e[1])]:[r.code]})}function nM(t){return sM(XB(t.map(e=>{let r=$m(e),n=Uint8Array.from(Hm.encode(r.code));return e.length>1&&(n=XB([n,e[1]])),n})))}function iM(t,e){return t.size>0?t.size/8:t.size===0?0:Hm.decode(e)+Hm.decode.bytes}function G9(t){let e=[],r=0;for(;r<t.length;){let n=Hm.decode(t,r),i=Hm.decode.bytes,o=$9(n),s=iM(o,t.slice(r+i));if(s===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+s);if(r+=s+i,r>t.length)throw j9("Invalid address Uint8Array: "+vme(t,"base16"));e.push([n,a])}return e}function Sme(t){let e=G9(t),r=rM(e);return eM(r)}function oM(t){t=W4(t);let e=JB(t),r=tM(e);return nM(r)}function xme(t){return oM(t)}function sM(t){let e=W9(t);if(e)throw e;return Uint8Array.from(t)}function W9(t){try{G9(t)}catch(e){return e}}function Rme(t){return W9(t)===void 0}function W4(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function j9(t){return new Error("Error parsing address: "+t)}function $m(t){return $9(t[0])}});var lM={};_t(lM,{equals:()=>Me});function Me(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var Mr=$e(()=>{c()});var Y4=x((XBe,hM)=>{"use strict";c();var Rs=cM(),mp=z4(),uM=ai(),{CID:Tme}=(te(),cr(Nm)),{base58btc:Ame}=(en(),cr(jd)),Ime=V(),Cme=Symbol.for("nodejs.util.inspect.custom"),{toString:j4}=(Re(),cr(dp)),{equals:Pme}=(Mr(),cr(lM)),Y9=new Map,fM=Symbol.for("@multiformats/js-multiaddr/multiaddr"),ci=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,fM,{value:!0}),e instanceof Uint8Array)this.bytes=Rs.fromBytes(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=Rs.fromString(e)}else if(ci.isMultiaddr(e))this.bytes=Rs.fromBytes(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return Rs.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){let e={},r=this.toString().split("/");return e.family=r[1]==="ip4"?4:6,e.host=r[2],e.transport=r[3],e.port=parseInt(r[4]),e}protos(){return this.protoCodes().map(e=>Object.assign({},mp(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=uM.decode(r,n),o=uM.decode.bytes,s=mp(i);n+=Rs.sizeForAddr(s,r.slice(n+o))+o,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return Rs.bytesToTuples(this.bytes)}stringTuples(){let e=Rs.bytesToTuples(this.bytes);return Rs.tuplesToStringTuples(e)}encapsulate(e){return e=new ci(e),new ci(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error("Address "+this+" does not contain subaddress: "+e);return new ci(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new ci(Rs.tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===mp.names.ipfs.code).pop();if(r&&r[1]){let n=r[1];return n[0]==="Q"||n[0]==="1"?j4(Ame.decode(`z${n}`),"base58btc"):j4(Tme.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>!!mp(r[0]).path)[0][1],e||(e=null)}catch{e=null}return e}equals(e){return Pme(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(!e)return[this];let r=Y9.get(e.name);if(!r)throw Ime(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new ci(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e||this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(!e)throw new Error("requires node address object");if(!r)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error(`Invalid addr family. Got '${e.family}' instead of 4 or 6`)}return new ci("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return ci.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return e instanceof ci||Boolean(e&&e[fM])}[Cme](){return"<Multiaddr "+j4(this.bytes,"base16")+" - "+Rs.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+j4(this.bytes,"base16")+" - "+Rs.bytesToString(this.bytes)+">"}};ci.protocols=mp;ci.resolvers=Y9;function Nme(t){return new ci(t)}hM.exports={Multiaddr:ci,multiaddr:Nme,protocols:mp,resolvers:Y9}});var SM=x((ZBe,vM)=>{"use strict";c();var{Multiaddr:Q9}=Y4(),mM=Ke("dns4"),gM=Ke("dns6"),yM=Ke("dnsaddr"),Kf=li(Ke("dns"),yM,mM,gM),Gm=li(Ke("ip4"),Ke("ip6")),bp=li(ut(Gm,Ke("tcp")),ut(Kf,Ke("tcp"))),X9=ut(Gm,Ke("udp")),wM=ut(X9,Ke("utp")),EM=ut(X9,Ke("quic")),yp=li(ut(bp,Ke("ws")),ut(Kf,Ke("ws"))),wp=li(ut(bp,Ke("wss")),ut(Kf,Ke("wss"))),Q4=li(ut(bp,Ke("http")),ut(Gm,Ke("http")),ut(Kf,Ke("http"))),X4=li(ut(bp,Ke("https")),ut(Gm,Ke("https")),ut(Kf,Ke("https"))),Z9=li(ut(yp,Ke("p2p-webrtc-star"),Ke("p2p")),ut(wp,Ke("p2p-webrtc-star"),Ke("p2p")),ut(yp,Ke("p2p-webrtc-star")),ut(wp,Ke("p2p-webrtc-star"))),kme=li(ut(yp,Ke("p2p-websocket-star"),Ke("p2p")),ut(wp,Ke("p2p-websocket-star"),Ke("p2p")),ut(yp,Ke("p2p-websocket-star")),ut(wp,Ke("p2p-websocket-star"))),J9=li(ut(Q4,Ke("p2p-webrtc-direct"),Ke("p2p")),ut(X4,Ke("p2p-webrtc-direct"),Ke("p2p")),ut(Q4,Ke("p2p-webrtc-direct")),ut(X4,Ke("p2p-webrtc-direct"))),Ep=li(yp,wp,Q4,X4,Z9,J9,bp,wM,EM,Kf),Dme=li(ut(Ep,Ke("p2p-stardust"),Ke("p2p")),ut(Ep,Ke("p2p-stardust"))),Ul=li(ut(Ep,Ke("p2p")),Z9,J9,Ke("p2p")),dM=li(ut(Ul,Ke("p2p-circuit"),Ul),ut(Ul,Ke("p2p-circuit")),ut(Ke("p2p-circuit"),Ul),ut(Ep,Ke("p2p-circuit")),ut(Ke("p2p-circuit"),Ep),Ke("p2p-circuit")),bM=()=>li(ut(dM,bM),dM),gp=bM(),pM=li(ut(gp,Ul,gp),ut(Ul,gp),ut(gp,Ul),gp,Ul);vM.exports={DNS:Kf,DNS4:mM,DNS6:gM,DNSADDR:yM,IP:Gm,TCP:bp,UDP:X9,QUIC:EM,UTP:wM,HTTP:Q4,HTTPS:X4,WebSockets:yp,WebSocketsSecure:wp,WebSocketStar:kme,WebRTCStar:Z9,WebRTCDirect:J9,Reliable:Ep,Stardust:Dme,Circuit:gp,P2P:pM,IPFS:pM};function _M(t){function e(r){if(!Q9.isMultiaddr(r))try{r=new Q9(r)}catch{return!1}let n=t(r.protoNames());return n===null?!1:n===!0||n===!1?n:n.length===0}return e}function ut(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:_M(e),partialMatch:e}}function li(...t){function e(n){let i=null;return t.some(o=>{let s=typeof o=="function"?o().partialMatch(n):o.partialMatch(n);return s?(i=s,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:_M(e),partialMatch:e}}function Ke(t){let e=t;function r(i){let o;if(typeof i=="string"||i instanceof Uint8Array)try{o=new Q9(i)}catch{return!1}else o=i;let s=o.protoNames();return s.length===1&&s[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}});var tS=x((JBe,RM)=>{"use strict";c();var Ome=typeof navigator<"u"&&navigator.product==="ReactNative";function Lme(){return Ome?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}var Wm=self.URL,xM=Lme(),eS=class{constructor(e="",r=xM){this.super=new Wm(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return Wm.createObjectURL(e)}static revokeObjectURL(e){Wm.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Bme(t){if(typeof t=="string")return new Wm(t).toString();if(!(t instanceof Wm)){let e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",o=t.host||"",s=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),l=t.hash||"",u=t.pathname||"",f=t.path||u+a;return`${i}${e||r}${o||s+n}${f}${l}`}}RM.exports={URLWithLegacySupport:eS,URLSearchParams:self.URLSearchParams,defaultBase:xM,format:Bme}});var IM=x((eMe,AM)=>{"use strict";c();var{URLWithLegacySupport:TM,format:Mme}=tS();AM.exports=(t,e={},r={},n)=>{let i=e.protocol?e.protocol.replace(":",""):"http";i=(r[i]||n||i)+":";let o;try{o=new TM(t)}catch{o={}}let s=Object.assign({},e,{protocol:i||o.protocol,host:e.host||o.host});return new TM(t,Mme(s)).toString()}});var Z4=x((tMe,CM)=>{"use strict";c();var{URLWithLegacySupport:Ume,format:Fme,URLSearchParams:Kme,defaultBase:Vme}=tS(),qme=IM();CM.exports={URL:Ume,URLSearchParams:Kme,format:Fme,relative:qme,defaultBase:Vme}});var Xm=x((rMe,qM)=>{"use strict";c();var{base58btc:zme}=(en(),cr(jd)),{base32:Hme}=(si(),cr(Sm)),$me=(On(),cr(xn)),{Multiaddr:PM}=Y4(),Gme=SM(),{CID:rS}=(te(),cr(Nm)),{URL:Wme}=Z4(),{toString:jme}=(Re(),cr(dp)),nS=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,_p=/^\/(ip[fn]s)\/([^/?#]+)/,DM=1,OM=2,Qm=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,LM=1,BM=2,Yme=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function Qme(t){let e=iS(t);try{$me.decode(zme.decode("z"+e))}catch{return!1}return!0}function Xme(t){try{Hme.decode(t)}catch{return!1}return!0}function jm(t){try{return typeof t=="string"?Boolean(rS.parse(t)):t instanceof Uint8Array?Boolean(rS.decode(t)):Boolean(rS.asCID(t))}catch{return!1}}function MM(t){if(!t)return!1;if(PM.isMultiaddr(t))return!0;try{return new PM(t),!0}catch{return!1}}function Zme(t){return MM(t)&&Gme.P2P.matches(t)}function Ym(t,e,r=DM,n=OM){let i=iS(t);if(!i)return!1;let o=i.match(e);if(!o||o[r]!=="ipfs")return!1;let s=o[n];return s&&e===Qm&&(s=s.toLowerCase()),jm(s)}function J4(t,e,r=DM,n=OM){let i=iS(t);if(!i)return!1;let o=i.match(e);if(!o||o[r]!=="ipns")return!1;let s=o[n];if(s&&e===Qm){if(s=s.toLowerCase(),jm(s))return!0;try{!s.includes(".")&&s.includes("-")&&(s=s.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));let{hostname:a}=new Wme(`http://${s}`);return Yme.test(a)}catch{return!1}}return!0}function UM(t){return typeof t=="string"}function iS(t){return t instanceof Uint8Array?jme(t,"base58btc"):UM(t)?t:!1}var oS=t=>Ym(t,Qm,BM,LM),sS=t=>J4(t,Qm,BM,LM),FM=t=>oS(t)||sS(t),KM=t=>Ym(t,nS)||oS(t),VM=t=>J4(t,nS)||sS(t),NM=t=>KM(t)||VM(t)||FM(t),kM=t=>Ym(t,_p)||J4(t,_p);qM.exports={multihash:Qme,multiaddr:MM,peerMultiaddr:Zme,cid:jm,base32cid:t=>Xme(t)&&jm(t),ipfsSubdomain:oS,ipnsSubdomain:sS,subdomain:FM,subdomainGatewayPattern:Qm,ipfsUrl:KM,ipnsUrl:VM,url:NM,pathGatewayPattern:nS,ipfsPath:t=>Ym(t,_p),ipnsPath:t=>J4(t,_p),path:kM,pathPattern:_p,urlOrPath:t=>NM(t)||kM(t),cidPath:t=>UM(t)&&!jm(t)&&Ym(`/ipfs/${t}`,_p)}});var zM,HM=$e(()=>{c();zM="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"});var aS={};_t(aS,{customAlphabet:()=>Jme,customRandom:()=>GM,nanoid:()=>Vf,random:()=>$M,urlAlphabet:()=>zM});var $M,GM,Jme,Vf,vp=$e(()=>{c();HM();$M=t=>crypto.getRandomValues(new Uint8Array(t)),GM=(t,e,r)=>{let n=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*n*e/t.length);return(o=e)=>{let s="";for(;;){let a=r(i),l=i;for(;l--;)if(s+=t[a[l]&n]||"",s.length===o)return s}}},Jme=(t,e=21)=>GM(t,e,$M),Vf=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,r)=>(r&=63,r<36?e+=r.toString(36):r<62?e+=(r-26).toString(36).toUpperCase():r>62?e+="-":e+="_",e),"")});var YM=x((lMe,jM)=>{"use strict";c();jM.exports=function(){return Date.now()}});var Zm=x((uMe,QM)=>{"use strict";c();var tw=YM(),cS=class{constructor(e,r,n){let i=this;this._started=tw(),this._rescheduled=0,this._scheduled=r,this._args=n,this._triggered=!1,this._timerWrapper=()=>{i._rescheduled>0?(i._scheduled=i._rescheduled-(tw()-i._started),i._schedule(i._scheduled)):(i._triggered=!0,e.apply(null,i._args))},this._timer=setTimeout(this._timerWrapper,r)}reschedule(e){e||(e=this._scheduled);let r=tw();r+e-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(e)):this._triggered?this._schedule(e):(this._started=r,this._rescheduled=e)}_schedule(e){this._triggered=!1,this._started=tw(),this._rescheduled=0,this._scheduled=e,this._timer=setTimeout(this._timerWrapper,e)}clear(){clearTimeout(this._timer)}};function n2e(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let t;if(arguments.length>0){t=new Array(arguments.length-2);for(var e=0;e<t.length;e++)t[e]=arguments[e+2]}return new cS(arguments[0],arguments[1],t)}QM.exports=n2e});var Vo=x((fMe,ZM)=>{"use strict";c();var{AbortController:i2e}=globalThis,XM=Zm(),Jm=class extends i2e{constructor(e){super(),this._ms=e,this._timer=XM(()=>this.abort(),e),Object.setPrototypeOf(this,Jm.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=XM(()=>this.abort(),this._ms)}};ZM.exports={TimeoutController:Jm}});var Ui=x((hMe,lS)=>{c();function JM(t){let e=new globalThis.AbortController;function r(){e.abort();for(let n of t)!n||!n.removeEventListener||n.removeEventListener("abort",r)}for(let n of t)if(!(!n||!n.addEventListener)){if(n.aborted){r();break}n.addEventListener("abort",r)}return e.signal}lS.exports=JM;lS.exports.anySignal=JM});var xp=x((kMe,lU)=>{c();lU.exports=function(t){if(!t)throw Error("hashlru must have a max value, of type number, greater than 0");var e=0,r=Object.create(null),n=Object.create(null);function i(o,s){r[o]=s,e++,e>=t&&(e=0,n=r,r=Object.create(null))}return{has:function(o){return r[o]!==void 0||n[o]!==void 0},remove:function(o){r[o]!==void 0&&(r[o]=void 0),n[o]!==void 0&&(n[o]=void 0)},get:function(o){var s=r[o];if(s!==void 0)return s;if((s=n[o])!==void 0)return i(o,s),s},set:function(o,s){r[o]!==void 0?r[o]=s:i(o,s)},clear:function(){r=Object.create(null),n=Object.create(null)}}}});var ql=x((OMe,hS)=>{"use strict";c();var a2e=Object.prototype.hasOwnProperty,vi="~";function r2(){}Object.create&&(r2.prototype=Object.create(null),new r2().__proto__||(vi=!1));function c2e(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function fU(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new c2e(r,n||t,i),s=vi?vi+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++),t}function ow(t,e){--t._eventsCount===0?t._events=new r2:delete t._events[e]}function fi(){this._events=new r2,this._eventsCount=0}fi.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)a2e.call(r,n)&&e.push(vi?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};fi.prototype.listeners=function(e){var r=vi?vi+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};fi.prototype.listenerCount=function(e){var r=vi?vi+e:e,n=this._events[r];return n?n.fn?1:n.length:0};fi.prototype.emit=function(e,r,n,i,o,s){var a=vi?vi+e:e;if(!this._events[a])return!1;var l=this._events[a],u=arguments.length,f,h;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),u){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,i),!0;case 5:return l.fn.call(l.context,r,n,i,o),!0;case 6:return l.fn.call(l.context,r,n,i,o,s),!0}for(h=1,f=new Array(u-1);h<u;h++)f[h-1]=arguments[h];l.fn.apply(l.context,f)}else{var p=l.length,d;for(h=0;h<p;h++)switch(l[h].once&&this.removeListener(e,l[h].fn,void 0,!0),u){case 1:l[h].fn.call(l[h].context);break;case 2:l[h].fn.call(l[h].context,r);break;case 3:l[h].fn.call(l[h].context,r,n);break;case 4:l[h].fn.call(l[h].context,r,n,i);break;default:if(!f)for(d=1,f=new Array(u-1);d<u;d++)f[d-1]=arguments[d];l[h].fn.apply(l[h].context,f)}}return!0};fi.prototype.on=function(e,r,n){return fU(this,e,r,n,!1)};fi.prototype.once=function(e,r,n){return fU(this,e,r,n,!0)};fi.prototype.removeListener=function(e,r,n,i){var o=vi?vi+e:e;if(!this._events[o])return this;if(!r)return ow(this,o),this;var s=this._events[o];if(s.fn)s.fn===r&&(!i||s.once)&&(!n||s.context===n)&&ow(this,o);else{for(var a=0,l=[],u=s.length;a<u;a++)(s[a].fn!==r||i&&!s[a].once||n&&s[a].context!==n)&&l.push(s[a]);l.length?this._events[o]=l.length===1?l[0]:l:ow(this,o)}return this};fi.prototype.removeAllListeners=function(e){var r;return e?(r=vi?vi+e:e,this._events[r]&&ow(this,r)):(this._events=new r2,this._eventsCount=0),this};fi.prototype.off=fi.prototype.removeListener;fi.prototype.addListener=fi.prototype.on;fi.prefixed=vi;fi.EventEmitter=fi;typeof hS<"u"&&(hS.exports=fi)});var _S=x(dw=>{"use strict";c();var wS=class extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}};dw.TimeoutError=wS;var ES=class extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}};dw.AbortError=ES;var bS=class extends Error{constructor(e){super(e.statusText),this.name="HTTPError",this.response=e}};dw.HTTPError=bS});var _U=x(()=>{c()});var l2=x((Ap,vU)=>{"use strict";c();var u2e=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof Sc<"u")return Sc;throw new Error("unable to locate global object")},Sc=u2e();vU.exports=Ap=Sc.fetch;Sc.fetch&&(Ap.default=Sc.fetch.bind(Sc));Ap.Headers=Sc.Headers;Ap.Request=Sc.Request;Ap.Response=Sc.Response});var SU=x(($Me,vS)=>{"use strict";c();globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?vS.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:vS.exports={default:l2().default,Headers:l2().Headers,Request:l2().Request,Response:l2().Response}});var xU=x((GMe,SS)=>{"use strict";c();var{isElectronMain:f2e}=l4();f2e?SS.exports=_U():SS.exports=SU()});var AU=x((WMe,TU)=>{"use strict";c();var{TimeoutError:h2e,AbortError:d2e}=_S(),{Response:RU,Request:p2e,Headers:RS,default:m2e}=xU(),g2e=(t,e={})=>{let r=new XMLHttpRequest;r.open(e.method||"GET",t.toString(),!0);let{timeout:n,headers:i}=e;if(n&&n>0&&n<1/0&&(r.timeout=n),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),i)for(let[o,s]of new RS(i))r.setRequestHeader(o,s);return e.signal&&(e.signal.onabort=()=>r.abort()),e.onUploadProgress&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((o,s)=>{let a=l=>{switch(l.type){case"error":{o(RU.error());break}case"load":{o(new xS(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:E2e(r.getAllResponseHeaders())}));break}case"timeout":{s(new h2e);break}case"abort":{s(new d2e);break}default:break}};r.onerror=a,r.onload=a,r.ontimeout=a,r.onabort=a,r.send(e.body)})},y2e=m2e,w2e=(t,e={})=>e.onUploadProgress!=null?g2e(t,e):y2e(t,e),E2e=t=>{let e=new RS;for(let r of t.trim().split(/[\r\n]+/)){let n=r.indexOf(": ");n>0&&e.set(r.slice(0,n),r.slice(n+1))}return e},xS=class extends RU{constructor(e,r,n){super(r,n),Object.defineProperty(this,"url",{value:e})}};TU.exports={fetch:w2e,Request:p2e,Headers:RS}});var Ip=x((jMe,DU)=>{"use strict";c();var{fetch:b2e,Request:_2e,Headers:v2e}=AU(),{TimeoutError:TS,HTTPError:NU}=_S(),IU=mv().bind({ignoreUndefined:!0}),{URL:CU,URLSearchParams:PU}=Z4(),S2e=Ui(),x2e=(t,e,r)=>{if(e===void 0)return t;let n=Date.now(),i=()=>Date.now()-n>=e;return new Promise((o,s)=>{let a=setTimeout(()=>{i()&&(s(new TS),r.abort())},e),l=u=>h=>{if(clearTimeout(a),i()){s(new TS);return}u(h)};t.then(l(o),l(s))})},R2e={throwHttpErrors:!0,credentials:"same-origin"},di=class{constructor(e={}){this.opts=IU(R2e,e)}async fetch(e,r={}){let n=IU(this.opts,r),i=new v2e(n.headers);if(typeof e!="string"&&!(e instanceof CU||e instanceof _2e))throw new TypeError("`resource` must be a string, URL, or Request");let o=new CU(e.toString(),n.base),{searchParams:s,transformSearchParams:a,json:l}=n;s&&(typeof a=="function"?o.search=a(new PU(n.searchParams)):o.search=new PU(n.searchParams)),l&&(n.body=JSON.stringify(n.json),i.set("content-type","application/json"));let u=new AbortController,f=S2e([u.signal,n.signal]),h=await x2e(b2e(o.toString(),{...n,signal:f,timeout:void 0,headers:i}),n.timeout,u);if(!h.ok&&n.throwHttpErrors)throw n.handleError&&await n.handleError(h),new NU(h);return h.iterator=function(){return kU(h.body)},h.ndjson=async function*(){for await(let p of T2e(h.iterator()))r.transform?yield r.transform(p):yield p},h}post(e,r={}){return this.fetch(e,{...r,method:"POST"})}get(e,r={}){return this.fetch(e,{...r,method:"GET"})}put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}},T2e=async function*(t){let e=new TextDecoder,r="";for await(let n of t){r+=e.decode(n,{stream:!0});let i=r.split(/\r?\n/);for(let o=0;o<i.length-1;o++){let s=i[o].trim();s.length>0&&(yield JSON.parse(s))}r=i[i.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},kU=t=>{if(C2e(t)){let e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(I2e(t)){let e=t.getReader();return async function*(){try{for(;;){let{done:r,value:n}=await e.read();if(r)return;n&&(yield n)}}finally{e.releaseLock()}}()}if(A2e(t))return t;throw new TypeError("Body can't be converted to AsyncIterable")},A2e=t=>typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function",I2e=t=>t&&typeof t.getReader=="function",C2e=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable");di.HTTPError=NU;di.TimeoutError=TS;di.streamToAsyncIterator=kU;di.post=(t,e)=>new di(e).post(t,e);di.get=(t,e)=>new di(e).get(t,e);di.put=(t,e)=>new di(e).put(t,e);di.delete=(t,e)=>new di(e).delete(t,e);di.options=(t,e)=>new di(e).options(t,e);DU.exports=di});var Fi=x((gUe,HU)=>{"use strict";c();var B2e=async t=>{let e;for await(let r of t)e=r;return e};HU.exports=B2e});var ZU=x((GUe,kS)=>{c();var $Ue=function(){typeof kS<"u"&&(kS.exports=w);var t=24*3600,e=3200,r=(365*400+97)*e/400,n=t*r,i=n*1e3,o=1e3*1e4*1e4*t,s=16777216,a=65536*65536,l=1e3*1e3,u=1e3*1e3*1e3,f="000000000",h=Math.trunc||He,p=w.prototype;w.fromDate=q,w.fromInt64BE=Ce(0,1,2,3,0,4),w.fromInt64LE=Ce(3,2,1,0,4,0),w.fromString=L,w.fromTimeT=G,p.year=0,p.time=0,p.nano=0,p.addNano=I,p.getNano=A,p.getTimeT=se,p.getYear=b,p.toDate=S,p.toJSON=re,p.toString=Ge,p.writeInt64BE=me(0,1,2,3,0,4),p.writeInt64LE=me(3,2,1,0,4,0);var d="%Y-%m-%dT%H:%M:%S.%NZ",m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],y={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return w;function w(J,ue,ce){var Te=this;if(!(Te instanceof w))return new w(J,ue,ce);Te.time=+J||0,Te.nano=+ue||0,Te.year=+ce||0,v(Te)}function b(){var J=this.toDate().getUTCFullYear();return J+this.year}function v(J){var ue=J.year,ce=J.time,Te=J.nano,Le,De;if(Te<0||l<=Te){var $t=Math.floor(Te/l);Te-=$t*l,ce+=$t,Le=1}var sr=ue%e;if(ce<-o||o<ce||sr){De=h(ce/i),De&&(ue+=De*e,ce-=De*i);var Xe=R(ce);Xe.setUTCFullYear(sr+Xe.getUTCFullYear()),ue-=sr,ce=+Xe,De=h(ue/e);var lt=ce+De*i;De&&-o<=lt&&lt<=o&&(ue-=De*e,ce=lt),Le=1}return Le&&(J.year=ue,J.time=ce,J.nano=Te),J}function S(){var J=v(this);return R(J.time)}function R(J){var ue=new Date(0);return ue.setTime(J),ue}function I(J){return this.nano+=+J||0,this}function A(){var J=v(this);return(J.time%1e3*l+ +J.nano+u)%u}function L(J){var ue,ce=new w;J+="";var Te=J.replace(/^\s*[+\-]?\d+/,function(Le){var De=+Le,$t=1970+(De-1970)%400;return ce.year=De-$t,$t}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(Le,De,$t){return De<0&&($t*=-1),ue=(+De*60+ +$t)*6e4,""}).replace(/\.\d+$/,function(Le){return ce.nano=+(Le+f).substr(1,9),""}).split(/\D+/);if(Te.length>1?Te[1]--:Te[1]=0,ce.time=ue=Date.UTC.apply(Date,Te)-(ue||0),isNaN(ue))throw new TypeError("Invalid Date");return v(ce)}function q(J){return new w(+J)}function G(J){return j(J,0)}function j(J,ue){ue|=0,ue*=a,J=+J||0;var ce=h(ue/n)+h(J/n),Te=ue%n+J%n,Le=h(Te/n);return Le&&(ce+=Le,Te-=Le*n),new w(Te*1e3,0,ce*e)}function se(){var J=v(this),ue=Math.floor(J.time/1e3),ce=J.year;return ce&&(ue+=ce*r*t/e),ue}function re(){return this.toString().replace(/0{1,6}Z$/,"Z")}function Ge(J){var ue=this,ce=ue.toDate(),Te={H:lt,L:Xr,M:ar,N:Zr,S:Br,Y:De,a:Em,b:bm,d:sr,e:Xe,m:$t};return Le(J||d);function Le(gs){return gs.replace(/%./g,function(Lk){var Bk=Lk[1],Mk=y[Bk],Uk=Te[Bk];return Mk?Le(Mk):Uk?Uk():Lk})}function De(){var gs=ue.getYear();return gs>999999?"+"+gs:gs>9999?"+"+it(gs,6):gs>=0?it(gs,4):gs>=-999999?"-"+it(-gs,6):gs}function $t(){return nt(ce.getUTCMonth()+1)}function sr(){return nt(ce.getUTCDate())}function Xe(){return or(ce.getUTCDate())}function lt(){return nt(ce.getUTCHours())}function ar(){return nt(ce.getUTCMinutes())}function Br(){return nt(ce.getUTCSeconds())}function Xr(){return it(ce.getUTCMilliseconds(),3)}function Zr(){return it(ue.getNano(),9)}function Em(){return g[ce.getUTCDay()]}function bm(){return m[ce.getUTCMonth()]}}function me(J,ue,ce,Te,Le,De){return $t;function $t(Xe,lt){var ar=v(this);Xe||(Xe=new Array(8)),z(Xe,lt|=0);var Br=Math.floor(ar.time/1e3),Xr=ar.year*(r*t/e),Zr=h(Xr/a)+h(Br/a),Em=Xr%a+Br%a,bm=Math.floor(Em/a);return bm&&(Zr+=bm,Em-=bm*a),sr(Xe,lt+Le,Zr),sr(Xe,lt+De,Em),Xe}function sr(Xe,lt,ar){Xe[lt+J]=ar>>24&255,Xe[lt+ue]=ar>>16&255,Xe[lt+ce]=ar>>8&255,Xe[lt+Te]=ar&255}}function Ce(J,ue,ce,Te,Le,De){return $t;function $t(Xe,lt){z(Xe,lt|=0);var ar=sr(Xe,lt+Le),Br=sr(Xe,lt+De);return j(Br,ar)}function sr(Xe,lt){return Xe[lt+J]*s+(Xe[lt+ue]<<16|Xe[lt+ce]<<8|Xe[lt+Te])}}function z(J,ue){var ce=J&&J.length;if(ce==null)throw new TypeError("Invalid Buffer");if(ce<ue+8)throw new RangeError("Out of range")}function He(J){var ue=J-J%1;return ue===0&&(J<0||J===0&&1/J!==1/0)?-0:ue}function or(J){return(J>9?"":" ")+(J|0)}function nt(J){return(J>9?"":"0")+(J|0)}function it(J,ue){return(f+(J|0)).substr(-ue)}}()});var wt=x((VKe,mF)=>{c();mF.exports={options:{usePureJavaScript:!1}}});var wF=x((qKe,yF)=>{c();var LS={};yF.exports=LS;var gF={};LS.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Vge(t,e);else{var i=0,o=e.length,s=e.charAt(0),a=[0];for(i=0;i<t.length;++i){for(var l=0,u=t[i];l<a.length;++l)u+=a[l]<<8,a[l]=u%o,u=u/o|0;for(;u>0;)a.push(u%o),u=u/o|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=a.length-1;i>=0;--i)n+=e[a[i]]}if(r){var f=new RegExp(".{1,"+r+"}","g");n=n.match(f).join(`\r
`)}return n};LS.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=gF[e];if(!r){r=gF[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,o=e.charAt(0),s=[0],n=0;n<t.length;n++){var a=r[t.charCodeAt(n)];if(a===void 0)return;for(var l=0,u=a;l<s.length;++l)u+=s[l]*i,s[l]=u&255,u>>=8;for(;u>0;)s.push(u&255),u>>=8}for(var f=0;t[f]===o&&f<t.length-1;++f)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Vge(t,e){var r=0,n=e.length,i=e.charAt(0),o=[0];for(r=0;r<t.length();++r){for(var s=0,a=t.at(r);s<o.length;++s)a+=o[s]<<8,o[s]=a%n,a=a/n|0;for(;a>0;)o.push(a%n),a=a/n|0}var l="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)l+=i;for(r=o.length-1;r>=0;--r)l+=e[o[r]];return l}});var Er=x((zKe,vF)=>{c();var EF=wt(),bF=wF(),D=vF.exports=EF.util=EF.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){D.nextTick=process.nextTick,typeof setImmediate=="function"?D.setImmediate=setImmediate:D.setImmediate=D.nextTick;return}if(typeof setImmediate=="function"){D.setImmediate=function(){return setImmediate.apply(void 0,arguments)},D.nextTick=function(a){return setImmediate(a)};return}if(D.setImmediate=function(a){setTimeout(a,0)},typeof window<"u"&&typeof window.postMessage=="function"){let a=function(l){if(l.source===window&&l.data===t){l.stopPropagation();var u=e.slice();e.length=0,u.forEach(function(f){f()})}};var s=a,t="forge.setImmediate",e=[];D.setImmediate=function(l){e.push(l),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",a,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var l=e.slice();e.length=0,l.forEach(function(u){u()})}).observe(i,{attributes:!0});var o=D.setImmediate;D.setImmediate=function(l){Date.now()-r>15?(r=Date.now(),o(l)):(e.push(l),e.length===1&&i.setAttribute("a",n=!n))}}D.nextTick=D.setImmediate})();D.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;D.globalScope=function(){return D.isNodejs?globalThis:typeof self>"u"?window:self}();D.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};D.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};D.isArrayBufferView=function(t){return t&&D.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function d2(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}D.ByteBuffer=BS;function BS(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(D.isArrayBuffer(t)||D.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof BS||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}D.ByteStringBuffer=BS;var qge=4096;D.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>qge&&(this.data.substr(0,1),this._constructedStringLength=0)};D.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};D.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};D.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};D.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};D.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};D.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(D.encodeUtf8(t))};D.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};D.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};D.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};D.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};D.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};D.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};D.ByteStringBuffer.prototype.putInt=function(t,e){d2(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};D.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};D.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};D.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};D.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};D.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};D.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};D.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};D.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};D.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};D.ByteStringBuffer.prototype.getInt=function(t){d2(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};D.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};D.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};D.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};D.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};D.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};D.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};D.ByteStringBuffer.prototype.copy=function(){var t=D.createBuffer(this.data);return t.read=this.read,t};D.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};D.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};D.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};D.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};D.ByteStringBuffer.prototype.toString=function(){return D.decodeUtf8(this.bytes())};function zge(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=D.isArrayBuffer(t),n=D.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}D.DataBuffer=zge;D.DataBuffer.prototype.length=function(){return this.write-this.read};D.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};D.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};D.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};D.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};D.DataBuffer.prototype.putBytes=function(t,e){if(D.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(D.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof D.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&D.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof D.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var o;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),o=new Uint8Array(this.data.buffer,this.write),this.write+=D.binary.hex.decode(t,o,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),o=new Uint8Array(this.data.buffer,this.write),this.write+=D.binary.base64.decode(t,o,this.write),this;if(e==="utf8"&&(t=D.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),o=new Uint8Array(this.data.buffer,this.write),this.write+=D.binary.raw.decode(o),this;if(e==="utf16")return this.accommodate(t.length*2),o=new Uint16Array(this.data.buffer,this.write),this.write+=D.text.utf16.encode(o),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};D.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};D.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};D.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};D.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};D.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};D.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};D.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};D.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};D.DataBuffer.prototype.putInt=function(t,e){d2(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};D.DataBuffer.prototype.putSignedInt=function(t,e){return d2(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};D.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};D.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};D.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};D.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};D.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};D.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};D.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};D.DataBuffer.prototype.getInt=function(t){d2(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};D.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};D.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};D.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};D.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};D.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};D.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};D.DataBuffer.prototype.copy=function(){return new D.DataBuffer(this)};D.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};D.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};D.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};D.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};D.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return D.binary.raw.encode(e);if(t==="hex")return D.binary.hex.encode(e);if(t==="base64")return D.binary.base64.encode(e);if(t==="utf8")return D.text.utf8.decode(e);if(t==="utf16")return D.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};D.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=D.encodeUtf8(t)),new D.ByteBuffer(t)};D.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};D.xorBytes=function(t,e,r){for(var n="",i="",o="",s=0,a=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),a>=10&&(n+=o,o="",a=0),o+=String.fromCharCode(i),++a;return n+=o,n};D.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};D.bytesToHex=function(t){return D.createBuffer(t).toHex()};D.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var Yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Ql=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_F="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";D.encode64=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.length;)i=t.charCodeAt(a++),o=t.charCodeAt(a++),s=t.charCodeAt(a++),r+=Yl.charAt(i>>2),r+=Yl.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Yl.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Yl.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};D.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,o,s=0;s<t.length;)r=Ql[t.charCodeAt(s++)-43],n=Ql[t.charCodeAt(s++)-43],i=Ql[t.charCodeAt(s++)-43],o=Ql[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),o!==64&&(e+=String.fromCharCode((i&3)<<6|o)));return e};D.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};D.decodeUtf8=function(t){return decodeURIComponent(escape(t))};D.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:bF.encode,decode:bF.decode}};D.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};D.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};D.binary.hex.encode=D.bytesToHex;D.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,o=r;for(t.length&1&&(i=1,n[o++]=parseInt(t[0],16));i<t.length;i+=2)n[o++]=parseInt(t.substr(i,2),16);return e?o-r:n};D.binary.base64.encode=function(t,e){for(var r="",n="",i,o,s,a=0;a<t.byteLength;)i=t[a++],o=t[a++],s=t[a++],r+=Yl.charAt(i>>2),r+=Yl.charAt((i&3)<<4|o>>4),isNaN(o)?r+="==":(r+=Yl.charAt((o&15)<<2|s>>6),r+=isNaN(s)?"=":Yl.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};D.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,o,s,a,l=0,u=r;l<t.length;)i=Ql[t.charCodeAt(l++)-43],o=Ql[t.charCodeAt(l++)-43],s=Ql[t.charCodeAt(l++)-43],a=Ql[t.charCodeAt(l++)-43],n[u++]=i<<2|o>>4,s!==64&&(n[u++]=(o&15)<<4|s>>2,a!==64&&(n[u++]=(s&3)<<6|a));return e?u-r:n.subarray(0,u)};D.binary.base58.encode=function(t,e){return D.binary.baseN.encode(t,_F,e)};D.binary.base58.decode=function(t,e){return D.binary.baseN.decode(t,_F,e)};D.text={utf8:{},utf16:{}};D.text.utf8.encode=function(t,e,r){t=D.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,o=0;o<t.length;++o)n[i++]=t.charCodeAt(o);return e?i-r:n};D.text.utf8.decode=function(t){return D.decodeUtf8(String.fromCharCode.apply(null,t))};D.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var o=r,s=r,a=0;a<t.length;++a)i[s++]=t.charCodeAt(a),o+=2;return e?o-r:n};D.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};D.deflate=function(t,e,r){if(e=D.decode64(t.deflate(D.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};D.inflate=function(t,e,r){var n=t.inflate(D.encode64(e)).rval;return n===null?null:D.decode64(n)};var MS=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=D.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},US=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(D.decode64(r))),r},Hge=function(t,e,r,n){var i=US(t,e);i===null&&(i={}),i[r]=n,MS(t,e,i)},$ge=function(t,e,r){var n=US(t,e);return n!==null&&(n=r in n?n[r]:null),n},Gge=function(t,e,r){var n=US(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var o in n){i=!1;break}i&&(n=null),MS(t,e,n)}},Wge=function(t,e){MS(t,e,null)},vw=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,o=!1,s=null;for(var a in r){i=r[a];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),o=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),o=!0)}catch(l){s=l}if(o)break}if(!o)throw s;return n};D.setItem=function(t,e,r,n,i){vw(Hge,arguments,i)};D.getItem=function(t,e,r,n){return vw($ge,arguments,n)};D.removeItem=function(t,e,r,n){vw(Gge,arguments,n)};D.clearItems=function(t,e,r){vw(Wge,arguments,r)};D.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};D.format=function(t){for(var e=/%./g,r,n,i=0,o=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&o.push(n),s=e.lastIndex;var a=r[0][1];switch(a){case"s":case"o":i<arguments.length?o.push(arguments[i+++1]):o.push("<?>");break;case"%":o.push("%");break;default:o.push("<%"+a+"?>")}}return o.push(t.substring(s)),o.join("")};D.formatNumber=function(t,e,r,n){var i=t,o=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,a=n===void 0?".":n,l=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(o),10)+"",f=u.length>3?u.length%3:0;return l+(f?u.substr(0,f)+a:"")+u.substr(f).replace(/(\d{3})(?=\d)/g,"$1"+a)+(o?s+Math.abs(i-u).toFixed(o).slice(2):"")};D.formatSize=function(t){return t>=1073741824?t=D.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=D.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=D.formatNumber(t/1024,0)+" KiB":t=D.formatNumber(t,0)+" bytes",t};D.bytesFromIP=function(t){return t.indexOf(".")!==-1?D.bytesFromIPv4(t):t.indexOf(":")!==-1?D.bytesFromIPv6(t):null};D.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=D.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};D.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=D.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var o=D.hexToBytes(t[i]);o.length<2&&n.putByte(0),n.putBytes(o)}return n.getBytes()};D.bytesToIP=function(t){return t.length===4?D.bytesToIPv4(t):t.length===16?D.bytesToIPv6(t):null};D.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};D.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var o=D.bytesToHex(t[i]+t[i+1]);o[0]==="0"&&o!=="0";)o=o.substr(1);if(o==="0"){var s=r[r.length-1],a=e.length;!s||a!==s.end+1?r.push({start:a,end:a}):(s.end=a,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(o)}if(r.length>0){var l=r[n];l.end-l.start>0&&(e.splice(l.start,l.end-l.start+1,""),l.start===0&&e.unshift(""),l.end===7&&e.push(""))}return e.join(":")};D.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in D&&!t.update)return e(null,D.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return D.cores=navigator.hardwareConcurrency,e(null,D.cores);if(typeof Worker>"u")return D.cores=1,e(null,D.cores);if(typeof Blob>"u")return D.cores=2,e(null,D.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var a=Date.now(),l=a+4;Date.now()<l;);self.postMessage({st:a,et:l})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,a,l){if(a===0){var u=Math.floor(s.reduce(function(f,h){return f+h},0)/s.length);return D.cores=Math.max(1,u),URL.revokeObjectURL(r),e(null,D.cores)}i(l,function(f,h){s.push(o(l,h)),n(s,a-1,l)})}function i(s,a){for(var l=[],u=[],f=0;f<s;++f){var h=new Worker(r);h.addEventListener("message",function(p){if(u.push(p.data),u.length===s){for(var d=0;d<s;++d)l[d].terminate();a(null,u)}}),l.push(h)}for(var f=0;f<s;++f)l[f].postMessage(f)}function o(s,a){for(var l=[],u=0;u<s;++u)for(var f=a[u],h=l[u]=[],p=0;p<s;++p)if(u!==p){var d=a[p];(f.st>d.st&&f.st<d.et||d.st>f.st&&d.st<f.et)&&h.push(p)}return l.reduce(function(m,g){return Math.max(m,g.length)},0)}}});var kp=x((HKe,SF)=>{c();var p2=wt();p2.pki=p2.pki||{};var FS=SF.exports=p2.pki.oids=p2.oids=p2.oids||{};function Z(t,e){FS[t]=e,FS[e]=t}function Wt(t,e){FS[t]=e}Z("1.2.840.113549.1.1.1","rsaEncryption");Z("1.2.840.113549.1.1.4","md5WithRSAEncryption");Z("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Z("1.2.840.113549.1.1.7","RSAES-OAEP");Z("1.2.840.113549.1.1.8","mgf1");Z("1.2.840.113549.1.1.9","pSpecified");Z("1.2.840.113549.1.1.10","RSASSA-PSS");Z("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Z("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Z("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Z("1.3.101.112","EdDSA25519");Z("1.2.840.10040.4.3","dsa-with-sha1");Z("1.3.14.3.2.7","desCBC");Z("1.3.14.3.2.26","sha1");Z("1.3.14.3.2.29","sha1WithRSASignature");Z("2.16.840.1.101.3.4.2.1","sha256");Z("2.16.840.1.101.3.4.2.2","sha384");Z("2.16.840.1.101.3.4.2.3","sha512");Z("2.16.840.1.101.3.4.2.4","sha224");Z("2.16.840.1.101.3.4.2.5","sha512-224");Z("2.16.840.1.101.3.4.2.6","sha512-256");Z("1.2.840.113549.2.2","md2");Z("1.2.840.113549.2.5","md5");Z("1.2.840.113549.1.7.1","data");Z("1.2.840.113549.1.7.2","signedData");Z("1.2.840.113549.1.7.3","envelopedData");Z("1.2.840.113549.1.7.4","signedAndEnvelopedData");Z("1.2.840.113549.1.7.5","digestedData");Z("1.2.840.113549.1.7.6","encryptedData");Z("1.2.840.113549.1.9.1","emailAddress");Z("1.2.840.113549.1.9.2","unstructuredName");Z("1.2.840.113549.1.9.3","contentType");Z("1.2.840.113549.1.9.4","messageDigest");Z("1.2.840.113549.1.9.5","signingTime");Z("1.2.840.113549.1.9.6","counterSignature");Z("1.2.840.113549.1.9.7","challengePassword");Z("1.2.840.113549.1.9.8","unstructuredAddress");Z("1.2.840.113549.1.9.14","extensionRequest");Z("1.2.840.113549.1.9.20","friendlyName");Z("1.2.840.113549.1.9.21","localKeyId");Z("1.2.840.113549.1.9.22.1","x509Certificate");Z("1.2.840.113549.1.12.10.1.1","keyBag");Z("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Z("1.2.840.113549.1.12.10.1.3","certBag");Z("1.2.840.113549.1.12.10.1.4","crlBag");Z("1.2.840.113549.1.12.10.1.5","secretBag");Z("1.2.840.113549.1.12.10.1.6","safeContentsBag");Z("1.2.840.113549.1.5.13","pkcs5PBES2");Z("1.2.840.113549.1.5.12","pkcs5PBKDF2");Z("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Z("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Z("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Z("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Z("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Z("1.2.840.113549.2.7","hmacWithSHA1");Z("1.2.840.113549.2.8","hmacWithSHA224");Z("1.2.840.113549.2.9","hmacWithSHA256");Z("1.2.840.113549.2.10","hmacWithSHA384");Z("1.2.840.113549.2.11","hmacWithSHA512");Z("1.2.840.113549.3.7","des-EDE3-CBC");Z("2.16.840.1.101.3.4.1.2","aes128-CBC");Z("2.16.840.1.101.3.4.1.22","aes192-CBC");Z("2.16.840.1.101.3.4.1.42","aes256-CBC");Z("2.5.4.3","commonName");Z("2.5.4.4","surname");Z("2.5.4.5","serialNumber");Z("2.5.4.6","countryName");Z("2.5.4.7","localityName");Z("2.5.4.8","stateOrProvinceName");Z("2.5.4.9","streetAddress");Z("2.5.4.10","organizationName");Z("2.5.4.11","organizationalUnitName");Z("2.5.4.12","title");Z("2.5.4.13","description");Z("2.5.4.15","businessCategory");Z("2.5.4.17","postalCode");Z("2.5.4.42","givenName");Z("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Z("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Z("2.16.840.1.113730.1.1","nsCertType");Z("2.16.840.1.113730.1.13","nsComment");Wt("2.5.29.1","authorityKeyIdentifier");Wt("2.5.29.2","keyAttributes");Wt("2.5.29.3","certificatePolicies");Wt("2.5.29.4","keyUsageRestriction");Wt("2.5.29.5","policyMapping");Wt("2.5.29.6","subtreesConstraint");Wt("2.5.29.7","subjectAltName");Wt("2.5.29.8","issuerAltName");Wt("2.5.29.9","subjectDirectoryAttributes");Wt("2.5.29.10","basicConstraints");Wt("2.5.29.11","nameConstraints");Wt("2.5.29.12","policyConstraints");Wt("2.5.29.13","basicConstraints");Z("2.5.29.14","subjectKeyIdentifier");Z("2.5.29.15","keyUsage");Wt("2.5.29.16","privateKeyUsagePeriod");Z("2.5.29.17","subjectAltName");Z("2.5.29.18","issuerAltName");Z("2.5.29.19","basicConstraints");Wt("2.5.29.20","cRLNumber");Wt("2.5.29.21","cRLReason");Wt("2.5.29.22","expirationDate");Wt("2.5.29.23","instructionCode");Wt("2.5.29.24","invalidityDate");Wt("2.5.29.25","cRLDistributionPoints");Wt("2.5.29.26","issuingDistributionPoint");Wt("2.5.29.27","deltaCRLIndicator");Wt("2.5.29.28","issuingDistributionPoint");Wt("2.5.29.29","certificateIssuer");Wt("2.5.29.30","nameConstraints");Z("2.5.29.31","cRLDistributionPoints");Z("2.5.29.32","certificatePolicies");Wt("2.5.29.33","policyMappings");Wt("2.5.29.34","policyConstraints");Z("2.5.29.35","authorityKeyIdentifier");Wt("2.5.29.36","policyConstraints");Z("2.5.29.37","extKeyUsage");Wt("2.5.29.46","freshestCRL");Wt("2.5.29.54","inhibitAnyPolicy");Z("1.3.6.1.4.1.11129.2.4.2","timestampList");Z("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Z("1.3.6.1.5.5.7.3.1","serverAuth");Z("1.3.6.1.5.5.7.3.2","clientAuth");Z("1.3.6.1.5.5.7.3.3","codeSigning");Z("1.3.6.1.5.5.7.3.4","emailProtection");Z("1.3.6.1.5.5.7.3.8","timeStamping")});var Xl=x(($Ke,RF)=>{c();var Tr=wt();Er();kp();var le=RF.exports=Tr.asn1=Tr.asn1||{};le.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};le.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};le.create=function(t,e,r,n,i){if(Tr.util.isArray(n)){for(var o=[],s=0;s<n.length;++s)n[s]!==void 0&&o.push(n[s]);n=o}var a={tagClass:t,type:e,constructed:r,composed:r||Tr.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(a.bitStringContents=i.bitStringContents,a.original=le.copy(a)),a};le.copy=function(t,e){var r;if(Tr.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(le.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:le.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};le.equals=function(t,e,r){if(Tr.util.isArray(t)){if(!Tr.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!le.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&le.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};le.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function m2(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var jge=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var o=r&127;m2(t,e,o),n=t.getInt(o<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};le.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=Tr.util.createBuffer(t));var r=t.length(),n=Sw(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function Sw(t,e,r,n){var i;m2(t,e,2);var o=t.getByte();e--;var s=o&192,a=o&31;i=t.length();var l=jge(t,e);if(e-=i-t.length(),l!==void 0&&l>e){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=t.length(),u.remaining=e,u.requested=l,u}l=e}var f,h,p=(o&32)===32;if(p)if(f=[],l===void 0)for(;;){if(m2(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),f.push(Sw(t,e,r+1,n)),e-=i-t.length()}else for(;l>0;)i=t.length(),f.push(Sw(t,l,r+1,n)),e-=i-t.length(),l-=i-t.length();if(f===void 0&&s===le.Class.UNIVERSAL&&a===le.Type.BITSTRING&&(h=t.bytes(l)),f===void 0&&n.decodeBitStrings&&s===le.Class.UNIVERSAL&&a===le.Type.BITSTRING&&l>1){var d=t.read,m=e,g=0;if(a===le.Type.BITSTRING&&(m2(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var y={strict:!0,decodeBitStrings:!0},w=Sw(t,e,r+1,y),b=i-t.length();e-=b,a==le.Type.BITSTRING&&b++;var v=w.tagClass;b===l&&(v===le.Class.UNIVERSAL||v===le.Class.CONTEXT_SPECIFIC)&&(f=[w])}catch{}f===void 0&&(t.read=d,e=m)}if(f===void 0){if(l===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=e}if(a===le.Type.BMPSTRING)for(f="";l>0;l-=2)m2(t,e,2),f+=String.fromCharCode(t.getInt16()),e-=2;else f=t.getBytes(l),e-=l}var S=h===void 0?null:{bitStringContents:h};return le.create(s,a,p,f,S)}le.toDer=function(t){var e=Tr.util.createBuffer(),r=t.tagClass|t.type,n=Tr.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=le.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var o=0;o<t.value.length;++o)t.value[o]!==void 0&&n.putBuffer(le.toDer(t.value[o]))}else if(t.type===le.Type.BMPSTRING)for(var o=0;o<t.value.length;++o)n.putInt16(t.value.charCodeAt(o));else t.type===le.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&(t.value.charCodeAt(1)&128)===0||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),a="";do a+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(a.length|128);for(var o=a.length-1;o>=0;--o)e.putByte(a.charCodeAt(o))}return e.putBuffer(n),e};le.oidToDer=function(t){var e=t.split("."),r=Tr.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,o,s,a=2;a<e.length;++a){n=!0,i=[],o=parseInt(e[a],10);do s=o&127,o=o>>>7,n||(s|=128),i.push(s),n=!1;while(o>0);for(var l=i.length-1;l>=0;--l)r.putByte(i[l])}return r};le.derToOid=function(t){var e;typeof t=="string"&&(t=Tr.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};le.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=0;if(t.length>11){var l=t.charAt(10),u=10;l!=="+"&&l!=="-"&&(a=parseInt(t.substr(10,2),10),u+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,0),u&&(l=t.charAt(u),l==="+"||l==="-")){var f=parseInt(t.substr(u+1,2),10),h=parseInt(t.substr(u+4,2),10),p=f*60+h;p*=6e4,l==="+"?e.setTime(+e-p):e.setTime(+e+p)}return e};le.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),o=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),a=parseInt(t.substr(12,2),10),l=0,u=0,f=!1;t.charAt(t.length-1)==="Z"&&(f=!0);var h=t.length-5,p=t.charAt(h);if(p==="+"||p==="-"){var d=parseInt(t.substr(h+1,2),10),m=parseInt(t.substr(h+4,2),10);u=d*60+m,u*=6e4,p==="+"&&(u*=-1),f=!0}return t.charAt(14)==="."&&(l=parseFloat(t.substr(14),10)*1e3),f?(e.setUTCFullYear(r,n,i),e.setUTCHours(o,s,a,l),e.setTime(+e+u)):(e.setFullYear(r,n,i),e.setHours(o,s,a,l)),e};le.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};le.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};le.integerToDer=function(t){var e=Tr.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};le.derToInteger=function(t){typeof t=="string"&&(t=Tr.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};le.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&Tr.util.isArray(e.value))for(var o=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[o]&&(i=le.validate(t.value[o],e.value[s],r,n),i?++o:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var a;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var l=t.bitStringContents.charCodeAt(0);if(l!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var xF=/[^\\u0000-\\u00ff]/;le.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",o=0;o<e*r;++o)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case le.Class.UNIVERSAL:n+="Universal:";break;case le.Class.APPLICATION:n+="Application:";break;case le.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case le.Class.PRIVATE:n+="Private:";break}if(t.tagClass===le.Class.UNIVERSAL)switch(n+=t.type,t.type){case le.Type.NONE:n+=" (None)";break;case le.Type.BOOLEAN:n+=" (Boolean)";break;case le.Type.INTEGER:n+=" (Integer)";break;case le.Type.BITSTRING:n+=" (Bit string)";break;case le.Type.OCTETSTRING:n+=" (Octet string)";break;case le.Type.NULL:n+=" (Null)";break;case le.Type.OID:n+=" (Object Identifier)";break;case le.Type.ODESC:n+=" (Object Descriptor)";break;case le.Type.EXTERNAL:n+=" (External or Instance of)";break;case le.Type.REAL:n+=" (Real)";break;case le.Type.ENUMERATED:n+=" (Enumerated)";break;case le.Type.EMBEDDED:n+=" (Embedded PDV)";break;case le.Type.UTF8:n+=" (UTF8)";break;case le.Type.ROID:n+=" (Relative Object Identifier)";break;case le.Type.SEQUENCE:n+=" (Sequence)";break;case le.Type.SET:n+=" (Set)";break;case le.Type.PRINTABLESTRING:n+=" (Printable String)";break;case le.Type.IA5String:n+=" (IA5String (ASCII))";break;case le.Type.UTCTIME:n+=" (UTC time)";break;case le.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case le.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,a="",o=0;o<t.value.length;++o)t.value[o]!==void 0&&(s+=1,a+=le.prettyPrint(t.value[o],e+1,r),o+1<t.value.length&&(a+=","));n+=i+"Sub values: "+s+a}else{if(n+=i+"Value: ",t.type===le.Type.OID){var l=le.derToOid(t.value);n+=l,Tr.pki&&Tr.pki.oids&&l in Tr.pki.oids&&(n+=" ("+Tr.pki.oids[l]+") ")}if(t.type===le.Type.INTEGER)try{n+=le.derToInteger(t.value)}catch{n+="0x"+Tr.util.bytesToHex(t.value)}else if(t.type===le.Type.BITSTRING){if(t.value.length>1?n+="0x"+Tr.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var u=t.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(t.type===le.Type.OCTETSTRING)xF.test(t.value)||(n+="("+t.value+") "),n+="0x"+Tr.util.bytesToHex(t.value);else if(t.type===le.Type.UTF8)try{n+=Tr.util.decodeUtf8(t.value)}catch(f){if(f.message==="URI malformed")n+="0x"+Tr.util.bytesToHex(t.value)+" (malformed UTF8)";else throw f}else t.type===le.Type.PRINTABLESTRING||t.type===le.Type.IA5String?n+=t.value:xF.test(t.value)?n+="0x"+Tr.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var VS=x((GKe,TF)=>{c();var Vn=wt();Er();TF.exports=Vn.cipher=Vn.cipher||{};Vn.cipher.algorithms=Vn.cipher.algorithms||{};Vn.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Vn.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Vn.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};Vn.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=Vn.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new Vn.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};Vn.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),Vn.cipher.algorithms[t]=e};Vn.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in Vn.cipher.algorithms?Vn.cipher.algorithms[t]:null};var KS=Vn.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};KS.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=Vn.util.createBuffer(),this.output=t.output||Vn.util.createBuffer(),this.mode.start(e)};KS.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};KS.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var zS=x((WKe,AF)=>{c();var qn=wt();Er();qn.cipher=qn.cipher||{};var Et=AF.exports=qn.cipher.modes=qn.cipher.modes||{};Et.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Et.ecb.prototype.start=function(t){};Et.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Et.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};Et.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Et.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Et.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};Et.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=xw(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};Et.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};Et.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};Et.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};Et.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};Et.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=qn.util.createBuffer(),this._partialBytes=0};Et.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xw(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Et.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Et.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Et.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=qn.util.createBuffer(),this._partialBytes=0};Et.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xw(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Et.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};Et.ofb.prototype.decrypt=Et.ofb.prototype.encrypt;Et.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=qn.util.createBuffer(),this._partialBytes=0};Et.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=xw(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};Et.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Rw(this._inBlock)};Et.ctr.prototype.decrypt=Et.ctr.prototype.encrypt;Et.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=qn.util.createBuffer(),this._partialBytes=0,this._R=3774873600};Et.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=qn.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=qn.util.createBuffer(t.additionalData):r=qn.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=qn.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(qS(n*8)))}this._inBlock=this._j0.slice(0),Rw(this._inBlock),this._partialBytes=0,r=qn.util.createBuffer(r),this._aDataLength=qS(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};Et.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var o=(this.blockSize-n)%this.blockSize;o>0&&(o=this.blockSize-o),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(o<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),o>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(o-this._partialBytes)),this._partialBytes=o,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Rw(this._inBlock)};Et.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Rw(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};Et.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=qn.util.createBuffer();var n=this._aDataLength.concat(qS(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var o=0;o<this._ints;++o)this.tag.putInt32(this._s[o]^i[o]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};Et.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var o=t[i/32|0]&1<<31-i%32;o&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};Et.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};Et.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,o=this._m[r][i];e[0]^=o[0],e[1]^=o[1],e[2]^=o[2],e[3]^=o[3]}return e};Et.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};Et.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,o=new Array(i),s=0;s<i;++s){var a=[0,0,0,0],l=s/n|0,u=(n-1-s%n)*e;a[l]=1<<e-1<<u,o[s]=this.generateSubHashTable(this.multiply(a,t),e)}return o};Et.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var o=n>>>1;o>0;)this.pow(i[2*o],i[o]=[]),o>>=1;for(o=2;o<n;){for(var s=1;s<o;++s){var a=i[o],l=i[s];i[o+s]=[a[0]^l[0],a[1]^l[1],a[2]^l[2],a[3]^l[3]]}o*=2}for(i[0]=[0,0,0,0],o=n+1;o<r;++o){var u=i[o^n];i[o]=[t[0]^u[0],t[1]^u[1],t[2]^u[2],t[3]^u[3]]}return i};function xw(t,e){if(typeof t=="string"&&(t=qn.util.createBuffer(t)),qn.util.isArray(t)&&t.length>4){var r=t;t=qn.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!qn.util.isArray(t)){for(var i=[],o=e/4,n=0;n<o;++n)i.push(t.getInt32());t=i}return t}function Rw(t){t[t.length-1]=t[t.length-1]+1&4294967295}function qS(t){return[t/4294967296|0,t&4294967295]}});var Lp=x((jKe,NF)=>{c();var br=wt();VS();zS();Er();NF.exports=br.aes=br.aes||{};br.aes.startEncrypting=function(t,e,r,n){var i=Tw({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};br.aes.createEncryptionCipher=function(t,e){return Tw({key:t,output:null,decrypt:!1,mode:e})};br.aes.startDecrypting=function(t,e,r,n){var i=Tw({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};br.aes.createDecryptionCipher=function(t,e){return Tw({key:t,output:null,decrypt:!0,mode:e})};br.aes.Algorithm=function(t,e){GS||CF();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return $S(r._w,n,i,!1)},decrypt:function(n,i){return $S(r._w,n,i,!0)}}}),r._init=!1};br.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=br.util.createBuffer(e);else if(br.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=br.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!br.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!br.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var o=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(o)!==-1;this._w=PF(e,t.decrypt&&!s),this._init=!0}};br.aes._expandKey=function(t,e){return GS||CF(),PF(t,e)};br.aes._updateBlock=$S;Op("AES-ECB",br.cipher.modes.ecb);Op("AES-CBC",br.cipher.modes.cbc);Op("AES-CFB",br.cipher.modes.cfb);Op("AES-OFB",br.cipher.modes.ofb);Op("AES-CTR",br.cipher.modes.ctr);Op("AES-GCM",br.cipher.modes.gcm);function Op(t,e){var r=function(){return new br.aes.Algorithm(t,e)};br.cipher.registerAlgorithm(t,r)}var GS=!1,Dp=4,Si,HS,IF,jf,Ns;function CF(){GS=!0,IF=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Si=new Array(256),HS=new Array(256),jf=new Array(4),Ns=new Array(4);for(var e=0;e<4;++e)jf[e]=new Array(256),Ns[e]=new Array(256);for(var r=0,n=0,i,o,s,a,l,u,f,e=0;e<256;++e){a=n^n<<1^n<<2^n<<3^n<<4,a=a>>8^a&255^99,Si[r]=a,HS[a]=r,l=t[a],i=t[r],o=t[i],s=t[o],u=l<<24^a<<16^a<<8^(a^l),f=(i^o^s)<<24^(r^s)<<16^(r^o^s)<<8^(r^i^s);for(var h=0;h<4;++h)jf[h][r]=u,Ns[h][a]=f,u=u<<24|u>>>8,f=f<<24|f>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function PF(t,e){for(var r=t.slice(0),n,i=1,o=r.length,s=o+6+1,a=Dp*s,l=o;l<a;++l)n=r[l-1],l%o===0?(n=Si[n>>>16&255]<<24^Si[n>>>8&255]<<16^Si[n&255]<<8^Si[n>>>24]^IF[i]<<24,i++):o>6&&l%o===4&&(n=Si[n>>>24]<<24^Si[n>>>16&255]<<16^Si[n>>>8&255]<<8^Si[n&255]),r[l]=r[l-o]^n;if(e){var u,f=Ns[0],h=Ns[1],p=Ns[2],d=Ns[3],m=r.slice(0);a=r.length;for(var l=0,g=a-Dp;l<a;l+=Dp,g-=Dp)if(l===0||l===a-Dp)m[l]=r[g],m[l+1]=r[g+3],m[l+2]=r[g+2],m[l+3]=r[g+1];else for(var y=0;y<Dp;++y)u=r[g+y],m[l+(3&-y)]=f[Si[u>>>24]]^h[Si[u>>>16&255]]^p[Si[u>>>8&255]]^d[Si[u&255]];r=m}return r}function $S(t,e,r,n){var i=t.length/4-1,o,s,a,l,u;n?(o=Ns[0],s=Ns[1],a=Ns[2],l=Ns[3],u=HS):(o=jf[0],s=jf[1],a=jf[2],l=jf[3],u=Si);var f,h,p,d,m,g,y;f=e[0]^t[0],h=e[n?3:1]^t[1],p=e[2]^t[2],d=e[n?1:3]^t[3];for(var w=3,b=1;b<i;++b)m=o[f>>>24]^s[h>>>16&255]^a[p>>>8&255]^l[d&255]^t[++w],g=o[h>>>24]^s[p>>>16&255]^a[d>>>8&255]^l[f&255]^t[++w],y=o[p>>>24]^s[d>>>16&255]^a[f>>>8&255]^l[h&255]^t[++w],d=o[d>>>24]^s[f>>>16&255]^a[h>>>8&255]^l[p&255]^t[++w],f=m,h=g,p=y;r[0]=u[f>>>24]<<24^u[h>>>16&255]<<16^u[p>>>8&255]<<8^u[d&255]^t[++w],r[n?3:1]=u[h>>>24]<<24^u[p>>>16&255]<<16^u[d>>>8&255]<<8^u[f&255]^t[++w],r[2]=u[p>>>24]<<24^u[d>>>16&255]<<16^u[f>>>8&255]<<8^u[h&255]^t[++w],r[n?1:3]=u[d>>>24]<<24^u[f>>>16&255]<<16^u[h>>>8&255]<<8^u[p&255]^t[++w]}function Tw(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=br.cipher.createDecipher(r,t.key):n=br.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof br.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Iw=x((YKe,DF)=>{c();var Nr=wt();VS();zS();Er();DF.exports=Nr.des=Nr.des||{};Nr.des.startEncrypting=function(t,e,r,n){var i=Aw({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Nr.des.createEncryptionCipher=function(t,e){return Aw({key:t,output:null,decrypt:!1,mode:e})};Nr.des.startDecrypting=function(t,e,r,n){var i=Aw({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};Nr.des.createDecryptionCipher=function(t,e){return Aw({key:t,output:null,decrypt:!0,mode:e})};Nr.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return kF(r._keys,n,i,!1)},decrypt:function(n,i){return kF(r._keys,n,i,!0)}}}),r._init=!1};Nr.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Nr.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=nye(e),this._init=!0}};ba("DES-ECB",Nr.cipher.modes.ecb);ba("DES-CBC",Nr.cipher.modes.cbc);ba("DES-CFB",Nr.cipher.modes.cfb);ba("DES-OFB",Nr.cipher.modes.ofb);ba("DES-CTR",Nr.cipher.modes.ctr);ba("3DES-ECB",Nr.cipher.modes.ecb);ba("3DES-CBC",Nr.cipher.modes.cbc);ba("3DES-CFB",Nr.cipher.modes.cfb);ba("3DES-OFB",Nr.cipher.modes.ofb);ba("3DES-CTR",Nr.cipher.modes.ctr);function ba(t,e){var r=function(){return new Nr.des.Algorithm(t,e)};Nr.cipher.registerAlgorithm(t,r)}var Yge=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Qge=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Xge=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Zge=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Jge=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],eye=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],tye=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],rye=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function nye(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],o=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],a=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],f=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],p=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],m=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,y=[],w=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,v,S=0;S<g;S++){var R=t.getInt32(),I=t.getInt32();v=(R>>>4^I)&252645135,I^=v,R^=v<<4,v=(I>>>-16^R)&65535,R^=v,I^=v<<-16,v=(R>>>2^I)&858993459,I^=v,R^=v<<2,v=(I>>>-16^R)&65535,R^=v,I^=v<<-16,v=(R>>>1^I)&1431655765,I^=v,R^=v<<1,v=(I>>>8^R)&16711935,R^=v,I^=v<<8,v=(R>>>1^I)&1431655765,I^=v,R^=v<<1,v=R<<8|I>>>20&240,R=I<<24|I<<8&16711680|I>>>8&65280|I>>>24&240,I=v;for(var A=0;A<w.length;++A){w[A]?(R=R<<2|R>>>26,I=I<<2|I>>>26):(R=R<<1|R>>>27,I=I<<1|I>>>27),R&=-15,I&=-15;var L=e[R>>>28]|r[R>>>24&15]|n[R>>>20&15]|i[R>>>16&15]|o[R>>>12&15]|s[R>>>8&15]|a[R>>>4&15],q=l[I>>>28]|u[I>>>24&15]|f[I>>>20&15]|h[I>>>16&15]|p[I>>>12&15]|d[I>>>8&15]|m[I>>>4&15];v=(q>>>16^L)&65535,y[b++]=L^v,y[b++]=q^v<<16}}return y}function kF(t,e,r,n){var i=t.length===32?3:9,o;i===3?o=n?[30,-2,-2]:[0,32,2]:o=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,a=e[0],l=e[1];s=(a>>>4^l)&252645135,l^=s,a^=s<<4,s=(a>>>16^l)&65535,l^=s,a^=s<<16,s=(l>>>2^a)&858993459,a^=s,l^=s<<2,s=(l>>>8^a)&16711935,a^=s,l^=s<<8,s=(a>>>1^l)&1431655765,l^=s,a^=s<<1,a=a<<1|a>>>31,l=l<<1|l>>>31;for(var u=0;u<i;u+=3){for(var f=o[u+1],h=o[u+2],p=o[u];p!=f;p+=h){var d=l^t[p],m=(l>>>4|l<<28)^t[p+1];s=a,a=l,l=s^(Qge[d>>>24&63]|Zge[d>>>16&63]|eye[d>>>8&63]|rye[d&63]|Yge[m>>>24&63]|Xge[m>>>16&63]|Jge[m>>>8&63]|tye[m&63])}s=a,a=l,l=s}a=a>>>1|a<<31,l=l>>>1|l<<31,s=(a>>>1^l)&1431655765,l^=s,a^=s<<1,s=(l>>>8^a)&16711935,a^=s,l^=s<<8,s=(l>>>2^a)&858993459,a^=s,l^=s<<2,s=(a>>>16^l)&65535,l^=s,a^=s<<16,s=(a>>>4^l)&252645135,l^=s,a^=s<<4,r[0]=a,r[1]=l}function Aw(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Nr.cipher.createDecipher(r,t.key):n=Nr.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(o,s){var a=null;s instanceof Nr.util.ByteBuffer&&(a=s,s={}),s=s||{},s.output=a,s.iv=o,i.call(n,s)},n}});var Zl=x((QKe,OF)=>{c();var Cw=wt();OF.exports=Cw.md=Cw.md||{};Cw.md.algorithms=Cw.md.algorithms||{}});var BF=x((XKe,LF)=>{c();var Rc=wt();Zl();Er();var iye=LF.exports=Rc.hmac=Rc.hmac||{};iye.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(o,s){if(o!==null)if(typeof o=="string")if(o=o.toLowerCase(),o in Rc.md.algorithms)e=Rc.md.algorithms[o].create();else throw new Error('Unknown hash algorithm "'+o+'"');else e=o;if(s===null)s=t;else{if(typeof s=="string")s=Rc.util.createBuffer(s);else if(Rc.util.isArray(s)){var a=s;s=Rc.util.createBuffer();for(var l=0;l<a.length;++l)s.putByte(a[l])}var u=s.length();u>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=Rc.util.createBuffer(),n=Rc.util.createBuffer(),u=s.length();for(var l=0;l<u;++l){var a=s.at(l);r.putByte(54^a),n.putByte(92^a)}if(u<e.blockLength)for(var a=e.blockLength-u,l=0;l<a;++l)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(o){e.update(o)},i.getMac=function(){var o=e.digest().bytes();return e.start(),e.update(n),e.update(o),e.digest()},i.digest=i.getMac,i}});var Yf=x(()=>{c()});var WS=x((eVe,MF)=>{c();var xi=wt();BF();Zl();Er();var oye=xi.pkcs5=xi.pkcs5||{},Tc;xi.util.isNodejs&&!xi.options.usePureJavaScript&&(Tc=Yf());MF.exports=xi.pbkdf2=oye.pbkdf2=function(t,e,r,n,i,o){if(typeof i=="function"&&(o=i,i=null),xi.util.isNodejs&&!xi.options.usePureJavaScript&&Tc.pbkdf2&&(i===null||typeof i!="object")&&(Tc.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),o?Tc.pbkdf2Sync.length===4?Tc.pbkdf2(t,e,r,n,function(v,S){if(v)return o(v);o(null,S.toString("binary"))}):Tc.pbkdf2(t,e,r,n,i,function(v,S){if(v)return o(v);o(null,S.toString("binary"))}):Tc.pbkdf2Sync.length===4?Tc.pbkdf2Sync(t,e,r,n).toString("binary"):Tc.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in xi.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=xi.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var a=new Error("Derived key is too long.");if(o)return o(a);throw a}var l=Math.ceil(n/s),u=n-(l-1)*s,f=xi.hmac.create();f.start(i,t);var h="",p,d,m;if(!o){for(var g=1;g<=l;++g){f.start(null,null),f.update(e),f.update(xi.util.int32ToBytes(g)),p=m=f.digest().getBytes();for(var y=2;y<=r;++y)f.start(null,null),f.update(m),d=f.digest().getBytes(),p=xi.util.xorBytes(p,d,s),m=d;h+=g<l?p:p.substr(0,u)}return h}var g=1,y;function w(){if(g>l)return o(null,h);f.start(null,null),f.update(e),f.update(xi.util.int32ToBytes(g)),p=m=f.digest().getBytes(),y=2,b()}function b(){if(y<=r)return f.start(null,null),f.update(m),d=f.digest().getBytes(),p=xi.util.xorBytes(p,d,s),m=d,++y,xi.util.setImmediate(b);h+=g<l?p:p.substr(0,u),++g,w()}w()}});var kw=x((tVe,FF)=>{c();var Nw=wt();Er();var UF=FF.exports=Nw.pem=Nw.pem||{};UF.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=Pw(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=Pw(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=Pw(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=Pw(t.headers[i]);return t.procType&&(r+=`\r
`),r+=Nw.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};UF.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,o;o=r.exec(t),!!o;){var s=o[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var a={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Nw.util.decode64(o[3])};if(e.push(a),!!o[2]){for(var l=o[2].split(i),u=0;o&&u<l.length;){for(var f=l[u].replace(/\s+$/,""),h=u+1;h<l.length;++h){var p=l[h];if(!/\s/.test(p[0]))break;f+=p,u=h}if(o=f.match(n),o){for(var d={name:o[1],values:[]},m=o[2].split(","),g=0;g<m.length;++g)d.values.push(sye(m[g]));if(a.procType)if(!a.contentDomain&&d.name==="Content-Domain")a.contentDomain=m[0]||"";else if(!a.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');a.dekInfo={algorithm:m[0],parameters:m[1]||null}}else a.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');a.procType={version:m[0],type:m[1]}}}++u}if(a.procType==="ENCRYPTED"&&!a.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function Pw(t){for(var e=t.name+": ",r=[],n=function(l,u){return" "+u},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var o=0,s=-1,i=0;i<e.length;++i,++o)if(o>65&&s!==-1){var a=e[s];a===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+a+e.substr(s+1),o=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function sye(t){return t.replace(/^\s+/,"")}});var $F=x((rVe,HF)=>{c();var _a=wt();Zl();Er();var VF=HF.exports=_a.sha256=_a.sha256||{};_a.md.sha256=_a.md.algorithms.sha256=VF;VF.create=function(){qF||aye();var t=null,e=_a.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=_a.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=_a.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),KF(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=_a.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(jS.substr(0,n.blockLength-s));for(var a,l,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,l=a/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};KF(h,r,i);var p=_a.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p.putInt32(h.h5),p.putInt32(h.h6),p.putInt32(h.h7),p},n};var jS=null,qF=!1,zF=null;function aye(){jS=String.fromCharCode(128),jS+=_a.util.fillString(String.fromCharCode(0),64),zF=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],qF=!0}function KF(t,e,r){for(var n,i,o,s,a,l,u,f,h,p,d,m,g,y,w,b=r.length();b>=64;){for(u=0;u<16;++u)e[u]=r.getInt32();for(;u<64;++u)n=e[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[u]=n+e[u-7]+i+e[u-16]|0;for(f=t.h0,h=t.h1,p=t.h2,d=t.h3,m=t.h4,g=t.h5,y=t.h6,w=t.h7,u=0;u<64;++u)s=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7),a=y^m&(g^y),o=(f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10),l=f&h|p&(f^h),n=w+s+a+zF[u]+e[u],i=o+l,w=y,y=g,g=m,m=d+n>>>0,d=p,p=h,h=f,f=n+i>>>0;t.h0=t.h0+f|0,t.h1=t.h1+h|0,t.h2=t.h2+p|0,t.h3=t.h3+d|0,t.h4=t.h4+m|0,t.h5=t.h5+g|0,t.h6=t.h6+y|0,t.h7=t.h7+w|0,b-=64}}});var WF=x((nVe,GF)=>{c();var va=wt();Er();var Dw=null;va.util.isNodejs&&!va.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Dw=Yf());var cye=GF.exports=va.prng=va.prng||{};cye.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(u,f){if(!f)return e.generateSync(u);var h=e.plugin.cipher,p=e.plugin.increment,d=e.plugin.formatKey,m=e.plugin.formatSeed,g=va.util.createBuffer();e.key=null,y();function y(w){if(w)return f(w);if(g.length()>=u)return f(null,g.getBytes(u));if(e.generated>1048575&&(e.key=null),e.key===null)return va.util.nextTick(function(){o(y)});var b=h(e.key,e.seed);e.generated+=b.length,g.putBytes(b),e.key=d(h(e.key,p(e.seed))),e.seed=m(h(e.key,e.seed)),va.util.setImmediate(y)}},e.generateSync=function(u){var f=e.plugin.cipher,h=e.plugin.increment,p=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var m=va.util.createBuffer();m.length()<u;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=f(e.key,e.seed);e.generated+=g.length,m.putBytes(g),e.key=p(f(e.key,h(e.seed))),e.seed=d(f(e.key,e.seed))}return m.getBytes(u)};function o(u){if(e.pools[0].messageLength>=32)return a(),u();var f=32-e.pools[0].messageLength<<5;e.seedFile(f,function(h,p){if(h)return u(h);e.collect(p),a(),u()})}function s(){if(e.pools[0].messageLength>=32)return a();var u=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(u)),a()}function a(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var u=e.plugin.md.create();u.update(e.keyBytes);for(var f=1,h=0;h<32;++h)e.reseeds%f===0&&(u.update(e.pools[h].digest().getBytes()),e.pools[h].start()),f=f<<1;e.keyBytes=u.digest().getBytes(),u.start(),u.update(e.keyBytes);var p=u.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(p),e.generated=0}function l(u){var f=null,h=va.util.globalScope,p=h.crypto||h.msCrypto;p&&p.getRandomValues&&(f=function(R){return p.getRandomValues(R)});var d=va.util.createBuffer();if(f)for(;d.length()<u;){var m=Math.max(1,Math.min(u-d.length(),65536)/4),g=new Uint32Array(Math.floor(m));try{f(g);for(var y=0;y<g.length;++y)d.putInt32(g[y])}catch(R){if(!(typeof QuotaExceededError<"u"&&R instanceof QuotaExceededError))throw R}}if(d.length()<u)for(var w,b,v,S=Math.floor(Math.random()*65536);d.length()<u;){b=16807*(S&65535),w=16807*(S>>16),b+=(w&32767)<<16,b+=w>>15,b=(b&2147483647)+(b>>31),S=b&4294967295;for(var y=0;y<3;++y)v=S>>>(y<<3),v^=Math.floor(Math.random()*256),d.putByte(v&255)}return d.getBytes(u)}return Dw?(e.seedFile=function(u,f){Dw.randomBytes(u,function(h,p){if(h)return f(h);f(null,p.toString())})},e.seedFileSync=function(u){return Dw.randomBytes(u).toString()}):(e.seedFile=function(u,f){try{f(null,l(u))}catch(h){f(h)}},e.seedFileSync=l),e.collect=function(u){for(var f=u.length,h=0;h<f;++h)e.pools[e.pool].update(u.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(u,f){for(var h="",p=0;p<f;p+=8)h+=String.fromCharCode(u>>p&255);e.collect(h)},e.registerWorker=function(u){if(u===self)e.seedFile=function(h,p){function d(m){var g=m.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),p(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var f=function(h){var p=h.data;p.forge&&p.forge.prng&&e.seedFile(p.forge.prng.needed,function(d,m){u.postMessage({forge:{prng:{err:d,bytes:m}}})})};u.addEventListener("message",f)}},e}});var Qf=x((iVe,YS)=>{c();var zn=wt();Lp();$F();WF();Er();(function(){if(zn.random&&zn.random.getBytes){YS.exports=zn.random;return}(function(t){var e={},r=new Array(4),n=zn.util.createBuffer();e.formatKey=function(h){var p=zn.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),zn.aes._expandKey(h,!1)},e.formatSeed=function(h){var p=zn.util.createBuffer(h);return h=new Array(4),h[0]=p.getInt32(),h[1]=p.getInt32(),h[2]=p.getInt32(),h[3]=p.getInt32(),h},e.cipher=function(h,p){return zn.aes._updateBlock(h,p,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=zn.md.sha256;function i(){var h=zn.prng.create(e);return h.getBytes=function(p,d){return h.generate(p,d)},h.getBytesSync=function(p){return h.generate(p)},h}var o=i(),s=null,a=zn.util.globalScope,l=a.crypto||a.msCrypto;if(l&&l.getRandomValues&&(s=function(h){return l.getRandomValues(h)}),zn.options.usePureJavaScript||!zn.util.isNodejs&&!s){if(typeof window>"u"||window.document,o.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var f in navigator)try{typeof navigator[f]=="string"&&(u+=navigator[f])}catch{}o.collect(u),u=null}t&&(t().mousemove(function(h){o.collectInt(h.clientX,16),o.collectInt(h.clientY,16)}),t().keypress(function(h){o.collectInt(h.charCode,8)}))}if(!zn.random)zn.random=o;else for(var f in o)zn.random[f]=o[f];zn.random.createInstance=i,YS.exports=zn.random})(typeof jQuery<"u"?jQuery:null)})()});var XF=x((oVe,QF)=>{c();var Ki=wt();Er();var QS=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],jF=[1,2,3,5],lye=function(t,e){return t<<e&65535|(t&65535)>>16-e},uye=function(t,e){return(t&65535)>>e|t<<16-e&65535};QF.exports=Ki.rc2=Ki.rc2||{};Ki.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Ki.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,o=Math.ceil(i/8),s=255>>(i&7),a;for(a=n;a<128;a++)r.putByte(QS[r.at(a-1)+r.at(a-n)&255]);for(r.setAt(128-o,QS[r.at(128-o)&s]),a=127-o;a>=0;a--)r.setAt(a,QS[r.at(a+1)^r.at(a+o)]);return r};var YF=function(t,e,r){var n=!1,i=null,o=null,s=null,a,l,u,f,h=[];for(t=Ki.rc2.expandKey(t,e),u=0;u<64;u++)h.push(t.getInt16Le());r?(a=function(m){for(u=0;u<4;u++)m[u]+=h[f]+(m[(u+3)%4]&m[(u+2)%4])+(~m[(u+3)%4]&m[(u+1)%4]),m[u]=lye(m[u],jF[u]),f++},l=function(m){for(u=0;u<4;u++)m[u]+=h[m[(u+3)%4]&63]}):(a=function(m){for(u=3;u>=0;u--)m[u]=uye(m[u],jF[u]),m[u]-=h[f]+(m[(u+3)%4]&m[(u+2)%4])+(~m[(u+3)%4]&m[(u+1)%4]),f--},l=function(m){for(u=3;u>=0;u--)m[u]-=h[m[(u+3)%4]&63]});var p=function(m){var g=[];for(u=0;u<4;u++){var y=i.getInt16Le();s!==null&&(r?y^=s.getInt16Le():s.putInt16Le(y)),g.push(y&65535)}f=r?0:63;for(var w=0;w<m.length;w++)for(var b=0;b<m[w][0];b++)m[w][1](g);for(u=0;u<4;u++)s!==null&&(r?s.putInt16Le(g[u]):g[u]^=s.getInt16Le()),o.putInt16Le(g[u])},d=null;return d={start:function(m,g){m&&typeof m=="string"&&(m=Ki.util.createBuffer(m)),n=!1,i=Ki.util.createBuffer(),o=g||new Ki.util.createBuffer,s=m,d.output=o},update:function(m){for(n||i.putBuffer(m);i.length()>=8;)p([[5,a],[1,l],[6,a],[1,l],[5,a]])},finish:function(m){var g=!0;if(r)if(m)g=m(8,i,!r);else{var y=i.length()===8?8:8-i.length();i.fillWithByte(y,y)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(m)g=m(8,o,!r);else{var w=o.length(),b=o.at(w-1);b>w?g=!1:o.truncate(b)}return g}},d};Ki.rc2.startEncrypting=function(t,e,r){var n=Ki.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Ki.rc2.createEncryptionCipher=function(t,e){return YF(t,e,!0)};Ki.rc2.startDecrypting=function(t,e,r){var n=Ki.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Ki.rc2.createDecryptionCipher=function(t,e){return YF(t,e,!1)}});var Bw=x((sVe,oK)=>{c();var XS=wt();oK.exports=XS.jsbn=XS.jsbn||{};var Ac,fye=0xdeadbeefcafe,ZF=(fye&16777215)==15715070;function Y(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}XS.jsbn.BigInteger=Y;function Mt(){return new Y(null)}function hye(t,e,r,n,i,o){for(;--o>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function dye(t,e,r,n,i,o){for(var s=e&32767,a=e>>15;--o>=0;){var l=this.data[t]&32767,u=this.data[t++]>>15,f=a*l+u*s;l=s*l+((f&32767)<<15)+r.data[n]+(i&1073741823),i=(l>>>30)+(f>>>15)+a*u+(i>>>30),r.data[n++]=l&1073741823}return i}function JF(t,e,r,n,i,o){for(var s=e&16383,a=e>>14;--o>=0;){var l=this.data[t]&16383,u=this.data[t++]>>14,f=a*l+u*s;l=s*l+((f&16383)<<14)+r.data[n]+i,i=(l>>28)+(f>>14)+a*u,r.data[n++]=l&268435455}return i}typeof navigator>"u"?(Y.prototype.am=JF,Ac=28):ZF&&navigator.appName=="Microsoft Internet Explorer"?(Y.prototype.am=dye,Ac=30):ZF&&navigator.appName!="Netscape"?(Y.prototype.am=hye,Ac=26):(Y.prototype.am=JF,Ac=28);Y.prototype.DB=Ac;Y.prototype.DM=(1<<Ac)-1;Y.prototype.DV=1<<Ac;var ZS=52;Y.prototype.FV=Math.pow(2,ZS);Y.prototype.F1=ZS-Ac;Y.prototype.F2=2*Ac-ZS;var pye="0123456789abcdefghijklmnopqrstuvwxyz",Ow=new Array,Bp,zo;Bp="0".charCodeAt(0);for(zo=0;zo<=9;++zo)Ow[Bp++]=zo;Bp="a".charCodeAt(0);for(zo=10;zo<36;++zo)Ow[Bp++]=zo;Bp="A".charCodeAt(0);for(zo=10;zo<36;++zo)Ow[Bp++]=zo;function eK(t){return pye.charAt(t)}function tK(t,e){var r=Ow[t.charCodeAt(e)];return r??-1}function mye(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function gye(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Jl(t){var e=Mt();return e.fromInt(t),e}function yye(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,o=0;--n>=0;){var s=r==8?t[n]&255:tK(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,o==0?this.data[this.t++]=s:o+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this.data[this.t++]=s>>this.DB-o):this.data[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB)}r==8&&(t[0]&128)!=0&&(this.s=-1,o>0&&(this.data[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&Y.ZERO.subTo(this,this)}function wye(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function Eye(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,o="",s=this.t,a=this.DB-s*this.DB%e;if(s-- >0)for(a<this.DB&&(n=this.data[s]>>a)>0&&(i=!0,o=eK(n));s>=0;)a<e?(n=(this.data[s]&(1<<a)-1)<<e-a,n|=this.data[--s]>>(a+=this.DB-e)):(n=this.data[s]>>(a-=e)&r,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(o+=eK(n));return i?o:"0"}function bye(){var t=Mt();return Y.ZERO.subTo(this,t),t}function _ye(){return this.s<0?this.negate():this}function vye(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function Lw(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function Sye(){return this.t<=0?0:this.DB*(this.t-1)+Lw(this.data[this.t-1]^this.s&this.DM)}function xye(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function Rye(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function Tye(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,o=Math.floor(t/this.DB),s=this.s<<r&this.DM,a;for(a=this.t-1;a>=0;--a)e.data[a+o+1]=this.data[a]>>n|s,s=(this.data[a]&i)<<r;for(a=o-1;a>=0;--a)e.data[a]=0;e.data[o]=s,e.t=this.t+o+1,e.s=this.s,e.clamp()}function Aye(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,o=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&o)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&o)<<i),e.t=this.t-r,e.clamp()}function Iye(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function Cye(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&Y.ZERO.subTo(e,e)}function Pye(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function Nye(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Mt());var o=Mt(),s=this.s,a=t.s,l=this.DB-Lw(n.data[n.t-1]);l>0?(n.lShiftTo(l,o),i.lShiftTo(l,r)):(n.copyTo(o),i.copyTo(r));var u=o.t,f=o.data[u-1];if(f!=0){var h=f*(1<<this.F1)+(u>1?o.data[u-2]>>this.F2:0),p=this.FV/h,d=(1<<this.F1)/h,m=1<<this.F2,g=r.t,y=g-u,w=e??Mt();for(o.dlShiftTo(y,w),r.compareTo(w)>=0&&(r.data[r.t++]=1,r.subTo(w,r)),Y.ONE.dlShiftTo(u,w),w.subTo(o,o);o.t<u;)o.data[o.t++]=0;for(;--y>=0;){var b=r.data[--g]==f?this.DM:Math.floor(r.data[g]*p+(r.data[g-1]+m)*d);if((r.data[g]+=o.am(0,b,r,y,0,u))<b)for(o.dlShiftTo(y,w),r.subTo(w,r);r.data[g]<--b;)r.subTo(w,r)}e!=null&&(r.drShiftTo(u,e),s!=a&&Y.ZERO.subTo(e,e)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),s<0&&Y.ZERO.subTo(r,r)}}}function kye(t){var e=Mt();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(Y.ZERO)>0&&t.subTo(e,e),e}function Xf(t){this.m=t}function Dye(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Oye(t){return t}function Lye(t){t.divRemTo(this.m,null,t)}function Bye(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Mye(t,e){t.squareTo(e),this.reduce(e)}Xf.prototype.convert=Dye;Xf.prototype.revert=Oye;Xf.prototype.reduce=Lye;Xf.prototype.mulTo=Bye;Xf.prototype.sqrTo=Mye;function Uye(){if(this.t<1)return 0;var t=this.data[0];if((t&1)==0)return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Zf(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Fye(t){var e=Mt();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(Y.ZERO)>0&&this.m.subTo(e,e),e}function Kye(t){var e=Mt();return t.copyTo(e),this.reduce(e),e}function Vye(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function qye(t,e){t.squareTo(e),this.reduce(e)}function zye(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Zf.prototype.convert=Fye;Zf.prototype.revert=Kye;Zf.prototype.reduce=Vye;Zf.prototype.mulTo=zye;Zf.prototype.sqrTo=qye;function Hye(){return(this.t>0?this.data[0]&1:this.s)==0}function $ye(t,e){if(t>4294967295||t<1)return Y.ONE;var r=Mt(),n=Mt(),i=e.convert(this),o=Lw(t)-1;for(i.copyTo(r);--o>=0;)if(e.sqrTo(r,n),(t&1<<o)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Gye(t,e){var r;return t<256||e.isEven()?r=new Xf(e):r=new Zf(e),this.exp(t,r)}Y.prototype.copyTo=mye;Y.prototype.fromInt=gye;Y.prototype.fromString=yye;Y.prototype.clamp=wye;Y.prototype.dlShiftTo=xye;Y.prototype.drShiftTo=Rye;Y.prototype.lShiftTo=Tye;Y.prototype.rShiftTo=Aye;Y.prototype.subTo=Iye;Y.prototype.multiplyTo=Cye;Y.prototype.squareTo=Pye;Y.prototype.divRemTo=Nye;Y.prototype.invDigit=Uye;Y.prototype.isEven=Hye;Y.prototype.exp=$ye;Y.prototype.toString=Eye;Y.prototype.negate=bye;Y.prototype.abs=_ye;Y.prototype.compareTo=vye;Y.prototype.bitLength=Sye;Y.prototype.mod=kye;Y.prototype.modPowInt=Gye;Y.ZERO=Jl(0);Y.ONE=Jl(1);function Wye(){var t=Mt();return this.copyTo(t),t}function jye(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Yye(){return this.t==0?this.s:this.data[0]<<24>>24}function Qye(){return this.t==0?this.s:this.data[0]<<16>>16}function Xye(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function Zye(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Jye(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Jl(r),i=Mt(),o=Mt(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(t)+s}function e3e(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,o=0,s=0,a=0;a<t.length;++a){var l=tK(t,a);if(l<0){t.charAt(a)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+l,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0)}o>0&&(this.dMultiply(Math.pow(e,o)),this.dAddOffset(s,0)),i&&Y.ZERO.subTo(this,this)}function t3e(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(Y.ONE.shiftLeft(t-1),JS,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(Y.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function r3e(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function n3e(t){return this.compareTo(t)==0}function i3e(t){return this.compareTo(t)<0?this:t}function o3e(t){return this.compareTo(t)>0?this:t}function s3e(t,e,r){var n,i,o=Math.min(t.t,this.t);for(n=0;n<o;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=o;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function a3e(t,e){return t&e}function c3e(t){var e=Mt();return this.bitwiseTo(t,a3e,e),e}function JS(t,e){return t|e}function l3e(t){var e=Mt();return this.bitwiseTo(t,JS,e),e}function rK(t,e){return t^e}function u3e(t){var e=Mt();return this.bitwiseTo(t,rK,e),e}function nK(t,e){return t&~e}function f3e(t){var e=Mt();return this.bitwiseTo(t,nK,e),e}function h3e(){for(var t=Mt(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function d3e(t){var e=Mt();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function p3e(t){var e=Mt();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function m3e(t){if(t==0)return-1;var e=0;return(t&65535)==0&&(t>>=16,e+=16),(t&255)==0&&(t>>=8,e+=8),(t&15)==0&&(t>>=4,e+=4),(t&3)==0&&(t>>=2,e+=2),(t&1)==0&&++e,e}function g3e(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+m3e(this.data[t]);return this.s<0?this.t*this.DB:-1}function y3e(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function w3e(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=y3e(this.data[r]^e);return t}function E3e(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function b3e(t,e){var r=Y.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function _3e(t){return this.changeBit(t,JS)}function v3e(t){return this.changeBit(t,nK)}function S3e(t){return this.changeBit(t,rK)}function x3e(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function R3e(t){var e=Mt();return this.addTo(t,e),e}function T3e(t){var e=Mt();return this.subTo(t,e),e}function A3e(t){var e=Mt();return this.multiplyTo(t,e),e}function I3e(t){var e=Mt();return this.divRemTo(t,e,null),e}function C3e(t){var e=Mt();return this.divRemTo(t,null,e),e}function P3e(t){var e=Mt(),r=Mt();return this.divRemTo(t,e,r),new Array(e,r)}function N3e(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function k3e(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function g2(){}function iK(t){return t}function D3e(t,e,r){t.multiplyTo(e,r)}function O3e(t,e){t.squareTo(e)}g2.prototype.convert=iK;g2.prototype.revert=iK;g2.prototype.mulTo=D3e;g2.prototype.sqrTo=O3e;function L3e(t){return this.exp(t,new g2)}function B3e(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function M3e(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function Mp(t){this.r2=Mt(),this.q3=Mt(),Y.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function U3e(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Mt();return t.copyTo(e),this.reduce(e),e}function F3e(t){return t}function K3e(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function V3e(t,e){t.squareTo(e),this.reduce(e)}function q3e(t,e,r){t.multiplyTo(e,r),this.reduce(r)}Mp.prototype.convert=U3e;Mp.prototype.revert=F3e;Mp.prototype.reduce=K3e;Mp.prototype.mulTo=q3e;Mp.prototype.sqrTo=V3e;function z3e(t,e){var r=t.bitLength(),n,i=Jl(1),o;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?o=new Xf(e):e.isEven()?o=new Mp(e):o=new Zf(e);var s=new Array,a=3,l=n-1,u=(1<<n)-1;if(s[1]=o.convert(this),n>1){var f=Mt();for(o.sqrTo(s[1],f);a<=u;)s[a]=Mt(),o.mulTo(f,s[a-2],s[a]),a+=2}var h=t.t-1,p,d=!0,m=Mt(),g;for(r=Lw(t.data[h])-1;h>=0;){for(r>=l?p=t.data[h]>>r-l&u:(p=(t.data[h]&(1<<r+1)-1)<<l-r,h>0&&(p|=t.data[h-1]>>this.DB+r-l)),a=n;(p&1)==0;)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--h),d)s[p].copyTo(i),d=!1;else{for(;a>1;)o.sqrTo(i,m),o.sqrTo(m,i),a-=2;a>0?o.sqrTo(i,m):(g=i,i=m,m=g),o.mulTo(m,s[p],i)}for(;h>=0&&(t.data[h]&1<<r)==0;)o.sqrTo(i,m),g=i,i=m,m=g,--r<0&&(r=this.DB-1,--h)}return o.revert(i)}function H3e(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return e;for(i<o&&(o=i),o>0&&(e.rShiftTo(o,e),r.rShiftTo(o,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function $3e(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function G3e(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return Y.ZERO;for(var r=t.clone(),n=this.clone(),i=Jl(1),o=Jl(0),s=Jl(0),a=Jl(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!o.isEven())&&(i.addTo(this,i),o.subTo(t,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!a.isEven())&&(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),o.subTo(a,o)):(n.subTo(r,n),e&&s.subTo(i,s),a.subTo(o,a))}if(n.compareTo(Y.ONE)!=0)return Y.ZERO;if(a.compareTo(t)>=0)return a.subtract(t);if(a.signum()<0)a.addTo(t,a);else return a;return a.signum()<0?a.add(t):a}var ks=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],W3e=(1<<26)/ks[ks.length-1];function j3e(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=ks[ks.length-1]){for(e=0;e<ks.length;++e)if(r.data[0]==ks[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<ks.length;){for(var n=ks[e],i=e+1;i<ks.length&&n<W3e;)n*=ks[i++];for(n=r.modInt(n);e<i;)if(n%ks[e++]==0)return!1}return r.millerRabin(t)}function Y3e(t){var e=this.subtract(Y.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Q3e(),o,s=0;s<t;++s){do o=new Y(this.bitLength(),i);while(o.compareTo(Y.ONE)<=0||o.compareTo(e)>=0);var a=o.modPow(n,this);if(a.compareTo(Y.ONE)!=0&&a.compareTo(e)!=0){for(var l=1;l++<r&&a.compareTo(e)!=0;)if(a=a.modPowInt(2,this),a.compareTo(Y.ONE)==0)return!1;if(a.compareTo(e)!=0)return!1}}return!0}function Q3e(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}Y.prototype.chunkSize=Xye;Y.prototype.toRadix=Jye;Y.prototype.fromRadix=e3e;Y.prototype.fromNumber=t3e;Y.prototype.bitwiseTo=s3e;Y.prototype.changeBit=b3e;Y.prototype.addTo=x3e;Y.prototype.dMultiply=N3e;Y.prototype.dAddOffset=k3e;Y.prototype.multiplyLowerTo=B3e;Y.prototype.multiplyUpperTo=M3e;Y.prototype.modInt=$3e;Y.prototype.millerRabin=Y3e;Y.prototype.clone=Wye;Y.prototype.intValue=jye;Y.prototype.byteValue=Yye;Y.prototype.shortValue=Qye;Y.prototype.signum=Zye;Y.prototype.toByteArray=r3e;Y.prototype.equals=n3e;Y.prototype.min=i3e;Y.prototype.max=o3e;Y.prototype.and=c3e;Y.prototype.or=l3e;Y.prototype.xor=u3e;Y.prototype.andNot=f3e;Y.prototype.not=h3e;Y.prototype.shiftLeft=d3e;Y.prototype.shiftRight=p3e;Y.prototype.getLowestSetBit=g3e;Y.prototype.bitCount=w3e;Y.prototype.testBit=E3e;Y.prototype.setBit=_3e;Y.prototype.clearBit=v3e;Y.prototype.flipBit=S3e;Y.prototype.add=R3e;Y.prototype.subtract=T3e;Y.prototype.multiply=A3e;Y.prototype.divide=I3e;Y.prototype.remainder=C3e;Y.prototype.divideAndRemainder=P3e;Y.prototype.modPow=z3e;Y.prototype.modInverse=G3e;Y.prototype.pow=L3e;Y.prototype.gcd=H3e;Y.prototype.isProbablePrime=j3e});var uK=x((aVe,lK)=>{c();var Sa=wt();Zl();Er();var aK=lK.exports=Sa.sha1=Sa.sha1||{};Sa.md.sha1=Sa.md.algorithms.sha1=aK;aK.create=function(){cK||X3e();var t=null,e=Sa.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,o=0;o<i;++o)n.fullMessageLength.push(0);return e=Sa.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,o){o==="utf8"&&(i=Sa.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var a=n.fullMessageLength.length-1;a>=0;--a)n.fullMessageLength[a]+=s[1],s[1]=s[0]+(n.fullMessageLength[a]/4294967296>>>0),n.fullMessageLength[a]=n.fullMessageLength[a]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),sK(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Sa.util.createBuffer();i.putBytes(e.bytes());var o=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=o&n.blockLength-1;i.putBytes(ex.substr(0,n.blockLength-s));for(var a,l,u=n.fullMessageLength[0]*8,f=0;f<n.fullMessageLength.length-1;++f)a=n.fullMessageLength[f+1]*8,l=a/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=a>>>0;i.putInt32(u);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};sK(h,r,i);var p=Sa.util.createBuffer();return p.putInt32(h.h0),p.putInt32(h.h1),p.putInt32(h.h2),p.putInt32(h.h3),p.putInt32(h.h4),p},n};var ex=null,cK=!1;function X3e(){ex=String.fromCharCode(128),ex+=Sa.util.fillString(String.fromCharCode(0),64),cK=!0}function sK(t,e,r){for(var n,i,o,s,a,l,u,f,h=r.length();h>=64;){for(i=t.h0,o=t.h1,s=t.h2,a=t.h3,l=t.h4,f=0;f<16;++f)n=r.getInt32(),e[f]=n,u=a^o&(s^a),n=(i<<5|i>>>27)+u+l+1518500249+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<20;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=a^o&(s^a),n=(i<<5|i>>>27)+u+l+1518500249+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<32;++f)n=e[f-3]^e[f-8]^e[f-14]^e[f-16],n=n<<1|n>>>31,e[f]=n,u=o^s^a,n=(i<<5|i>>>27)+u+l+1859775393+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<40;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o^s^a,n=(i<<5|i>>>27)+u+l+1859775393+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<60;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o&s|a&(o^s),n=(i<<5|i>>>27)+u+l+2400959708+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;for(;f<80;++f)n=e[f-6]^e[f-16]^e[f-28]^e[f-32],n=n<<2|n>>>30,e[f]=n,u=o^s^a,n=(i<<5|i>>>27)+u+l+3395469782+n,l=a,a=s,s=(o<<30|o>>>2)>>>0,o=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+o|0,t.h2=t.h2+s|0,t.h3=t.h3+a|0,t.h4=t.h4+l|0,h-=64}}});var dK=x((cVe,hK)=>{c();var xa=wt();Er();Qf();uK();var fK=hK.exports=xa.pkcs1=xa.pkcs1||{};fK.encode_rsa_oaep=function(t,e,r){var n,i,o,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,o=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),o?o.start():o=xa.md.sha1.create(),s||(s=o);var a=Math.ceil(t.n.bitLength()/8),l=a-2*o.digestLength-2;if(e.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=e.length,u.maxLength=l,u}n||(n=""),o.update(n,"raw");for(var f=o.digest(),h="",p=l-e.length,d=0;d<p;d++)h+="\0";var m=f.getBytes()+h+""+e;if(!i)i=xa.random.getBytes(o.digestLength);else if(i.length!==o.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=o.digestLength,u}var g=Mw(i,a-o.digestLength-1,s),y=xa.util.xorBytes(m,g,m.length),w=Mw(y,o.digestLength,s),b=xa.util.xorBytes(i,w,i.length);return"\0"+b+y};fK.decode_rsa_oaep=function(t,e,r){var n,i,o;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(o=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var y=new Error("RSAES-OAEP encoded message length is invalid.");throw y.length=e.length,y.expectedLength=s,y}if(i===void 0?i=xa.md.sha1.create():i.start(),o||(o=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var a=i.digest().getBytes(),l=e.charAt(0),u=e.substring(1,i.digestLength+1),f=e.substring(1+i.digestLength),h=Mw(f,i.digestLength,o),p=xa.util.xorBytes(u,h,u.length),d=Mw(p,s-i.digestLength-1,o),m=xa.util.xorBytes(f,d,f.length),g=m.substring(0,i.digestLength),y=l!=="\0",w=0;w<i.digestLength;++w)y|=a.charAt(w)!==g.charAt(w);for(var b=1,v=i.digestLength,S=i.digestLength;S<m.length;S++){var R=m.charCodeAt(S),I=R&1^1,A=b?65534:0;y|=R&A,b=b&I,v+=b}if(y||m.charCodeAt(v)!==1)throw new Error("Invalid RSAES-OAEP padding.");return m.substring(v+1)};function Mw(t,e,r){r||(r=xa.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),o=0;o<i;++o){var s=String.fromCharCode(o>>24&255,o>>16&255,o>>8&255,o&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var pK=x((lVe,tx)=>{c();var eu=wt();Er();Bw();Qf();(function(){if(eu.prime){tx.exports=eu.prime;return}var t=tx.exports=eu.prime=eu.prime||{},e=eu.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,p){return h|p};t.generateProbablePrime=function(h,p,d){typeof p=="function"&&(d=p,p={}),p=p||{};var m=p.algorithm||"PRIMEINC";typeof m=="string"&&(m={name:m}),m.options=m.options||{};var g=p.prng||eu.random,y={nextBytes:function(w){for(var b=g.getBytesSync(w.length),v=0;v<w.length;++v)w[v]=b.charCodeAt(v)}};if(m.name==="PRIMEINC")return o(h,y,m.options,d);throw new Error("Invalid prime generation algorithm: "+m.name)};function o(h,p,d,m){return"workers"in d?l(h,p,d,m):s(h,p,d,m)}function s(h,p,d,m){var g=u(h,p),y=0,w=f(g.bitLength());"millerRabinTests"in d&&(w=d.millerRabinTests);var b=10;"maxBlockTime"in d&&(b=d.maxBlockTime),a(g,h,p,y,w,b,m)}function a(h,p,d,m,g,y,w){var b=+new Date;do{if(h.bitLength()>p&&(h=u(p,d)),h.isProbablePrime(g))return w(null,h);h.dAddOffset(r[m++%8],0)}while(y<0||+new Date-b<y);eu.util.setImmediate(function(){a(h,p,d,m,g,y,w)})}function l(h,p,d,m){if(typeof Worker>"u")return s(h,p,d,m);var g=u(h,p),y=d.workers,w=d.workLoad||100,b=w*30/8,v=d.workerScript||"forge/prime.worker.js";if(y===-1)return eu.util.estimateCores(function(R,I){R&&(I=2),y=I-1,S()});S();function S(){y=Math.max(1,y);for(var R=[],I=0;I<y;++I)R[I]=new Worker(v);for(var A=y,I=0;I<y;++I)R[I].addEventListener("message",q);var L=!1;function q(G){if(!L){--A;var j=G.data;if(j.found){for(var se=0;se<R.length;++se)R[se].terminate();return L=!0,m(null,new e(j.prime,16))}g.bitLength()>h&&(g=u(h,p));var re=g.toString(16);G.target.postMessage({hex:re,workLoad:w}),g.dAddOffset(b,0)}}}}function u(h,p){var d=new e(h,p),m=h-1;return d.testBit(m)||d.bitwiseTo(e.ONE.shiftLeft(m),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function f(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var y2=x((uVe,_K)=>{c();var Ne=wt();Xl();Bw();kp();dK();pK();Qf();Er();typeof Pt>"u"&&(Pt=Ne.jsbn.BigInteger);var Pt,rx=Ne.util.isNodejs?Yf():null,M=Ne.asn1,Ho=Ne.util;Ne.pki=Ne.pki||{};_K.exports=Ne.pki.rsa=Ne.rsa=Ne.rsa||{};var tt=Ne.pki,Z3e=[6,4,2,4,2,4,6,2],J3e={name:"PrivateKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},e4e={name:"RSAPrivateKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},t4e={name:"RSAPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:M.Class.UNIVERSAL,type:M.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},r4e=Ne.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},n4e={name:"DigestInfo",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:M.Class.UNIVERSAL,type:M.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:M.Class.UNIVERSAL,type:M.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:M.Class.UNIVERSAL,type:M.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:M.Class.UNIVERSAL,type:M.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},i4e=function(t){var e;if(t.algorithm in tt.oids)e=tt.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=M.oidToDer(e).getBytes(),i=M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[]),o=M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[]);o.value.push(M.create(M.Class.UNIVERSAL,M.Type.OID,!1,n)),o.value.push(M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,""));var s=M.create(M.Class.UNIVERSAL,M.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(o),i.value.push(s),M.toDer(i).getBytes()},EK=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Pt.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Pt.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Pt(Ne.util.bytesToHex(Ne.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Pt.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),o=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(o)<0;)i=i.add(e.p);var s=i.subtract(o).multiply(e.qInv).mod(e.p).multiply(e.q).add(o);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};tt.rsa.encrypt=function(t,e,r){var n=r,i,o=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=bK(t,e,r)):(i=Ne.util.createBuffer(),i.putBytes(t));for(var s=new Pt(i.toHex(),16),a=EK(s,e,n),l=a.toString(16),u=Ne.util.createBuffer(),f=o-Math.ceil(l.length/2);f>0;)u.putByte(0),--f;return u.putBytes(Ne.util.hexToBytes(l)),u.getBytes()};tt.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var o=new Error("Encrypted message length is invalid.");throw o.length=t.length,o.expected=i,o}var s=new Pt(Ne.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var a=EK(s,e,r),l=a.toString(16),u=Ne.util.createBuffer(),f=i-Math.ceil(l.length/2);f>0;)u.putByte(0),--f;return u.putBytes(Ne.util.hexToBytes(l)),n!==!1?Uw(u.getBytes(),e,r):u.getBytes()};tt.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||Ne.random,i={nextBytes:function(a){for(var l=n.getBytesSync(a.length),u=0;u<a.length;++u)a[u]=l.charCodeAt(u)}},o=r.algorithm||"PRIMEINC",s;if(o==="PRIMEINC")s={algorithm:o,state:0,bits:t,rng:i,eInt:e||65537,e:new Pt(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+o);return s};tt.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Pt(null);r.fromInt(30);for(var n=0,i=function(h,p){return h|p},o=+new Date,s,a=0;t.keys===null&&(e<=0||a<e);){if(t.state===0){var l=t.p===null?t.pBits:t.qBits,u=l-1;t.pqState===0?(t.num=new Pt(l,t.rng),t.num.testBit(u)||t.num.bitwiseTo(Pt.ONE.shiftLeft(u),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>l?t.pqState=0:t.num.isProbablePrime(s4e(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(Z3e[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Pt.ONE),t.q1=t.q.subtract(Pt.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Pt.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var f=t.e.modInverse(t.phi);t.keys={privateKey:tt.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:tt.rsa.setPublicKey(t.n,t.e)}}s=+new Date,a+=s-o,o=s}return t.keys!==null};tt.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!Ne.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(mK("generateKeyPair"))return rx.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(a,l,u){if(a)return n(a);n(null,{privateKey:tt.privateKeyFromPem(u),publicKey:tt.publicKeyFromPem(l)})});if(gK("generateKey")&&gK("exportKey"))return Ho.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:wK(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(a){return Ho.globalScope.crypto.subtle.exportKey("pkcs8",a.privateKey)}).then(void 0,function(a){n(a)}).then(function(a){if(a){var l=tt.privateKeyFromAsn1(M.fromDer(Ne.util.createBuffer(a)));n(null,{privateKey:l,publicKey:tt.setRsaPublicKey(l.n,l.e)})}});if(yK("generateKey")&&yK("exportKey")){var i=Ho.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:wK(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(a){var l=a.target.result,u=Ho.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(f){var h=f.target.result,p=tt.privateKeyFromAsn1(M.fromDer(Ne.util.createBuffer(h)));n(null,{privateKey:p,publicKey:tt.setRsaPublicKey(p.n,p.e)})},u.onerror=function(f){n(f)}},i.onerror=function(a){n(a)};return}}else if(mK("generateKeyPairSync")){var o=rx.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:tt.privateKeyFromPem(o.privateKey),publicKey:tt.publicKeyFromPem(o.publicKey)}}}var s=tt.rsa.createKeyPairGenerationState(t,e,r);if(!n)return tt.rsa.stepKeyPairGenerationState(s,0),s.keys;o4e(s,r,n)};tt.setRsaPublicKey=tt.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,o){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(a,l,u){return bK(a,l,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(a,l){return Ne.pkcs1.encode_rsa_oaep(l,a,o)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(a){return a}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return tt.rsa.encrypt(s,r,!0)},r.verify=function(n,i,o,s){typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),o==="RSASSA-PKCS1-V1_5"?o={verify:function(l,u){u=Uw(u,r,!0);var f=M.fromDer(u,{parseAllBytes:s._parseAllDigestBytes}),h={},p=[];if(!M.validate(f,n4e,h,p)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=p,d}var m=M.derToOid(h.algorithmIdentifier);if(!(m===Ne.oids.md2||m===Ne.oids.md5||m===Ne.oids.sha1||m===Ne.oids.sha224||m===Ne.oids.sha256||m===Ne.oids.sha384||m===Ne.oids.sha512||m===Ne.oids["sha512-224"]||m===Ne.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=m,d}if((m===Ne.oids.md2||m===Ne.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===h.digest}}:(o==="NONE"||o==="NULL"||o===null)&&(o={verify:function(l,u){return u=Uw(u,r,!0),l===u}});var a=tt.rsa.decrypt(i,r,!0,!1);return o.verify(n,a,r.n.bitLength())},r};tt.setRsaPrivateKey=tt.rsa.setPrivateKey=function(t,e,r,n,i,o,s,a){var l={n:t,e,d:r,p:n,q:i,dP:o,dQ:s,qInv:a};return l.decrypt=function(u,f,h){typeof f=="string"?f=f.toUpperCase():f===void 0&&(f="RSAES-PKCS1-V1_5");var p=tt.rsa.decrypt(u,l,!1,!1);if(f==="RSAES-PKCS1-V1_5")f={decode:Uw};else if(f==="RSA-OAEP"||f==="RSAES-OAEP")f={decode:function(d,m){return Ne.pkcs1.decode_rsa_oaep(m,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(f)!==-1)f={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+f+'".');return f.decode(p,l,!1)},l.sign=function(u,f){var h=!1;typeof f=="string"&&(f=f.toUpperCase()),f===void 0||f==="RSASSA-PKCS1-V1_5"?(f={encode:i4e},h=1):(f==="NONE"||f==="NULL"||f===null)&&(f={encode:function(){return u}},h=1);var p=f.encode(u,l.n.bitLength());return tt.rsa.encrypt(p,l,h)},l};tt.wrapRsaPrivateKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,M.integerToDer(0).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.OID,!1,M.oidToDer(tt.oids.rsaEncryption).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,"")]),M.create(M.Class.UNIVERSAL,M.Type.OCTETSTRING,!1,M.toDer(t).getBytes())])};tt.privateKeyFromAsn1=function(t){var e={},r=[];if(M.validate(t,J3e,e,r)&&(t=M.fromDer(Ne.util.createBuffer(e.privateKey))),e={},r=[],!M.validate(t,e4e,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,o,s,a,l,u,f,h;return i=Ne.util.createBuffer(e.privateKeyModulus).toHex(),o=Ne.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=Ne.util.createBuffer(e.privateKeyPrivateExponent).toHex(),a=Ne.util.createBuffer(e.privateKeyPrime1).toHex(),l=Ne.util.createBuffer(e.privateKeyPrime2).toHex(),u=Ne.util.createBuffer(e.privateKeyExponent1).toHex(),f=Ne.util.createBuffer(e.privateKeyExponent2).toHex(),h=Ne.util.createBuffer(e.privateKeyCoefficient).toHex(),tt.setRsaPrivateKey(new Pt(i,16),new Pt(o,16),new Pt(s,16),new Pt(a,16),new Pt(l,16),new Pt(u,16),new Pt(f,16),new Pt(h,16))};tt.privateKeyToAsn1=tt.privateKeyToRSAPrivateKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,M.integerToDer(0).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.n)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.e)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.d)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.p)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.q)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.dP)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.dQ)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.qInv))])};tt.publicKeyFromAsn1=function(t){var e={},r=[];if(M.validate(t,r4e,e,r)){var n=M.derToOid(e.publicKeyOid);if(n!==tt.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!M.validate(t,t4e,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var o=Ne.util.createBuffer(e.publicKeyModulus).toHex(),s=Ne.util.createBuffer(e.publicKeyExponent).toHex();return tt.setRsaPublicKey(new Pt(o,16),new Pt(s,16))};tt.publicKeyToAsn1=tt.publicKeyToSubjectPublicKeyInfo=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.OID,!1,M.oidToDer(tt.oids.rsaEncryption).getBytes()),M.create(M.Class.UNIVERSAL,M.Type.NULL,!1,"")]),M.create(M.Class.UNIVERSAL,M.Type.BITSTRING,!1,[tt.publicKeyToRSAPublicKey(t)])])};tt.publicKeyToRSAPublicKey=function(t){return M.create(M.Class.UNIVERSAL,M.Type.SEQUENCE,!0,[M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.n)),M.create(M.Class.UNIVERSAL,M.Type.INTEGER,!1,Ra(t.e))])};function bK(t,e,r){var n=Ne.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var o=new Error("Message is too long for PKCS#1 v1.5 padding.");throw o.length=t.length,o.max=i-11,o}n.putByte(0),n.putByte(r);var s=i-3-t.length,a;if(r===0||r===1){a=r===0?0:255;for(var l=0;l<s;++l)n.putByte(a)}else for(;s>0;){for(var u=0,f=Ne.random.getBytes(s),l=0;l<s;++l)a=f.charCodeAt(l),a===0?++u:n.putByte(a);s=u}return n.putByte(0),n.putBytes(t),n}function Uw(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),o=Ne.util.createBuffer(t),s=o.getByte(),a=o.getByte();if(s!==0||r&&a!==0&&a!==1||!r&&a!=2||r&&a===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var l=0;if(a===0){l=i-3-n;for(var u=0;u<l;++u)if(o.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(a===1)for(l=0;o.length()>1;){if(o.getByte()!==255){--o.read;break}++l}else if(a===2)for(l=0;o.length()>1;){if(o.getByte()===0){--o.read;break}++l}var f=o.getByte();if(f!==0||l!==i-3-o.length())throw new Error("Encryption block is invalid.");return o.getBytes()}function o4e(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){o(t.pBits,function(a,l){if(a)return r(a);if(t.p=l,t.q!==null)return s(a,t.q);o(t.qBits,s)})}function o(a,l){Ne.prime.generateProbablePrime(a,n,l)}function s(a,l){if(a)return r(a);if(t.q=l,t.p.compareTo(t.q)<0){var u=t.p;t.p=t.q,t.q=u}if(t.p.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)!==0){t.p=null,i();return}if(t.q.subtract(Pt.ONE).gcd(t.e).compareTo(Pt.ONE)!==0){t.q=null,o(t.qBits,s);return}if(t.p1=t.p.subtract(Pt.ONE),t.q1=t.q.subtract(Pt.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Pt.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,o(t.qBits,s);return}var f=t.e.modInverse(t.phi);t.keys={privateKey:tt.rsa.setPrivateKey(t.n,t.e,f,t.p,t.q,f.mod(t.p1),f.mod(t.q1),t.q.modInverse(t.p)),publicKey:tt.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Ra(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=Ne.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function s4e(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function mK(t){return Ne.util.isNodejs&&typeof rx[t]=="function"}function gK(t){return typeof Ho.globalScope<"u"&&typeof Ho.globalScope.crypto=="object"&&typeof Ho.globalScope.crypto.subtle=="object"&&typeof Ho.globalScope.crypto.subtle[t]=="function"}function yK(t){return typeof Ho.globalScope<"u"&&typeof Ho.globalScope.msCrypto=="object"&&typeof Ho.globalScope.msCrypto.subtle=="object"&&typeof Ho.globalScope.msCrypto.subtle[t]=="function"}function wK(t){for(var e=Ne.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var nx=x((fVe,TK)=>{c();var de=wt();Lp();Xl();Iw();Zl();kp();WS();kw();Qf();XF();y2();Er();typeof vK>"u"&&(vK=de.jsbn.BigInteger);var vK,$=de.asn1,at=de.pki=de.pki||{};TK.exports=at.pbe=de.pbe=de.pbe||{};var Jf=at.oids,a4e={name:"EncryptedPrivateKeyInfo",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},c4e={name:"PBES2Algorithms",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:$.Class.UNIVERSAL,type:$.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},l4e={name:"pkcs-12PbeParams",tagClass:$.Class.UNIVERSAL,type:$.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:$.Class.UNIVERSAL,type:$.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:$.Class.UNIVERSAL,type:$.Type.INTEGER,constructed:!1,capture:"iterations"}]};at.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=de.random.getBytesSync(r.saltSize),i=r.count,o=$.integerToDer(i),s,a,l;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,f,h;switch(r.algorithm){case"aes128":s=16,u=16,f=Jf["aes128-CBC"],h=de.aes.createEncryptionCipher;break;case"aes192":s=24,u=16,f=Jf["aes192-CBC"],h=de.aes.createEncryptionCipher;break;case"aes256":s=32,u=16,f=Jf["aes256-CBC"],h=de.aes.createEncryptionCipher;break;case"des":s=8,u=8,f=Jf.desCBC,h=de.des.createEncryptionCipher;break;default:var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),m=RK(d),g=de.pkcs5.pbkdf2(e,n,i,s,m),y=de.random.getBytesSync(u),w=h(g);w.start(y),w.update($.toDer(t)),w.finish(),l=w.output.getBytes();var b=u4e(n,o,s,d);a=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(Jf.pkcs5PBES2).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(Jf.pkcs5PBKDF2).getBytes()),b]),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(f).getBytes()),$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,y)])])])}else if(r.algorithm==="3des"){s=24;var v=new de.util.ByteBuffer(n),g=at.pbe.generatePkcs12Key(e,v,1,i,s),y=at.pbe.generatePkcs12Key(e,v,2,i,s),w=de.des.createEncryptionCipher(g);w.start(y),w.update($.toDer(t)),w.finish(),l=w.output.getBytes(),a=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(Jf["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,n),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,o.getBytes())])])}else{var p=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw p.algorithm=r.algorithm,p}var S=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[a,$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,l)]);return S};at.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!$.validate(t,a4e,n,i)){var o=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=$.derToOid(n.encryptionOid),a=at.pbe.getCipher(s,n.encryptionParams,e),l=de.util.createBuffer(n.encryptedData);return a.update(l),a.finish()&&(r=$.fromDer(a.output)),r};at.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:$.toDer(t).getBytes()};return de.pem.encode(r,{maxline:e})};at.encryptedPrivateKeyFromPem=function(t){var e=de.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return $.fromDer(e.body)};at.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=at.wrapRsaPrivateKey(at.privateKeyToAsn1(t));return n=at.encryptPrivateKeyInfo(n,e,r),at.encryptedPrivateKeyToPem(n)}var i,o,s,a;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,o=de.random.getBytesSync(16),a=de.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,o=de.random.getBytesSync(16),a=de.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,o=de.random.getBytesSync(16),a=de.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,o=de.random.getBytesSync(8),a=de.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,o=de.random.getBytesSync(8),a=de.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw l.algorithm=r.algorithm,l}var u=de.pbe.opensslDeriveBytes(e,o.substr(0,8),s),f=a(u);f.start(o),f.update($.toDer(at.privateKeyToAsn1(t))),f.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:de.util.bytesToHex(o).toUpperCase()},body:f.output.getBytes()};return de.pem.encode(h)};at.decryptRsaPrivateKey=function(t,e){var r=null,n=de.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var o,s;switch(n.dekInfo.algorithm){case"DES-CBC":o=8,s=de.des.createDecryptionCipher;break;case"DES-EDE3-CBC":o=24,s=de.des.createDecryptionCipher;break;case"AES-128-CBC":o=16,s=de.aes.createDecryptionCipher;break;case"AES-192-CBC":o=24,s=de.aes.createDecryptionCipher;break;case"AES-256-CBC":o=32,s=de.aes.createDecryptionCipher;break;case"RC2-40-CBC":o=5,s=function(h){return de.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":o=8,s=function(h){return de.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":o=16,s=function(h){return de.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var a=de.util.hexToBytes(n.dekInfo.parameters),l=de.pbe.opensslDeriveBytes(e,a.substr(0,8),o),u=s(l);if(u.start(a),u.update(de.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=at.decryptPrivateKeyInfo($.fromDer(r),e):r=$.fromDer(r),r!==null&&(r=at.privateKeyFromAsn1(r)),r};at.pbe.generatePkcs12Key=function(t,e,r,n,i,o){var s,a;if(typeof o>"u"||o===null){if(!("sha1"in de.md))throw new Error('"sha1" hash algorithm unavailable.');o=de.md.sha1.create()}var l=o.digestLength,u=o.blockLength,f=new de.util.ByteBuffer,h=new de.util.ByteBuffer;if(t!=null){for(a=0;a<t.length;a++)h.putInt16(t.charCodeAt(a));h.putInt16(0)}var p=h.length(),d=e.length(),m=new de.util.ByteBuffer;m.fillWithByte(r,u);var g=u*Math.ceil(d/u),y=new de.util.ByteBuffer;for(a=0;a<g;a++)y.putByte(e.at(a%d));var w=u*Math.ceil(p/u),b=new de.util.ByteBuffer;for(a=0;a<w;a++)b.putByte(h.at(a%p));var v=y;v.putBuffer(b);for(var S=Math.ceil(i/l),R=1;R<=S;R++){var I=new de.util.ByteBuffer;I.putBytes(m.bytes()),I.putBytes(v.bytes());for(var A=0;A<n;A++)o.start(),o.update(I.getBytes()),I=o.digest();var L=new de.util.ByteBuffer;for(a=0;a<u;a++)L.putByte(I.at(a%l));var q=Math.ceil(d/u)+Math.ceil(p/u),G=new de.util.ByteBuffer;for(s=0;s<q;s++){var j=new de.util.ByteBuffer(v.getBytes(u)),se=511;for(a=L.length()-1;a>=0;a--)se=se>>8,se+=L.at(a)+j.at(a),j.setAt(a,se&255);G.putBuffer(j)}v=G,f.putBuffer(I)}return f.truncate(f.length()-i),f};at.pbe.getCipher=function(t,e,r){switch(t){case at.oids.pkcs5PBES2:return at.pbe.getCipherForPBES2(t,e,r);case at.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case at.oids["pbewithSHAAnd40BitRC2-CBC"]:return at.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};at.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!$.validate(e,c4e,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}if(t=$.derToOid(n.kdfOid),t!==at.oids.pkcs5PBKDF2){var o=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw o.oid=t,o.supportedOids=["pkcs5PBKDF2"],o}if(t=$.derToOid(n.encOid),t!==at.oids["aes128-CBC"]&&t!==at.oids["aes192-CBC"]&&t!==at.oids["aes256-CBC"]&&t!==at.oids["des-EDE3-CBC"]&&t!==at.oids.desCBC){var o=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw o.oid=t,o.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],o}var s=n.kdfSalt,a=de.util.createBuffer(n.kdfIterationCount);a=a.getInt(a.length()<<3);var l,u;switch(at.oids[t]){case"aes128-CBC":l=16,u=de.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=de.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=de.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=de.des.createDecryptionCipher;break;case"desCBC":l=8,u=de.des.createDecryptionCipher;break}var f=xK(n.prfOid),h=de.pkcs5.pbkdf2(r,s,a,l,f),p=n.encIv,d=u(h);return d.start(p),d};at.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!$.validate(e,l4e,n,i)){var o=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw o.errors=i,o}var s=de.util.createBuffer(n.salt),a=de.util.createBuffer(n.iterations);a=a.getInt(a.length()<<3);var l,u,f;switch(t){case at.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,f=de.des.startDecrypting;break;case at.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,f=function(g,y){var w=de.rc2.createDecryptionCipher(g,40);return w.start(y,null),w};break;default:var o=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw o.oid=t,o}var h=xK(n.prfOid),p=at.pbe.generatePkcs12Key(r,s,1,a,l,h);h.start();var d=at.pbe.generatePkcs12Key(r,s,2,a,u,h);return f(p,d)};at.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in de.md))throw new Error('"md5" hash algorithm unavailable.');n=de.md.md5.create()}e===null&&(e="");for(var i=[SK(n,t+e)],o=16,s=1;o<r;++s,o+=16)i.push(SK(n,i[s-1]+t+e));return i.join("").substr(0,r)};function SK(t,e){return t.start().update(e).digest().getBytes()}function xK(t){var e;if(!t)e="hmacWithSHA1";else if(e=at.oids[$.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return RK(e)}function RK(t){var e=de.md;switch(t){case"hmacWithSHA224":e=de.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function u4e(t,e,r,n){var i=$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OCTETSTRING,!1,t),$.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push($.create($.Class.UNIVERSAL,$.Type.INTEGER,!1,de.util.hexToBytes(r.toString(16))),$.create($.Class.UNIVERSAL,$.Type.SEQUENCE,!0,[$.create($.Class.UNIVERSAL,$.Type.OID,!1,$.oidToDer(at.oids[n]).getBytes()),$.create($.Class.UNIVERSAL,$.Type.NULL,!1,"")])),i}});var HK=x((UVe,zK)=>{c();var Ar=wt();Zl();Er();var w2=zK.exports=Ar.sha512=Ar.sha512||{};Ar.md.sha512=Ar.md.algorithms.sha512=w2;var VK=Ar.sha384=Ar.sha512.sha384=Ar.sha512.sha384||{};VK.create=function(){return w2.create("SHA-384")};Ar.md.sha384=Ar.md.algorithms.sha384=VK;Ar.sha512.sha256=Ar.sha512.sha256||{create:function(){return w2.create("SHA-512/256")}};Ar.md["sha512/256"]=Ar.md.algorithms["sha512/256"]=Ar.sha512.sha256;Ar.sha512.sha224=Ar.sha512.sha224||{create:function(){return w2.create("SHA-512/224")}};Ar.md["sha512/224"]=Ar.md.algorithms["sha512/224"]=Ar.sha512.sha224;w2.create=function(t){if(qK||g4e(),typeof t>"u"&&(t="SHA-512"),!(t in eh))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=eh[t],r=null,n=Ar.util.createBuffer(),i=new Array(80),o=0;o<80;++o)i[o]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var a={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return a.start=function(){a.messageLength=0,a.fullMessageLength=a.messageLength128=[];for(var l=a.messageLengthSize/4,u=0;u<l;++u)a.fullMessageLength.push(0);n=Ar.util.createBuffer(),r=new Array(e.length);for(var u=0;u<e.length;++u)r[u]=e[u].slice(0);return a},a.start(),a.update=function(l,u){u==="utf8"&&(l=Ar.util.encodeUtf8(l));var f=l.length;a.messageLength+=f,f=[f/4294967296>>>0,f>>>0];for(var h=a.fullMessageLength.length-1;h>=0;--h)a.fullMessageLength[h]+=f[1],f[1]=f[0]+(a.fullMessageLength[h]/4294967296>>>0),a.fullMessageLength[h]=a.fullMessageLength[h]>>>0,f[0]=f[1]/4294967296>>>0;return n.putBytes(l),KK(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),a},a.digest=function(){var l=Ar.util.createBuffer();l.putBytes(n.bytes());var u=a.fullMessageLength[a.fullMessageLength.length-1]+a.messageLengthSize,f=u&a.blockLength-1;l.putBytes(sx.substr(0,a.blockLength-f));for(var h,p,d=a.fullMessageLength[0]*8,m=0;m<a.fullMessageLength.length-1;++m)h=a.fullMessageLength[m+1]*8,p=h/4294967296>>>0,d+=p,l.putInt32(d>>>0),d=h>>>0;l.putInt32(d);for(var g=new Array(r.length),m=0;m<r.length;++m)g[m]=r[m].slice(0);KK(g,i,l);var y=Ar.util.createBuffer(),w;t==="SHA-512"?w=g.length:t==="SHA-384"?w=g.length-2:w=g.length-4;for(var m=0;m<w;++m)y.putInt32(g[m][0]),(m!==w-1||t!=="SHA-512/224")&&y.putInt32(g[m][1]);return y},a};var sx=null,qK=!1,ax=null,eh=null;function g4e(){sx=String.fromCharCode(128),sx+=Ar.util.fillString(String.fromCharCode(0),128),ax=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],eh={},eh["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],eh["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],eh["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],eh["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],qK=!0}function KK(t,e,r){for(var n,i,o,s,a,l,u,f,h,p,d,m,g,y,w,b,v,S,R,I,A,L,q,G,j,se,re,Ge,me,Ce,z,He,or,nt,it,J=r.length();J>=128;){for(me=0;me<16;++me)e[me][0]=r.getInt32()>>>0,e[me][1]=r.getInt32()>>>0;for(;me<80;++me)He=e[me-2],Ce=He[0],z=He[1],n=((Ce>>>19|z<<13)^(z>>>29|Ce<<3)^Ce>>>6)>>>0,i=((Ce<<13|z>>>19)^(z<<3|Ce>>>29)^(Ce<<26|z>>>6))>>>0,nt=e[me-15],Ce=nt[0],z=nt[1],o=((Ce>>>1|z<<31)^(Ce>>>8|z<<24)^Ce>>>7)>>>0,s=((Ce<<31|z>>>1)^(Ce<<24|z>>>8)^(Ce<<25|z>>>7))>>>0,or=e[me-7],it=e[me-16],z=i+or[1]+s+it[1],e[me][0]=n+or[0]+o+it[0]+(z/4294967296>>>0)>>>0,e[me][1]=z>>>0;for(g=t[0][0],y=t[0][1],w=t[1][0],b=t[1][1],v=t[2][0],S=t[2][1],R=t[3][0],I=t[3][1],A=t[4][0],L=t[4][1],q=t[5][0],G=t[5][1],j=t[6][0],se=t[6][1],re=t[7][0],Ge=t[7][1],me=0;me<80;++me)u=((A>>>14|L<<18)^(A>>>18|L<<14)^(L>>>9|A<<23))>>>0,f=((A<<18|L>>>14)^(A<<14|L>>>18)^(L<<23|A>>>9))>>>0,h=(j^A&(q^j))>>>0,p=(se^L&(G^se))>>>0,a=((g>>>28|y<<4)^(y>>>2|g<<30)^(y>>>7|g<<25))>>>0,l=((g<<4|y>>>28)^(y<<30|g>>>2)^(y<<25|g>>>7))>>>0,d=(g&w|v&(g^w))>>>0,m=(y&b|S&(y^b))>>>0,z=Ge+f+p+ax[me][1]+e[me][1],n=re+u+h+ax[me][0]+e[me][0]+(z/4294967296>>>0)>>>0,i=z>>>0,z=l+m,o=a+d+(z/4294967296>>>0)>>>0,s=z>>>0,re=j,Ge=se,j=q,se=G,q=A,G=L,z=I+i,A=R+n+(z/4294967296>>>0)>>>0,L=z>>>0,R=v,I=S,v=w,S=b,w=g,b=y,z=i+s,g=n+o+(z/4294967296>>>0)>>>0,y=z>>>0;z=t[0][1]+y,t[0][0]=t[0][0]+g+(z/4294967296>>>0)>>>0,t[0][1]=z>>>0,z=t[1][1]+b,t[1][0]=t[1][0]+w+(z/4294967296>>>0)>>>0,t[1][1]=z>>>0,z=t[2][1]+S,t[2][0]=t[2][0]+v+(z/4294967296>>>0)>>>0,t[2][1]=z>>>0,z=t[3][1]+I,t[3][0]=t[3][0]+R+(z/4294967296>>>0)>>>0,t[3][1]=z>>>0,z=t[4][1]+L,t[4][0]=t[4][0]+A+(z/4294967296>>>0)>>>0,t[4][1]=z>>>0,z=t[5][1]+G,t[5][0]=t[5][0]+q+(z/4294967296>>>0)>>>0,t[5][1]=z>>>0,z=t[6][1]+se,t[6][0]=t[6][0]+j+(z/4294967296>>>0)>>>0,t[6][1]=z>>>0,z=t[7][1]+Ge,t[7][0]=t[7][0]+re+(z/4294967296>>>0)>>>0,t[7][1]=z>>>0,J-=128}}});var Fp=x((FVe,$K)=>{"use strict";c();function y4e(t){let e=new Uint8Array(t),r=0;if(t>0)if(t>65536)for(;r<t;)r+65536>t?(crypto.getRandomValues(e.subarray(r,r+(t-r))),r+=t-r):(crypto.getRandomValues(e.subarray(r,r+65536)),r+=65536);else crypto.getRandomValues(e);return e}$K.exports=y4e});var Bs=x((xze,aq)=>{"use strict";c();var gwe=async t=>{let e=[];for await(let r of t)e.push(r);return e};aq.exports=gwe});var Ti=x((Tze,lq)=>{"use strict";c();var ywe=async t=>{for await(let e of t);};lq.exports=ywe});var Hi=x((Aze,uq)=>{"use strict";c();var wwe=async function*(t,e){for await(let r of t)await e(r)&&(yield r)};uq.exports=wwe});var Jp=x((Ize,fq)=>{"use strict";c();var Ewe=async function*(t,e){let r=0;if(!(e<1)){for await(let n of t)if(yield n,r++,r===e)return}};fq.exports=Ewe});var dq=x((kze,hq)=>{c();hq.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var e0=x((Oze,mq)=>{c();var pq=dq();mq.exports=class{constructor(e){this.hwm=e||16,this.head=new pq(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new pq(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}}});var yq=x((Lze,gq)=>{c();var Hx=e0();gq.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new Hx,n,i,o,s=()=>{if(!r.isEmpty()){if(t.writev){let g,y=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;y.push(g.value)}return{done:g.done,value:y}}let m=r.shift();if(m.error)throw m.error;return m}return o?{done:!0}:new Promise((m,g)=>{i=y=>(i=null,y.error?g(y.error):t.writev&&!y.done?m({done:y.done,value:[y.value]}):m(y),n)})},a=m=>i?i(m):(r.push(m),n),l=m=>(r=new Hx,i?i({error:m}):(r.push({error:m}),n)),u=m=>o?n:a({done:!1,value:m}),f=m=>o?n:(o=!0,m?l(m):a({done:!0})),h=()=>(r=new Hx,f(),{done:!0}),p=m=>(f(m),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:p,push:u,end:f},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(m){return d.throw(m),e&&(e(m),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(m){return d.end(m),e&&(e(m),e=null),n}},n}});var a6=x((Wx,jx)=>{c();(function(t,e){typeof Wx=="object"&&typeof jx<"u"?jx.exports=function(r,n,i,o,s){for(n=n.split?n.split("."):n,o=0;o<n.length;o++)r=r?r[n[o]]:s;return r===s?i:r}:typeof define=="function"&&define.amd?define(function(){return function(r,n,i,o,s){for(n=n.split?n.split("."):n,o=0;o<n.length;o++)r=r?r[n[o]]:s;return r===s?i:r}}):t.dlv=function(r,n,i,o,s){for(n=n.split?n.split("."):n,o=0;o<n.length;o++)r=r?r[n[o]]:s;return r===s?i:r}})(Wx)});var ei=x((Zze,_q)=>{"use strict";c();var Swe=async function*(t,e){for await(let r of t)yield e(r)};_q.exports=Swe});var xq=x((Jze,t0)=>{c();var vq=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},Yx=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),l6=t=>t&&typeof t.sink=="function"&&Yx(t.source),xwe=t=>e=>(t.sink(e),t.source),Sq=(...t)=>{if(l6(t[0])){let e=t[0];t[0]=()=>e.source}else if(Yx(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&l6(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)l6(t[e])&&(t[e]=xwe(t[e]));return vq(...t)};t0.exports=Sq;t0.exports.pipe=Sq;t0.exports.rawPipe=vq;t0.exports.isIterable=Yx;t0.exports.isDuplex=l6});var Aq=x((uHe,Tq)=>{c();var Qx=e0();Tq.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new Qx,n,i,o,s=()=>{if(!r.isEmpty()){if(t.writev){let g,y=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;y.push(g.value)}return{done:g.done,value:y}}let m=r.shift();if(m.error)throw m.error;return m}return o?{done:!0}:new Promise((m,g)=>{i=y=>(i=null,y.error?g(y.error):t.writev&&!y.done?m({done:y.done,value:[y.value]}):m(y),n)})},a=m=>i?i(m):(r.push(m),n),l=m=>(r=new Qx,i?i({error:m}):(r.push({error:m}),n)),u=m=>o?n:a({done:!1,value:m}),f=m=>o?n:(o=!0,m?l(m):a({done:!0})),h=()=>(r=new Qx,f(),{done:!0}),p=m=>(f(m),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:p,push:u,end:f},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(m){return d.throw(m),e&&(e(m),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(m){return d.end(m),e&&(e(m),e=null),n}},n}});var Dc=x((fHe,Iq)=>{"use strict";c();var Awe=Aq(),Iwe=async function*(...t){let e=Awe();setTimeout(async()=>{try{await Promise.all(t.map(async r=>{for await(let n of r)e.push(n)})),e.end()}catch(r){e.end(r)}},0),yield*e};Iq.exports=Iwe});var Kq=x((P$e,Fq)=>{"use strict";c();var Lwe=/^(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9])?\.){0,126}(?:[a-z0-9](?:[a-z0-9\-]{0,61}[a-z0-9]))\.?$/i;Fq.exports=function(e,r){if(r==null&&(r=!1),e.length<2||e.length>255)return!1;var n=e[e.length-1];if(r){if(n!==".")return!1}else if(n===".")return!1;return Lwe.test(e)}});var Cz=x((IWe,Iz)=>{"use strict";c();var g6e=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};Iz.exports=g6e});var In=x((CWe,wR)=>{"use strict";c();var a0=typeof Reflect=="object"?Reflect:null,Pz=a0&&typeof a0.apply=="function"?a0.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},P6;a0&&typeof a0.ownKeys=="function"?P6=a0.ownKeys:Object.getOwnPropertySymbols?P6=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:P6=function(e){return Object.getOwnPropertyNames(e)};function y6e(t){console&&console.warn&&console.warn(t)}var kz=Number.isNaN||function(e){return e!==e};function lr(){lr.init.call(this)}wR.exports=lr;wR.exports.once=_6e;lr.EventEmitter=lr;lr.prototype._events=void 0;lr.prototype._eventsCount=0;lr.prototype._maxListeners=void 0;var Nz=10;function N6(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(lr,"defaultMaxListeners",{enumerable:!0,get:function(){return Nz},set:function(t){if(typeof t!="number"||t<0||kz(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Nz=t}});lr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};lr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||kz(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Dz(t){return t._maxListeners===void 0?lr.defaultMaxListeners:t._maxListeners}lr.prototype.getMaxListeners=function(){return Dz(this)};lr.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(r.length>0&&(s=r[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var l=o[e];if(l===void 0)return!1;if(typeof l=="function")Pz(l,this,r);else for(var u=l.length,f=Uz(l,u),n=0;n<u;++n)Pz(f[n],this,r);return!0};function Oz(t,e,r,n){var i,o,s;if(N6(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),s===void 0)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),i=Dz(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,y6e(a)}return t}lr.prototype.addListener=function(e,r){return Oz(this,e,r,!1)};lr.prototype.on=lr.prototype.addListener;lr.prototype.prependListener=function(e,r){return Oz(this,e,r,!0)};function w6e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lz(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=w6e.bind(n);return i.listener=r,n.wrapFn=i,i}lr.prototype.once=function(e,r){return N6(r),this.on(e,Lz(this,e,r)),this};lr.prototype.prependOnceListener=function(e,r){return N6(r),this.prependListener(e,Lz(this,e,r)),this};lr.prototype.removeListener=function(e,r){var n,i,o,s,a;if(N6(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===r||n[s].listener===r){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():E6e(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};lr.prototype.off=lr.prototype.removeListener;lr.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function Bz(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?b6e(i):Uz(i,i.length)}lr.prototype.listeners=function(e){return Bz(this,e,!0)};lr.prototype.rawListeners=function(e){return Bz(this,e,!1)};lr.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Mz.call(t,e)};lr.prototype.listenerCount=Mz;function Mz(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}lr.prototype.eventNames=function(){return this._eventsCount>0?P6(this._events):[]};function Uz(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function E6e(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function b6e(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function _6e(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}Fz(t,e,o,{once:!0}),e!=="error"&&v6e(t,i,{once:!0})})}function v6e(t,e,r){typeof t.on=="function"&&Fz(t,"error",e,r)}function Fz(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var D6=x((PWe,Kz)=>{"use strict";c();var k6=Cz(),S6e=In().EventEmitter;async function*x6e(t,e={}){let r=e.concurrency||1/0;r<1&&(r=1/0);let n=e.ordered==null?!1:e.ordered,i=new S6e,o=[],s=k6(),a=k6(),l=!1,u,f=!1;i.on("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(let m of t){if(o.length===r&&(s=k6(),await s.promise),f)break;let g={done:!1};o.push(g),m().then(y=>{g.done=!0,g.ok=!0,g.value=y,i.emit("task-complete")},y=>{g.done=!0,g.err=y,i.emit("task-complete")})}l=!0,i.emit("task-complete")}catch(m){u=m,i.emit("task-complete")}});function h(){return Boolean(n?o[0]&&o[0].done:o.find(m=>m.done))}function*p(){for(;o.length&&o[0].done;){let m=o[0];if(o.shift(),m.ok)yield m.value;else throw f=!0,s.resolve(),m.err;s.resolve()}}function*d(){for(;h();)for(let m=0;m<o.length;m++)if(o[m].done){let g=o[m];if(o.splice(m,1),m--,g.ok)yield g.value;else throw f=!0,s.resolve(),g.err;s.resolve()}}for(;;){if(h()||(a=k6(),await a.promise),u)throw u;if(n?yield*p():yield*d(),l&&o.length===0)break}}Kz.exports=x6e});var l0=x((QWe,Yz)=>{"use strict";c();async function*C6e(t,e={}){let r=t.getReader();try{for(;;){let n=await r.read();if(n.done)return;yield n.value}}finally{e.preventCancel!==!0&&r.cancel(),r.releaseLock()}}Yz.exports=C6e});var Zz=x((XWe,Xz)=>{"use strict";c();var Qz=l0();function P6e(t){return typeof t.stream=="function"?Qz(t.stream()):Qz(new Response(t).body)}Xz.exports=P6e});var u0=x((ZWe,Jz)=>{"use strict";c();function N6e(t){let[e,r]=t[Symbol.asyncIterator]?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}Jz.exports=N6e});var q6=x((fje,fH)=>{"use strict";c();async function*k6e(t,e=1){let r=[];e<1&&(e=1);for await(let n of t)for(r.push(n);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length;)yield r.slice(0,e),r=r.slice(e)}fH.exports=k6e});var z6=x((hje,hH)=>{"use strict";c();var D6e=q6();async function*O6e(t,e=1){for await(let r of D6e(t,e)){let n=r.map(i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}hH.exports=O6e});var dH=x((Y2,H6)=>{c();(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(d){if(!Array.isArray(d)&&!ArrayBuffer.isView(d))return!1;for(var m=0;m<d.length;m++)if(!Number.isInteger(d[m])||d[m]<0||d[m]>255)return!1;return!0}function i(d,m){return(d&65535)*m+(((d>>>16)*m&65535)<<16)}function o(d,m){return d<<m|d>>>32-m}function s(d){return d^=d>>>16,d=i(d,2246822507),d^=d>>>13,d=i(d,3266489909),d^=d>>>16,d}function a(d,m){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],m=[m[0]>>>16,m[0]&65535,m[1]>>>16,m[1]&65535];var g=[0,0,0,0];return g[3]+=d[3]+m[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=d[2]+m[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=d[1]+m[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=d[0]+m[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function l(d,m){d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535],m=[m[0]>>>16,m[0]&65535,m[1]>>>16,m[1]&65535];var g=[0,0,0,0];return g[3]+=d[3]*m[3],g[2]+=g[3]>>>16,g[3]&=65535,g[2]+=d[2]*m[3],g[1]+=g[2]>>>16,g[2]&=65535,g[2]+=d[3]*m[2],g[1]+=g[2]>>>16,g[2]&=65535,g[1]+=d[1]*m[3],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=d[2]*m[2],g[0]+=g[1]>>>16,g[1]&=65535,g[1]+=d[3]*m[1],g[0]+=g[1]>>>16,g[1]&=65535,g[0]+=d[0]*m[3]+d[1]*m[2]+d[2]*m[1]+d[3]*m[0],g[0]&=65535,[g[0]<<16|g[1],g[2]<<16|g[3]]}function u(d,m){return m%=64,m===32?[d[1],d[0]]:m<32?[d[0]<<m|d[1]>>>32-m,d[1]<<m|d[0]>>>32-m]:(m-=32,[d[1]<<m|d[0]>>>32-m,d[0]<<m|d[1]>>>32-m])}function f(d,m){return m%=64,m===0?d:m<32?[d[0]<<m|d[1]>>>32-m,d[1]<<m]:[d[1]<<m-32,0]}function h(d,m){return[d[0]^m[0],d[1]^m[1]]}function p(d){return d=h(d,[0,d[0]>>>1]),d=l(d,[4283543511,3981806797]),d=h(d,[0,d[0]>>>1]),d=l(d,[3301882366,444984403]),d=h(d,[0,d[0]>>>1]),d}r.x86.hash32=function(d,m){if(r.inputValidation&&!n(d))return e;m=m||0;for(var g=d.length%4,y=d.length-g,w=m,b=0,v=3432918353,S=461845907,R=0;R<y;R=R+4)b=d[R]|d[R+1]<<8|d[R+2]<<16|d[R+3]<<24,b=i(b,v),b=o(b,15),b=i(b,S),w^=b,w=o(w,13),w=i(w,5)+3864292196;switch(b=0,g){case 3:b^=d[R+2]<<16;case 2:b^=d[R+1]<<8;case 1:b^=d[R],b=i(b,v),b=o(b,15),b=i(b,S),w^=b}return w^=d.length,w=s(w),w>>>0},r.x86.hash128=function(d,m){if(r.inputValidation&&!n(d))return e;m=m||0;for(var g=d.length%16,y=d.length-g,w=m,b=m,v=m,S=m,R=0,I=0,A=0,L=0,q=597399067,G=2869860233,j=951274213,se=2716044179,re=0;re<y;re=re+16)R=d[re]|d[re+1]<<8|d[re+2]<<16|d[re+3]<<24,I=d[re+4]|d[re+5]<<8|d[re+6]<<16|d[re+7]<<24,A=d[re+8]|d[re+9]<<8|d[re+10]<<16|d[re+11]<<24,L=d[re+12]|d[re+13]<<8|d[re+14]<<16|d[re+15]<<24,R=i(R,q),R=o(R,15),R=i(R,G),w^=R,w=o(w,19),w+=b,w=i(w,5)+1444728091,I=i(I,G),I=o(I,16),I=i(I,j),b^=I,b=o(b,17),b+=v,b=i(b,5)+197830471,A=i(A,j),A=o(A,17),A=i(A,se),v^=A,v=o(v,15),v+=S,v=i(v,5)+2530024501,L=i(L,se),L=o(L,18),L=i(L,q),S^=L,S=o(S,13),S+=w,S=i(S,5)+850148119;switch(R=0,I=0,A=0,L=0,g){case 15:L^=d[re+14]<<16;case 14:L^=d[re+13]<<8;case 13:L^=d[re+12],L=i(L,se),L=o(L,18),L=i(L,q),S^=L;case 12:A^=d[re+11]<<24;case 11:A^=d[re+10]<<16;case 10:A^=d[re+9]<<8;case 9:A^=d[re+8],A=i(A,j),A=o(A,17),A=i(A,se),v^=A;case 8:I^=d[re+7]<<24;case 7:I^=d[re+6]<<16;case 6:I^=d[re+5]<<8;case 5:I^=d[re+4],I=i(I,G),I=o(I,16),I=i(I,j),b^=I;case 4:R^=d[re+3]<<24;case 3:R^=d[re+2]<<16;case 2:R^=d[re+1]<<8;case 1:R^=d[re],R=i(R,q),R=o(R,15),R=i(R,G),w^=R}return w^=d.length,b^=d.length,v^=d.length,S^=d.length,w+=b,w+=v,w+=S,b+=w,v+=w,S+=w,w=s(w),b=s(b),v=s(v),S=s(S),w+=b,w+=v,w+=S,b+=w,v+=w,S+=w,("00000000"+(w>>>0).toString(16)).slice(-8)+("00000000"+(b>>>0).toString(16)).slice(-8)+("00000000"+(v>>>0).toString(16)).slice(-8)+("00000000"+(S>>>0).toString(16)).slice(-8)},r.x64.hash128=function(d,m){if(r.inputValidation&&!n(d))return e;m=m||0;for(var g=d.length%16,y=d.length-g,w=[0,m],b=[0,m],v=[0,0],S=[0,0],R=[2277735313,289559509],I=[1291169091,658871167],A=0;A<y;A=A+16)v=[d[A+4]|d[A+5]<<8|d[A+6]<<16|d[A+7]<<24,d[A]|d[A+1]<<8|d[A+2]<<16|d[A+3]<<24],S=[d[A+12]|d[A+13]<<8|d[A+14]<<16|d[A+15]<<24,d[A+8]|d[A+9]<<8|d[A+10]<<16|d[A+11]<<24],v=l(v,R),v=u(v,31),v=l(v,I),w=h(w,v),w=u(w,27),w=a(w,b),w=a(l(w,[0,5]),[0,1390208809]),S=l(S,I),S=u(S,33),S=l(S,R),b=h(b,S),b=u(b,31),b=a(b,w),b=a(l(b,[0,5]),[0,944331445]);switch(v=[0,0],S=[0,0],g){case 15:S=h(S,f([0,d[A+14]],48));case 14:S=h(S,f([0,d[A+13]],40));case 13:S=h(S,f([0,d[A+12]],32));case 12:S=h(S,f([0,d[A+11]],24));case 11:S=h(S,f([0,d[A+10]],16));case 10:S=h(S,f([0,d[A+9]],8));case 9:S=h(S,[0,d[A+8]]),S=l(S,I),S=u(S,33),S=l(S,R),b=h(b,S);case 8:v=h(v,f([0,d[A+7]],56));case 7:v=h(v,f([0,d[A+6]],48));case 6:v=h(v,f([0,d[A+5]],40));case 5:v=h(v,f([0,d[A+4]],32));case 4:v=h(v,f([0,d[A+3]],24));case 3:v=h(v,f([0,d[A+2]],16));case 2:v=h(v,f([0,d[A+1]],8));case 1:v=h(v,[0,d[A]]),v=l(v,R),v=u(v,31),v=l(v,I),w=h(w,v)}return w=h(w,[0,d.length]),b=h(b,[0,d.length]),w=a(w,b),b=a(b,w),w=p(w),b=p(b),w=a(w,b),b=a(b,w),("00000000"+(w[0]>>>0).toString(16)).slice(-8)+("00000000"+(w[1]>>>0).toString(16)).slice(-8)+("00000000"+(b[0]>>>0).toString(16)).slice(-8)+("00000000"+(b[1]>>>0).toString(16)).slice(-8)},typeof Y2<"u"?(typeof H6<"u"&&H6.exports&&(Y2=H6.exports=r),Y2.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(Y2)});var mH=x((dje,pH)=>{c();pH.exports=dH()});var SR=x((zje,PH)=>{"use strict";c();var{Buffer:Ks}=bi(),CH=Symbol.for("BufferList");function vr(t){if(!(this instanceof vr))return new vr(t);vr._init.call(this,t)}vr._init=function(e){Object.defineProperty(this,CH,{value:!0}),this._bufs=[],this.length=0,e&&this.append(e)};vr.prototype._new=function(e){return new vr(e)};vr.prototype._offset=function(e){if(e===0)return[0,0];let r=0;for(let n=0;n<this._bufs.length;n++){let i=r+this._bufs[n].length;if(e<i||n===this._bufs.length-1)return[n,e-r];r=i}};vr.prototype._reverseOffset=function(t){let e=t[0],r=t[1];for(let n=0;n<e;n++)r+=this._bufs[n].length;return r};vr.prototype.get=function(e){if(e>this.length||e<0)return;let r=this._offset(e);return this._bufs[r[0]][r[1]]};vr.prototype.slice=function(e,r){return typeof e=="number"&&e<0&&(e+=this.length),typeof r=="number"&&r<0&&(r+=this.length),this.copy(null,0,e,r)};vr.prototype.copy=function(e,r,n,i){if((typeof n!="number"||n<0)&&(n=0),(typeof i!="number"||i>this.length)&&(i=this.length),n>=this.length||i<=0)return e||Ks.alloc(0);let o=!!e,s=this._offset(n),a=i-n,l=a,u=o&&r||0,f=s[1];if(n===0&&i===this.length){if(!o)return this._bufs.length===1?this._bufs[0]:Ks.concat(this._bufs,this.length);for(let h=0;h<this._bufs.length;h++)this._bufs[h].copy(e,u),u+=this._bufs[h].length;return e}if(l<=this._bufs[s[0]].length-f)return o?this._bufs[s[0]].copy(e,r,f,f+l):this._bufs[s[0]].slice(f,f+l);o||(e=Ks.allocUnsafe(a));for(let h=s[0];h<this._bufs.length;h++){let p=this._bufs[h].length-f;if(l>p)this._bufs[h].copy(e,u,f),u+=p;else{this._bufs[h].copy(e,u,f,f+l),u+=p;break}l-=p,f&&(f=0)}return e.length>u?e.slice(0,u):e};vr.prototype.shallowSlice=function(e,r){if(e=e||0,r=typeof r!="number"?this.length:r,e<0&&(e+=this.length),r<0&&(r+=this.length),e===r)return this._new();let n=this._offset(e),i=this._offset(r),o=this._bufs.slice(n[0],i[0]+1);return i[1]===0?o.pop():o[o.length-1]=o[o.length-1].slice(0,i[1]),n[1]!==0&&(o[0]=o[0].slice(n[1])),this._new(o)};vr.prototype.toString=function(e,r,n){return this.slice(r,n).toString(e)};vr.prototype.consume=function(e){if(e=Math.trunc(e),Number.isNaN(e)||e<=0)return this;for(;this._bufs.length;)if(e>=this._bufs[0].length)e-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(e),this.length-=e;break}return this};vr.prototype.duplicate=function(){let e=this._new();for(let r=0;r<this._bufs.length;r++)e.append(this._bufs[r]);return e};vr.prototype.append=function(e){if(e==null)return this;if(e.buffer)this._appendBuffer(Ks.from(e.buffer,e.byteOffset,e.byteLength));else if(Array.isArray(e))for(let r=0;r<e.length;r++)this.append(e[r]);else if(this._isBufferList(e))for(let r=0;r<e._bufs.length;r++)this.append(e._bufs[r]);else typeof e=="number"&&(e=e.toString()),this._appendBuffer(Ks.from(e));return this};vr.prototype._appendBuffer=function(e){this._bufs.push(e),this.length+=e.length};vr.prototype.indexOf=function(t,e,r){if(r===void 0&&typeof e=="string"&&(r=e,e=void 0),typeof t=="function"||Array.isArray(t))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof t=="number"?t=Ks.from([t]):typeof t=="string"?t=Ks.from(t,r):this._isBufferList(t)?t=t.slice():Array.isArray(t.buffer)?t=Ks.from(t.buffer,t.byteOffset,t.byteLength):Ks.isBuffer(t)||(t=Ks.from(t)),e=Number(e||0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let n=this._offset(e),i=n[0],o=n[1];for(;i<this._bufs.length;i++){let s=this._bufs[i];for(;o<s.length;)if(s.length-o>=t.length){let l=s.indexOf(t,o);if(l!==-1)return this._reverseOffset([i,l]);o=s.length-t.length+1}else{let l=this._reverseOffset([i,o]);if(this._match(l,t))return l;o++}o=0}return-1};vr.prototype._match=function(t,e){if(this.length-t<e.length)return!1;for(let r=0;r<e.length;r++)if(this.get(t+r)!==e[r])return!1;return!0};(function(){let t={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(let e in t)(function(r){t[r]===null?vr.prototype[r]=function(n,i){return this.slice(n,n+i)[r](0,i)}:vr.prototype[r]=function(n=0){return this.slice(n,n+t[r])[r](0)}})(e)})();vr.prototype._isBufferList=function(e){return e instanceof vr||vr.isBufferList(e)};vr.isBufferList=function(e){return e!=null&&e[CH]};PH.exports=vr});var kH=x((Hje,NH)=>{c();var xR=class{constructor(e,r=12,n=8*1024,i=32*1024,o=64,s){this.bits=r,this.min=n,this.max=i,this.asModule=e,this.rabin=new e.Rabin(r,n,i,o,s),this.polynomial=s}fingerprint(e){let{__retain:r,__release:n,__allocArray:i,__getInt32Array:o,Int32Array_ID:s,Uint8Array_ID:a}=this.asModule,l=new Int32Array(Math.ceil(e.length/this.min)),u=r(i(s,l)),f=r(i(a,e)),h=this.rabin.fingerprint(f,u),p=o(h);n(f),n(u);let d=p.indexOf(0);return d>=0?p.subarray(0,d):p}};NH.exports=xR});var UH=x(Z2=>{"use strict";c();var j6e=typeof BigUint64Array<"u",Q2=Symbol(),X2=1024;function DH(t,e){let r=new Uint32Array(t),n=new Uint16Array(t);var i=r[e+-4>>>2]>>>1,o=e>>>1;if(i<=X2)return String.fromCharCode.apply(String,n.subarray(o,o+i));let s=[];do{let a=n[o+X2-1],l=a>=55296&&a<56320?X2-1:X2;s.push(String.fromCharCode.apply(String,n.subarray(o,o+=l))),i-=l}while(i>X2);return s.join("")+String.fromCharCode.apply(String,n.subarray(o,o+i))}function RR(t){let e={};function r(i,o){return i?DH(i.buffer,o):"<yet unknown>"}let n=t.env=t.env||{};return n.abort=n.abort||function(o,s,a,l){let u=e.memory||n.memory;throw Error("abort: "+r(u,o)+" at "+r(u,s)+":"+a+":"+l)},n.trace=n.trace||function(o,s){let a=e.memory||n.memory;console.log("trace: "+r(a,o)+(s?" ":"")+Array.prototype.slice.call(arguments,2,2+s).join(", "))},t.Math=t.Math||Math,t.Date=t.Date||Date,e}function TR(t,e){let r=e.exports,n=r.memory,i=r.table,o=r.__alloc,s=r.__retain,a=r.__rtti_base||-1;function l(I){let A=new Uint32Array(n.buffer),L=A[a>>>2];if((I>>>=0)>=L)throw Error("invalid id: "+I);return A[(a+4>>>2)+I*2]}function u(I){let A=new Uint32Array(n.buffer),L=A[a>>>2];if((I>>>=0)>=L)throw Error("invalid id: "+I);return A[(a+4>>>2)+I*2+1]}function f(I){return 31-Math.clz32(I>>>5&31)}function h(I){return 31-Math.clz32(I>>>14&31)}function p(I){let A=I.length,L=o(A<<1,1),q=new Uint16Array(n.buffer);for(var G=0,j=L>>>1;G<A;++G)q[j+G]=I.charCodeAt(G);return L}t.__allocString=p;function d(I){let A=n.buffer;if(new Uint32Array(A)[I+-8>>>2]!==1)throw Error("not a string: "+I);return DH(A,I)}t.__getString=d;function m(I,A,L){let q=n.buffer;if(L)switch(I){case 2:return new Float32Array(q);case 3:return new Float64Array(q)}else switch(I){case 0:return new(A?Int8Array:Uint8Array)(q);case 1:return new(A?Int16Array:Uint16Array)(q);case 2:return new(A?Int32Array:Uint32Array)(q);case 3:return new(A?BigInt64Array:BigUint64Array)(q)}throw Error("unsupported align: "+I)}function g(I,A){let L=l(I);if(!(L&3))throw Error("not an array: "+I+" @ "+L);let q=f(L),G=A.length,j=o(G<<q,0),se=o(L&2?16:12,I),re=new Uint32Array(n.buffer);re[se+0>>>2]=s(j),re[se+4>>>2]=j,re[se+8>>>2]=G<<q,L&2&&(re[se+12>>>2]=G);let Ge=m(q,L&1024,L&2048);if(L&8192)for(let me=0;me<G;++me)Ge[(j>>>q)+me]=s(A[me]);else Ge.set(A,j>>>q);return se}t.__allocArray=g;function y(I){let A=new Uint32Array(n.buffer),L=A[I+-8>>>2],q=l(L);if(!(q&1))throw Error("not an array: "+L);let G=f(q);var j=A[I+4>>>2];let se=q&2?A[I+12>>>2]:A[j+-4>>>2]>>>G;return m(G,q&1024,q&2048).subarray(j>>>=G,j+se)}t.__getArrayView=y;function w(I){let A=y(I),L=A.length,q=new Array(L);for(let G=0;G<L;G++)q[G]=A[G];return q}t.__getArray=w;function b(I){let A=n.buffer,L=new Uint32Array(A)[I+-4>>>2];return A.slice(I,I+L)}t.__getArrayBuffer=b;function v(I,A,L){return new I(S(I,A,L))}function S(I,A,L){let q=n.buffer,G=new Uint32Array(q),j=G[L+4>>>2];return new I(q,j,G[j+-4>>>2]>>>A)}t.__getInt8Array=v.bind(null,Int8Array,0),t.__getInt8ArrayView=S.bind(null,Int8Array,0),t.__getUint8Array=v.bind(null,Uint8Array,0),t.__getUint8ArrayView=S.bind(null,Uint8Array,0),t.__getUint8ClampedArray=v.bind(null,Uint8ClampedArray,0),t.__getUint8ClampedArrayView=S.bind(null,Uint8ClampedArray,0),t.__getInt16Array=v.bind(null,Int16Array,1),t.__getInt16ArrayView=S.bind(null,Int16Array,1),t.__getUint16Array=v.bind(null,Uint16Array,1),t.__getUint16ArrayView=S.bind(null,Uint16Array,1),t.__getInt32Array=v.bind(null,Int32Array,2),t.__getInt32ArrayView=S.bind(null,Int32Array,2),t.__getUint32Array=v.bind(null,Uint32Array,2),t.__getUint32ArrayView=S.bind(null,Uint32Array,2),j6e&&(t.__getInt64Array=v.bind(null,BigInt64Array,3),t.__getInt64ArrayView=S.bind(null,BigInt64Array,3),t.__getUint64Array=v.bind(null,BigUint64Array,3),t.__getUint64ArrayView=S.bind(null,BigUint64Array,3)),t.__getFloat32Array=v.bind(null,Float32Array,2),t.__getFloat32ArrayView=S.bind(null,Float32Array,2),t.__getFloat64Array=v.bind(null,Float64Array,3),t.__getFloat64ArrayView=S.bind(null,Float64Array,3);function R(I,A){let L=new Uint32Array(n.buffer);var q=L[I+-8>>>2];if(q<=L[a>>>2])do if(q==A)return!0;while(q=u(q));return!1}return t.__instanceof=R,t.memory=t.memory||n,t.table=t.table||i,MH(r,t)}function OH(t){return typeof Response<"u"&&t instanceof Response}async function LH(t,e){return OH(t=await t)?BH(t,e):TR(RR(e||(e={})),await WebAssembly.instantiate(t instanceof WebAssembly.Module?t:await WebAssembly.compile(t),e))}Z2.instantiate=LH;function Y6e(t,e){return TR(RR(e||(e={})),new WebAssembly.Instance(t instanceof WebAssembly.Module?t:new WebAssembly.Module(t),e))}Z2.instantiateSync=Y6e;async function BH(t,e){return WebAssembly.instantiateStreaming?TR(RR(e||(e={})),(await WebAssembly.instantiateStreaming(t,e)).instance):LH(OH(t=await t)?t.arrayBuffer():t,e)}Z2.instantiateStreaming=BH;function MH(t,e){var r=e?Object.create(e):{},n=t.__argumentsLength?function(i){t.__argumentsLength.value=i}:t.__setArgumentsLength||t.__setargc||function(){};for(let i in t){if(!Object.prototype.hasOwnProperty.call(t,i))continue;let o=t[i],s=i.split("."),a=r;for(;s.length>1;){let f=s.shift();Object.prototype.hasOwnProperty.call(a,f)||(a[f]={}),a=a[f]}let l=s[0],u=l.indexOf("#");if(u>=0){let f=l.substring(0,u),h=a[f];if(typeof h>"u"||!h.prototype){let p=function(...d){return p.wrap(p.prototype.constructor(0,...d))};p.prototype={valueOf:function(){return this[Q2]}},p.wrap=function(d){return Object.create(p.prototype,{[Q2]:{value:d,writable:!1}})},h&&Object.getOwnPropertyNames(h).forEach(d=>Object.defineProperty(p,d,Object.getOwnPropertyDescriptor(h,d))),a[f]=p}if(l=l.substring(u+1),a=a[f].prototype,/^(get|set):/.test(l)){if(!Object.prototype.hasOwnProperty.call(a,l=l.substring(4))){let p=t[i.replace("set:","get:")],d=t[i.replace("get:","set:")];Object.defineProperty(a,l,{get:function(){return p(this[Q2])},set:function(m){d(this[Q2],m)},enumerable:!0})}}else l==="constructor"?(a[l]=(...p)=>(n(p.length),o(...p))).original=o:(a[l]=function(...p){return n(p.length),o(this[Q2],...p)}).original=o}else/^(get|set):/.test(l)?Object.prototype.hasOwnProperty.call(a,l=l.substring(4))||Object.defineProperty(a,l,{get:t[i.replace("set:","get:")],set:t[i.replace("get:","set:")],enumerable:!0}):typeof o=="function"&&o!==n?(a[l]=(...f)=>(n(f.length),o(...f))).original=o:a[l]=o}return r}Z2.demangle=MH});var KH=x((Gje,FH)=>{c();var{instantiate:Q6e}=UH();AR.supported=typeof WebAssembly<"u";function AR(t={}){if(!AR.supported)return null;var e=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return Q6e(new Response(new Blob([e],{type:"application/wasm"})),t)}FH.exports=AR});var zH=x((Wje,qH)=>{c();var VH=kH(),X6e=KH(),Z6e=async(t,e,r,n,i)=>{let o=await X6e();return new VH(o,t,e,r,n,i)};qH.exports={Rabin:VH,create:Z6e}});var ZH=x((fYe,XH)=>{"use strict";c();XH.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let n=this._internalPositionFor(e,!1);if(r===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(e),this._changedData=!0):i=!0,this._setInternalPos(n,e,r,i),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,n=new Array(this.length);for(;r<this.length;)n[r]=e(this.get(r),r,this),r++;return n}reduce(e,r){let n=0,i=r;for(;n<this.length;){let o=this.get(n);i=e(i,o,n),n++}return i}find(e){let r=0,n,i;for(;r<this.length&&!n;)i=this.get(r),n=e(i),r++;return n?i:void 0}_internalPositionFor(e,r){let n=this._bytePosFor(e,r);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],o=e-n*7;if(!((i&1<<o)>0))return-1;let a=this._bitArrays.slice(0,n).reduce(a5e,0),l=~(4294967295<<o+1),u=QH(i&l);return a+u-1}_bytePosFor(e,r){let n=Math.floor(e/7),i=n+1;for(;!r&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*7}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*7)}_setInternalPos(e,r,n,i){let o=this._data,s=[r,n];if(i)this._sortData(),o[e]=s;else{if(o.length)if(o[o.length-1][0]>=r)o.push(s);else if(o[0][0]<=r)o.unshift(s);else{let a=Math.round(o.length/2);this._data=o.slice(0,a).concat(s).concat(o.slice(a))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(c5e),this._changedData=!1}bitField(){let e=[],r=8,n=0,i=0,o,s=this._bitArrays.slice();for(;s.length||n;){n===0&&(o=s.shift(),n=7);let l=Math.min(n,r),u=~(255<<l);i|=(o&u)<<8-r,o=o>>>l,n-=l,r-=l,(!r||!n&&!s.length)&&(e.push(i),i=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(l5e)}};function a5e(t,e){return t+QH(e)}function QH(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function c5e(t,e){return t[0]-e[0]}function l5e(t){return t[1]}});var t$=x((hYe,e$)=>{"use strict";c();var u5e=ZH(),{fromString:f5e}=(Ae(),cr(M9)),Qo=class{constructor(e,r,n=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=n,this._children=new u5e,this.key=null}async put(e,r){let n=await this._findNewBucketAndPos(e);await n.bucket._putAt(n,e,r)}async get(e){let r=await this._findChild(e);if(r)return r.value}async del(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);n&&n.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,n)=>n instanceof Qo?r+n.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof Qo?yield*r.eachLeafSeries():yield r;return[]}serialize(e,r){let n=[];return r(this._children.reduce((i,o,s)=>(o&&(o instanceof Qo?i.push(o.serialize(e,r)):i.push(e(o,s))),i),n))}asyncTransform(e,r){return JH(this,e,r)}toJSON(){return this.serialize(d5e,p5e)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);if(!(n instanceof Qo)&&n&&n.key===e)return n}async _findPlace(e){let r=this._options.hash(typeof e=="string"?f5e(e):e),n=await r.take(this._options.bits),i=this._children.get(n);return i instanceof Qo?i._findPlace(r):{bucket:this,pos:n,hash:r,existingChild:i}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild&&r.existingChild.key!==e){let n=new Qo(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,n);let i=await n._findPlace(r.existingChild.hash);return i.bucket._putAt(i,r.existingChild.key,r.existingChild.value),n._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,n){this._putObjectAt(e.pos,{key:r,value:n,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)||this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){let e=this._children.find(h5e);if(e&&!(e instanceof Qo)){let r=e.hash;r.untake(this._options.bits);let n={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function h5e(t){return Boolean(t)}function d5e(t,e){return t.key}function p5e(t){return t}async function JH(t,e,r){let n=[];for(let i of t._children.compactArray())if(i instanceof Qo)await JH(i,e,r);else{let o=await e(i);n.push({bitField:t._children.bitField(),children:o})}return r(n)}e$.exports=Qo});var n$=x((pYe,r$)=>{"use strict";c();var m5e=[255,254,252,248,240,224,192,128],g5e=[1,3,7,15,31,63,127,255];r$.exports=class{constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,n=0;for(;r&&this._haveBits();){let i=this._value[this._currentBytePos],o=this._currentBitPos+1,s=Math.min(o,r),a=y5e(i,o-s,s);n=(n<<s)+a,r-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function y5e(t,e,r){let n=w5e(e,r);return(t&n)>>>e}function w5e(t,e){return m5e[t]&g5e[Math.min(e+t-1,7)]}});var i$=x((mYe,DR)=>{"use strict";c();var E5e=n$(),{concat:b5e}=(Pr(),cr(qm));function _5e(t){function e(r){return r instanceof eg?r:new eg(r,t)}return e}var eg=class{constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let n=0;for(;r>0;){let i=this._buffers[this._currentBufferIndex],o=Math.min(i.availableBits(),r),s=i.take(o);n=(n<<o)+s,r-=o,this._availableBits-=o,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(e){let r=e;for(;r>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),r);n.untake(i),r-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth?b5e([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),n=new E5e(r);this._buffers.push(n),this._availableBits+=n.availableBits()}};DR.exports=_5e;DR.exports.InfiniteHash=eg});var tg=x((gYe,s$)=>{"use strict";c();var o$=t$(),v5e=i$();function S5e(t){if(!t||!t.hashFn)throw new Error("please define an options.hashFn");let e={bits:t.bits||8,hash:v5e(t.hashFn)};return new o$(e)}s$.exports={createHAMT:S5e,Bucket:o$}});var K$=x((nXe,F$)=>{"use strict";c();F$.exports={RTLD_LAZY:1,RTLD_NOW:2,RTLD_GLOBAL:256,RTLD_LOCAL:0,RTLD_DEEPBIND:8,E2BIG:7,EACCES:13,EADDRINUSE:98,EADDRNOTAVAIL:99,EAFNOSUPPORT:97,EAGAIN:11,EALREADY:114,EBADF:9,EBADMSG:74,EBUSY:16,ECANCELED:125,ECHILD:10,ECONNABORTED:103,ECONNREFUSED:111,ECONNRESET:104,EDEADLK:35,EDESTADDRREQ:89,EDOM:33,EDQUOT:122,EEXIST:17,EFAULT:14,EFBIG:27,EHOSTUNREACH:113,EIDRM:43,EILSEQ:84,EINPROGRESS:115,EINTR:4,EINVAL:22,EIO:5,EISCONN:106,EISDIR:21,ELOOP:40,EMFILE:24,EMLINK:31,EMSGSIZE:90,EMULTIHOP:72,ENAMETOOLONG:36,ENETDOWN:100,ENETRESET:102,ENETUNREACH:101,ENFILE:23,ENOBUFS:105,ENODATA:61,ENODEV:19,ENOENT:2,ENOEXEC:8,ENOLCK:37,ENOLINK:67,ENOMEM:12,ENOMSG:42,ENOPROTOOPT:92,ENOSPC:28,ENOSR:63,ENOSTR:60,ENOSYS:38,ENOTCONN:107,ENOTDIR:20,ENOTEMPTY:39,ENOTSOCK:88,ENOTSUP:95,ENOTTY:25,ENXIO:6,EOPNOTSUPP:95,EOVERFLOW:75,EPERM:1,EPIPE:32,EPROTO:71,EPROTONOSUPPORT:93,EPROTOTYPE:91,ERANGE:34,EROFS:30,ESPIPE:29,ESRCH:3,ESTALE:116,ETIME:62,ETIMEDOUT:110,ETXTBSY:26,EWOULDBLOCK:11,EXDEV:18,PRIORITY_LOW:19,PRIORITY_BELOW_NORMAL:10,PRIORITY_NORMAL:0,PRIORITY_ABOVE_NORMAL:-7,PRIORITY_HIGH:-14,PRIORITY_HIGHEST:-20,SIGHUP:1,SIGINT:2,SIGQUIT:3,SIGILL:4,SIGTRAP:5,SIGABRT:6,SIGIOT:6,SIGBUS:7,SIGFPE:8,SIGKILL:9,SIGUSR1:10,SIGSEGV:11,SIGUSR2:12,SIGPIPE:13,SIGALRM:14,SIGTERM:15,SIGCHLD:17,SIGSTKFLT:16,SIGCONT:18,SIGSTOP:19,SIGTSTP:20,SIGTTIN:21,SIGTTOU:22,SIGURG:23,SIGXCPU:24,SIGXFSZ:25,SIGVTALRM:26,SIGPROF:27,SIGWINCH:28,SIGIO:29,SIGPOLL:29,SIGPWR:30,SIGSYS:31,SIGUNUSED:31,UV_FS_SYMLINK_DIR:1,UV_FS_SYMLINK_JUNCTION:2,O_RDONLY:0,O_WRONLY:1,O_RDWR:2,UV_DIRENT_UNKNOWN:0,UV_DIRENT_FILE:1,UV_DIRENT_DIR:2,UV_DIRENT_LINK:3,UV_DIRENT_FIFO:4,UV_DIRENT_SOCKET:5,UV_DIRENT_CHAR:6,UV_DIRENT_BLOCK:7,S_IFMT:61440,S_IFREG:32768,S_IFDIR:16384,S_IFCHR:8192,S_IFBLK:24576,S_IFIFO:4096,S_IFLNK:40960,S_IFSOCK:49152,O_CREAT:64,O_EXCL:128,UV_FS_O_FILEMAP:0,O_NOCTTY:256,O_TRUNC:512,O_APPEND:1024,O_DIRECTORY:65536,O_NOATIME:262144,O_NOFOLLOW:131072,O_SYNC:1052672,O_DSYNC:4096,O_DIRECT:16384,O_NONBLOCK:2048,S_IRWXU:448,S_IRUSR:256,S_IWUSR:128,S_IXUSR:64,S_IRWXG:56,S_IRGRP:32,S_IWGRP:16,S_IXGRP:8,S_IRWXO:7,S_IROTH:4,S_IWOTH:2,S_IXOTH:1,F_OK:0,R_OK:4,W_OK:2,X_OK:1,UV_FS_COPYFILE_EXCL:1,COPYFILE_EXCL:1,UV_FS_COPYFILE_FICLONE:2,COPYFILE_FICLONE:2,UV_FS_COPYFILE_FICLONE_FORCE:4,COPYFILE_FICLONE_FORCE:4,OPENSSL_VERSION_NUMBER:269488383,SSL_OP_ALL:2147485780,SSL_OP_ALLOW_NO_DHE_KEX:1024,SSL_OP_ALLOW_UNSAFE_LEGACY_RENEGOTIATION:262144,SSL_OP_CIPHER_SERVER_PREFERENCE:4194304,SSL_OP_CISCO_ANYCONNECT:32768,SSL_OP_COOKIE_EXCHANGE:8192,SSL_OP_CRYPTOPRO_TLSEXT_BUG:2147483648,SSL_OP_DONT_INSERT_EMPTY_FRAGMENTS:2048,SSL_OP_EPHEMERAL_RSA:0,SSL_OP_LEGACY_SERVER_CONNECT:4,SSL_OP_MICROSOFT_BIG_SSLV3_BUFFER:0,SSL_OP_MICROSOFT_SESS_ID_BUG:0,SSL_OP_MSIE_SSLV2_RSA_PADDING:0,SSL_OP_NETSCAPE_CA_DN_BUG:0,SSL_OP_NETSCAPE_CHALLENGE_BUG:0,SSL_OP_NETSCAPE_DEMO_CIPHER_CHANGE_BUG:0,SSL_OP_NETSCAPE_REUSE_CIPHER_CHANGE_BUG:0,SSL_OP_NO_COMPRESSION:131072,SSL_OP_NO_ENCRYPT_THEN_MAC:524288,SSL_OP_NO_QUERY_MTU:4096,SSL_OP_NO_RENEGOTIATION:1073741824,SSL_OP_NO_SESSION_RESUMPTION_ON_RENEGOTIATION:65536,SSL_OP_NO_SSLv2:0,SSL_OP_NO_SSLv3:33554432,SSL_OP_NO_TICKET:16384,SSL_OP_NO_TLSv1:67108864,SSL_OP_NO_TLSv1_1:268435456,SSL_OP_NO_TLSv1_2:134217728,SSL_OP_NO_TLSv1_3:536870912,SSL_OP_PKCS1_CHECK_1:0,SSL_OP_PKCS1_CHECK_2:0,SSL_OP_PRIORITIZE_CHACHA:2097152,SSL_OP_SINGLE_DH_USE:0,SSL_OP_SINGLE_ECDH_USE:0,SSL_OP_SSLEAY_080_CLIENT_DH_BUG:0,SSL_OP_SSLREF2_REUSE_CERT_TYPE_BUG:0,SSL_OP_TLS_BLOCK_PADDING_BUG:0,SSL_OP_TLS_D5_BUG:0,SSL_OP_TLS_ROLLBACK_BUG:8388608,ENGINE_METHOD_RSA:1,ENGINE_METHOD_DSA:2,ENGINE_METHOD_DH:4,ENGINE_METHOD_RAND:8,ENGINE_METHOD_EC:2048,ENGINE_METHOD_CIPHERS:64,ENGINE_METHOD_DIGESTS:128,ENGINE_METHOD_PKEY_METHS:512,ENGINE_METHOD_PKEY_ASN1_METHS:1024,ENGINE_METHOD_ALL:65535,ENGINE_METHOD_NONE:0,DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,RSA_PSS_SALTLEN_DIGEST:-1,RSA_PSS_SALTLEN_MAX_SIGN:-2,RSA_PSS_SALTLEN_AUTO:-2,defaultCoreCipherList:"TLS_AES_256_GCM_SHA384:TLS_CHACHA20_POLY1305_SHA256:TLS_AES_128_GCM_SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384:DHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA256:HIGH:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!SRP:!CAMELLIA",TLS1_VERSION:769,TLS1_1_VERSION:770,TLS1_2_VERSION:771,TLS1_3_VERSION:772,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var KR=x((iXe,V$)=>{"use strict";c();var{concat:J5e}=(Pr(),cr(qm));async function e8e(t){let e=new Uint8Array(0);for await(let r of t)e=J5e([e,r],e.length+r.length);return e}V$.exports=e8e});var Kc=x((SZe,PW)=>{"use strict";c();var U_e=async t=>{for await(let e of t)return e};PW.exports=U_e});var YT=x((git,uY)=>{c();uY.exports=$7e;function $7e(t,e,r){if(!t)return r;var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");for(;n.length;)if(i=n.shift(),!t||(t=t[i],t===void 0))return r;return t}});var Bg=x((yit,fY)=>{"use strict";c();var G7e=async t=>{let e=0;for await(let r of t)e++;return e};fY.exports=G7e});var bY=x((QT,EY)=>{"use strict";c();Object.defineProperty(QT,"__esModule",{value:!0});X5.BASE=2166136261;function X5(t,e=X5.BASE){let r=t.length;for(let n=0;n<r;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0}QT.default=X5;EY.exports=X5});var GY=x((Tot,s8)=>{"use strict";c();s8.exports=bve;s8.exports.format=HY;s8.exports.parse=$Y;var yve=/\B(?=(\d{3})+(?!\d))/g,wve=/(?:\.0*|(\.[^0]+)0+)$/,ku={b:1,kb:1<<10,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},Eve=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function bve(t,e){return typeof t=="string"?$Y(t):typeof t=="number"?HY(t,e):null}function HY(t,e){if(!Number.isFinite(t))return null;var r=Math.abs(t),n=e&&e.thousandsSeparator||"",i=e&&e.unitSeparator||"",o=e&&e.decimalPlaces!==void 0?e.decimalPlaces:2,s=Boolean(e&&e.fixedDecimals),a=e&&e.unit||"";(!a||!ku[a.toLowerCase()])&&(r>=ku.pb?a="PB":r>=ku.tb?a="TB":r>=ku.gb?a="GB":r>=ku.mb?a="MB":r>=ku.kb?a="KB":a="B");var l=t/ku[a.toLowerCase()],u=l.toFixed(o);return s||(u=u.replace(wve,"$1")),n&&(u=u.split(".").map(function(f,h){return h===0?f.replace(yve,n):f}).join(".")),u+i+a}function $Y(t){if(typeof t=="number"&&!isNaN(t))return t;if(typeof t!="string")return null;var e=Eve.exec(t),r,n="b";return e?(r=parseFloat(e[1]),n=e[4].toLowerCase()):(r=parseInt(t,10),n="b"),isNaN(r)?null:Math.floor(ku[n]*r)}});var JY=x((Oot,ZY)=>{"use strict";c();ZY.exports=(t,e)=>(e=e||(()=>{}),t.then(r=>new Promise(n=>{n(e())}).then(()=>r),r=>new Promise(n=>{n(e())}).then(()=>{throw r})))});var tQ=x((Lot,u8)=>{"use strict";c();var Sve=JY(),l8=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},eQ=(t,e,r)=>new Promise((n,i)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(t);return}let o=setTimeout(()=>{if(typeof r=="function"){try{n(r())}catch(l){i(l)}return}let s=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,a=r instanceof Error?r:new l8(s);typeof t.cancel=="function"&&t.cancel(),i(a)},e);Sve(t.then(n,i),()=>{clearTimeout(o)})});u8.exports=eQ;u8.exports.default=eQ;u8.exports.TimeoutError=l8});var rQ=x(dA=>{"use strict";c();Object.defineProperty(dA,"__esModule",{value:!0});function xve(t,e,r){let n=0,i=t.length;for(;i>0;){let o=i/2|0,s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}dA.default=xve});var nQ=x(mA=>{"use strict";c();Object.defineProperty(mA,"__esModule",{value:!0});var Rve=rQ(),pA=class{constructor(){this._queue=[]}enqueue(e,r){r=Object.assign({priority:0},r);let n={priority:r.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=r.priority){this._queue.push(n);return}let i=Rve.default(this._queue,n,(o,s)=>s.priority-o.priority);this._queue.splice(i,0,n)}dequeue(){let e=this._queue.shift();return e?.run}filter(e){return this._queue.filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return this._queue.length}};mA.default=pA});var wA=x(yA=>{"use strict";c();Object.defineProperty(yA,"__esModule",{value:!0});var Tve=ql(),iQ=tQ(),Ave=nQ(),f8=()=>{},Ive=new iQ.TimeoutError,gA=class extends Tve{constructor(e){var r,n,i,o;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=f8,this._resolveIdle=f8,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Ave.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=f8,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=f8,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){let e=Date.now();if(this._intervalId===void 0){let r=this._intervalEnd-e;if(r<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},r)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){let e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){let r=this._queue.dequeue();return r?(this.emit("active"),r(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{this._pendingCount++,this._intervalCount++;try{let s=this._timeout===void 0&&r.timeout===void 0?e():iQ.default(Promise.resolve(e()),r.timeout===void 0?this._timeout:r.timeout,()=>{(r.throwOnTimeout===void 0?this._throwOnTimeout:r.throwOnTimeout)&&i(Ive)});n(await s)}catch(s){i(s)}this._next()};this._queue.enqueue(o,r),this._tryToStartAnother(),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{let r=this._resolveEmpty;this._resolveEmpty=()=>{r(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{let r=this._resolveIdle;this._resolveIdle=()=>{r(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}};yA.default=gA});var aQ=x((Fot,sQ)=>{c();sQ.exports=Cve;function Cve(t,e,r){var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;oQ(i);for(var o;o=n.shift();)if(oQ(o),typeof t[o]>"u"&&(t[o]={}),t=t[o],!t||typeof t!="object")return!1;return t[i]=r,!0}function oQ(t){if(t==="__proto__"||t==="constructor"||t==="prototype")throw new Error("setting of prototype values not supported")}});var hQ=x((Got,fQ)=>{"use strict";c();var bA=dv();fQ.exports=(t,e={})=>{if(!bA(t)&&!Array.isArray(t))throw new TypeError("Expected a plain object or array");let{deep:r}=e,n=[],i=[],o=a=>{let l=n.indexOf(a);if(l!==-1)return i[l];let u=[];return n.push(a),i.push(u),u.push(...a.map(f=>Array.isArray(f)?o(f):bA(f)?s(f):f)),u},s=a=>{let l=n.indexOf(a);if(l!==-1)return i[l];let u={},f=Object.keys(a).sort(e.compare);n.push(a),i.push(u);for(let h of f){let p=a[h],d;r&&Array.isArray(p)?d=o(p):d=r&&bA(p)?s(p):p,Object.defineProperty(u,h,{...Object.getOwnPropertyDescriptor(a,h),value:d})}return u};return Array.isArray(t)?r?o(t):t.slice():s(t)}});var yQ=x((est,gQ)=>{c();var SA=e0();gQ.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new SA,n,i,o,s=()=>{if(!r.isEmpty()){if(t.writev){let g,y=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;y.push(g.value)}return{done:g.done,value:y}}let m=r.shift();if(m.error)throw m.error;return m}return o?{done:!0}:new Promise((m,g)=>{i=y=>(i=null,y.error?g(y.error):t.writev&&!y.done?m({done:y.done,value:[y.value]}):m(y),n)})},a=m=>i?i(m):(r.push(m),n),l=m=>(r=new SA,i?i({error:m}):(r.push({error:m}),n)),u=m=>o?n:a({done:!1,value:m}),f=m=>o?n:(o=!0,m?l(m):a({done:!0})),h=()=>(r=new SA,f(),{done:!0}),p=m=>(f(m),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:p,push:u,end:f},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(m){return d.throw(m),e&&(e(m),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(m){return d.end(m),e&&(e(m),e=null),n}},n}});var AA=x((Sst,LQ)=>{c();LQ.exports={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"}});var BQ=x(()=>{c()});var GQ=x((Tst,$Q)=>{c();var Lve=In().EventEmitter,{nanoid:Bve}=(vp(),cr(aS)),{WORKER_REQUEST_READ_LOCK:MQ,WORKER_RELEASE_READ_LOCK:UQ,MASTER_GRANT_READ_LOCK:FQ,WORKER_REQUEST_WRITE_LOCK:KQ,WORKER_RELEASE_WRITE_LOCK:VQ,MASTER_GRANT_WRITE_LOCK:qQ}=AA(),Hg,zQ=(t,e,r,n,i)=>(o,s)=>{s&&s.type===r&&t.emit(e,s.name,()=>(o.send({type:i,name:s.name,identifier:s.identifier}),new Promise(a=>{let l=u=>{u&&u.type===n&&u.identifier===s.identifier&&(o.removeListener("message",l),a())};o.on("message",l)})))},HQ=(t,e,r,n)=>()=>{let i=Bve();return process.send({type:e,identifier:i,name:t}),new Promise(o=>{let s=a=>{a&&a.type===r&&a.identifier===i&&(process.removeListener("message",s),o(()=>{process.send({type:n,identifier:i,name:t})}))};process.on("message",s)})};$Q.exports=t=>{try{if(Hg=BQ(),!Object.keys(Hg).length)return}catch{return}if(Hg.isMaster||t.singleProcess){let e=new Lve;return Hg.on("message",zQ(e,"requestReadLock",MQ,UQ,FQ)),Hg.on("message",zQ(e,"requestWriteLock",KQ,VQ,qQ)),e}return{isWorker:!0,readLock:e=>HQ(e,MQ,FQ,UQ),writeLock:e=>HQ(e,KQ,qQ,VQ)}}});var IA=x((Ast,WQ)=>{c();var Ou={},V0=t=>{t.addEventListener("message",e=>{V0.dispatchEvent("message",t,e)}),t.port&&t.port.addEventListener("message",e=>{V0.dispatchEvent("message",t,e)})};V0.addEventListener=(t,e)=>{Ou[t]||(Ou[t]=[]),Ou[t].push(e)};V0.removeEventListener=(t,e)=>{!Ou[t]||(Ou[t]=Ou[t].filter(r=>r===e))};V0.dispatchEvent=function(){let t=Array.prototype.slice.call(arguments),e=t.shift();!Ou[e]||Ou[e].forEach(r=>r.apply(null,t))};WQ.exports=V0});var iX=x((Ist,nX)=>{c();var Mve=In().EventEmitter,{nanoid:Uve}=(vp(),cr(aS)),{WORKER_REQUEST_READ_LOCK:jQ,WORKER_RELEASE_READ_LOCK:YQ,MASTER_GRANT_READ_LOCK:QQ,WORKER_REQUEST_WRITE_LOCK:XQ,WORKER_RELEASE_WRITE_LOCK:ZQ,MASTER_GRANT_WRITE_LOCK:JQ}=AA(),eX=IA(),tX=(t,e,r,n,i)=>(o,s)=>{if(!s||!s.data||s.data.type!==r)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};t.emit(e,a.name,()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),new Promise(l=>{let u=f=>{if(!f||!f.data)return;let h={type:f.data.type,name:f.data.name,identifier:f.data.identifier};h&&h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),l())};o.addEventListener("message",u)})))},rX=(t,e,r,n)=>()=>{let i=Uve();return globalThis.postMessage({type:e,identifier:i,name:t}),new Promise(o=>{let s=a=>{if(!a||!a.data)return;let l={type:a.data.type,identifier:a.data.identifier};l&&l.type===r&&l.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:t})}))};globalThis.addEventListener("message",s)})},Fve={singleProcess:!1};nX.exports=t=>{if(t=Object.assign({},Fve,t),!!globalThis.document||t.singleProcess){let r=new Mve;return eX.addEventListener("message",tX(r,"requestReadLock",jQ,YQ,QQ)),eX.addEventListener("message",tX(r,"requestWriteLock",XQ,ZQ,JQ)),r}return{isWorker:!0,readLock:r=>rX(r,jQ,QQ,YQ),writeLock:r=>rX(r,XQ,JQ,ZQ)}}});var oX=x((Pst,CA)=>{"use strict";c();var g8,Cst=CA.exports.timeout=function(t,e){var r=new g8,n;return Promise.race([t,new Promise(function(i,o){n=setTimeout(function(){o(r)},e)})]).then(function(i){return clearTimeout(n),i},function(i){throw clearTimeout(n),i})};g8=CA.exports.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"};g8.prototype=Object.create(Error.prototype);g8.prototype.name="TimeoutError"});var aX=x((Nst,NA)=>{c();var Kve=GQ(),Vve=iX(),{default:sX}=wA(),{timeout:qve}=oX(),zve=IA(),Kh={},Lu;function PA(t,e){let r,n=new Promise(i=>{r=i});return t.add(()=>qve((()=>new Promise(i=>{r(()=>{i()})}))(),e.timeout)),n}var Hve=(t,e)=>{if(Lu.isWorker)return{readLock:Lu.readLock(t,e),writeLock:Lu.writeLock(t,e)};let r=new sX({concurrency:1}),n=null;return{readLock:()=>{if(n)return PA(n,e);n=new sX({concurrency:e.concurrency,autoStart:!1});let i=n,o=PA(n,e);return r.add(()=>(i.start(),i.onIdle().then(()=>{n===i&&(n=null)}))),o},writeLock:()=>(n=null,PA(r,e))}},$ve={concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};NA.exports=(t,e)=>(e||(e={}),typeof t=="object"&&(e=t,t="lock"),t||(t="lock"),e=Object.assign({},$ve,e),Lu||(Lu=Kve(e)||Vve(e),Lu.isWorker||(Lu.on("requestReadLock",(r,n)=>{!Kh[r]||Kh[r].readLock().then(i=>n().finally(()=>i()))}),Lu.on("requestWriteLock",async(r,n)=>{!Kh[r]||Kh[r].writeLock().then(i=>n().finally(()=>i()))}))),Kh[t]||(Kh[t]=Hve(t,e)),Kh[t]);NA.exports.Worker=function(t,e){e=e||globalThis.Worker;let r;try{r=new e(t)}catch(n){n.message.includes("not a constructor")&&(r=e(t))}if(!r)throw new Error("Could not create Worker from",e);return zve(r),r}});var uX=x((kst,q0)=>{c();var cX=(...t)=>{let e;for(;t.length;)e=t.shift()(e);return e},kA=t=>t&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),y8=t=>t&&typeof t.sink=="function"&&kA(t.source),Gve=t=>e=>(t.sink(e),t.source),lX=(...t)=>{if(y8(t[0])){let e=t[0];t[0]=()=>e.source}else if(kA(t[0])){let e=t[0];t[0]=()=>e}if(t.length>1&&y8(t[t.length-1])&&(t[t.length-1]=t[t.length-1].sink),t.length>2)for(let e=1;e<t.length-1;e++)y8(t[e])&&(t[e]=Gve(t[e]));return cX(...t)};q0.exports=lX;q0.exports.pipe=lX;q0.exports.rawPipe=cX;q0.exports.isIterable=kA;q0.exports.isDuplex=y8});var Gg=x((Xst,_X)=>{"use strict";c();var r9e=Bs(),n9e=async function*(t,e){yield*(await r9e(t)).sort(e)};_X.exports=n9e});var SX=x((Zst,vX)=>{c();vX.exports=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}});var xX=x((Jst,BA)=>{c();typeof Object.create=="function"?BA.exports=function(e,r){e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:BA.exports=function(e,r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}});var IX=x(jt=>{c();var i9e=/%[sdj%]/g;jt.format=function(t){if(!R8(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(Bu(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,i=n.length,o=String(t).replace(i9e,function(a){if(a==="%%")return"%";if(r>=i)return a;switch(a){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch{return"[Circular]"}default:return a}}),s=n[r];r<i;s=n[++r])x8(s)||!z0(s)?o+=" "+s:o+=" "+Bu(s);return o};jt.deprecate=function(t,e){if(Hc(globalThis.process))return function(){return jt.deprecate(t,e).apply(this,arguments)};if(process.noDeprecation===!0)return t;var r=!1;function n(){if(!r){if(process.throwDeprecation)throw new Error(e);process.traceDeprecation?console.trace(e):console.error(e),r=!0}return t.apply(this,arguments)}return n};var E8={},MA;jt.debuglog=function(t){if(Hc(MA)&&(MA=process.env.NODE_DEBUG||""),t=t.toUpperCase(),!E8[t])if(new RegExp("\\b"+t+"\\b","i").test(MA)){var e=process.pid;E8[t]=function(){var r=jt.format.apply(jt,arguments);console.error("%s %d: %s",t,e,r)}}else E8[t]=function(){};return E8[t]};function Bu(t,e){var r={seen:[],stylize:s9e};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),qA(e)?r.showHidden=e:e&&jt._extend(r,e),Hc(r.showHidden)&&(r.showHidden=!1),Hc(r.depth)&&(r.depth=2),Hc(r.colors)&&(r.colors=!1),Hc(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o9e),S8(r,t,r.depth)}jt.inspect=Bu;Bu.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Bu.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o9e(t,e){var r=Bu.styles[e];return r?"\x1B["+Bu.colors[r][0]+"m"+t+"\x1B["+Bu.colors[r][1]+"m":t}function s9e(t,e){return t}function a9e(t){var e={};return t.forEach(function(r,n){e[r]=!0}),e}function S8(t,e,r){if(t.customInspect&&e&&v8(e.inspect)&&e.inspect!==jt.inspect&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(r,t);return R8(n)||(n=S8(t,n,r)),n}var i=c9e(t,e);if(i)return i;var o=Object.keys(e),s=a9e(o);if(t.showHidden&&(o=Object.getOwnPropertyNames(e)),_8(e)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return UA(e);if(o.length===0){if(v8(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(b8(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(VA(e))return t.stylize(Date.prototype.toString.call(e),"date");if(_8(e))return UA(e)}var l="",u=!1,f=["{","}"];if(RX(e)&&(u=!0,f=["[","]"]),v8(e)){var h=e.name?": "+e.name:"";l=" [Function"+h+"]"}if(b8(e)&&(l=" "+RegExp.prototype.toString.call(e)),VA(e)&&(l=" "+Date.prototype.toUTCString.call(e)),_8(e)&&(l=" "+UA(e)),o.length===0&&(!u||e.length==0))return f[0]+l+f[1];if(r<0)return b8(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var p;return u?p=l9e(t,e,r,s,o):p=o.map(function(d){return KA(t,e,r,s,d,u)}),t.seen.pop(),u9e(p,l,f)}function c9e(t,e){if(Hc(e))return t.stylize("undefined","undefined");if(R8(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(TX(e))return t.stylize(""+e,"number");if(qA(e))return t.stylize(""+e,"boolean");if(x8(e))return t.stylize("null","null")}function UA(t){return"["+Error.prototype.toString.call(t)+"]"}function l9e(t,e,r,n,i){for(var o=[],s=0,a=e.length;s<a;++s)AX(e,String(s))?o.push(KA(t,e,r,n,String(s),!0)):o.push("");return i.forEach(function(l){l.match(/^\d+$/)||o.push(KA(t,e,r,n,l,!0))}),o}function KA(t,e,r,n,i,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},l.get?l.set?a=t.stylize("[Getter/Setter]","special"):a=t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),AX(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(l.value)<0?(x8(r)?a=S8(t,l.value,null):a=S8(t,l.value,r-1),a.indexOf(`
`)>-1&&(o?a=a.split(`
`).map(function(u){return"  "+u}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(u){return"   "+u}).join(`
`))):a=t.stylize("[Circular]","special")),Hc(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function u9e(t,e,r){var n=0,i=t.reduce(function(o,s){return n++,s.indexOf(`
`)>=0&&n++,o+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function RX(t){return Array.isArray(t)}jt.isArray=RX;function qA(t){return typeof t=="boolean"}jt.isBoolean=qA;function x8(t){return t===null}jt.isNull=x8;function f9e(t){return t==null}jt.isNullOrUndefined=f9e;function TX(t){return typeof t=="number"}jt.isNumber=TX;function R8(t){return typeof t=="string"}jt.isString=R8;function h9e(t){return typeof t=="symbol"}jt.isSymbol=h9e;function Hc(t){return t===void 0}jt.isUndefined=Hc;function b8(t){return z0(t)&&zA(t)==="[object RegExp]"}jt.isRegExp=b8;function z0(t){return typeof t=="object"&&t!==null}jt.isObject=z0;function VA(t){return z0(t)&&zA(t)==="[object Date]"}jt.isDate=VA;function _8(t){return z0(t)&&(zA(t)==="[object Error]"||t instanceof Error)}jt.isError=_8;function v8(t){return typeof t=="function"}jt.isFunction=v8;function d9e(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}jt.isPrimitive=d9e;jt.isBuffer=SX();function zA(t){return Object.prototype.toString.call(t)}function FA(t){return t<10?"0"+t.toString(10):t.toString(10)}var p9e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function m9e(){var t=new Date,e=[FA(t.getHours()),FA(t.getMinutes()),FA(t.getSeconds())].join(":");return[t.getDate(),p9e[t.getMonth()],e].join(" ")}jt.log=function(){console.log("%s - %s",m9e(),jt.format.apply(jt,arguments))};jt.inherits=xX();jt._extend=function(t,e){if(!e||!z0(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};function AX(t,e){return Object.prototype.hasOwnProperty.call(t,e)}});var HA=x((tat,PX)=>{"use strict";c();PX.exports=function(...e){let r=e.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(r,{bufferKeys:r.bufferKeys||!1,snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,idempotentOpen:r.idempotentOpen||!1,passiveOpen:r.passiveOpen||!1,serialize:r.serialize||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,openCallback:r.openCallback||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:CX(r.encodings),events:CX(r.events),additionalMethods:Object.assign({},r.additionalMethods)})};function CX(t){return t?Object.assign({},t):!1}});var kX=x((rat,NX)=>{c();NX.exports=function(e){return e!=null&&e.constructor!=null&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}});var OX=x((nat,DX)=>{c();DX.exports=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t)});var T8=x($A=>{"use strict";c();var LX=OX();$A.fromCallback=function(t,e){if(t===void 0){var r=new Promise(function(n,i){t=function(o,s){o?i(o):n(s)}});t[e!==void 0?e:"promise"]=r}else if(typeof t!="function")throw new TypeError("Callback must be a function");return t};$A.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){LX(()=>e(null,r))}).catch(function(r){LX(()=>e(r))})}});var A8=x((oat,MX)=>{c();var BX;MX.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):t=>(BX||(BX=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var I8=x((sat,FX)=>{"use strict";c();var UX=A8();FX.exports=function(t,...e){e.length===0?UX(t):UX(()=>t(...e))}});var GA=x((aat,KX)=>{"use strict";c();function $c(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._ended=!1,this._nexting=!1}$c.prototype.next=function(t){let e=this;if(t===void 0)e=new Promise(function(r,n){t=function(i,o,s){i?n(i):o===void 0&&s===void 0?r():r([o,s])}});else if(typeof t!="function")throw new Error("next() requires a callback argument");return this._ended?(this._nextTick(t,new Error("cannot call next() after end()")),e):this._nexting?(this._nextTick(t,new Error("cannot call next() before previous next() has completed")),e):(this._nexting=!0,this._next((r,...n)=>{this._nexting=!1,t(r,...n)}),e)};$c.prototype._next=function(t){this._nextTick(t)};$c.prototype.seek=function(t){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");t=this.db._serializeKey(t),this._seek(t)};$c.prototype._seek=function(t){};$c.prototype.end=function(t){let e;if(t===void 0)e=new Promise(function(r,n){t=function(i){i?n(i):r()}});else if(typeof t!="function")throw new Error("end() requires a callback argument");return this._ended?(this._nextTick(t,new Error("end() already called on iterator")),e):(this._ended=!0,this._end(t),e)};$c.prototype._end=function(t){this._nextTick(t)};$c.prototype[Symbol.asyncIterator]=async function*(){try{let t;for(;(t=await this.next())!==void 0;)yield t}finally{this._ended||await this.end()}};$c.prototype._nextTick=I8();KX.exports=$c});var WA=x((cat,qX)=>{"use strict";c();var VX=Object.freeze({});function $s(t){if(typeof t!="object"||t===null)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=t,this._operations=[],this._written=!1}$s.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")};$s.prototype.put=function(t,e,r){this._checkWritten();let n=this.db._checkKey(t)||this.db._checkValue(e);if(n)throw n;return t=this.db._serializeKey(t),e=this.db._serializeValue(e),this._put(t,e,r??VX),this};$s.prototype._put=function(t,e,r){this._operations.push({...r,type:"put",key:t,value:e})};$s.prototype.del=function(t,e){this._checkWritten();let r=this.db._checkKey(t);if(r)throw r;return t=this.db._serializeKey(t),this._del(t,e??VX),this};$s.prototype._del=function(t,e){this._operations.push({...e,type:"del",key:t})};$s.prototype.clear=function(){return this._checkWritten(),this._clear(),this};$s.prototype._clear=function(){this._operations=[]};$s.prototype.write=function(t,e){if(this._checkWritten(),typeof t=="function"&&(e=t),typeof e!="function")throw new Error("write() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),this._written=!0,this._write(t,e)};$s.prototype._write=function(t,e){this.db._batch(this._operations,t,e)};$s.prototype._nextTick=I8();qX.exports=$s});var YA=x(jA=>{"use strict";c();jA.getCallback=function(t,e){return typeof t=="function"?t:e};jA.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var $X=x((uat,HX)=>{"use strict";c();var g9e=HA(),y9e=kX(),w9e=T8(),E9e=GA(),b9e=WA(),_9e=YA().getCallback,v9e=YA().getOptions,S9e=Object.prototype.hasOwnProperty,x9e=["lt","lte","gt","gte"];function ur(t){this.status="new",this.supports=g9e(t,{status:!0})}ur.prototype.open=function(t,e){let r=this.status;if(typeof t=="function"&&(e=t),typeof e!="function")throw new Error("open() requires a callback argument");(typeof t!="object"||t===null)&&(t={}),t.createIfMissing=t.createIfMissing!==!1,t.errorIfExists=!!t.errorIfExists,this.status="opening",this._open(t,n=>{if(n)return this.status=r,e(n);this.status="open",e()})};ur.prototype._open=function(t,e){this._nextTick(e)};ur.prototype.close=function(t){let e=this.status;if(typeof t!="function")throw new Error("close() requires a callback argument");this.status="closing",this._close(r=>{if(r)return this.status=e,t(r);this.status="closed",t()})};ur.prototype._close=function(t){this._nextTick(t)};ur.prototype.get=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("get() requires a callback argument");let n=this._checkKey(t);if(n)return this._nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),e.asBuffer=e.asBuffer!==!1,this._get(t,e,r)};ur.prototype._get=function(t,e,r){this._nextTick(function(){r(new Error("NotFound"))})};ur.prototype.getMany=function(t,e,r){if(r=_9e(e,r),r=w9e.fromCallback(r),e=v9e(e),T9e(this,r))return r.promise;if(!Array.isArray(t))return this._nextTick(r,new Error("getMany() requires an array argument")),r.promise;if(t.length===0)return this._nextTick(r,null,[]),r.promise;typeof e.asBuffer!="boolean"&&(e={...e,asBuffer:!0});let n=new Array(t.length);for(let i=0;i<t.length;i++){let o=t[i],s=this._checkKey(o);if(s)return this._nextTick(r,s),r.promise;n[i]=this._serializeKey(o)}return this._getMany(n,e,r),r.promise};ur.prototype._getMany=function(t,e,r){this._nextTick(r,null,new Array(t.length).fill(void 0))};ur.prototype.put=function(t,e,r,n){if(typeof r=="function"&&(n=r),typeof n!="function")throw new Error("put() requires a callback argument");let i=this._checkKey(t)||this._checkValue(e);if(i)return this._nextTick(n,i);t=this._serializeKey(t),e=this._serializeValue(e),(typeof r!="object"||r===null)&&(r={}),this._put(t,e,r,n)};ur.prototype._put=function(t,e,r,n){this._nextTick(n)};ur.prototype.del=function(t,e,r){if(typeof e=="function"&&(r=e),typeof r!="function")throw new Error("del() requires a callback argument");let n=this._checkKey(t);if(n)return this._nextTick(r,n);t=this._serializeKey(t),(typeof e!="object"||e===null)&&(e={}),this._del(t,e,r)};ur.prototype._del=function(t,e,r){this._nextTick(r)};ur.prototype.batch=function(t,e,r){if(!arguments.length)return this._chainedBatch();if(typeof e=="function"&&(r=e),typeof t=="function"&&(r=t),typeof r!="function")throw new Error("batch(array) requires a callback argument");if(!Array.isArray(t))return this._nextTick(r,new Error("batch(array) requires an array argument"));if(t.length===0)return this._nextTick(r);(typeof e!="object"||e===null)&&(e={});let n=new Array(t.length);for(let i=0;i<t.length;i++){if(typeof t[i]!="object"||t[i]===null)return this._nextTick(r,new Error("batch(array) element must be an object and not `null`"));let o=Object.assign({},t[i]);if(o.type!=="put"&&o.type!=="del")return this._nextTick(r,new Error("`type` must be 'put' or 'del'"));let s=this._checkKey(o.key);if(s)return this._nextTick(r,s);if(o.key=this._serializeKey(o.key),o.type==="put"){let a=this._checkValue(o.value);if(a)return this._nextTick(r,a);o.value=this._serializeValue(o.value)}n[i]=o}this._batch(n,e,r)};ur.prototype._batch=function(t,e,r){this._nextTick(r)};ur.prototype.clear=function(t,e){if(typeof t=="function")e=t;else if(typeof e!="function")throw new Error("clear() requires a callback argument");t=zX(this,t),t.reverse=!!t.reverse,t.limit="limit"in t?t.limit:-1,this._clear(t,e)};ur.prototype._clear=function(t,e){t.keys=!0,t.values=!1,t.keyAsBuffer=!0,t.valueAsBuffer=!0;let r=this._iterator(t),n={},i=o=>{if(o)return r.end(function(){e(o)});r.next((s,a)=>{if(s)return i(s);if(a===void 0)return r.end(e);this._del(a,n,i)})};i()};ur.prototype._setupIteratorOptions=function(t){return t=zX(this,t),t.reverse=!!t.reverse,t.keys=t.keys!==!1,t.values=t.values!==!1,t.limit="limit"in t?t.limit:-1,t.keyAsBuffer=t.keyAsBuffer!==!1,t.valueAsBuffer=t.valueAsBuffer!==!1,t};function zX(t,e){let r={};for(let n in e){if(!S9e.call(e,n))continue;if(n==="start"||n==="end")throw new Error('Legacy range options ("start" and "end") have been removed');let i=e[n];R9e(n)&&(i=t._serializeKey(i)),r[n]=i}return r}function R9e(t){return x9e.indexOf(t)!==-1}ur.prototype.iterator=function(t){return(typeof t!="object"||t===null)&&(t={}),t=this._setupIteratorOptions(t),this._iterator(t)};ur.prototype._iterator=function(t){return new E9e(this)};ur.prototype._chainedBatch=function(){return new b9e(this)};ur.prototype._serializeKey=function(t){return t};ur.prototype._serializeValue=function(t){return t};ur.prototype._checkKey=function(t){if(t==null)return new Error("key cannot be `null` or `undefined`");if(y9e(t)&&t.length===0)return new Error("key cannot be an empty Buffer");if(t==="")return new Error("key cannot be an empty String");if(Array.isArray(t)&&t.length===0)return new Error("key cannot be an empty Array")};ur.prototype._checkValue=function(t){if(t==null)return new Error("value cannot be `null` or `undefined`")};ur.prototype.isOperational=function(){return this.status==="open"||this._isOperational()};ur.prototype._isOperational=function(){return!1};ur.prototype._nextTick=I8();HX.exports=ur;function T9e(t,e){return t.isOperational()?!1:(t._nextTick(e,new Error("Database is not open")),!0)}});var Gc=x(C8=>{"use strict";c();C8.AbstractLevelDOWN=$X();C8.AbstractIterator=GA();C8.AbstractChainedBatch=WA()});var ni=x((hat,QA)=>{c();typeof Object.create=="function"?QA.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:QA.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var XA=x(GX=>{"use strict";c();GX.getCallback=function(t,e,r){let n=t[t.length-1];if(typeof n!="function"){let i=new Promise((o,s)=>{t.push(n=function(a,...l){a?s(a):o(r?r(...l):l[0])})});n[e]=i}return n}});var XX=x((pat,QX)=>{"use strict";c();var{AbstractIterator:WX}=Gc(),A9e=ni(),jX=XA().getCallback,YX=Symbol("options"),H0=Symbol("iterator"),$0=Symbol("operations"),P8=Symbol("promise");function qh(t,e){WX.call(this,t),this[YX]=e,this[H0]=null,this[$0]=[]}A9e(qh,WX);qh.prototype.setDb=function(t){this[H0]=t.iterator(this[YX]);for(let e of this[$0].splice(0,this[$0].length))this[H0][e.method](...e.args)};qh.prototype.next=function(...t){if(this.db.status==="open")return this[H0].next(...t);let e=jX(t,P8,function(n,i){if(!(n===void 0&&i===void 0))return[n,i]});return this.db.status==="opening"?this[$0].push({method:"next",args:t}):this._nextTick(e,new Error("Database is not open")),e[P8]||this};qh.prototype.seek=function(...t){if(this.db.status==="open")this[H0].seek(...t);else if(this.db.status==="opening")this[$0].push({method:"seek",args:t});else throw new Error("Database is not open")};qh.prototype.end=function(...t){if(this.db.status==="open")return this[H0].end(...t);let e=jX(t,P8);return this.db.status==="opening"?this[$0].push({method:"end",args:t}):this._nextTick(e,new Error("Database is not open")),e[P8]||this};for(let t of["next","seek","end"])qh.prototype["_"+t]=function(){throw new Error("Did not expect private method to be called: "+t)};QX.exports=qh});var JX=x((gat,ZX)=>{"use strict";c();var{AbstractChainedBatch:I9e}=Gc(),Wg=Symbol("operations");ZX.exports=class extends I9e{constructor(e){super(e),this[Wg]=[]}_put(e,r,n){this[Wg].push({...n,type:"put",key:e,value:r})}_del(e,r){this[Wg].push({...r,type:"del",key:e})}_clear(){this[Wg]=[]}_write(e,r){this.db.batch(this[Wg],e,r)}}});var iZ=x((yat,ZA)=>{"use strict";c();var{AbstractLevelDOWN:rZ}=Gc(),C9e=ni(),nZ=XX(),P9e=JX(),N9e=XA().getCallback,eZ=["put","get","getMany","del","batch","clear"],k9e=["approximateSize","compactRange"],Gs=Symbol("innerDb"),G0=Symbol("operations"),tZ=Symbol("promise");function zh(t){rZ.call(this,t.supports||{});for(let e of k9e)typeof t[e]=="function"&&!this.supports.additionalMethods[e]&&(this.supports.additionalMethods[e]=!0);this[Gs]=t,this[G0]=[],D9e(this)}C9e(zh,rZ);zh.prototype.type="deferred-leveldown";Object.defineProperty(zh.prototype,"_db",{enumerable:!0,get(){return this[Gs]}});zh.prototype._open=function(t,e){let r=n=>{if(n||this[Gs].status!=="open")return e(n||new Error("Database is not open"));let i=this[G0];this[G0]=[];for(let o of i)o.iterator?o.iterator.setDb(this[Gs]):this[Gs][o.method](...o.args);if(this[G0].length>0)throw new Error("Did not expect further operations");e()};this[Gs].status==="new"||this[Gs].status==="closed"?this[Gs].open(t,r):this._nextTick(r)};zh.prototype._close=function(t){this[Gs].close(t)};zh.prototype._isOperational=function(){return this.status==="opening"};function D9e(t){let e=Object.keys(t.supports.additionalMethods);for(let r of eZ.concat(e))t[r]=function(...n){if(r==="batch"&&n.length===0)return new P9e(this);if(this.status==="open")return this[Gs][r](...n);let i=N9e(n,tZ);return this.status==="opening"?this[G0].push({method:r,args:n}):this._nextTick(i,new Error("Database is not open")),i[tZ]};t.iterator=function(r){if(this.status==="open")return this[Gs].iterator(r);if(this.status==="opening"){let n=new nZ(this,r);return this[G0].push({iterator:n}),n}else throw new Error("Database is not open")};for(let r of eZ.concat(["iterator"]))t["_"+r]=function(){throw new Error("Did not expect private method to be called: "+r)}}ZA.exports=zh;ZA.exports.DeferredIterator=nZ});var JA=x((wat,oZ)=>{c();oZ.exports=In().EventEmitter});var jg=x(()=>{c()});var lZ=x((_at,cZ)=>{"use strict";c();function sZ(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function O9e(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sZ(Object(r),!0).forEach(function(n){L9e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sZ(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function L9e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B9e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function M9e(t,e,r){return e&&aZ(t.prototype,e),r&&aZ(t,r),t}var U9e=bi(),N8=U9e.Buffer,F9e=jg(),eI=F9e.inspect,K9e=eI&&eI.custom||"inspect";function V9e(t,e,r){N8.prototype.copy.call(t,e,r)}cZ.exports=function(){function t(){B9e(this,t),this.head=null,this.tail=null,this.length=0}return M9e(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return N8.alloc(0);for(var n=N8.allocUnsafe(r>>>0),i=this.head,o=0;i;)V9e(i.data,n,o),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,o=n.data;for(r-=o.length;n=n.next;){var s=n.data,a=r>s.length?s.length:r;if(a===s.length?o+=s:o+=s.slice(0,r),r-=a,r===0){a===s.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(a));break}++i}return this.length-=i,o}},{key:"_getBuffer",value:function(r){var n=N8.allocUnsafe(r),i=this.head,o=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var s=i.data,a=r>s.length?s.length:r;if(s.copy(n,n.length-r,0,a),r-=a,r===0){a===s.length?(++o,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(a));break}++o}return this.length-=o,n}},{key:K9e,value:function(r,n){return eI(this,O9e({},n,{depth:0,customInspect:!1}))}}]),t}()});var rI=x((vat,fZ)=>{"use strict";c();function q9e(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(tI,this,t)):process.nextTick(tI,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?r._writableState?r._writableState.errorEmitted?process.nextTick(k8,r):(r._writableState.errorEmitted=!0,process.nextTick(uZ,r,o)):process.nextTick(uZ,r,o):e?(process.nextTick(k8,r),e(o)):process.nextTick(k8,r)}),this)}function uZ(t,e){tI(t,e),k8(t)}function k8(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function z9e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function tI(t,e){t.emit("error",e)}function H9e(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}fZ.exports={destroy:q9e,undestroy:z9e,errorOrDestroy:H9e}});var Hh=x((Sat,pZ)=>{"use strict";c();function $9e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var dZ={};function ts(t,e,r){r||(r=Error);function n(o,s,a){return typeof e=="string"?e:e(o,s,a)}var i=function(o){$9e(s,o);function s(a,l,u){return o.call(this,n(a,l,u))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=t,dZ[t]=i}function hZ(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function G9e(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function W9e(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function j9e(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}ts("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);ts("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&G9e(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(W9e(t," argument"))i="The ".concat(t," ").concat(n," ").concat(hZ(e,"type"));else{var o=j9e(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(n," ").concat(hZ(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);ts("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");ts("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});ts("ERR_STREAM_PREMATURE_CLOSE","Premature close");ts("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});ts("ERR_MULTIPLE_CALLBACK","Callback called multiple times");ts("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");ts("ERR_STREAM_WRITE_AFTER_END","write after end");ts("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ts("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);ts("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");pZ.exports.codes=dZ});var nI=x((xat,mZ)=>{"use strict";c();var Y9e=Hh().codes.ERR_INVALID_OPT_VALUE;function Q9e(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function X9e(t,e,r,n){var i=Q9e(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=n?r:"highWaterMark";throw new Y9e(o,i)}return Math.floor(i)}return t.objectMode?16:16*1024}mZ.exports={getHighWaterMark:X9e}});var oI=x((Rat,gZ)=>{c();gZ.exports=Z9e;function Z9e(t,e){if(iI("noDeprecation"))return t;var r=!1;function n(){if(!r){if(iI("throwDeprecation"))throw new Error(e);iI("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function iI(t){try{if(!globalThis.localStorage)return!1}catch{return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var cI=x((Tat,vZ)=>{"use strict";c();vZ.exports=Wr;function wZ(t){var e=this;this.next=null,this.entry=null,this.finish=function(){RSe(e,t)}}var W0;Wr.WritableState=Qg;var J9e={deprecate:oI()},EZ=JA(),O8=bi().Buffer,eSe=globalThis.Uint8Array||function(){};function tSe(t){return O8.from(t)}function rSe(t){return O8.isBuffer(t)||t instanceof eSe}var aI=rI(),nSe=nI(),iSe=nSe.getHighWaterMark,Mu=Hh().codes,oSe=Mu.ERR_INVALID_ARG_TYPE,sSe=Mu.ERR_METHOD_NOT_IMPLEMENTED,aSe=Mu.ERR_MULTIPLE_CALLBACK,cSe=Mu.ERR_STREAM_CANNOT_PIPE,lSe=Mu.ERR_STREAM_DESTROYED,uSe=Mu.ERR_STREAM_NULL_VALUES,fSe=Mu.ERR_STREAM_WRITE_AFTER_END,hSe=Mu.ERR_UNKNOWN_ENCODING,j0=aI.errorOrDestroy;ni()(Wr,EZ);function dSe(){}function Qg(t,e,r){W0=W0||$h(),t=t||{},typeof r!="boolean"&&(r=e instanceof W0),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=iSe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){bSe(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new wZ(this)}Qg.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(Qg.prototype,"buffer",{get:J9e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var D8;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(D8=Function.prototype[Symbol.hasInstance],Object.defineProperty(Wr,Symbol.hasInstance,{value:function(e){return D8.call(this,e)?!0:this!==Wr?!1:e&&e._writableState instanceof Qg}})):D8=function(e){return e instanceof this};function Wr(t){W0=W0||$h();var e=this instanceof W0;if(!e&&!D8.call(Wr,this))return new Wr(t);this._writableState=new Qg(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),EZ.call(this)}Wr.prototype.pipe=function(){j0(this,new cSe)};function pSe(t,e){var r=new fSe;j0(t,r),process.nextTick(e,r)}function mSe(t,e,r,n){var i;return r===null?i=new uSe:typeof r!="string"&&!e.objectMode&&(i=new oSe("chunk",["string","Buffer"],r)),i?(j0(t,i),process.nextTick(n,i),!1):!0}Wr.prototype.write=function(t,e,r){var n=this._writableState,i=!1,o=!n.objectMode&&rSe(t);return o&&!O8.isBuffer(t)&&(t=tSe(t)),typeof e=="function"&&(r=e,e=null),o?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=dSe),n.ending?pSe(this,r):(o||mSe(this,n,t,r))&&(n.pendingcb++,i=ySe(this,n,o,t,e,r)),i};Wr.prototype.cork=function(){this._writableState.corked++};Wr.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&bZ(this,t))};Wr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new hSe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Wr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function gSe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=O8.from(e,r)),e}Object.defineProperty(Wr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ySe(t,e,r,n,i,o){if(!r){var s=gSe(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else sI(t,e,!1,a,n,i,o);return l}function sI(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new lSe("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function wSe(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(Yg,t,e),t._writableState.errorEmitted=!0,j0(t,n)):(i(n),t._writableState.errorEmitted=!0,j0(t,n),Yg(t,e))}function ESe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function bSe(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new aSe;if(ESe(r),e)wSe(t,r,n,e,i);else{var o=_Z(r)||t.destroyed;!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&bZ(t,r),n?process.nextTick(yZ,t,r,o,i):yZ(t,r,o,i)}}function yZ(t,e,r,n){r||_Se(t,e),e.pendingcb--,n(),Yg(t,e)}function _Se(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function bZ(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,sI(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new wZ(e),e.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,f=r.callback,h=e.objectMode?1:l.length;if(sI(t,e,!1,h,l,u,f),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Wr.prototype._write=function(t,e,r){r(new sSe("_write()"))};Wr.prototype._writev=null;Wr.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||xSe(this,n,r),this};Object.defineProperty(Wr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function _Z(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function vSe(t,e){t._final(function(r){e.pendingcb--,r&&j0(t,r),e.prefinished=!0,t.emit("prefinish"),Yg(t,e)})}function SSe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(vSe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function Yg(t,e){var r=_Z(e);if(r&&(SSe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function xSe(t,e,r){e.ending=!0,Yg(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function RSe(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Wr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Wr.prototype.destroy=aI.destroy;Wr.prototype._undestroy=aI.undestroy;Wr.prototype._destroy=function(t,e){e(t)}});var $h=x((Aat,xZ)=>{"use strict";c();var TSe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};xZ.exports=Fa;var SZ=fI(),uI=cI();ni()(Fa,SZ);for(lI=TSe(uI.prototype),L8=0;L8<lI.length;L8++)B8=lI[L8],Fa.prototype[B8]||(Fa.prototype[B8]=uI.prototype[B8]);var lI,B8,L8;function Fa(t){if(!(this instanceof Fa))return new Fa(t);SZ.call(this,t),uI.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",ASe)))}Object.defineProperty(Fa.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Fa.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Fa.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ASe(){this._writableState.ended||process.nextTick(ISe,this)}function ISe(t){t.end()}Object.defineProperty(Fa.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var AZ=x((hI,TZ)=>{c();var M8=bi(),Wc=M8.Buffer;function RZ(t,e){for(var r in t)e[r]=t[r]}Wc.from&&Wc.alloc&&Wc.allocUnsafe&&Wc.allocUnsafeSlow?TZ.exports=M8:(RZ(M8,hI),hI.Buffer=Y0);function Y0(t,e,r){return Wc(t,e,r)}RZ(Wc,Y0);Y0.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Wc(t,e,r)};Y0.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=Wc(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};Y0.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Wc(t)};Y0.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return M8.SlowBuffer(t)}});var Zg=x(CZ=>{"use strict";c();var pI=AZ().Buffer,IZ=pI.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function CSe(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function PSe(t){var e=CSe(t);if(typeof e!="string"&&(pI.isEncoding===IZ||!IZ(t)))throw new Error("Unknown encoding: "+t);return e||t}CZ.StringDecoder=Xg;function Xg(t){this.encoding=PSe(t);var e;switch(this.encoding){case"utf16le":this.text=BSe,this.end=MSe,e=4;break;case"utf8":this.fillLast=DSe,e=4;break;case"base64":this.text=USe,this.end=FSe,e=3;break;default:this.write=KSe,this.end=VSe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=pI.allocUnsafe(e)}Xg.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};Xg.prototype.end=LSe;Xg.prototype.text=OSe;Xg.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function dI(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function NSe(t,e,r){var n=e.length-1;if(n<r)return 0;var i=dI(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=dI(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=dI(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function kSe(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function DSe(t){var e=this.lastTotal-this.lastNeed,r=kSe(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function OSe(t,e){var r=NSe(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function LSe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function BSe(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function MSe(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function USe(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function FSe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function KSe(t){return t.toString(this.encoding)}function VSe(t){return t&&t.length?this.write(t):""}});var U8=x((Cat,kZ)=>{"use strict";c();var PZ=Hh().codes.ERR_STREAM_PREMATURE_CLOSE;function qSe(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function zSe(){}function HSe(t){return t.setHeader&&typeof t.abort=="function"}function NZ(t,e,r){if(typeof e=="function")return NZ(t,null,e);e||(e={}),r=qSe(r||zSe);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){i=!1,s=!0,n||r.call(t)},l=t._readableState&&t._readableState.endEmitted,u=function(){n=!1,l=!0,i||r.call(t)},f=function(m){r.call(t,m)},h=function(){var m;if(n&&!l)return(!t._readableState||!t._readableState.ended)&&(m=new PZ),r.call(t,m);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(m=new PZ),r.call(t,m)},p=function(){t.req.on("finish",a)};return HSe(t)?(t.on("complete",a),t.on("abort",h),t.req?p():t.on("request",p)):i&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",f),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",p),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",f),t.removeListener("close",h)}}kZ.exports=NZ});var OZ=x((Pat,DZ)=>{"use strict";c();var F8;function Uu(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var $Se=U8(),Fu=Symbol("lastResolve"),Gh=Symbol("lastReject"),Jg=Symbol("error"),K8=Symbol("ended"),Wh=Symbol("lastPromise"),mI=Symbol("handlePromise"),jh=Symbol("stream");function Ku(t,e){return{value:t,done:e}}function GSe(t){var e=t[Fu];if(e!==null){var r=t[jh].read();r!==null&&(t[Wh]=null,t[Fu]=null,t[Gh]=null,e(Ku(r,!1)))}}function WSe(t){process.nextTick(GSe,t)}function jSe(t,e){return function(r,n){t.then(function(){if(e[K8]){r(Ku(void 0,!0));return}e[mI](r,n)},n)}}var YSe=Object.getPrototypeOf(function(){}),QSe=Object.setPrototypeOf((F8={get stream(){return this[jh]},next:function(){var e=this,r=this[Jg];if(r!==null)return Promise.reject(r);if(this[K8])return Promise.resolve(Ku(void 0,!0));if(this[jh].destroyed)return new Promise(function(s,a){process.nextTick(function(){e[Jg]?a(e[Jg]):s(Ku(void 0,!0))})});var n=this[Wh],i;if(n)i=new Promise(jSe(n,this));else{var o=this[jh].read();if(o!==null)return Promise.resolve(Ku(o,!1));i=new Promise(this[mI])}return this[Wh]=i,i}},Uu(F8,Symbol.asyncIterator,function(){return this}),Uu(F8,"return",function(){var e=this;return new Promise(function(r,n){e[jh].destroy(null,function(i){if(i){n(i);return}r(Ku(void 0,!0))})})}),F8),YSe),XSe=function(e){var r,n=Object.create(QSe,(r={},Uu(r,jh,{value:e,writable:!0}),Uu(r,Fu,{value:null,writable:!0}),Uu(r,Gh,{value:null,writable:!0}),Uu(r,Jg,{value:null,writable:!0}),Uu(r,K8,{value:e._readableState.endEmitted,writable:!0}),Uu(r,mI,{value:function(o,s){var a=n[jh].read();a?(n[Wh]=null,n[Fu]=null,n[Gh]=null,o(Ku(a,!1))):(n[Fu]=o,n[Gh]=s)},writable:!0}),r));return n[Wh]=null,$Se(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=n[Gh];o!==null&&(n[Wh]=null,n[Fu]=null,n[Gh]=null,o(i)),n[Jg]=i;return}var s=n[Fu];s!==null&&(n[Wh]=null,n[Fu]=null,n[Gh]=null,s(Ku(void 0,!0))),n[K8]=!0}),e.on("readable",WSe.bind(null,n)),n};DZ.exports=XSe});var BZ=x((Nat,LZ)=>{c();LZ.exports=function(){throw new Error("Readable.from is not available in the browser")}});var fI=x((Dat,GZ)=>{"use strict";c();GZ.exports=Ut;var Q0;Ut.ReadableState=KZ;var kat=In().EventEmitter,FZ=function(e,r){return e.listeners(r).length},ty=JA(),V8=bi().Buffer,ZSe=globalThis.Uint8Array||function(){};function JSe(t){return V8.from(t)}function exe(t){return V8.isBuffer(t)||t instanceof ZSe}var gI=jg(),pt;gI&&gI.debuglog?pt=gI.debuglog("stream"):pt=function(){};var txe=lZ(),SI=rI(),rxe=nI(),nxe=rxe.getHighWaterMark,q8=Hh().codes,ixe=q8.ERR_INVALID_ARG_TYPE,oxe=q8.ERR_STREAM_PUSH_AFTER_EOF,sxe=q8.ERR_METHOD_NOT_IMPLEMENTED,axe=q8.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,X0,yI,wI;ni()(Ut,ty);var ey=SI.errorOrDestroy,EI=["error","close","destroy","pause","resume"];function cxe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function KZ(t,e,r){Q0=Q0||$h(),t=t||{},typeof r!="boolean"&&(r=e instanceof Q0),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=nxe(this,t,"readableHighWaterMark",r),this.buffer=new txe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(X0||(X0=Zg().StringDecoder),this.decoder=new X0(t.encoding),this.encoding=t.encoding)}function Ut(t){if(Q0=Q0||$h(),!(this instanceof Ut))return new Ut(t);var e=this instanceof Q0;this._readableState=new KZ(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),ty.call(this)}Object.defineProperty(Ut.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Ut.prototype.destroy=SI.destroy;Ut.prototype._undestroy=SI.undestroy;Ut.prototype._destroy=function(t,e){e(t)};Ut.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=V8.from(t,e),e=""),n=!0),VZ(this,t,e,!1,n)};Ut.prototype.unshift=function(t){return VZ(this,t,null,!0,!1)};function VZ(t,e,r,n,i){pt("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,fxe(t,o);else{var s;if(i||(s=lxe(o,e)),s)ey(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==V8.prototype&&(e=JSe(e)),n)o.endEmitted?ey(t,new axe):bI(t,o,e,!0);else if(o.ended)ey(t,new oxe);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(e=o.decoder.write(e),o.objectMode||e.length!==0?bI(t,o,e,!1):vI(t,o)):bI(t,o,e,!1)}else n||(o.reading=!1,vI(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function bI(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&z8(t)),vI(t,e)}function lxe(t,e){var r;return!exe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new ixe("chunk",["string","Buffer","Uint8Array"],e)),r}Ut.prototype.isPaused=function(){return this._readableState.flowing===!1};Ut.prototype.setEncoding=function(t){X0||(X0=Zg().StringDecoder);var e=new X0(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var MZ=1073741824;function uxe(t){return t>=MZ?t=MZ:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function UZ(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=uxe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Ut.prototype.read=function(t){pt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return pt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?_I(this):z8(this),null;if(t=UZ(t,e),t===0&&e.ended)return e.length===0&&_I(this),null;var n=e.needReadable;pt("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,pt("length less than watermark",n)),e.ended||e.reading?(n=!1,pt("reading or ended",n)):n&&(pt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=UZ(r,e)));var i;return t>0?i=HZ(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&_I(this)),i!==null&&this.emit("data",i),i};function fxe(t,e){if(pt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?z8(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,qZ(t)))}}function z8(t){var e=t._readableState;pt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(pt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(qZ,t))}function qZ(t){var e=t._readableState;pt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,xI(t)}function vI(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(hxe,t,e))}function hxe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(pt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Ut.prototype._read=function(t){ey(this,new sxe("_read()"))};Ut.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,pt("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=i?a:g;n.endEmitted?process.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(y,w){pt("onunpipe"),y===r&&w&&w.hasUnpiped===!1&&(w.hasUnpiped=!0,f())}function a(){pt("onend"),t.end()}var l=dxe(r);t.on("drain",l);var u=!1;function f(){pt("cleanup"),t.removeListener("close",d),t.removeListener("finish",m),t.removeListener("drain",l),t.removeListener("error",p),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",g),r.removeListener("data",h),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&l()}r.on("data",h);function h(y){pt("ondata");var w=t.write(y);pt("dest.write",w),w===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&$Z(n.pipes,t)!==-1)&&!u&&(pt("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function p(y){pt("onerror",y),g(),t.removeListener("error",p),FZ(t,"error")===0&&ey(t,y)}cxe(t,"error",p);function d(){t.removeListener("finish",m),g()}t.once("close",d);function m(){pt("onfinish"),t.removeListener("close",d),g()}t.once("finish",m);function g(){pt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(pt("pipe resume"),r.resume()),t};function dxe(t){return function(){var r=t._readableState;pt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&FZ(t,"data")&&(r.flowing=!0,xI(t))}}Ut.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=$Z(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Ut.prototype.on=function(t,e){var r=ty.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,pt("on readable",n.length,n.reading),n.length?z8(this):n.reading||process.nextTick(pxe,this)),r};Ut.prototype.addListener=Ut.prototype.on;Ut.prototype.removeListener=function(t,e){var r=ty.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(zZ,this),r};Ut.prototype.removeAllListeners=function(t){var e=ty.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(zZ,this),e};function zZ(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function pxe(t){pt("readable nexttick read 0"),t.read(0)}Ut.prototype.resume=function(){var t=this._readableState;return t.flowing||(pt("resume"),t.flowing=!t.readableListening,mxe(this,t)),t.paused=!1,this};function mxe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(gxe,t,e))}function gxe(t,e){pt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),xI(t),e.flowing&&!e.reading&&t.read(0)}Ut.prototype.pause=function(){return pt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(pt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function xI(t){var e=t._readableState;for(pt("flow",e.flowing);e.flowing&&t.read()!==null;);}Ut.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(pt("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(pt("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!(r.objectMode&&s==null)&&!(!r.objectMode&&(!s||!s.length))){var a=e.push(s);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var o=0;o<EI.length;o++)t.on(EI[o],this.emit.bind(this,EI[o]));return this._read=function(s){pt("wrapped _read",s),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(Ut.prototype[Symbol.asyncIterator]=function(){return yI===void 0&&(yI=OZ()),yI(this)});Object.defineProperty(Ut.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Ut.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Ut.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Ut._fromList=HZ;Object.defineProperty(Ut.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function HZ(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function _I(t){var e=t._readableState;pt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(yxe,e,t))}function yxe(t,e){if(pt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Ut.from=function(t,e){return wI===void 0&&(wI=BZ()),wI(Ut,t,e)});function $Z(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var RI=x((Oat,jZ)=>{"use strict";c();jZ.exports=jc;var H8=Hh().codes,wxe=H8.ERR_METHOD_NOT_IMPLEMENTED,Exe=H8.ERR_MULTIPLE_CALLBACK,bxe=H8.ERR_TRANSFORM_ALREADY_TRANSFORMING,_xe=H8.ERR_TRANSFORM_WITH_LENGTH_0,$8=$h();ni()(jc,$8);function vxe(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new Exe);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function jc(t){if(!(this instanceof jc))return new jc(t);$8.call(this,t),this._transformState={afterTransform:vxe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",Sxe)}function Sxe(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){WZ(t,e,r)}):WZ(this,null,null)}jc.prototype.push=function(t,e){return this._transformState.needTransform=!1,$8.prototype.push.call(this,t,e)};jc.prototype._transform=function(t,e,r){r(new wxe("_transform()"))};jc.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};jc.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};jc.prototype._destroy=function(t,e){$8.prototype._destroy.call(this,t,function(r){e(r)})};function WZ(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new _xe;if(t._transformState.transforming)throw new bxe;return t.push(null)}});var XZ=x((Lat,QZ)=>{"use strict";c();QZ.exports=ry;var YZ=RI();ni()(ry,YZ);function ry(t){if(!(this instanceof ry))return new ry(t);YZ.call(this,t)}ry.prototype._transform=function(t,e,r){r(null,t)}});var rJ=x((Bat,tJ)=>{"use strict";c();var TI;function xxe(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var eJ=Hh().codes,Rxe=eJ.ERR_MISSING_ARGS,Txe=eJ.ERR_STREAM_DESTROYED;function ZZ(t){if(t)throw t}function Axe(t){return t.setHeader&&typeof t.abort=="function"}function Ixe(t,e,r,n){n=xxe(n);var i=!1;t.on("close",function(){i=!0}),TI===void 0&&(TI=U8()),TI(t,{readable:e,writable:r},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,Axe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(s||new Txe("pipe"))}}}function JZ(t){t()}function Cxe(t,e){return t.pipe(e)}function Pxe(t){return!t.length||typeof t[t.length-1]!="function"?ZZ:t.pop()}function Nxe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=Pxe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new Rxe("streams");var i,o=e.map(function(s,a){var l=a<e.length-1,u=a>0;return Ixe(s,l,u,function(f){i||(i=f),f&&o.forEach(JZ),!l&&(o.forEach(JZ),n(i))})});return e.reduce(Cxe)}tJ.exports=Nxe});var iJ=x((rs,nJ)=>{c();rs=nJ.exports=fI();rs.Stream=rs;rs.Readable=rs;rs.Writable=cI();rs.Duplex=$h();rs.Transform=RI();rs.PassThrough=XZ();rs.finished=U8();rs.pipeline=rJ()});var aJ=x((Mat,sJ)=>{"use strict";c();var kxe=ni(),{Readable:oJ}=iJ();sJ.exports=Z0;kxe(Z0,oJ);function Z0(t,e){if(!(this instanceof Z0))return new Z0(t,e);e=e||{},oJ.call(this,Object.assign({},e,{objectMode:!0})),this._iterator=t,this._options=e,this.on("end",this.destroy.bind(this,null,null))}Z0.prototype._read=function(){this.destroyed||this._iterator.next((t,e,r)=>{if(!this.destroyed){if(t)return this.destroy(t);e===void 0&&r===void 0?this.push(null):this._options.keys!==!1&&this._options.values===!1?this.push(e):this._options.keys===!1&&this._options.values!==!1?this.push(r):this.push({key:e,value:r})}})};Z0.prototype._destroy=function(t,e){this._iterator.end(function(r){e(t||r)})}});var W8=x((Uat,G8)=>{"use strict";c();function Qh(t,e){let r=function(n,i){if(typeof n=="object"&&n!==null&&(i=i||n,n=n.message||n.name),n=n||"",i=i||void 0,typeof i=="object"&&i.type===t&&i.message===n)return i;Object.defineProperty(this,"type",{value:t,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"name",{value:t,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"cause",{value:i,enumerable:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"message",{value:n,enumerable:!1,writable:!0,configurable:!0}),Error.call(this),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,r)};return r.prototype=new e,r}var Yh=Qh("LevelUPError",Error);G8.exports={LevelUPError:Yh,InitializationError:Qh("InitializationError",Yh),OpenError:Qh("OpenError",Yh),ReadError:Qh("ReadError",Yh),WriteError:Qh("WriteError",Yh),NotFoundError:Qh("NotFoundError",Yh),EncodingError:Qh("EncodingError",Yh)};G8.exports.NotFoundError.prototype.notFound=!0;G8.exports.NotFoundError.prototype.status=404});var ny=x(AI=>{"use strict";c();AI.getCallback=function(t,e){return typeof t=="function"?t:e};AI.getOptions=function(t){return typeof t=="object"&&t!==null?t:{}}});var lJ=x((Kat,cJ)=>{"use strict";c();var iy=W8().WriteError,Dxe=T8(),Oxe=ny().getCallback,Lxe=ny().getOptions;function oy(t){this.db=t,this.batch=t.db.batch(),this.ops=[],this.length=0}oy.prototype.put=function(t,e,r){try{this.batch.put(t,e,r)}catch(n){throw new iy(n)}return this.ops.push({...r,type:"put",key:t,value:e}),this.length++,this};oy.prototype.del=function(t,e){try{this.batch.del(t,e)}catch(r){throw new iy(r)}return this.ops.push({...e,type:"del",key:t}),this.length++,this};oy.prototype.clear=function(){try{this.batch.clear()}catch(t){throw new iy(t)}return this.ops=[],this.length=0,this};oy.prototype.write=function(t,e){let r=this.db,n=this.ops;e=Oxe(t,e),e=Dxe.fromCallback(e),t=Lxe(t);try{this.batch.write(t,function(i){if(i)return e(new iy(i));r.emit("batch",n),e()})}catch(i){throw new iy(i)}return e.promise};cJ.exports=oy});var hJ=x((Vat,fJ)=>{"use strict";c();var uJ=A8();fJ.exports=function(t,...e){e.length===0?uJ(t):uJ(()=>t(...e))}});var mJ=x((qat,pJ)=>{"use strict";c();var j8=In().EventEmitter,Bxe=IX().inherits,Mxe=iZ(),Uxe=aJ(),Fxe=lJ(),J0=W8(),Kxe=HA(),Xh=T8(),sy=ny().getCallback,e1=ny().getOptions,ay=hJ(),Y8=J0.WriteError,dJ=J0.ReadError,Vxe=J0.NotFoundError,qxe=J0.OpenError,zxe=J0.InitializationError;function Yt(t,e,r){if(!(this instanceof Yt))return new Yt(t,e,r);let n;if(j8.call(this),this.setMaxListeners(1/0),typeof e=="function"&&(r=e,e={}),e=e||{},!t||typeof t!="object"){if(n=new zxe("First argument must be an abstract-leveldown compliant store"),typeof r=="function")return ay(r,n);throw n}if(typeof t.status!="string")throw new Error(".status required, old abstract-leveldown");this.options=e1(e),this._db=t,this.db=null,this.open(r||(i=>{i&&this.emit("error",i)})),this.supports=Kxe(this.db.supports,{status:!0,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0});for(let i of Object.keys(this.supports.additionalMethods))this[i]==null&&(this[i]=function(...o){return this.db[i](...o)})}Yt.prototype.emit=j8.prototype.emit;Yt.prototype.once=j8.prototype.once;Bxe(Yt,j8);Object.defineProperty(Yt.prototype,"status",{enumerable:!0,get(){return this.db.status}});Yt.prototype.isOperational=function(){return this.db.status==="open"||this.db.status==="opening"};Yt.prototype.open=function(t,e){return typeof t=="function"&&(e=t,t=null),e=Xh.fromCallback(e),t||(t=this.options),this.db&&this.isOpen()?(ay(e,null,this),e.promise):this.db&&this._isOpening()?(this.once("open",()=>{e(null,this)}),e.promise):(this.db=new Mxe(this._db),this.emit("opening"),this.db.open(t,r=>{if(r)return e(new qxe(r));this.db=this._db,e(null,this),this.emit("open"),this.emit("ready")}),e.promise)};Yt.prototype.close=function(t){return t=Xh.fromCallback(t),this.isOpen()?(this.db.close((e,...r)=>{this.emit("closed"),t(e,...r)}),this.emit("closing")):this.isClosed()?ay(t):this.db.status==="closing"?this.once("closed",t):this._isOpening()&&this.once("open",()=>{this.close(t)}),t.promise};Yt.prototype.isOpen=function(){return this.db.status==="open"};Yt.prototype._isOpening=function(){return this.db.status==="opening"};Yt.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)};Yt.prototype.get=function(t,e,r){return r=sy(e,r),r=Xh.fromCallback(r),cy(this,r)||(e=e1(e),this.db.get(t,e,function(n,i){if(n)return/notfound/i.test(n)||n.notFound?n=new Vxe("Key not found in database ["+t+"]",n):n=new dJ(n),r(n);r(null,i)})),r.promise};Yt.prototype.getMany=function(t,e,r){return this.db.getMany(t,e,r)};Yt.prototype.put=function(t,e,r,n){return n=sy(r,n),n=Xh.fromCallback(n),cy(this,n)||(r=e1(r),this.db.put(t,e,r,i=>{if(i)return n(new Y8(i));this.emit("put",t,e),n()})),n.promise};Yt.prototype.del=function(t,e,r){return r=sy(e,r),r=Xh.fromCallback(r),cy(this,r)||(e=e1(e),this.db.del(t,e,n=>{if(n)return r(new Y8(n));this.emit("del",t),r()})),r.promise};Yt.prototype.batch=function(t,e,r){return arguments.length?(typeof t=="function"?r=t:r=sy(e,r),r=Xh.fromCallback(r),cy(this,r)||(e=e1(e),this.db.batch(t,e,n=>{if(n)return r(new Y8(n));this.emit("batch",t),r()})),r.promise):new Fxe(this)};Yt.prototype.iterator=function(t){return this.db.iterator(t)};Yt.prototype.clear=function(t,e){return e=sy(t,e),t=e1(t),e=Xh.fromCallback(e),cy(this,e)||this.db.clear(t,r=>{if(r)return e(new Y8(r));this.emit("clear",t),e()}),e.promise};Yt.prototype.readStream=Yt.prototype.createReadStream=function(t){return t=Object.assign({keys:!0,values:!0},t),typeof t.limit!="number"&&(t.limit=-1),new Uxe(this.db.iterator(t),t)};Yt.prototype.keyStream=Yt.prototype.createKeyStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!0,values:!1}))};Yt.prototype.valueStream=Yt.prototype.createValueStream=function(t){return this.createReadStream(Object.assign({},t,{keys:!1,values:!0}))};Yt.prototype.toString=function(){return"LevelUP"};Yt.prototype.type="levelup";Yt.prototype._nextTick=ay;function cy(t,e){return t.isOperational()?!1:(ay(e,new dJ("Database is not open")),!0)}Yt.errors=J0;pJ.exports=Yt});var gJ=x(Yc=>{"use strict";c();var{Buffer:II}=bi();Yc.utf8=Yc["utf-8"]={encode:function(t){return CI(t)?t:String(t)},decode:Q8,buffer:!1,type:"utf8"};Yc.json={encode:JSON.stringify,decode:JSON.parse,buffer:!1,type:"json"};Yc.binary={encode:function(t){return CI(t)?t:II.from(t)},decode:Q8,buffer:!0,type:"binary"};Yc.none={encode:Q8,decode:Q8,buffer:!1,type:"id"};Yc.id=Yc.none;var Hxe=["hex","ascii","base64","ucs2","ucs-2","utf16le","utf-16le"];for(let t of Hxe)Yc[t]={encode:function(e){return CI(e)?e:II.from(e,t)},decode:function(e){return e.toString(t)},buffer:!0,type:t};function Q8(t){return t}function CI(t){return t==null||II.isBuffer(t)}});var wJ=x((Hat,yJ)=>{"use strict";c();var PI=gJ(),$xe=new Set(["lt","gt","lte","gte"]);yJ.exports=Ai;function Ai(t){if(!(this instanceof Ai))return new Ai(t);this.opts=t||{},this.encodings=PI}Ai.prototype._encoding=function(t){return typeof t=="string"&&(t=PI[t]),t||(t=PI.id),t};Ai.prototype._keyEncoding=function(t,e){return this._encoding(e&&e.keyEncoding||t&&t.keyEncoding||this.opts.keyEncoding)};Ai.prototype._valueEncoding=function(t,e){return this._encoding(e&&(e.valueEncoding||e.encoding)||t&&(t.valueEncoding||t.encoding)||this.opts.valueEncoding||this.opts.encoding)};Ai.prototype.encodeKey=function(t,e,r){return this._keyEncoding(e,r).encode(t)};Ai.prototype.encodeValue=function(t,e,r){return this._valueEncoding(e,r).encode(t)};Ai.prototype.decodeKey=function(t,e){return this._keyEncoding(e).decode(t)};Ai.prototype.decodeValue=function(t,e){return this._valueEncoding(e).decode(t)};Ai.prototype.encodeBatch=function(t,e){return t.map(r=>{let n={type:r.type,key:this.encodeKey(r.key,e,r)};return this.keyAsBuffer(e,r)&&(n.keyEncoding="binary"),r.prefix&&(n.prefix=r.prefix),"value"in r&&(n.value=this.encodeValue(r.value,e,r),this.valueAsBuffer(e,r)&&(n.valueEncoding="binary")),n})};Ai.prototype.encodeLtgt=function(t){let e={};for(let r of Object.keys(t)){if(r==="start"||r==="end")throw new Error('Legacy range options ("start" and "end") have been removed');e[r]=$xe.has(r)?this.encodeKey(t[r],t):t[r]}return e};Ai.prototype.createStreamDecoder=function(t){return t.keys&&t.values?(e,r)=>({key:this.decodeKey(e,t),value:this.decodeValue(r,t)}):t.keys?e=>this.decodeKey(e,t):t.values?(e,r)=>this.decodeValue(r,t):function(){}};Ai.prototype.keyAsBuffer=function(t){return this._keyEncoding(t).buffer};Ai.prototype.valueAsBuffer=function(t){return this._valueEncoding(t).buffer}});var SJ=x(($at,vJ)=>{"use strict";c();var EJ=Gc().AbstractLevelDOWN,bJ=Gc().AbstractChainedBatch,_J=Gc().AbstractIterator,NI=ni(),Gxe=wJ(),kI=W8().EncodingError,Wxe=["approximateSize","compactRange"];vJ.exports=ii;function ii(t,e){if(!(this instanceof ii))return new ii(t,e);let r=t.supports||{},n=r.additionalMethods||{};EJ.call(this,r),this.supports.encodings=!0,this.supports.additionalMethods={},Wxe.forEach(function(i){let o=typeof t[i]=="function";(n[i]||o)&&(this.supports.additionalMethods[i]=!0,this[i]=function(s,a,l,u){return s=this.codec.encodeKey(s,l),a=this.codec.encodeKey(a,l),this.db[i](s,a,l,u)})},this),e=e||{},typeof e.keyEncoding>"u"&&(e.keyEncoding="utf8"),typeof e.valueEncoding>"u"&&(e.valueEncoding="utf8"),this.db=t,this.codec=new Gxe(e)}NI(ii,EJ);ii.prototype.type="encoding-down";ii.prototype._serializeKey=ii.prototype._serializeValue=function(t){return t};ii.prototype._open=function(t,e){this.db.open(t,e)};ii.prototype._close=function(t){this.db.close(t)};ii.prototype._put=function(t,e,r,n){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.db.put(t,e,r,n)};ii.prototype._get=function(t,e,r){t=this.codec.encodeKey(t,e),e.asBuffer=this.codec.valueAsBuffer(e),this.db.get(t,e,(n,i)=>{if(n)return r(n);try{i=this.codec.decodeValue(i,e)}catch(o){return r(new kI(o))}r(null,i)})};ii.prototype._getMany=function(t,e,r){t=t.map(n=>this.codec.encodeKey(n,e)),e.asBuffer=this.codec.valueAsBuffer(e),this.db.getMany(t,e,(n,i)=>{if(n)return r(n);let o=new Array(i.length);for(let s=0;s<i.length;s++){if(i[s]===void 0){o[s]=void 0;continue}try{o[s]=this.codec.decodeValue(i[s],e)}catch(a){return r(new kI(a))}}r(null,o)})};ii.prototype._del=function(t,e,r){t=this.codec.encodeKey(t,e),this.db.del(t,e,r)};ii.prototype._chainedBatch=function(){return new t1(this)};ii.prototype._batch=function(t,e,r){t=this.codec.encodeBatch(t,e),this.db.batch(t,e,r)};ii.prototype._iterator=function(t){return t.keyAsBuffer=this.codec.keyAsBuffer(t),t.valueAsBuffer=this.codec.valueAsBuffer(t),new ly(this,t)};ii.prototype._clear=function(t,e){t=this.codec.encodeLtgt(t),this.db.clear(t,e)};function ly(t,e){_J.call(this,t),this.codec=t.codec,this.keys=e.keys,this.values=e.values,this.opts=this.codec.encodeLtgt(e),this.it=t.db.iterator(this.opts)}NI(ly,_J);ly.prototype._next=function(t){this.it.next((e,r,n)=>{if(e)return t(e);try{this.keys&&typeof r<"u"?r=this.codec.decodeKey(r,this.opts):r=void 0,this.values&&typeof n<"u"?n=this.codec.decodeValue(n,this.opts):n=void 0}catch(i){return t(new kI(i))}t(null,r,n)})};ly.prototype._seek=function(t){t=this.codec.encodeKey(t,this.opts),this.it.seek(t)};ly.prototype._end=function(t){this.it.end(t)};function t1(t,e){bJ.call(this,t),this.codec=t.codec,this.batch=t.db.batch()}NI(t1,bJ);t1.prototype._put=function(t,e,r){t=this.codec.encodeKey(t,r),e=this.codec.encodeValue(e,r),this.batch.put(t,e)};t1.prototype._del=function(t,e){t=this.codec.encodeKey(t,e),this.batch.del(t)};t1.prototype._clear=function(){this.batch.clear()};t1.prototype._write=function(t,e){this.batch.write(t,e)}});var TJ=x((Gat,RJ)=>{"use strict";c();var xJ=mJ(),jxe=SJ();function Yxe(t){function e(n,i,o){return typeof n=="function"?o=n:typeof i=="function"&&(o=i),r(i)||(i=r(n)?n:{}),xJ(jxe(t(n,i),i),i,o)}function r(n){return typeof n=="object"&&n!==null}for(let n of["destroy","repair"])typeof t[n]=="function"&&(e[n]=function(...i){t[n](...i)});return e.errors=xJ.errors,e}RJ.exports=Yxe});var IJ=x((Wat,AJ)=>{c();AJ.exports=Xxe;var Qxe=A8();function Xxe(t,e,r){if(typeof e!="number")throw new Error("second argument must be a Number");let n,i,o,s,a,l=!0,u;Array.isArray(t)?(n=[],o=i=t.length):(s=Object.keys(t),n={},o=i=s.length);function f(p){function d(){r&&r(p,n),r=null}l?Qxe(d):d()}function h(p,d,m){if(n[p]=m,d&&(a=!0),--o===0||d)f(d);else if(!a&&u<i){let g;s?(g=s[u],u+=1,t[g](function(y,w){h(g,y,w)})):(g=u,u+=1,t[g](function(y,w){h(g,y,w)}))}}u=e,o?s?s.some(function(p,d){return t[p](function(m,g){h(p,m,g)}),d===e-1}):t.some(function(p,d){return p(function(m,g){h(d,m,g)}),d===e-1}):f(null),l=!1}});var PJ=x(cn=>{c();cn.compare=function(t,e){if(Buffer.isBuffer(t)){for(var r=Math.min(t.length,e.length),n=0;n<r;n++){var i=t[n]-e[n];if(i)return i}return t.length-e.length}return t<e?-1:t>e?1:0};function CJ(t){return t!==void 0&&t!==""}function r1(t,e){return Object.hasOwnProperty.call(t,e)}function Ka(t,e){return Object.hasOwnProperty.call(t,e)&&e}var Zxe=cn.lowerBoundKey=function(t){return Ka(t,"gt")||Ka(t,"gte")||Ka(t,"min")||(t.reverse?Ka(t,"end"):Ka(t,"start"))||void 0},DI=cn.lowerBound=function(t,e){var r=Zxe(t);return r?t[r]:e},OI=cn.lowerBoundInclusive=function(t){return!r1(t,"gt")},LI=cn.upperBoundInclusive=function(t){return!r1(t,"lt")},Jxe=cn.lowerBoundExclusive=function(t){return!OI(t)},eRe=cn.upperBoundExclusive=function(t){return!LI(t)},tRe=cn.upperBoundKey=function(t){return Ka(t,"lt")||Ka(t,"lte")||Ka(t,"max")||(t.reverse?Ka(t,"start"):Ka(t,"end"))||void 0},BI=cn.upperBound=function(t,e){var r=tRe(t);return r?t[r]:e};cn.start=function(t,e){return t.reverse?BI(t,e):DI(t,e)};cn.end=function(t,e){return t.reverse?DI(t,e):BI(t,e)};cn.startInclusive=function(t){return t.reverse?LI(t):OI(t)};cn.endInclusive=function(t){return t.reverse?OI(t):LI(t)};function rRe(t){return t}cn.toLtgt=function(t,e,r,n,i){e=e||{},r=r||rRe;var o=arguments.length>3,s=cn.lowerBoundKey(t),a=cn.upperBoundKey(t);return s?s==="gt"?e.gt=r(t.gt,!1):e.gte=r(t[s],!1):o&&(e.gte=r(n,!1)),a?a==="lt"?e.lt=r(t.lt,!0):e.lte=r(t[a],!0):o&&(e.lte=r(i,!0)),t.reverse!=null&&(e.reverse=!!t.reverse),r1(e,"max")&&delete e.max,r1(e,"min")&&delete e.min,r1(e,"start")&&delete e.start,r1(e,"end")&&delete e.end,e};cn.contains=function(t,e,r){r=r||cn.compare;var n=DI(t);if(CJ(n)){var i=r(e,n);if(i<0||i===0&&Jxe(t))return!1}var o=BI(t);if(CJ(o)){var i=r(e,o);if(i>0||i===0&&eRe(t))return!1}return!0};cn.filter=function(t,e){return function(r){return cn.contains(t,r,e)}}});var MI=x((Yat,NJ)=>{"use strict";c();var X8=PJ(),Vu=Symbol("none");NJ.exports=function(e){let r=X8.lowerBound(e,Vu),n=X8.upperBound(e,Vu),i=X8.lowerBoundExclusive(e,Vu),o=X8.upperBoundExclusive(e,Vu);return r!==Vu&&n!==Vu?IDBKeyRange.bound(r,n,i,o):r!==Vu?IDBKeyRange.lowerBound(r,i):n!==Vu?IDBKeyRange.upperBound(n,o):null}});var UI=x((Qat,DJ)=>{"use strict";c();var Z8=bi().Buffer,nRe=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return kJ(e).toString()}}(),iRe=function(){if(globalThis.TextDecoder){let t=new TextDecoder("utf-8");return t.decode.bind(t)}else return function(e){return Z8.from(e).toString()}}();function kJ(t){let e=Z8.from(t.buffer);return t.byteLength===t.buffer.byteLength?e:e.slice(t.byteOffset,t.byteOffset+t.byteLength)}DJ.exports=function(t,e){return t instanceof Uint8Array?e?kJ(t):nRe(t):t instanceof ArrayBuffer?e?Z8.from(t):iRe(t):e?Z8.from(String(t)):String(t)}});var MJ=x((Xat,BJ)=>{"use strict";c();var oRe=ni(),OJ=Gc().AbstractIterator,sRe=MI(),LJ=UI(),aRe=function(){};BJ.exports=Ws;function Ws(t,e,r){if(OJ.call(this,t),this._limit=r.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=r.keys,this._values=r.values,this._keyAsBuffer=r.keyAsBuffer,this._valueAsBuffer=r.valueAsBuffer,this._limit===0){this._completed=!0;return}let n;try{n=sRe(r)}catch{this._completed=!0;return}this.createIterator(e,n,r.reverse)}oRe(Ws,OJ);Ws.prototype.createIterator=function(t,e,r){let n=this.db.db.transaction([t],"readonly"),o=n.objectStore(t).openCursor(e,r?"prev":"next");o.onsuccess=s=>{let a=s.target.result;a&&this.onItem(a)},this._transaction=n,n.onabort=()=>{this.onAbort(this._transaction.error||new Error("aborted by user"))},n.oncomplete=()=>{this.onComplete()}};Ws.prototype.onItem=function(t){this._cache.push(t.key,t.value),(this._limit<=0||++this._count<this._limit)&&t.continue(),this.maybeNext()};Ws.prototype.onAbort=function(t){this._aborted=!0,this._error=t,this.maybeNext()};Ws.prototype.onComplete=function(){this._completed=!0,this.maybeNext()};Ws.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)};Ws.prototype._next=function(t){if(this._aborted){let e=this._error;this._error=null,this._nextTick(t,e)}else if(this._cache.length>0){let e=this._cache.shift(),r=this._cache.shift();this._keys&&e!==void 0?e=this._deserializeKey(e,this._keyAsBuffer):e=void 0,this._values&&r!==void 0?r=this._deserializeValue(r,this._valueAsBuffer):r=void 0,this._nextTick(t,null,e,r)}else this._completed?this._nextTick(t):this._callback=t};Ws.prototype._deserializeKey=LJ;Ws.prototype._deserializeValue=LJ;Ws.prototype._end=function(t){if(this._aborted||this._completed)return this._nextTick(t,this._error);this.onItem=aRe,this.onAbort=t,this.onComplete=t}});var KJ=x((Zat,FJ)=>{"use strict";c();var UJ=bi().Buffer,cRe=function(){if(globalThis.TextEncoder){let t=new TextEncoder("utf-8");return t.encode.bind(t)}else return UJ.from}();FJ.exports=function(t,e){return e?UJ.isBuffer(t)?t:cRe(String(t)):String(t)}});var VJ=x(J8=>{"use strict";c();var lRe=bi().Buffer;J8.test=function(t){return function(r){try{return r.cmp(t,0),!0}catch{return!1}}};J8.bufferKeys=J8.test(lRe.alloc(0))});var zJ=x((ect,qJ)=>{"use strict";c();qJ.exports=function(e,r,n,i,o){if(i.limit===0)return e._nextTick(o);let s=e.db.transaction([r],"readwrite"),a=s.objectStore(r),l=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",f=i.reverse?"prev":"next";a[u](n,f).onsuccess=function(h){let p=h.target.result;p&&(a.delete(p.key).onsuccess=function(){(i.limit<=0||++l<i.limit)&&p.continue()})}}});var jJ=x((tct,WJ)=>{"use strict";c();WJ.exports=yn;var HJ=Gc().AbstractLevelDOWN,uRe=ni(),fRe=IJ(),hRe=MJ(),$J=KJ(),eE=UI(),dRe=VJ(),pRe=zJ(),mRe=MI(),GJ="level-js-";function yn(t,e){if(!(this instanceof yn))return new yn(t,e);if(HJ.call(this,{bufferKeys:dRe.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0,getMany:!0}),e=e||{},typeof t!="string")throw new Error("constructor requires a location string argument");this.location=t,this.prefix=e.prefix==null?GJ:e.prefix,this.version=parseInt(e.version||1,10)}uRe(yn,HJ);yn.prototype.type="level-js";yn.prototype._open=function(t,e){let r=indexedDB.open(this.prefix+this.location,this.version);r.onerror=function(){e(r.error||new Error("unknown error"))},r.onsuccess=()=>{this.db=r.result,e()},r.onupgradeneeded=n=>{let i=n.target.result;i.objectStoreNames.contains(this.location)||i.createObjectStore(this.location)}};yn.prototype.store=function(t){return this.db.transaction([this.location],t).objectStore(this.location)};yn.prototype.await=function(t,e){let r=t.transaction;r.onabort=function(){e(r.error||new Error("aborted by user"))},r.oncomplete=function(){e(null,t.result)}};yn.prototype._get=function(t,e,r){let n=this.store("readonly"),i;try{i=n.get(t)}catch(o){return this._nextTick(r,o)}this.await(i,function(o,s){if(o)return r(o);if(s===void 0)return r(new Error("NotFound"));r(null,eE(s,e.asBuffer))})};yn.prototype._getMany=function(t,e,r){let n=e.asBuffer,i=this.store("readonly"),o=t.map(s=>a=>{let l;try{l=i.get(s)}catch(u){return a(u)}l.onsuccess=()=>{let u=l.result;a(null,u===void 0?u:eE(u,n))},l.onerror=u=>{u.stopPropagation(),a(l.error)}});fRe(o,16,r)};yn.prototype._del=function(t,e,r){let n=this.store("readwrite"),i;try{i=n.delete(t)}catch(o){return this._nextTick(r,o)}this.await(i,r)};yn.prototype._put=function(t,e,r,n){let i=this.store("readwrite"),o;try{o=i.put(e,t)}catch(s){return this._nextTick(n,s)}this.await(o,n)};yn.prototype._serializeKey=function(t){return $J(t,this.supports.bufferKeys)};yn.prototype._serializeValue=function(t){return $J(t,!0)};yn.prototype._iterator=function(t){return new hRe(this,this.location,t)};yn.prototype._batch=function(t,e,r){if(t.length===0)return this._nextTick(r);let n=this.store("readwrite"),i=n.transaction,o=0,s;i.onabort=function(){r(s||i.error||new Error("aborted by user"))},i.oncomplete=function(){r()};function a(){let l=t[o++],u=l.key,f;try{f=l.type==="del"?n.delete(u):n.put(l.value,u)}catch(h){s=h,i.abort();return}o<t.length&&(f.onsuccess=a)}a()};yn.prototype._clear=function(t,e){let r,n;try{r=mRe(t)}catch{return this._nextTick(e)}if(t.limit>=0)return pRe(this,this.location,r,t,e);try{let i=this.store("readwrite");n=r?i.delete(r):i.clear()}catch(i){return this._nextTick(e,i)}this.await(n,e)};yn.prototype._close=function(t){this.db.close(),this._nextTick(t)};yn.prototype.upgrade=function(t){if(this.status!=="open")return this._nextTick(t,new Error("cannot upgrade() before open()"));let e=this.iterator(),r={},n=this;e._deserializeKey=e._deserializeValue=a,i();function i(l){if(l)return s(l);e.next(o)}function o(l,u,f){if(l||u===void 0)return s(l);let h=n._serializeKey(eE(u,!0)),p=n._serializeValue(eE(f,!0));n._batch([{type:"del",key:u},{type:"put",key:h,value:p}],r,i)}function s(l){e.end(function(u){t(l||u)})}function a(l){return l}};yn.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=GJ);let n=indexedDB.deleteDatabase(e+t);n.onsuccess=function(){r()},n.onerror=function(i){r(i)}}});var QJ=x((rct,YJ)=>{c();YJ.exports=TJ()(jJ())});var eee=x((sct,JJ)=>{c();var VI=e0();JJ.exports=t=>{t=t||{};let e;typeof t=="function"?(e=t,t={}):e=t.onEnd;let r=new VI,n,i,o,s=()=>{if(!r.isEmpty()){if(t.writev){let g,y=[];for(;!r.isEmpty();){if(g=r.shift(),g.error)throw g.error;y.push(g.value)}return{done:g.done,value:y}}let m=r.shift();if(m.error)throw m.error;return m}return o?{done:!0}:new Promise((m,g)=>{i=y=>(i=null,y.error?g(y.error):t.writev&&!y.done?m({done:y.done,value:[y.value]}):m(y),n)})},a=m=>i?i(m):(r.push(m),n),l=m=>(r=new VI,i?i({error:m}):(r.push({error:m}),n)),u=m=>o?n:a({done:!1,value:m}),f=m=>o?n:(o=!0,m?l(m):a({done:!0})),h=()=>(r=new VI,f(),{done:!0}),p=m=>(f(m),{done:!0});if(n={[Symbol.asyncIterator](){return this},next:s,return:h,throw:p,push:u,end:f},!e)return n;let d=n;return n={[Symbol.asyncIterator](){return this},next(){return d.next()},throw(m){return d.throw(m),e&&(e(m),e=null),{done:!0}},return(){return d.return(),e&&(e(),e=null),{done:!0}},push:u,end(m){return d.end(m),e&&(e(m),e=null),n}},n}});var Aee=x((Jlt,Tee)=>{"use strict";c();function jr(t,r){var r=r||{};this._head=0,this._tail=0,this._capacity=r.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(t)&&this._fromArray(t)}jr.prototype.peekAt=function(e){var r=e;if(r===(r|0)){var n=this.size();if(!(r>=n||r<-n))return r<0&&(r+=n),r=this._head+r&this._capacityMask,this._list[r]}};jr.prototype.get=function(e){return this.peekAt(e)};jr.prototype.peek=function(){if(this._head!==this._tail)return this._list[this._head]};jr.prototype.peekFront=function(){return this.peek()};jr.prototype.peekBack=function(){return this.peekAt(-1)};Object.defineProperty(jr.prototype,"length",{get:function(){return this.size()}});jr.prototype.size=function(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.unshift=function(e){if(e===void 0)return this.size();var r=this._list.length;return this._head=this._head-1+r&this._capacityMask,this._list[this._head]=e,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.shift=function(){var e=this._head;if(e!==this._tail){var r=this._list[e];return this._list[e]=void 0,this._head=e+1&this._capacityMask,e<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),r}};jr.prototype.push=function(e){if(e===void 0)return this.size();var r=this._tail;return this._list[r]=e,this._tail=r+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};jr.prototype.pop=function(){var e=this._tail;if(e!==this._head){var r=this._list.length;this._tail=e-1+r&this._capacityMask;var n=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&e>1e4&&e<=r>>>2&&this._shrinkArray(),n}};jr.prototype.removeOne=function(e){var r=e;if(r===(r|0)&&this._head!==this._tail){var n=this.size(),i=this._list.length;if(!(r>=n||r<-n)){r<0&&(r+=n),r=this._head+r&this._capacityMask;var o=this._list[r],s;if(e<n/2){for(s=e;s>0;s--)this._list[r]=this._list[r=r-1+i&this._capacityMask];this._list[r]=void 0,this._head=this._head+1+i&this._capacityMask}else{for(s=n-1-e;s>0;s--)this._list[r]=this._list[r=r+1+i&this._capacityMask];this._list[r]=void 0,this._tail=this._tail-1+i&this._capacityMask}return o}}};jr.prototype.remove=function(e,r){var n=e,i,o=r;if(n===(n|0)&&this._head!==this._tail){var s=this.size(),a=this._list.length;if(!(n>=s||n<-s||r<1)){if(n<0&&(n+=s),r===1||!r)return i=new Array(1),i[0]=this.removeOne(n),i;if(n===0&&n+r>=s)return i=this.toArray(),this.clear(),i;n+r>s&&(r=s-n);var l;for(i=new Array(r),l=0;l<r;l++)i[l]=this._list[this._head+n+l&this._capacityMask];if(n=this._head+n&this._capacityMask,e+r===s){for(this._tail=this._tail-r+a&this._capacityMask,l=r;l>0;l--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(e===0){for(this._head=this._head+r+a&this._capacityMask,l=r-1;l>0;l--)this._list[n=n+1+a&this._capacityMask]=void 0;return i}if(n<s/2){for(this._head=this._head+e+r+a&this._capacityMask,l=e;l>0;l--)this.unshift(this._list[n=n-1+a&this._capacityMask]);for(n=this._head-1+a&this._capacityMask;o>0;)this._list[n=n-1+a&this._capacityMask]=void 0,o--;e<0&&(this._tail=n)}else{for(this._tail=n,n=n+r+a&this._capacityMask,l=s-(r+e);l>0;l--)this.push(this._list[n++]);for(n=this._tail;o>0;)this._list[n=n+1+a&this._capacityMask]=void 0,o--}return this._head<2&&this._tail>1e4&&this._tail<=a>>>2&&this._shrinkArray(),i}}};jr.prototype.splice=function(e,r){var n=e;if(n===(n|0)){var i=this.size();if(n<0&&(n+=i),!(n>i))if(arguments.length>2){var o,s,a,l=arguments.length,u=this._list.length,f=2;if(!i||n<i/2){for(s=new Array(n),o=0;o<n;o++)s[o]=this._list[this._head+o&this._capacityMask];for(r===0?(a=[],n>0&&(this._head=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._head=this._head+n+u&this._capacityMask);l>f;)this.unshift(arguments[--l]);for(o=n;o>0;o--)this.unshift(s[o-1])}else{s=new Array(i-(n+r));var h=s.length;for(o=0;o<h;o++)s[o]=this._list[this._head+n+r+o&this._capacityMask];for(r===0?(a=[],n!=i&&(this._tail=this._head+n+u&this._capacityMask)):(a=this.remove(n,r),this._tail=this._tail-h+u&this._capacityMask);f<l;)this.push(arguments[f++]);for(o=0;o<h;o++)this.push(s[o])}return a}else return this.remove(n,r)}};jr.prototype.clear=function(){this._head=0,this._tail=0};jr.prototype.isEmpty=function(){return this._head===this._tail};jr.prototype.toArray=function(){return this._copyArray(!1)};jr.prototype._fromArray=function(e){for(var r=0;r<e.length;r++)this.push(e[r])};jr.prototype._copyArray=function(e){var r=[],n=this._list,i=n.length,o;if(e||this._head>this._tail){for(o=this._head;o<i;o++)r.push(n[o]);for(o=0;o<this._tail;o++)r.push(n[o])}else for(o=this._head;o<this._tail;o++)r.push(n[o]);return r};jr.prototype._growArray=function(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1};jr.prototype._shrinkArray=function(){this._list.length>>>=1,this._capacityMask>>>=1};Tee.exports=jr});var tC=x((Sut,Nee)=>{c();Nee.exports=In().EventEmitter});var Lee=x((xut,Oee)=>{"use strict";c();function kee(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function LRe(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?kee(Object(r),!0).forEach(function(n){BRe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):kee(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function BRe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function URe(t,e,r){return e&&Dee(t.prototype,e),r&&Dee(t,r),t}var FRe=bi(),uE=FRe.Buffer,KRe=jg(),rC=KRe.inspect,VRe=rC&&rC.custom||"inspect";function qRe(t,e,r){uE.prototype.copy.call(t,e,r)}Oee.exports=function(){function t(){MRe(this,t),this.head=null,this.tail=null,this.length=0}return URe(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return uE.alloc(0);for(var n=uE.allocUnsafe(r>>>0),i=this.head,o=0;i;)qRe(i.data,n,o),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,o=n.data;for(r-=o.length;n=n.next;){var s=n.data,a=r>s.length?s.length:r;if(a===s.length?o+=s:o+=s.slice(0,r),r-=a,r===0){a===s.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(a));break}++i}return this.length-=i,o}},{key:"_getBuffer",value:function(r){var n=uE.allocUnsafe(r),i=this.head,o=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var s=i.data,a=r>s.length?s.length:r;if(s.copy(n,n.length-r,0,a),r-=a,r===0){a===s.length?(++o,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(a));break}++o}return this.length-=o,n}},{key:VRe,value:function(r,n){return rC(this,LRe({},n,{depth:0,customInspect:!1}))}}]),t}()});var iC=x((Rut,Mee)=>{"use strict";c();function zRe(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(nC,this,t)):process.nextTick(nC,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?r._writableState?r._writableState.errorEmitted?process.nextTick(fE,r):(r._writableState.errorEmitted=!0,process.nextTick(Bee,r,o)):process.nextTick(Bee,r,o):e?(process.nextTick(fE,r),e(o)):process.nextTick(fE,r)}),this)}function Bee(t,e){nC(t,e),fE(t)}function fE(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function HRe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function nC(t,e){t.emit("error",e)}function $Re(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}Mee.exports={destroy:zRe,undestroy:HRe,errorOrDestroy:$Re}});var rd=x((Tut,Kee)=>{"use strict";c();function GRe(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Fee={};function is(t,e,r){r||(r=Error);function n(o,s,a){return typeof e=="string"?e:e(o,s,a)}var i=function(o){GRe(s,o);function s(a,l,u){return o.call(this,n(a,l,u))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=t,Fee[t]=i}function Uee(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function WRe(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function jRe(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function YRe(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}is("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);is("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&WRe(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(jRe(t," argument"))i="The ".concat(t," ").concat(n," ").concat(Uee(e,"type"));else{var o=YRe(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(n," ").concat(Uee(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);is("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");is("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});is("ERR_STREAM_PREMATURE_CLOSE","Premature close");is("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});is("ERR_MULTIPLE_CALLBACK","Callback called multiple times");is("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");is("ERR_STREAM_WRITE_AFTER_END","write after end");is("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);is("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);is("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Kee.exports.codes=Fee});var oC=x((Aut,Vee)=>{"use strict";c();var QRe=rd().codes.ERR_INVALID_OPT_VALUE;function XRe(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function ZRe(t,e,r,n){var i=XRe(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=n?r:"highWaterMark";throw new QRe(o,i)}return Math.floor(i)}return t.objectMode?16:16*1024}Vee.exports={getHighWaterMark:ZRe}});var cC=x((Iut,Wee)=>{"use strict";c();Wee.exports=Yr;function zee(t){var e=this;this.next=null,this.entry=null,this.finish=function(){RTe(e,t)}}var h1;Yr.WritableState=yy;var JRe={deprecate:oI()},Hee=tC(),dE=bi().Buffer,eTe=globalThis.Uint8Array||function(){};function tTe(t){return dE.from(t)}function rTe(t){return dE.isBuffer(t)||t instanceof eTe}var aC=iC(),nTe=oC(),iTe=nTe.getHighWaterMark,ju=rd().codes,oTe=ju.ERR_INVALID_ARG_TYPE,sTe=ju.ERR_METHOD_NOT_IMPLEMENTED,aTe=ju.ERR_MULTIPLE_CALLBACK,cTe=ju.ERR_STREAM_CANNOT_PIPE,lTe=ju.ERR_STREAM_DESTROYED,uTe=ju.ERR_STREAM_NULL_VALUES,fTe=ju.ERR_STREAM_WRITE_AFTER_END,hTe=ju.ERR_UNKNOWN_ENCODING,d1=aC.errorOrDestroy;ni()(Yr,Hee);function dTe(){}function yy(t,e,r){h1=h1||nd(),t=t||{},typeof r!="boolean"&&(r=e instanceof h1),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=iTe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){bTe(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new zee(this)}yy.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(yy.prototype,"buffer",{get:JRe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var hE;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(hE=Function.prototype[Symbol.hasInstance],Object.defineProperty(Yr,Symbol.hasInstance,{value:function(e){return hE.call(this,e)?!0:this!==Yr?!1:e&&e._writableState instanceof yy}})):hE=function(e){return e instanceof this};function Yr(t){h1=h1||nd();var e=this instanceof h1;if(!e&&!hE.call(Yr,this))return new Yr(t);this._writableState=new yy(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Hee.call(this)}Yr.prototype.pipe=function(){d1(this,new cTe)};function pTe(t,e){var r=new fTe;d1(t,r),process.nextTick(e,r)}function mTe(t,e,r,n){var i;return r===null?i=new uTe:typeof r!="string"&&!e.objectMode&&(i=new oTe("chunk",["string","Buffer"],r)),i?(d1(t,i),process.nextTick(n,i),!1):!0}Yr.prototype.write=function(t,e,r){var n=this._writableState,i=!1,o=!n.objectMode&&rTe(t);return o&&!dE.isBuffer(t)&&(t=tTe(t)),typeof e=="function"&&(r=e,e=null),o?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=dTe),n.ending?pTe(this,r):(o||mTe(this,n,t,r))&&(n.pendingcb++,i=yTe(this,n,o,t,e,r)),i};Yr.prototype.cork=function(){this._writableState.corked++};Yr.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&$ee(this,t))};Yr.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new hTe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Yr.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function gTe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=dE.from(e,r)),e}Object.defineProperty(Yr.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function yTe(t,e,r,n,i,o){if(!r){var s=gTe(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else sC(t,e,!1,a,n,i,o);return l}function sC(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new lTe("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function wTe(t,e,r,n,i){--e.pendingcb,r?(process.nextTick(i,n),process.nextTick(gy,t,e),t._writableState.errorEmitted=!0,d1(t,n)):(i(n),t._writableState.errorEmitted=!0,d1(t,n),gy(t,e))}function ETe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function bTe(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new aTe;if(ETe(r),e)wTe(t,r,n,e,i);else{var o=Gee(r)||t.destroyed;!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&$ee(t,r),n?process.nextTick(qee,t,r,o,i):qee(t,r,o,i)}}function qee(t,e,r,n){r||_Te(t,e),e.pendingcb--,n(),gy(t,e)}function _Te(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function $ee(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,sC(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new zee(e),e.bufferedRequestCount=0}else{for(;r;){var l=r.chunk,u=r.encoding,f=r.callback,h=e.objectMode?1:l.length;if(sC(t,e,!1,h,l,u,f),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Yr.prototype._write=function(t,e,r){r(new sTe("_write()"))};Yr.prototype._writev=null;Yr.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||xTe(this,n,r),this};Object.defineProperty(Yr.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Gee(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function vTe(t,e){t._final(function(r){e.pendingcb--,r&&d1(t,r),e.prefinished=!0,t.emit("prefinish"),gy(t,e)})}function STe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,process.nextTick(vTe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function gy(t,e){var r=Gee(e);if(r&&(STe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function xTe(t,e,r){e.ending=!0,gy(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function RTe(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Yr.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){!this._writableState||(this._writableState.destroyed=e)}});Yr.prototype.destroy=aC.destroy;Yr.prototype._undestroy=aC.undestroy;Yr.prototype._destroy=function(t,e){e(t)}});var nd=x((Cut,Yee)=>{"use strict";c();var TTe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};Yee.exports=Ga;var jee=fC(),uC=cC();ni()(Ga,jee);for(lC=TTe(uC.prototype),pE=0;pE<lC.length;pE++)mE=lC[pE],Ga.prototype[mE]||(Ga.prototype[mE]=uC.prototype[mE]);var lC,mE,pE;function Ga(t){if(!(this instanceof Ga))return new Ga(t);jee.call(this,t),uC.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",ATe)))}Object.defineProperty(Ga.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Ga.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Ga.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ATe(){this._writableState.ended||process.nextTick(ITe,this)}function ITe(t){t.end()}Object.defineProperty(Ga.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var gE=x((Put,Zee)=>{"use strict";c();var Qee=rd().codes.ERR_STREAM_PREMATURE_CLOSE;function CTe(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function PTe(){}function NTe(t){return t.setHeader&&typeof t.abort=="function"}function Xee(t,e,r){if(typeof e=="function")return Xee(t,null,e);e||(e={}),r=CTe(r||PTe);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){i=!1,s=!0,n||r.call(t)},l=t._readableState&&t._readableState.endEmitted,u=function(){n=!1,l=!0,i||r.call(t)},f=function(m){r.call(t,m)},h=function(){var m;if(n&&!l)return(!t._readableState||!t._readableState.ended)&&(m=new Qee),r.call(t,m);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(m=new Qee),r.call(t,m)},p=function(){t.req.on("finish",a)};return NTe(t)?(t.on("complete",a),t.on("abort",h),t.req?p():t.on("request",p)):i&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",f),t.on("close",h),function(){t.removeListener("complete",a),t.removeListener("abort",h),t.removeListener("request",p),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",f),t.removeListener("close",h)}}Zee.exports=Xee});var ete=x((Nut,Jee)=>{"use strict";c();var yE;function Yu(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kTe=gE(),Qu=Symbol("lastResolve"),id=Symbol("lastReject"),wy=Symbol("error"),wE=Symbol("ended"),od=Symbol("lastPromise"),hC=Symbol("handlePromise"),sd=Symbol("stream");function Xu(t,e){return{value:t,done:e}}function DTe(t){var e=t[Qu];if(e!==null){var r=t[sd].read();r!==null&&(t[od]=null,t[Qu]=null,t[id]=null,e(Xu(r,!1)))}}function OTe(t){process.nextTick(DTe,t)}function LTe(t,e){return function(r,n){t.then(function(){if(e[wE]){r(Xu(void 0,!0));return}e[hC](r,n)},n)}}var BTe=Object.getPrototypeOf(function(){}),MTe=Object.setPrototypeOf((yE={get stream(){return this[sd]},next:function(){var e=this,r=this[wy];if(r!==null)return Promise.reject(r);if(this[wE])return Promise.resolve(Xu(void 0,!0));if(this[sd].destroyed)return new Promise(function(s,a){process.nextTick(function(){e[wy]?a(e[wy]):s(Xu(void 0,!0))})});var n=this[od],i;if(n)i=new Promise(LTe(n,this));else{var o=this[sd].read();if(o!==null)return Promise.resolve(Xu(o,!1));i=new Promise(this[hC])}return this[od]=i,i}},Yu(yE,Symbol.asyncIterator,function(){return this}),Yu(yE,"return",function(){var e=this;return new Promise(function(r,n){e[sd].destroy(null,function(i){if(i){n(i);return}r(Xu(void 0,!0))})})}),yE),BTe),UTe=function(e){var r,n=Object.create(MTe,(r={},Yu(r,sd,{value:e,writable:!0}),Yu(r,Qu,{value:null,writable:!0}),Yu(r,id,{value:null,writable:!0}),Yu(r,wy,{value:null,writable:!0}),Yu(r,wE,{value:e._readableState.endEmitted,writable:!0}),Yu(r,hC,{value:function(o,s){var a=n[sd].read();a?(n[od]=null,n[Qu]=null,n[id]=null,o(Xu(a,!1))):(n[Qu]=o,n[id]=s)},writable:!0}),r));return n[od]=null,kTe(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=n[id];o!==null&&(n[od]=null,n[Qu]=null,n[id]=null,o(i)),n[wy]=i;return}var s=n[Qu];s!==null&&(n[od]=null,n[Qu]=null,n[id]=null,s(Xu(void 0,!0))),n[wE]=!0}),e.on("readable",OTe.bind(null,n)),n};Jee.exports=UTe});var rte=x((kut,tte)=>{c();tte.exports=function(){throw new Error("Readable.from is not available in the browser")}});var fC=x((Out,hte)=>{"use strict";c();hte.exports=Ft;var p1;Ft.ReadableState=ste;var Dut=In().EventEmitter,ote=function(e,r){return e.listeners(r).length},by=tC(),EE=bi().Buffer,FTe=globalThis.Uint8Array||function(){};function KTe(t){return EE.from(t)}function VTe(t){return EE.isBuffer(t)||t instanceof FTe}var dC=jg(),mt;dC&&dC.debuglog?mt=dC.debuglog("stream"):mt=function(){};var qTe=Lee(),bC=iC(),zTe=oC(),HTe=zTe.getHighWaterMark,bE=rd().codes,$Te=bE.ERR_INVALID_ARG_TYPE,GTe=bE.ERR_STREAM_PUSH_AFTER_EOF,WTe=bE.ERR_METHOD_NOT_IMPLEMENTED,jTe=bE.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,m1,pC,mC;ni()(Ft,by);var Ey=bC.errorOrDestroy,gC=["error","close","destroy","pause","resume"];function YTe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function ste(t,e,r){p1=p1||nd(),t=t||{},typeof r!="boolean"&&(r=e instanceof p1),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=HTe(this,t,"readableHighWaterMark",r),this.buffer=new qTe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(m1||(m1=Zg().StringDecoder),this.decoder=new m1(t.encoding),this.encoding=t.encoding)}function Ft(t){if(p1=p1||nd(),!(this instanceof Ft))return new Ft(t);var e=this instanceof p1;this._readableState=new ste(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),by.call(this)}Object.defineProperty(Ft.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){!this._readableState||(this._readableState.destroyed=e)}});Ft.prototype.destroy=bC.destroy;Ft.prototype._undestroy=bC.undestroy;Ft.prototype._destroy=function(t,e){e(t)};Ft.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=EE.from(t,e),e=""),n=!0),ate(this,t,e,!1,n)};Ft.prototype.unshift=function(t){return ate(this,t,null,!0,!1)};function ate(t,e,r,n,i){mt("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,ZTe(t,o);else{var s;if(i||(s=QTe(o,e)),s)Ey(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==EE.prototype&&(e=KTe(e)),n)o.endEmitted?Ey(t,new jTe):yC(t,o,e,!0);else if(o.ended)Ey(t,new GTe);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(e=o.decoder.write(e),o.objectMode||e.length!==0?yC(t,o,e,!1):EC(t,o)):yC(t,o,e,!1)}else n||(o.reading=!1,EC(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function yC(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&_E(t)),EC(t,e)}function QTe(t,e){var r;return!VTe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new $Te("chunk",["string","Buffer","Uint8Array"],e)),r}Ft.prototype.isPaused=function(){return this._readableState.flowing===!1};Ft.prototype.setEncoding=function(t){m1||(m1=Zg().StringDecoder);var e=new m1(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var nte=1073741824;function XTe(t){return t>=nte?t=nte:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function ite(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=XTe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Ft.prototype.read=function(t){mt("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return mt("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?wC(this):_E(this),null;if(t=ite(t,e),t===0&&e.ended)return e.length===0&&wC(this),null;var n=e.needReadable;mt("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,mt("length less than watermark",n)),e.ended||e.reading?(n=!1,mt("reading or ended",n)):n&&(mt("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=ite(r,e)));var i;return t>0?i=ute(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&wC(this)),i!==null&&this.emit("data",i),i};function ZTe(t,e){if(mt("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?_E(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,cte(t)))}}function _E(t){var e=t._readableState;mt("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(mt("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(cte,t))}function cte(t){var e=t._readableState;mt("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,_C(t)}function EC(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(JTe,t,e))}function JTe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(mt("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Ft.prototype._read=function(t){Ey(this,new WTe("_read()"))};Ft.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,mt("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==process.stdout&&t!==process.stderr,o=i?a:g;n.endEmitted?process.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(y,w){mt("onunpipe"),y===r&&w&&w.hasUnpiped===!1&&(w.hasUnpiped=!0,f())}function a(){mt("onend"),t.end()}var l=eAe(r);t.on("drain",l);var u=!1;function f(){mt("cleanup"),t.removeListener("close",d),t.removeListener("finish",m),t.removeListener("drain",l),t.removeListener("error",p),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",g),r.removeListener("data",h),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&l()}r.on("data",h);function h(y){mt("ondata");var w=t.write(y);mt("dest.write",w),w===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&fte(n.pipes,t)!==-1)&&!u&&(mt("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function p(y){mt("onerror",y),g(),t.removeListener("error",p),ote(t,"error")===0&&Ey(t,y)}YTe(t,"error",p);function d(){t.removeListener("finish",m),g()}t.once("close",d);function m(){mt("onfinish"),t.removeListener("close",d),g()}t.once("finish",m);function g(){mt("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(mt("pipe resume"),r.resume()),t};function eAe(t){return function(){var r=t._readableState;mt("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&ote(t,"data")&&(r.flowing=!0,_C(t))}}Ft.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=fte(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Ft.prototype.on=function(t,e){var r=by.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,mt("on readable",n.length,n.reading),n.length?_E(this):n.reading||process.nextTick(tAe,this)),r};Ft.prototype.addListener=Ft.prototype.on;Ft.prototype.removeListener=function(t,e){var r=by.prototype.removeListener.call(this,t,e);return t==="readable"&&process.nextTick(lte,this),r};Ft.prototype.removeAllListeners=function(t){var e=by.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&process.nextTick(lte,this),e};function lte(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function tAe(t){mt("readable nexttick read 0"),t.read(0)}Ft.prototype.resume=function(){var t=this._readableState;return t.flowing||(mt("resume"),t.flowing=!t.readableListening,rAe(this,t)),t.paused=!1,this};function rAe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(nAe,t,e))}function nAe(t,e){mt("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),_C(t),e.flowing&&!e.reading&&t.read(0)}Ft.prototype.pause=function(){return mt("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(mt("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function _C(t){var e=t._readableState;for(mt("flow",e.flowing);e.flowing&&t.read()!==null;);}Ft.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(mt("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(mt("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!(r.objectMode&&s==null)&&!(!r.objectMode&&(!s||!s.length))){var a=e.push(s);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var o=0;o<gC.length;o++)t.on(gC[o],this.emit.bind(this,gC[o]));return this._read=function(s){mt("wrapped _read",s),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(Ft.prototype[Symbol.asyncIterator]=function(){return pC===void 0&&(pC=ete()),pC(this)});Object.defineProperty(Ft.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Ft.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Ft.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Ft._fromList=ute;Object.defineProperty(Ft.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ute(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function wC(t){var e=t._readableState;mt("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(iAe,e,t))}function iAe(t,e){if(mt("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Ft.from=function(t,e){return mC===void 0&&(mC=rte()),mC(Ft,t,e)});function fte(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var vC=x((Lut,pte)=>{"use strict";c();pte.exports=el;var vE=rd().codes,oAe=vE.ERR_METHOD_NOT_IMPLEMENTED,sAe=vE.ERR_MULTIPLE_CALLBACK,aAe=vE.ERR_TRANSFORM_ALREADY_TRANSFORMING,cAe=vE.ERR_TRANSFORM_WITH_LENGTH_0,SE=nd();ni()(el,SE);function lAe(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new sAe);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function el(t){if(!(this instanceof el))return new el(t);SE.call(this,t),this._transformState={afterTransform:lAe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",uAe)}function uAe(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){dte(t,e,r)}):dte(this,null,null)}el.prototype.push=function(t,e){return this._transformState.needTransform=!1,SE.prototype.push.call(this,t,e)};el.prototype._transform=function(t,e,r){r(new oAe("_transform()"))};el.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};el.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};el.prototype._destroy=function(t,e){SE.prototype._destroy.call(this,t,function(r){e(r)})};function dte(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new cAe;if(t._transformState.transforming)throw new aAe;return t.push(null)}});var yte=x((But,gte)=>{"use strict";c();gte.exports=_y;var mte=vC();ni()(_y,mte);function _y(t){if(!(this instanceof _y))return new _y(t);mte.call(this,t)}_y.prototype._transform=function(t,e,r){r(null,t)}});var vte=x((Mut,_te)=>{"use strict";c();var SC;function fAe(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var bte=rd().codes,hAe=bte.ERR_MISSING_ARGS,dAe=bte.ERR_STREAM_DESTROYED;function wte(t){if(t)throw t}function pAe(t){return t.setHeader&&typeof t.abort=="function"}function mAe(t,e,r,n){n=fAe(n);var i=!1;t.on("close",function(){i=!0}),SC===void 0&&(SC=gE()),SC(t,{readable:e,writable:r},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,pAe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(s||new dAe("pipe"))}}}function Ete(t){t()}function gAe(t,e){return t.pipe(e)}function yAe(t){return!t.length||typeof t[t.length-1]!="function"?wte:t.pop()}function wAe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=yAe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new hAe("streams");var i,o=e.map(function(s,a){var l=a<e.length-1,u=a>0;return mAe(s,l,u,function(f){i||(i=f),f&&o.forEach(Ete),!l&&(o.forEach(Ete),n(i))})});return e.reduce(gAe)}_te.exports=wAe});var xte=x((os,Ste)=>{c();os=Ste.exports=fC();os.Stream=os;os.Readable=os;os.Writable=cC();os.Duplex=nd();os.Transform=vC();os.PassThrough=yte();os.finished=gE();os.pipeline=vte()});var xC=x((Uut,Tte)=>{"use strict";c();var{Readable:EAe}=xte(),Rte=Fp(),bAe=(t=1/0)=>{let e=0;return new EAe({read(r){if(e>=t)return this.push(null);e+r>=t&&(r=t-e),e+=r,this.push(Rte(r))}})};Tte.exports={randomStream:bAe,randomBytes:Rte}});var ane=x((I1t,sne)=>{c();sne.exports=t=>{if(t[Symbol.asyncIterator])return t;if(t.getReader)return async function*(){let e=t.getReader();try{for(;;){let{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}();throw new Error("unknown stream")}});var VC=x(()=>{c()});var qC=x((vwt,Zie)=>{"use strict";c();var OIe=Ip(),LIe=(t,e)=>({path:decodeURIComponent(new URL(t).pathname.split("/").pop()||""),content:BIe(t,e)});async function*BIe(t,e){yield*(await new OIe().get(t,e)).iterator()}Zie.exports=LIe});var tP=x(($5t,eP)=>{"use strict";c();var fCe=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),Aoe=()=>{let t=new Error("Delay aborted");return t.name="AbortError",t},Ioe=({clearTimeout:t,setTimeout:e,willResolve:r})=>(n,{value:i,signal:o}={})=>{if(o&&o.aborted)return Promise.reject(Aoe());let s,a,l,u=t||clearTimeout,f=()=>{u(s),l(Aoe())},h=()=>{o&&o.removeEventListener("abort",f)},p=new Promise((d,m)=>{a=()=>{h(),r?d(i):m(i)},l=m,s=(e||setTimeout)(a,n)});return o&&o.addEventListener("abort",f,{once:!0}),p.clear=()=>{u(s),s=null,a()},p},Coe=t=>{let e=Ioe({...t,willResolve:!0});return e.reject=Ioe({...t,willResolve:!1}),e.range=(r,n,i)=>e(fCe(r,n),i),e},JC=Coe();JC.createWithTimers=Coe;eP.exports=JC;eP.exports.default=JC});var lP=x((rEt,Goe)=>{"use strict";c();var k1=new Map,vCe=()=>`${Date.now()}:${Math.floor(Math.random()*1e6)}`;async function SCe(t,e,r){for(;k1.get(r);){try{await t()}catch(n){setTimeout(()=>{throw n},1);break}if(!k1.get(r))break;await new Promise(n=>{let i=setTimeout(n,e);k1.set(r,i)})}}function xCe(t,e,r){r=r||e;let n=vCe(),i=setTimeout(()=>{SCe(t,e,n)},r);return k1.set(n,i),n}function RCe(t){let e=k1.get(t);e&&(clearTimeout(e),k1.delete(t))}Goe.exports={setDelayedInterval:xCe,clearDelayedInterval:RCe}});var nse=x((PEt,rse)=>{"use strict";c();var PCe=()=>{let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t};rse.exports=PCe});var ase=x((kEt,sse)=>{c();var ise=e0(),ose=nse();sse.exports=class{constructor(){this._buffer=new ise,this._waitingConsumers=new ise}push(e){let{promise:r,resolve:n}=ose();return this._buffer.push({chunk:e,resolve:n}),this._consume(),r}_consume(){for(;!this._waitingConsumers.isEmpty()&&!this._buffer.isEmpty();){let e=this._waitingConsumers.shift(),r=this._buffer.shift();e.resolve(r.chunk),r.resolve()}}shift(){let{promise:e,resolve:r}=ose();return this._waitingConsumers.push({resolve:r}),this._consume(),e}isEmpty(){return this._buffer.isEmpty()}}});var fse=x(Zy=>{c();(function(){var t,e,r,n,i,o,s,a;a=function(l){var u,f,h,p;return u=(l&255<<24)>>>24,f=(l&255<<16)>>>16,h=(l&255<<8)>>>8,p=l&255,[u,f,h,p].join(".")},s=function(l){var u,f,h,p,d,m;for(u=[],h=p=0;p<=3&&l.length!==0;h=++p){if(h>0){if(l[0]!==".")throw new Error("Invalid IP");l=l.substring(1)}m=e(l),d=m[0],f=m[1],l=l.substring(f),u.push(d)}if(l.length!==0)throw new Error("Invalid IP");switch(u.length){case 1:if(u[0]>4294967295)throw new Error("Invalid IP");return u[0]>>>0;case 2:if(u[0]>255||u[1]>16777215)throw new Error("Invalid IP");return(u[0]<<24|u[1])>>>0;case 3:if(u[0]>255||u[1]>255||u[2]>65535)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2])>>>0;case 4:if(u[0]>255||u[1]>255||u[2]>255||u[3]>255)throw new Error("Invalid IP");return(u[0]<<24|u[1]<<16|u[2]<<8|u[3])>>>0;default:throw new Error("Invalid IP")}},r=function(l){return l.charCodeAt(0)},n=r("0"),o=r("a"),i=r("A"),e=function(l){var u,f,h,p,d;for(p=0,u=10,f="9",h=0,l.length>1&&l[h]==="0"&&(l[h+1]==="x"||l[h+1]==="X"?(h+=2,u=16):"0"<=l[h+1]&&l[h+1]<="9"&&(h++,u=8,f="7")),d=h;h<l.length;){if("0"<=l[h]&&l[h]<=f)p=p*u+(r(l[h])-n)>>>0;else if(u===16)if("a"<=l[h]&&l[h]<="f")p=p*u+(10+r(l[h])-o)>>>0;else if("A"<=l[h]&&l[h]<="F")p=p*u+(10+r(l[h])-i)>>>0;else break;else break;if(p>4294967295)throw new Error("too large");h++}if(h===d)throw new Error("empty octet");return[p,h]},t=function(){function l(u,f){var h,p,d,m;if(typeof u!="string")throw new Error("Missing `net' parameter");if(f||(m=u.split("/",2),u=m[0],f=m[1]),f||(f=32),typeof f=="string"&&f.indexOf(".")>-1){try{this.maskLong=s(f)}catch(g){throw h=g,new Error("Invalid mask: "+f)}for(p=d=32;d>=0;p=--d)if(this.maskLong===4294967295<<32-p>>>0){this.bitmask=p;break}}else if(f||f===0)this.bitmask=parseInt(f,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(s(u)&this.maskLong)>>>0}catch(g){throw h=g,new Error("Invalid net address: "+u)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+f);this.size=Math.pow(2,32-this.bitmask),this.base=a(this.netLong),this.mask=a(this.maskLong),this.hostmask=a(~this.maskLong),this.first=this.bitmask<=30?a(this.netLong+1):this.base,this.last=this.bitmask<=30?a(this.netLong+this.size-2):a(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?a(this.netLong+this.size-1):void 0}return l.prototype.contains=function(u){return typeof u=="string"&&(u.indexOf("/")>0||u.split(".").length!==4)&&(u=new l(u)),u instanceof l?this.contains(u.base)&&this.contains(u.broadcast||u.last):(s(u)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},l.prototype.next=function(u){return u==null&&(u=1),new l(a(this.netLong+this.size*u),this.mask)},l.prototype.forEach=function(u){var f,h,p;for(p=s(this.first),h=s(this.last),f=0;p<=h;)u(a(p),p,f),f++,p++},l.prototype.toString=function(){return this.base+"/"+this.bitmask},l}(),Zy.ip2long=s,Zy.long2ip=a,Zy.Netmask=t}).call(Zy)});var gP=x((MEt,dse)=>{"use strict";c();var hse="[a-fA-F\\d:]",of=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${hse})|(?<=${hse})(?=\\s|$))`:"",Xs="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",_n="[a-fA-F\\d]{1,4}",Rb=`
(?:
(?:${_n}:){7}(?:${_n}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${_n}:){6}(?:${Xs}|:${_n}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${_n}:){5}(?::${Xs}|(?::${_n}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${_n}:){4}(?:(?::${_n}){0,1}:${Xs}|(?::${_n}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${_n}:){3}(?:(?::${_n}){0,2}:${Xs}|(?::${_n}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${_n}:){2}(?:(?::${_n}){0,3}:${Xs}|(?::${_n}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${_n}:){1}(?:(?::${_n}){0,4}:${Xs}|(?::${_n}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${_n}){0,5}:${Xs}|(?::${_n}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),NCe=new RegExp(`(?:^${Xs}$)|(?:^${Rb}$)`),kCe=new RegExp(`^${Xs}$`),DCe=new RegExp(`^${Rb}$`),mP=t=>t&&t.exact?NCe:new RegExp(`(?:${of(t)}${Xs}${of(t)})|(?:${of(t)}${Rb}${of(t)})`,"g");mP.v4=t=>t&&t.exact?kCe:new RegExp(`${of(t)}${Xs}${of(t)}`,"g");mP.v6=t=>t&&t.exact?DCe:new RegExp(`${of(t)}${Rb}${of(t)}`,"g");dse.exports=mP});var mse=x((UEt,pse)=>{"use strict";c();var yP=gP(),D1=t=>yP({exact:!0}).test(t);D1.v4=t=>yP.v4({exact:!0}).test(t);D1.v6=t=>yP.v6({exact:!0}).test(t);D1.version=t=>D1(t)?D1.v4(t)?4:6:void 0;pse.exports=D1});var yse=x((gse,Tb)=>{c();(function(t){"use strict";let e="(0?\\d+|0x[a-f0-9]+)",r={fourOctet:new RegExp(`^${e}\\.${e}\\.${e}\\.${e}$`,"i"),threeOctet:new RegExp(`^${e}\\.${e}\\.${e}$`,"i"),twoOctet:new RegExp(`^${e}\\.${e}$`,"i"),longValue:new RegExp(`^${e}$`,"i")},n=new RegExp("^0[0-7]+$","i"),i=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",s="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${s})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${e}\\.${e}\\.${e}\\.${e}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${s})|(?:::)(?:${s})?)${e}\\.${e}\\.${e}\\.${e}(${o})?$`,"i")};function l(d,m){if(d.indexOf("::")!==d.lastIndexOf("::"))return null;let g=0,y=-1,w=(d.match(a.zoneIndex)||[])[0],b,v;for(w&&(w=w.substring(1),d=d.replace(/%.+$/,""));(y=d.indexOf(":",y+1))>=0;)g++;if(d.substr(0,2)==="::"&&g--,d.substr(-2,2)==="::"&&g--,g>m)return null;for(v=m-g,b=":";v--;)b+="0:";return d=d.replace("::",b),d[0]===":"&&(d=d.slice(1)),d[d.length-1]===":"&&(d=d.slice(0,-1)),m=function(){let S=d.split(":"),R=[];for(let I=0;I<S.length;I++)R.push(parseInt(S[I],16));return R}(),{parts:m,zoneId:w}}function u(d,m,g,y){if(d.length!==m.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let w=0,b;for(;y>0;){if(b=g-y,b<0&&(b=0),d[w]>>b!==m[w]>>b)return!1;y-=g,w+=1}return!0}function f(d){if(i.test(d))return parseInt(d,16);if(d[0]==="0"&&!isNaN(parseInt(d[1],10))){if(n.test(d))return parseInt(d,8);throw new Error(`ipaddr: cannot parse ${d} as octal`)}return parseInt(d,10)}function h(d,m){for(;d.length<m;)d=`0${d}`;return d}let p={};p.IPv4=function(){function d(m){if(m.length!==4)throw new Error("ipaddr: ipv4 octet count should be 4");let g,y;for(g=0;g<m.length;g++)if(y=m[g],!(0<=y&&y<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=m}return d.prototype.SpecialRanges={unspecified:[[new d([0,0,0,0]),8]],broadcast:[[new d([255,255,255,255]),32]],multicast:[[new d([224,0,0,0]),4]],linkLocal:[[new d([169,254,0,0]),16]],loopback:[[new d([127,0,0,0]),8]],carrierGradeNat:[[new d([100,64,0,0]),10]],private:[[new d([10,0,0,0]),8],[new d([172,16,0,0]),12],[new d([192,168,0,0]),16]],reserved:[[new d([192,0,0,0]),24],[new d([192,0,2,0]),24],[new d([192,88,99,0]),24],[new d([198,51,100,0]),24],[new d([203,0,113,0]),24],[new d([240,0,0,0]),4]]},d.prototype.kind=function(){return"ipv4"},d.prototype.match=function(m,g){let y;if(g===void 0&&(y=m,m=y[0],g=y[1]),m.kind()!=="ipv4")throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,m.octets,8,g)},d.prototype.prefixLengthFromSubnetMask=function(){let m=0,g=!1,y={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},w,b,v;for(w=3;w>=0;w-=1)if(b=this.octets[w],b in y){if(v=y[b],g&&v!==0)return null;v!==8&&(g=!0),m+=v}else return null;return 32-m},d.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){return this.octets.slice(0)},d.prototype.toIPv4MappedAddress=function(){return p.IPv6.parse(`::ffff:${this.toString()}`)},d.prototype.toNormalizedString=function(){return this.toString()},d.prototype.toString=function(){return this.octets.join(".")},d}(),p.IPv4.broadcastAddressFromCIDR=function(d){try{let m=this.parseCIDR(d),g=m[0].toByteArray(),y=this.subnetMaskFromPrefixLength(m[1]).toByteArray(),w=[],b=0;for(;b<4;)w.push(parseInt(g[b],10)|parseInt(y[b],10)^255),b++;return new this(w)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.isIPv4=function(d){return this.parser(d)!==null},p.IPv4.isValid=function(d){try{return new this(this.parser(d)),!0}catch{return!1}},p.IPv4.isValidFourPartDecimal=function(d){return!!(p.IPv4.isValid(d)&&d.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},p.IPv4.networkAddressFromCIDR=function(d){let m,g,y,w,b;try{for(m=this.parseCIDR(d),y=m[0].toByteArray(),b=this.subnetMaskFromPrefixLength(m[1]).toByteArray(),w=[],g=0;g<4;)w.push(parseInt(y[g],10)&parseInt(b[g],10)),g++;return new this(w)}catch{throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},p.IPv4.parse=function(d){let m=this.parser(d);if(m===null)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(m)},p.IPv4.parseCIDR=function(d){let m;if(m=d.match(/^(.+)\/(\d+)$/)){let g=parseInt(m[2]);if(g>=0&&g<=32){let y=[this.parse(m[1]),g];return Object.defineProperty(y,"toString",{value:function(){return this.join("/")}}),y}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},p.IPv4.parser=function(d){let m,g,y;if(m=d.match(r.fourOctet))return function(){let w=m.slice(1,6),b=[];for(let v=0;v<w.length;v++)g=w[v],b.push(f(g));return b}();if(m=d.match(r.longValue)){if(y=f(m[1]),y>4294967295||y<0)throw new Error("ipaddr: address outside defined range");return function(){let w=[],b;for(b=0;b<=24;b+=8)w.push(y>>b&255);return w}().reverse()}else return(m=d.match(r.twoOctet))?function(){let w=m.slice(1,4),b=[];if(y=f(w[1]),y>16777215||y<0)throw new Error("ipaddr: address outside defined range");return b.push(f(w[0])),b.push(y>>16&255),b.push(y>>8&255),b.push(y&255),b}():(m=d.match(r.threeOctet))?function(){let w=m.slice(1,5),b=[];if(y=f(w[2]),y>65535||y<0)throw new Error("ipaddr: address outside defined range");return b.push(f(w[0])),b.push(f(w[1])),b.push(y>>8&255),b.push(y&255),b}():null},p.IPv4.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>32)throw new Error("ipaddr: invalid IPv4 prefix length");let m=[0,0,0,0],g=0,y=Math.floor(d/8);for(;g<y;)m[g]=255,g++;return y<4&&(m[y]=Math.pow(2,d%8)-1<<8-d%8),new this(m)},p.IPv6=function(){function d(m,g){let y,w;if(m.length===16)for(this.parts=[],y=0;y<=14;y+=2)this.parts.push(m[y]<<8|m[y+1]);else if(m.length===8)this.parts=m;else throw new Error("ipaddr: ipv6 part count should be 8 or 16");for(y=0;y<this.parts.length;y++)if(w=this.parts[y],!(0<=w&&w<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");g&&(this.zoneId=g)}return d.prototype.SpecialRanges={unspecified:[new d([0,0,0,0,0,0,0,0]),128],linkLocal:[new d([65152,0,0,0,0,0,0,0]),10],multicast:[new d([65280,0,0,0,0,0,0,0]),8],loopback:[new d([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new d([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new d([0,0,0,0,0,65535,0,0]),96],rfc6145:[new d([0,0,0,0,65535,0,0,0]),96],rfc6052:[new d([100,65435,0,0,0,0,0,0]),96],"6to4":[new d([8194,0,0,0,0,0,0,0]),16],teredo:[new d([8193,0,0,0,0,0,0,0]),32],reserved:[[new d([8193,3512,0,0,0,0,0,0]),32]]},d.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"},d.prototype.kind=function(){return"ipv6"},d.prototype.match=function(m,g){let y;if(g===void 0&&(y=m,m=y[0],g=y[1]),m.kind()!=="ipv6")throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,m.parts,16,g)},d.prototype.prefixLengthFromSubnetMask=function(){let m=0,g=!1,y={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0},w,b;for(let v=7;v>=0;v-=1)if(w=this.parts[v],w in y){if(b=y[w],g&&b!==0)return null;b!==16&&(g=!0),m+=b}else return null;return 128-m},d.prototype.range=function(){return p.subnetMatch(this,this.SpecialRanges)},d.prototype.toByteArray=function(){let m,g=[],y=this.parts;for(let w=0;w<y.length;w++)m=y[w],g.push(m>>8),g.push(m&255);return g},d.prototype.toFixedLengthString=function(){let m=function(){let y=[];for(let w=0;w<this.parts.length;w++)y.push(h(this.parts[w].toString(16),4));return y}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),m+g},d.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");let m=this.parts.slice(-2),g=m[0],y=m[1];return new p.IPv4([g>>8,g&255,y>>8,y&255])},d.prototype.toNormalizedString=function(){let m=function(){let y=[];for(let w=0;w<this.parts.length;w++)y.push(this.parts[w].toString(16));return y}.call(this).join(":"),g="";return this.zoneId&&(g=`%${this.zoneId}`),m+g},d.prototype.toRFC5952String=function(){let m=/((^|:)(0(:|$)){2,})/g,g=this.toNormalizedString(),y=0,w=-1,b;for(;b=m.exec(g);)b[0].length>w&&(y=b.index,w=b[0].length);return w<0?g:`${g.substring(0,y)}::${g.substring(y+w)}`},d.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},d}(),p.IPv6.broadcastAddressFromCIDR=function(d){try{let m=this.parseCIDR(d),g=m[0].toByteArray(),y=this.subnetMaskFromPrefixLength(m[1]).toByteArray(),w=[],b=0;for(;b<16;)w.push(parseInt(g[b],10)|parseInt(y[b],10)^255),b++;return new this(w)}catch(m){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${m})`)}},p.IPv6.isIPv6=function(d){return this.parser(d)!==null},p.IPv6.isValid=function(d){if(typeof d=="string"&&d.indexOf(":")===-1)return!1;try{let m=this.parser(d);return new this(m.parts,m.zoneId),!0}catch{return!1}},p.IPv6.networkAddressFromCIDR=function(d){let m,g,y,w,b;try{for(m=this.parseCIDR(d),y=m[0].toByteArray(),b=this.subnetMaskFromPrefixLength(m[1]).toByteArray(),w=[],g=0;g<16;)w.push(parseInt(y[g],10)&parseInt(b[g],10)),g++;return new this(w)}catch(v){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${v})`)}},p.IPv6.parse=function(d){let m=this.parser(d);if(m.parts===null)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(m.parts,m.zoneId)},p.IPv6.parseCIDR=function(d){let m,g,y;if((g=d.match(/^(.+)\/(\d+)$/))&&(m=parseInt(g[2]),m>=0&&m<=128))return y=[this.parse(g[1]),m],Object.defineProperty(y,"toString",{value:function(){return this.join("/")}}),y;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},p.IPv6.parser=function(d){let m,g,y,w,b,v;if(y=d.match(a.deprecatedTransitional))return this.parser(`::ffff:${y[1]}`);if(a.native.test(d))return l(d,8);if((y=d.match(a.transitional))&&(v=y[6]||"",m=l(y[1].slice(0,-1)+v,6),m.parts)){for(b=[parseInt(y[2]),parseInt(y[3]),parseInt(y[4]),parseInt(y[5])],g=0;g<b.length;g++)if(w=b[g],!(0<=w&&w<=255))return null;return m.parts.push(b[0]<<8|b[1]),m.parts.push(b[2]<<8|b[3]),{parts:m.parts,zoneId:m.zoneId}}return null},p.IPv6.subnetMaskFromPrefixLength=function(d){if(d=parseInt(d),d<0||d>128)throw new Error("ipaddr: invalid IPv6 prefix length");let m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,y=Math.floor(d/8);for(;g<y;)m[g]=255,g++;return y<16&&(m[y]=Math.pow(2,d%8)-1<<8-d%8),new this(m)},p.fromByteArray=function(d){let m=d.length;if(m===4)return new p.IPv4(d);if(m===16)return new p.IPv6(d);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},p.isValid=function(d){return p.IPv6.isValid(d)||p.IPv4.isValid(d)},p.parse=function(d){if(p.IPv6.isValid(d))return p.IPv6.parse(d);if(p.IPv4.isValid(d))return p.IPv4.parse(d);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},p.parseCIDR=function(d){try{return p.IPv6.parseCIDR(d)}catch{try{return p.IPv4.parseCIDR(d)}catch{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},p.process=function(d){let m=this.parse(d);return m.kind()==="ipv6"&&m.isIPv4MappedAddress()?m.toIPv4Address():m},p.subnetMatch=function(d,m,g){let y,w,b,v;g==null&&(g="unicast");for(w in m)if(Object.prototype.hasOwnProperty.call(m,w)){for(b=m[w],b[0]&&!(b[0]instanceof Array)&&(b=[b]),y=0;y<b.length;y++)if(v=b[y],d.kind()===v[0].kind()&&d.match.apply(d,v))return w}return g},typeof Tb<"u"&&Tb.exports?Tb.exports=p:t.ipaddr=p})(gse)});var _se=x(Jy=>{"use strict";c();var bse=Jy&&Jy.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Jy,"__esModule",{value:!0});var OCe=fse(),LCe=bse(gP()),BCe=bse(mse()),wse=yse(),MCe=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],UCe=MCe.map(t=>new OCe.Netmask(t));function FCe(t){for(let e of UCe)if(e.contains(t))return!0;return!1}function Ese(t){return/^::$/.test(t)||/^::1$/.test(t)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(t)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(t)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(t)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(t)||/^ff([0-9a-fA-F]{2,2}):/i.test(t)}Jy.default=t=>{if(wse.isValid(t)){let e=wse.parse(t);if(e.kind()==="ipv4")return FCe(e.toNormalizedString());if(e.kind()==="ipv6")return Ese(t)}else if(BCe.default(t)&&LCe.default.v6().test(t))return Ese(t)}});var Ab=x((KEt,vse)=>{"use strict";c();vse.exports=_se().default});var Zse=x((k_t,Xse)=>{"use strict";c();function ZCe(t){return t>=55296&&t<=56319}function JCe(t){return t>=56320&&t<=57343}Xse.exports=function(e,r,n){if(typeof r!="string")throw new Error("Input must be string");for(var i=r.length,o=0,s,a,l=0;l<i;l+=1){if(s=r.charCodeAt(l),a=r[l],ZCe(s)&&JCe(r.charCodeAt(l+1))&&(l+=1,a+=r[l]),o+=e(a),o===n)return r.slice(0,l+1);if(o>n)return r.slice(0,l-a.length+1)}return r}});var eae=x((D_t,Jse)=>{"use strict";c();function ePe(t){return t>=55296&&t<=56319}function tPe(t){return t>=56320&&t<=57343}Jse.exports=function(e){if(typeof e!="string")throw new Error("Input must be string");for(var r=e.length,n=0,i=null,o=null,s=0;s<r;s++)i=e.charCodeAt(s),tPe(i)?o!=null&&ePe(o)?n+=1:n+=3:i<=127?n+=1:i>=128&&i<=2047?n+=2:i>=2048&&i<=65535&&(n+=3),o=i;return n}});var rae=x((O_t,tae)=>{"use strict";c();var rPe=Zse(),nPe=eae();tae.exports=rPe.bind(null,nPe)});var oae=x((L_t,iae)=>{"use strict";c();var iPe=rae(),oPe=/[\/\?<>\\:\*\|"]/g,sPe=/[\x00-\x1f\x80-\x9f]/g,aPe=/^\.+$/,cPe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,lPe=/[\. ]+$/;function nae(t,e){if(typeof t!="string")throw new Error("Input must be string");var r=t.replace(oPe,e).replace(sPe,e).replace(aPe,e).replace(cPe,e).replace(lPe,e);return iPe(r,255)}iae.exports=function(t,e){var r=e&&e.replacement||"",n=nae(t,r);return r===""?n:nae(n,"")}});var lae=x((B_t,cae)=>{c();var B1=wt();Xl();Er();var fe=B1.asn1,M1=cae.exports=B1.pkcs7asn1=B1.pkcs7asn1||{};B1.pkcs7=B1.pkcs7||{};B1.pkcs7.asn1=M1;var sae={name:"ContentInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:fe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};M1.contentInfoValidator=sae;var aae={name:"EncryptedContentInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:fe.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:fe.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};M1.envelopedDataValidator={name:"EnvelopedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(aae)};M1.encryptedDataValidator={name:"EncryptedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"version"}].concat(aae)};var uPe={name:"SignerInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:fe.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:fe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:fe.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};M1.signedDataValidator={name:"SignedData",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},sae,{name:"SignedData.Certificates",tagClass:fe.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:fe.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SET,capture:"signerInfos",optional:!0,value:[uPe]}]};M1.recipientInfoValidator={name:"RecipientInfo",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:fe.Class.UNIVERSAL,type:fe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:fe.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:fe.Class.UNIVERSAL,type:fe.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var fae=x((M_t,uae)=>{c();var wd=wt();Er();wd.mgf=wd.mgf||{};var fPe=uae.exports=wd.mgf.mgf1=wd.mgf1=wd.mgf1||{};fPe.create=function(t){var e={generate:function(r,n){for(var i=new wd.util.ByteBuffer,o=Math.ceil(n/t.digestLength),s=0;s<o;s++){var a=new wd.util.ByteBuffer;a.putInt32(s),t.start(),t.update(r+a.getBytes()),i.putBuffer(t.digest())}return i.truncate(i.length()-n),i.getBytes()}};return e}});var dae=x((U_t,hae)=>{c();var Ub=wt();fae();hae.exports=Ub.mgf=Ub.mgf||{};Ub.mgf.mgf1=Ub.mgf1});var mae=x((F_t,pae)=>{c();var Ed=wt();Qf();Er();var hPe=pae.exports=Ed.pss=Ed.pss||{};hPe.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,i=t.salt||null;typeof i=="string"&&(i=Ed.util.createBuffer(i));var o;if("saltLength"in t)o=t.saltLength;else if(i!==null)o=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==o)throw new Error("Given salt length does not match length of given salt.");var s=t.prng||Ed.random,a={};return a.encode=function(l,u){var f,h=u-1,p=Math.ceil(h/8),d=l.digest().getBytes();if(p<n+o+2)throw new Error("Message is too long to encrypt.");var m;i===null?m=s.getBytesSync(o):m=i.bytes();var g=new Ed.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(d),g.putBytes(m),e.start(),e.update(g.getBytes());var y=e.digest().getBytes(),w=new Ed.util.ByteBuffer;w.fillWithByte(0,p-o-n-2),w.putByte(1),w.putBytes(m);var b=w.getBytes(),v=p-n-1,S=r.generate(y,v),R="";for(f=0;f<v;f++)R+=String.fromCharCode(b.charCodeAt(f)^S.charCodeAt(f));var I=65280>>8*p-h&255;return R=String.fromCharCode(R.charCodeAt(0)&~I)+R.substr(1),R+y+String.fromCharCode(188)},a.verify=function(l,u,f){var h,p=f-1,d=Math.ceil(p/8);if(u=u.substr(-d),d<n+o+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(d-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var m=d-n-1,g=u.substr(0,m),y=u.substr(m,n),w=65280>>8*d-p&255;if((g.charCodeAt(0)&w)!==0)throw new Error("Bits beyond keysize not zero as expected.");var b=r.generate(y,m),v="";for(h=0;h<m;h++)v+=String.fromCharCode(g.charCodeAt(h)^b.charCodeAt(h));v=String.fromCharCode(v.charCodeAt(0)&~w)+v.substr(1);var S=d-n-o-2;for(h=0;h<S;h++)if(v.charCodeAt(h)!==0)throw new Error("Leftmost octets not zero as expected");if(v.charCodeAt(S)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var R=v.substr(-o),I=new Ed.util.ByteBuffer;I.fillWithByte(0,8),I.putBytes(l),I.putBytes(R),e.start(),e.update(I.getBytes());var A=e.digest().getBytes();return y===A},a}});var PP=x((K_t,bae)=>{c();var ke=wt();Lp();Xl();Iw();Zl();dae();kp();kw();mae();y2();Er();var _=ke.asn1,ne=bae.exports=ke.pki=ke.pki||{},Ot=ne.oids,Qr={};Qr.CN=Ot.commonName;Qr.commonName="CN";Qr.C=Ot.countryName;Qr.countryName="C";Qr.L=Ot.localityName;Qr.localityName="L";Qr.ST=Ot.stateOrProvinceName;Qr.stateOrProvinceName="ST";Qr.O=Ot.organizationName;Qr.organizationName="O";Qr.OU=Ot.organizationalUnitName;Qr.organizationalUnitName="OU";Qr.E=Ot.emailAddress;Qr.emailAddress="E";var yae=ke.pki.rsa.publicKeyValidator,dPe={name:"Certificate",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:_.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:_.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:_.Class.UNIVERSAL,type:_.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:_.Class.UNIVERSAL,type:_.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:_.Class.UNIVERSAL,type:_.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:_.Class.UNIVERSAL,type:_.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},yae,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:_.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:_.Class.UNIVERSAL,type:_.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:_.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:_.Class.UNIVERSAL,type:_.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:_.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:_.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:_.Class.UNIVERSAL,type:_.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},pPe={name:"rsapss",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:_.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:_.Class.UNIVERSAL,type:_.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:_.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:_.Class.UNIVERSAL,type:_.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:_.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:_.Class.UNIVERSAL,type:_.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:_.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:_.Class.UNIVERSAL,type:_.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},mPe={name:"CertificationRequestInfo",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:_.Class.UNIVERSAL,type:_.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},yae,{name:"CertificationRequestInfo.attributes",tagClass:_.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:_.Class.UNIVERSAL,type:_.Type.SET,constructed:!0}]}]}]},gPe={name:"CertificationRequest",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[mPe,{name:"CertificationRequest.signatureAlgorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:_.Class.UNIVERSAL,type:_.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:_.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:_.Class.UNIVERSAL,type:_.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};ne.RDNAttributesAsArray=function(t,e){for(var r=[],n,i,o,s=0;s<t.value.length;++s){n=t.value[s];for(var a=0;a<n.value.length;++a)o={},i=n.value[a],o.type=_.derToOid(i.value[0].value),o.value=i.value[1].value,o.valueTagClass=i.value[1].type,o.type in Ot&&(o.name=Ot[o.type],o.name in Qr&&(o.shortName=Qr[o.name])),e&&(e.update(o.type),e.update(o.value)),r.push(o)}return r};ne.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],i=_.derToOid(n.value[0].value),o=n.value[1].value,s=0;s<o.length;++s){var a={};if(a.type=i,a.value=o[s].value,a.valueTagClass=o[s].type,a.type in Ot&&(a.name=Ot[a.type],a.name in Qr&&(a.shortName=Qr[a.name])),a.type===Ot.extensionRequest){a.extensions=[];for(var l=0;l<a.value.length;++l)a.extensions.push(ne.certificateExtensionFromAsn1(a.value[l]))}e.push(a)}return e};function af(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,i=0;r===null&&i<t.attributes.length;++i)n=t.attributes[i],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var Fb=function(t,e,r){var n={};if(t!==Ot["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:Ot.sha1},mgf:{algorithmOid:Ot.mgf1,hash:{algorithmOid:Ot.sha1}},saltLength:20});var i={},o=[];if(!_.validate(e,pPe,i,o)){var s=new Error("Cannot read RSASSA-PSS parameter block.");throw s.errors=o,s}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=_.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=_.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=_.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},Kb=function(t){switch(Ot[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return ke.md.sha1.create();case"md5WithRSAEncryption":return ke.md.md5.create();case"sha256WithRSAEncryption":return ke.md.sha256.create();case"sha384WithRSAEncryption":return ke.md.sha384.create();case"sha512WithRSAEncryption":return ke.md.sha512.create();case"RSASSA-PSS":return ke.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},wae=function(t){var e=t.certificate,r;switch(e.signatureOid){case Ot.sha1WithRSAEncryption:case Ot.sha1WithRSASignature:break;case Ot["RSASSA-PSS"]:var n,i;if(n=Ot[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||ke.md[n]===void 0){var o=new Error("Unsupported MGF hash function.");throw o.oid=e.signatureParameters.mgf.hash.algorithmOid,o.name=n,o}if(i=Ot[e.signatureParameters.mgf.algorithmOid],i===void 0||ke.mgf[i]===void 0){var o=new Error("Unsupported MGF function.");throw o.oid=e.signatureParameters.mgf.algorithmOid,o.name=i,o}if(i=ke.mgf[i].create(ke.md[n].create()),n=Ot[e.signatureParameters.hash.algorithmOid],n===void 0||ke.md[n]===void 0){var o=new Error("Unsupported RSASSA-PSS hash function.");throw o.oid=e.signatureParameters.hash.algorithmOid,o.name=n,o}r=ke.pss.create(ke.md[n].create(),i,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};ne.certificateFromPem=function(t,e,r){var n=ke.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var o=_.fromDer(n.body,r);return ne.certificateFromAsn1(o,e)};ne.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:_.toDer(ne.certificateToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};ne.publicKeyFromPem=function(t){var e=ke.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=_.fromDer(e.body);return ne.publicKeyFromAsn1(n)};ne.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:_.toDer(ne.publicKeyToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};ne.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:_.toDer(ne.publicKeyToRSAPublicKey(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};ne.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||ke.md.sha1.create(),n=e.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=_.toDer(ne.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":i=_.toDer(ne.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(i);var o=r.digest();if(e.encoding==="hex"){var s=o.toHex();return e.delimiter?s.match(/.{2}/g).join(e.delimiter):s}else{if(e.encoding==="binary")return o.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return o};ne.certificationRequestFromPem=function(t,e,r){var n=ke.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var o=_.fromDer(n.body,r);return ne.certificationRequestFromAsn1(o,e)};ne.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:_.toDer(ne.certificationRequestToAsn1(t)).getBytes()};return ke.pem.encode(r,{maxline:e})};ne.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return af(t.issuer,e)},t.issuer.addField=function(e){fs([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return af(t.subject,e)},t.subject.addField=function(e){fs([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){fs(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){fs(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)Eae(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,i=0;r===null&&i<t.extensions.length;++i)n=t.extensions[i],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||ke.md.sha1.create();var n=Ot[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=ne.getTBSCertificate(t);var o=_.toDer(t.tbsCertificate);t.md.update(o.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,i=t.subject,o=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw o.expectedIssuer=i.attributes,o.actualIssuer=n.attributes,o}var s=e.md;if(s===null){s=Kb({signatureOid:e.signatureOid,type:"certificate"});var a=e.tbsCertificate||ne.getTBSCertificate(e),l=_.toDer(a);s.update(l.getBytes())}return s!==null&&(r=wae({certificate:t,md:s,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,i=e.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var o,s,a=0;r&&a<n.attributes.length;++a)o=n.attributes[a],s=i.attributes[a],(o.type!==s.type||o.value!==s.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return ne.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=Ot.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var i=t.generateSubjectKeyIdentifier().getBytes();return ke.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},t};ne.certificateFromAsn1=function(t,e){var r={},n=[];if(!_.validate(t,dPe,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var o=_.derToOid(r.publicKeyOid);if(o!==ne.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=ne.createCertificate();s.version=r.certVersion?r.certVersion.charCodeAt(0):0;var a=ke.util.createBuffer(r.certSerialNumber);s.serialNumber=a.toHex(),s.signatureOid=ke.asn1.derToOid(r.certSignatureOid),s.signatureParameters=Fb(s.signatureOid,r.certSignatureParams,!0),s.siginfo.algorithmOid=ke.asn1.derToOid(r.certinfoSignatureOid),s.siginfo.parameters=Fb(s.siginfo.algorithmOid,r.certinfoSignatureParams,!1),s.signature=r.certSignature;var l=[];if(r.certValidity1UTCTime!==void 0&&l.push(_.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&l.push(_.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&l.push(_.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&l.push(_.generalizedTimeToDate(r.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(s.validity.notBefore=l[0],s.validity.notAfter=l[1],s.tbsCertificate=r.tbsCertificate,e){s.md=Kb({signatureOid:s.signatureOid,type:"certificate"});var u=_.toDer(s.tbsCertificate);s.md.update(u.getBytes())}var f=ke.md.sha1.create(),h=_.toDer(r.certIssuer);f.update(h.getBytes()),s.issuer.getField=function(m){return af(s.issuer,m)},s.issuer.addField=function(m){fs([m]),s.issuer.attributes.push(m)},s.issuer.attributes=ne.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(s.issuer.uniqueId=r.certIssuerUniqueId),s.issuer.hash=f.digest().toHex();var p=ke.md.sha1.create(),d=_.toDer(r.certSubject);return p.update(d.getBytes()),s.subject.getField=function(m){return af(s.subject,m)},s.subject.addField=function(m){fs([m]),s.subject.attributes.push(m)},s.subject.attributes=ne.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(s.subject.uniqueId=r.certSubjectUniqueId),s.subject.hash=p.digest().toHex(),r.certExtensions?s.extensions=ne.certificateExtensionsFromAsn1(r.certExtensions):s.extensions=[],s.publicKey=ne.publicKeyFromAsn1(r.subjectPublicKeyInfo),s};ne.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],i=0;i<n.value.length;++i)e.push(ne.certificateExtensionFromAsn1(n.value[i]));return e};ne.certificateExtensionFromAsn1=function(t){var e={};if(e.id=_.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===_.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in Ot){if(e.name=Ot[e.id],e.name==="keyUsage"){var r=_.fromDer(e.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(i&128)===128}else if(e.name==="basicConstraints"){var r=_.fromDer(e.value);r.value.length>0&&r.value[0].type===_.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var o=null;r.value.length>0&&r.value[0].type===_.Type.INTEGER?o=r.value[0].value:r.value.length>1&&(o=r.value[1].value),o!==null&&(e.pathLenConstraint=_.derToInteger(o))}else if(e.name==="extKeyUsage")for(var r=_.fromDer(e.value),s=0;s<r.value.length;++s){var a=_.derToOid(r.value[s].value);a in Ot?e[Ot[a]]=!0:e[a]=!0}else if(e.name==="nsCertType"){var r=_.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var l,r=_.fromDer(e.value),u=0;u<r.value.length;++u){l=r.value[u];var f={type:l.type,value:l.value};switch(e.altNames.push(f),l.type){case 1:case 2:case 6:break;case 7:f.ip=ke.util.bytesToIP(l.value);break;case 8:f.oid=_.derToOid(l.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=_.fromDer(e.value);e.subjectKeyIdentifier=ke.util.bytesToHex(r.value)}}return e};ne.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!_.validate(t,gPe,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var o=_.derToOid(r.publicKeyOid);if(o!==ne.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var s=ne.createCertificationRequest();if(s.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,s.signatureOid=ke.asn1.derToOid(r.csrSignatureOid),s.signatureParameters=Fb(s.signatureOid,r.csrSignatureParams,!0),s.siginfo.algorithmOid=ke.asn1.derToOid(r.csrSignatureOid),s.siginfo.parameters=Fb(s.siginfo.algorithmOid,r.csrSignatureParams,!1),s.signature=r.csrSignature,s.certificationRequestInfo=r.certificationRequestInfo,e){s.md=Kb({signatureOid:s.signatureOid,type:"certification request"});var a=_.toDer(s.certificationRequestInfo);s.md.update(a.getBytes())}var l=ke.md.sha1.create();return s.subject.getField=function(u){return af(s.subject,u)},s.subject.addField=function(u){fs([u]),s.subject.attributes.push(u)},s.subject.attributes=ne.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),s.subject.hash=l.digest().toHex(),s.publicKey=ne.publicKeyFromAsn1(r.subjectPublicKeyInfo),s.getAttribute=function(u){return af(s,u)},s.addAttribute=function(u){fs([u]),s.attributes.push(u)},s.attributes=ne.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),s};ne.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return af(t.subject,e)},t.subject.addField=function(e){fs([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return af(t,e)},t.addAttribute=function(e){fs([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){fs(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){fs(e),t.attributes=e},t.sign=function(e,r){t.md=r||ke.md.sha1.create();var n=Ot[t.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=t.md.algorithm,i}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=ne.getCertificationRequestInfo(t);var o=_.toDer(t.certificationRequestInfo);t.md.update(o.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=Kb({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||ne.getCertificationRequestInfo(t),i=_.toDer(n);r.update(i.getBytes())}return r!==null&&(e=wae({certificate:t,md:r,signature:t.signature})),e},t};function U1(t){for(var e=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]),r,n,i=t.attributes,o=0;o<i.length;++o){r=i[o];var s=r.value,a=_.Type.PRINTABLESTRING;"valueTagClass"in r&&(a=r.valueTagClass,a===_.Type.UTF8&&(s=ke.util.encodeUtf8(s))),n=_.create(_.Class.UNIVERSAL,_.Type.SET,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(r.type).getBytes()),_.create(_.Class.UNIVERSAL,a,!1,s)])]),e.value.push(n)}return e}function fs(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in ne.oids?e.name=ne.oids[e.type]:e.shortName&&e.shortName in Qr&&(e.name=ne.oids[Qr[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in ne.oids)e.type=ne.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in Qr&&(e.shortName=Qr[e.name]),e.type===Ot.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=_.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var i=0;i<e.extensions.length;++i)e.value.push(ne.certificateExtensionToAsn1(Eae(e.extensions[i])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function Eae(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in ne.oids&&(t.name=ne.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in ne.oids)t.id=ne.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,i=0,o=0;t.digitalSignature&&(i|=128,n=7),t.nonRepudiation&&(i|=64,n=6),t.keyEncipherment&&(i|=32,n=5),t.dataEncipherment&&(i|=16,n=4),t.keyAgreement&&(i|=8,n=3),t.keyCertSign&&(i|=4,n=2),t.cRLSign&&(i|=2,n=1),t.encipherOnly&&(i|=1,n=0),t.decipherOnly&&(o|=128,n=7);var s=String.fromCharCode(n);o!==0?s+=String.fromCharCode(i)+String.fromCharCode(o):i!==0&&(s+=String.fromCharCode(i)),t.value=_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,s)}else if(t.name==="basicConstraints")t.value=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(_.create(_.Class.UNIVERSAL,_.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in t&&t.value.value.push(_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);var a=t.value.value;for(var l in t)t[l]===!0&&(l in Ot?a.push(_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(Ot[l]).getBytes())):l.indexOf(".")!==-1&&a.push(_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(l).getBytes())))}else if(t.name==="nsCertType"){var n=0,i=0;t.client&&(i|=128,n=7),t.server&&(i|=64,n=6),t.email&&(i|=32,n=5),t.objsign&&(i|=16,n=4),t.reserved&&(i|=8,n=3),t.sslCA&&(i|=4,n=2),t.emailCA&&(i|=2,n=1),t.objCA&&(i|=1,n=0);var s=String.fromCharCode(n);i!==0&&(s+=String.fromCharCode(i)),t.value=_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,s)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);for(var u,f=0;f<t.altNames.length;++f){u=t.altNames[f];var s=u.value;if(u.type===7&&u.ip){if(s=ke.util.bytesFromIP(u.ip),s===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?s=_.oidToDer(_.oidToDer(u.oid)):s=_.oidToDer(s));t.value.value.push(_.create(_.Class.CONTEXT_SPECIFIC,u.type,!1,s))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=_.create(_.Class.UNIVERSAL,_.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var h=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=h.toHex(),t.value=_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,h.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);var a=t.value.value;if(t.keyIdentifier){var p=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;a.push(_.create(_.Class.CONTEXT_SPECIFIC,0,!1,p))}if(t.authorityCertIssuer){var d=[_.create(_.Class.CONTEXT_SPECIFIC,4,!0,[U1(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];a.push(_.create(_.Class.CONTEXT_SPECIFIC,1,!0,d))}if(t.serialNumber){var m=ke.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);a.push(_.create(_.Class.CONTEXT_SPECIFIC,2,!1,m))}}else if(t.name==="cRLDistributionPoints"){t.value=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);for(var a=t.value.value,g=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]),y=_.create(_.Class.CONTEXT_SPECIFIC,0,!0,[]),u,f=0;f<t.altNames.length;++f){u=t.altNames[f];var s=u.value;if(u.type===7&&u.ip){if(s=ke.util.bytesFromIP(u.ip),s===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else u.type===8&&(u.oid?s=_.oidToDer(_.oidToDer(u.oid)):s=_.oidToDer(s));y.value.push(_.create(_.Class.CONTEXT_SPECIFIC,u.type,!1,s))}g.value.push(_.create(_.Class.CONTEXT_SPECIFIC,0,!0,[y])),a.push(g)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function CP(t,e){switch(t){case Ot["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(_.create(_.Class.CONTEXT_SPECIFIC,0,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(e.hash.algorithmOid).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(_.create(_.Class.CONTEXT_SPECIFIC,1,!0,[_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(e.mgf.algorithmOid).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(e.mgf.hash.algorithmOid).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(_.create(_.Class.CONTEXT_SPECIFIC,2,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(e.saltLength).getBytes())])),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,r);default:return _.create(_.Class.UNIVERSAL,_.Type.NULL,!1,"")}}function yPe(t){var e=_.create(_.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var i=r[n],o=i.value,s=_.Type.UTF8;"valueTagClass"in i&&(s=i.valueTagClass),s===_.Type.UTF8&&(o=ke.util.encodeUtf8(o));var a=!1;"valueConstructed"in i&&(a=i.valueConstructed);var l=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(i.type).getBytes()),_.create(_.Class.UNIVERSAL,_.Type.SET,!0,[_.create(_.Class.UNIVERSAL,s,a,o)])]);e.value.push(l)}return e}var wPe=new Date("1950-01-01T00:00:00Z"),EPe=new Date("2050-01-01T00:00:00Z");function gae(t){return t>=wPe&&t<EPe?_.create(_.Class.UNIVERSAL,_.Type.UTCTIME,!1,_.dateToUtcTime(t)):_.create(_.Class.UNIVERSAL,_.Type.GENERALIZEDTIME,!1,_.dateToGeneralizedTime(t))}ne.getTBSCertificate=function(t){var e=gae(t.validity.notBefore),r=gae(t.validity.notAfter),n=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.CONTEXT_SPECIFIC,0,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(t.version).getBytes())]),_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,ke.util.hexToBytes(t.serialNumber)),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(t.siginfo.algorithmOid).getBytes()),CP(t.siginfo.algorithmOid,t.siginfo.parameters)]),U1(t.issuer),_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[e,r]),U1(t.subject),ne.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(_.create(_.Class.CONTEXT_SPECIFIC,1,!0,[_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,String.fromCharCode(0)+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(_.create(_.Class.CONTEXT_SPECIFIC,2,!0,[_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,String.fromCharCode(0)+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(ne.certificateExtensionsToAsn1(t.extensions)),n};ne.getCertificationRequestInfo=function(t){var e=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.INTEGER,!1,_.integerToDer(t.version).getBytes()),U1(t.subject),ne.publicKeyToAsn1(t.publicKey),yPe(t)]);return e};ne.distinguishedNameToAsn1=function(t){return U1(t)};ne.certificateToAsn1=function(t){var e=t.tbsCertificate||ne.getTBSCertificate(t);return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[e,_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(t.signatureOid).getBytes()),CP(t.signatureOid,t.signatureParameters)]),_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};ne.certificateExtensionsToAsn1=function(t){var e=_.create(_.Class.CONTEXT_SPECIFIC,3,!0,[]),r=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(ne.certificateExtensionToAsn1(t[n]));return e};ne.certificateExtensionToAsn1=function(t){var e=_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[]);e.value.push(_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(t.id).getBytes())),t.critical&&e.value.push(_.create(_.Class.UNIVERSAL,_.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=t.value;return typeof t.value!="string"&&(r=_.toDer(r).getBytes()),e.value.push(_.create(_.Class.UNIVERSAL,_.Type.OCTETSTRING,!1,r)),e};ne.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||ne.getCertificationRequestInfo(t);return _.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[e,_.create(_.Class.UNIVERSAL,_.Type.SEQUENCE,!0,[_.create(_.Class.UNIVERSAL,_.Type.OID,!1,_.oidToDer(t.signatureOid).getBytes()),CP(t.signatureOid,t.signatureParameters)]),_.create(_.Class.UNIVERSAL,_.Type.BITSTRING,!1,String.fromCharCode(0)+t.signature)])};ne.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(s){var a=r(s.issuer);return a},e.addCertificate=function(s){if(typeof s=="string"&&(s=ke.pki.certificateFromPem(s)),n(s.subject),!e.hasCertificate(s))if(s.subject.hash in e.certs){var a=e.certs[s.subject.hash];ke.util.isArray(a)||(a=[a]),a.push(s),e.certs[s.subject.hash]=a}else e.certs[s.subject.hash]=s},e.hasCertificate=function(s){typeof s=="string"&&(s=ke.pki.certificateFromPem(s));var a=r(s.subject);if(!a)return!1;ke.util.isArray(a)||(a=[a]);for(var l=_.toDer(ne.certificateToAsn1(s)).getBytes(),u=0;u<a.length;++u){var f=_.toDer(ne.certificateToAsn1(a[u])).getBytes();if(l===f)return!0}return!1},e.listAllCertificates=function(){var s=[];for(var a in e.certs)if(e.certs.hasOwnProperty(a)){var l=e.certs[a];if(!ke.util.isArray(l))s.push(l);else for(var u=0;u<l.length;++u)s.push(l[u])}return s},e.removeCertificate=function(s){var a;if(typeof s=="string"&&(s=ke.pki.certificateFromPem(s)),n(s.subject),!e.hasCertificate(s))return null;var l=r(s.subject);if(!ke.util.isArray(l))return a=e.certs[s.subject.hash],delete e.certs[s.subject.hash],a;for(var u=_.toDer(ne.certificateToAsn1(s)).getBytes(),f=0;f<l.length;++f){var h=_.toDer(ne.certificateToAsn1(l[f])).getBytes();u===h&&(a=l[f],l.splice(f,1))}return l.length===0&&delete e.certs[s.subject.hash],a};function r(s){return n(s),e.certs[s.hash]||null}function n(s){if(!s.hash){var a=ke.md.sha1.create();s.attributes=ne.RDNAttributesAsArray(U1(s),a),s.hash=a.digest().toHex()}}if(t)for(var i=0;i<t.length;++i){var o=t[i];e.addCertificate(o)}return e};ne.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};ne.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var o=!0,s=null,a=0;do{var l=e.shift(),u=null,f=!1;if(i&&(i<l.validity.notBefore||i>l.validity.notAfter)&&(s={message:"Certificate is not valid yet or has expired.",error:ne.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:i}),s===null){if(u=e[0]||t.getIssuer(l),u===null&&l.isIssuer(l)&&(f=!0,u=l),u){var h=u;ke.util.isArray(h)||(h=[h]);for(var p=!1;!p&&h.length>0;){u=h.shift();try{p=u.verify(l)}catch{}}p||(s={message:"Certificate signature is invalid.",error:ne.certificateError.bad_certificate})}s===null&&(!u||f)&&!t.hasCertificate(l)&&(s={message:"Certificate is not trusted.",error:ne.certificateError.unknown_ca})}if(s===null&&u&&!l.isIssuer(u)&&(s={message:"Certificate issuer is invalid.",error:ne.certificateError.bad_certificate}),s===null)for(var d={keyUsage:!0,basicConstraints:!0},m=0;s===null&&m<l.extensions.length;++m){var g=l.extensions[m];g.critical&&!(g.name in d)&&(s={message:"Certificate has an unsupported critical extension.",error:ne.certificateError.unsupported_certificate})}if(s===null&&(!o||e.length===0&&(!u||f))){var y=l.getExtension("basicConstraints"),w=l.getExtension("keyUsage");if(w!==null&&(!w.keyCertSign||y===null)&&(s={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:ne.certificateError.bad_certificate}),s===null&&y!==null&&!y.cA&&(s={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:ne.certificateError.bad_certificate}),s===null&&w!==null&&"pathLenConstraint"in y){var b=a-1;b>y.pathLenConstraint&&(s={message:"Certificate basicConstraints pathLenConstraint violated.",error:ne.certificateError.bad_certificate})}}var v=s===null?!0:s.error,S=r.verify?r.verify(v,a,n):v;if(S===!0)s=null;else throw v===!0&&(s={message:"The application rejected the certificate.",error:ne.certificateError.bad_certificate}),(S||S===0)&&(typeof S=="object"&&!ke.util.isArray(S)?(S.message&&(s.message=S.message),S.error&&(s.error=S.error)):typeof S=="string"&&(s.error=S)),s;o=!1,++a}while(e.length>0);return!0}});var Sae=x((V_t,vae)=>{c();var oe=wt();Lp();Xl();Iw();kp();kw();lae();Qf();Er();PP();var N=oe.asn1,Pi=vae.exports=oe.pkcs7=oe.pkcs7||{};Pi.messageFromPem=function(t){var e=oe.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=N.fromDer(e.body);return Pi.messageFromAsn1(n)};Pi.messageToPem=function(t,e){var r={type:"PKCS7",body:N.toDer(t.toAsn1()).getBytes()};return oe.pem.encode(r,{maxline:e})};Pi.messageFromAsn1=function(t){var e={},r=[];if(!N.validate(t,Pi.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=N.derToOid(e.contentType),o;switch(i){case oe.pki.oids.envelopedData:o=Pi.createEnvelopedData();break;case oe.pki.oids.encryptedData:o=Pi.createEncryptedData();break;case oe.pki.oids.signedData:o=Pi.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return o.fromAsn1(e.content.value[0]),o};Pi.createSignedData=function(){var t=null;return t={type:oe.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(kP(t,n,Pi.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var i=t.rawCapture.certificates.value,o=0;o<i.length;++o)t.certificates.push(oe.pki.certificateFromAsn1(i[o]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],i=0;i<t.certificates.length;++i)n.push(oe.pki.certificateToAsn1(t.certificates[i]));var o=[],s=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&s.value[0].value.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,n)),o.length>0&&s.value[0].value.push(N.create(N.Class.CONTEXT_SPECIFIC,1,!0,o)),s.value[0].value.push(N.create(N.Class.UNIVERSAL,N.Type.SET,!0,t.signerInfos)),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),s])},addSigner:function(n){var i=n.issuer,o=n.serialNumber;if(n.certificate){var s=n.certificate;typeof s=="string"&&(s=oe.pki.certificateFromPem(s)),i=s.issuer.attributes,o=s.serialNumber}var a=n.key;if(!a)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof a=="string"&&(a=oe.pki.privateKeyFromPem(a));var l=n.digestAlgorithm||oe.pki.oids.sha1;switch(l){case oe.pki.oids.sha1:case oe.pki.oids.sha256:case oe.pki.oids.sha384:case oe.pki.oids.sha512:case oe.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var f=!1,h=!1,p=0;p<u.length;++p){var d=u[p];if(!f&&d.type===oe.pki.oids.contentType){if(f=!0,h)break;continue}if(!h&&d.type===oe.pki.oids.messageDigest){if(h=!0,f)break;continue}}if(!f||!h)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:a,version:1,issuer:i,serialNumber:o,digestAlgorithm:l,signatureAlgorithm:oe.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(oe.pki.oids.data).getBytes())]),"content"in t)){var i;t.content instanceof oe.util.ByteBuffer?i=t.content.bytes():typeof t.content=="string"&&(i=oe.util.encodeUtf8(t.content)),n.detached?t.detachedContent=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,i):t.contentInfo.value.push(N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,i)]))}if(t.signers.length!==0){var o=e();r(o)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=oe.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},i=0;i<t.signers.length;++i){var o=t.signers[i],s=o.digestAlgorithm;s in n||(n[s]=oe.md[oe.pki.oids[s]].create()),o.authenticatedAttributes.length===0?o.md=n[s]:o.md=oe.md[oe.pki.oids[s]].create()}t.digestAlgorithmIdentifiers=[];for(var s in n)t.digestAlgorithmIdentifiers.push(N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(s).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]));return n}function r(n){var i;if(t.detachedContent?i=t.detachedContent:(i=t.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var o=N.derToOid(t.contentInfo.value[0].value),s=N.toDer(i);s.getByte(),N.getBerValueLength(s),s=s.getBytes();for(var a in n)n[a].start().update(s);for(var l=new Date,u=0;u<t.signers.length;++u){var f=t.signers[u];if(f.authenticatedAttributes.length===0){if(o!==oe.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{f.authenticatedAttributesAsn1=N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var h=N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[]),p=0;p<f.authenticatedAttributes.length;++p){var d=f.authenticatedAttributes[p];d.type===oe.pki.oids.messageDigest?d.value=n[f.digestAlgorithm].digest():d.type===oe.pki.oids.signingTime&&(d.value||(d.value=l)),h.value.push(NP(d)),f.authenticatedAttributesAsn1.value.push(NP(d))}s=N.toDer(h).getBytes(),f.md.start().update(s)}f.signature=f.key.sign(f.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=RPe(t.signers)}};Pi.createEncryptedData=function(){var t=null;return t={type:oe.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(e){kP(t,e,Pi.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),_ae(t)}},t};Pi.createEnvelopedData=function(){var t=null;return t={type:oe.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:oe.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=kP(t,e,Pi.asn1.envelopedDataValidator);t.recipients=vPe(r.recipientInfos.value)},toAsn1:function(){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,SPe(t.recipients)),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,TPe(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var i=t.recipients[n],o=i.issuer;if(i.serialNumber===e.serialNumber&&o.length===r.length){for(var s=!0,a=0;a<r.length;++a)if(o[a].type!==r[a].type||o[a].value!==r[a].value){s=!1;break}if(s)return i}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:case oe.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=oe.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}_ae(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:oe.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,i,o;switch(r){case oe.pki.oids["aes128-CBC"]:n=16,i=16,o=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes192-CBC"]:n=24,i=16,o=oe.aes.createEncryptionCipher;break;case oe.pki.oids["aes256-CBC"]:n=32,i=16,o=oe.aes.createEncryptionCipher;break;case oe.pki.oids["des-EDE3-CBC"]:n=24,i=8,o=oe.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=oe.util.createBuffer(oe.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=oe.util.createBuffer(oe.random.getBytes(i));var s=o(e);if(s.start(t.encryptedContent.parameter.copy()),s.update(t.content),!s.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=s.output}for(var a=0;a<t.recipients.length;++a){var l=t.recipients[a];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case oe.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},t};function bPe(t){var e={},r=[];if(!N.validate(t,Pi.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:oe.pki.RDNAttributesAsArray(e.issuer),serialNumber:oe.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:N.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function _Pe(t){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:t.issuer}),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,oe.util.hexToBytes(t.serialNumber))]),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.encryptedContent.algorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function vPe(t){for(var e=[],r=0;r<t.length;++r)e.push(bPe(t[r]));return e}function SPe(t){for(var e=[],r=0;r<t.length;++r)e.push(_Pe(t[r]));return e}function xPe(t){var e=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(t.version).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[oe.pki.distinguishedNameToAsn1({attributes:t.issuer}),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,oe.util.hexToBytes(t.serialNumber))]),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.digestAlgorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.signatureAlgorithm).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")])),e.value.push(N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=N.create(N.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var i=t.unauthenticatedAttributes[n];r.values.push(NP(i))}e.value.push(r)}return e}function RPe(t){for(var e=[],r=0;r<t.length;++r)e.push(xPe(t[r]));return e}function NP(t){var e;if(t.type===oe.pki.oids.contentType)e=N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.value).getBytes());else if(t.type===oe.pki.oids.messageDigest)e=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===oe.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=t.value;if(typeof i=="string"){var o=Date.parse(i);isNaN(o)?i.length===13?i=N.utcTimeToDate(i):i=N.generalizedTimeToDate(i):i=new Date(o)}i>=r&&i<n?e=N.create(N.Class.UNIVERSAL,N.Type.UTCTIME,!1,N.dateToUtcTime(i)):e=N.create(N.Class.UNIVERSAL,N.Type.GENERALIZEDTIME,!1,N.dateToGeneralizedTime(i))}return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.type).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SET,!0,[e])])}function TPe(t){return[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(oe.pki.oids.data).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(t.algorithm).getBytes()),t.parameter?N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),N.create(N.Class.CONTEXT_SPECIFIC,0,!0,[N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,t.content.getBytes())])]}function kP(t,e,r){var n={},i=[];if(!N.validate(e,r,n,i)){var o=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw o.errors=o,o}var s=N.derToOid(n.contentType);if(s!==oe.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var a="";if(oe.util.isArray(n.encryptedContent))for(var l=0;l<n.encryptedContent.length;++l){if(n.encryptedContent[l].type!==N.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");a+=n.encryptedContent[l].value}else a=n.encryptedContent;t.encryptedContent={algorithm:N.derToOid(n.encAlgorithm),parameter:oe.util.createBuffer(n.encParameter.value),content:oe.util.createBuffer(a)}}if(n.content){var a="";if(oe.util.isArray(n.content))for(var l=0;l<n.content.length;++l){if(n.content[l].type!==N.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");a+=n.content[l].value}else a=n.content;t.content=oe.util.createBuffer(a)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function _ae(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case oe.pki.oids["aes128-CBC"]:case oe.pki.oids["aes192-CBC"]:case oe.pki.oids["aes256-CBC"]:e=oe.aes.createDecryptionCipher(t.encryptedContent.key);break;case oe.pki.oids.desCBC:case oe.pki.oids["des-EDE3-CBC"]:e=oe.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var LP=x((b7t,Oae)=>{"use strict";c();var DPe=async function*(t,e){for await(let r of t)await e(r),yield r};Oae.exports=DPe});var Hae=x((gvt,zae)=>{"use strict";c();function UPe(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}else return Array.from(t)}zae.exports=function(e){var r=void 0,n=void 0;function i(a){if(!(a instanceof Object))throw new Error('Target "'+a+'" is not an object');n=a}function o(a){Object.keys(a).forEach(function(l){var u=a[l];if(typeof u!="function")throw new Error('Trap "'+l+": "+u+'" is not a function');if(!Reflect[l])throw new Error('Trap "'+l+": "+u+'" is not a valid trap')}),r=a}i(function(){}),e&&i(e),o(Reflect);var s=new Proxy({},{get:function(l,u){return function(){for(var f=arguments.length,h=Array(f),p=0;p<f;p++)h[p]=arguments[p];return r[u].apply(null,[n].concat(UPe(h.slice(1))))}}});return{setTarget:i,setHandler:o,getTarget:function(){return n},getHandler:function(){return r},proxy:new Proxy(n,s)}}});var JP=x((y9t,fce)=>{"use strict";c();var qPe=gv(),e_=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,u3=qPe(),zPe=e_&&!u3,HPe=u3&&!e_,$Pe=u3&&e_,GPe=typeof Bd=="function"&&typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!u3,WPe=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,jPe=typeof globalThis.process<"u"&&typeof globalThis.process.env<"u"&&globalThis.process.env["NODE"+(()=>"_")()+"ENV"]==="test",YPe=typeof navigator<"u"&&navigator.product==="ReactNative";fce.exports={isTest:jPe,isElectron:u3,isElectronMain:HPe,isElectronRenderer:$Pe,isNode:GPe,isBrowser:zPe,isWebWorker:WPe,isEnvWithDom:e_,isReactNative:YPe}});var Kce=x((GSt,Fce)=>{"use strict";c();Fce.exports=Uce;var nNe=yv(),pf=Uce.prototype,iNe=new Date%1e9;function oNe(){return(Math.random()*1e9>>>0)+iNe++}function Uce(t){t=t||{},this.id=t.id||oNe(),this.max=t.max||1/0,this.items=t.items||[],this._lookup={},this.size=this.items.length,this.lastModified=new Date(t.lastModified||new Date);for(var e,r,n=this.items.length;n--;)e=this.items[n],r=new Date(e.expires)-new Date,this._lookup[e.key]=e,r>0?this.expire(e.key,r):r<=0&&this.delete(e.key)}pf.has=function(t){return t in this._lookup};pf.get=function(t){if(!this.has(t))return null;var e=this._lookup[t];return e.refresh&&this.expire(t,e.refresh),this.items.splice(this.items.indexOf(e),1),this.items.push(e),e.value};pf.meta=function(t){if(!this.has(t))return null;var e=this._lookup[t];return"meta"in e?e.meta:null};pf.set=function(t,e,r){var n=this._lookup[t],i=this._lookup[t]={key:t,value:e};return this.lastModified=new Date,n?(clearTimeout(n.timeout),this.items.splice(this.items.indexOf(n),1,i)):(this.size>=this.max&&this.delete(this.items[0].key),this.items.push(i),this.size++),r&&("ttl"in r&&this.expire(t,r.ttl),"meta"in r&&(i.meta=r.meta),r.refresh&&(i.refresh=r.ttl)),this};pf.delete=function(t){var e=this._lookup[t];return e?(this.lastModified=new Date,this.items.splice(this.items.indexOf(e),1),clearTimeout(e.timeout),delete this._lookup[t],this.size--,this):!1};pf.expire=function(t,e){var r=e||0,n=this._lookup[t];if(!n)return this;if(typeof r=="string"&&(r=nNe(e)),typeof r!="number")throw new TypeError("Expiration time must be a string or number.");return clearTimeout(n.timeout),n.timeout=setTimeout(this.delete.bind(this,n.key),r),n.expires=Number(new Date)+r,this};pf.clear=function(){for(var t=this.items.length;t--;)this.delete(this.items[t].key);return this};pf.toJSON=function(){for(var t=new Array(this.items.length),e,r=t.length;r--;)e=this.items[r],t[r]={key:e.key,meta:e.meta,value:e.value,expires:e.expires,refresh:e.refresh};return{id:this.id,max:isFinite(this.max)?this.max:void 0,lastModified:this.lastModified,items:t}}});var ele=x((IN,Jce)=>{c();var C_=bi(),tc=C_.Buffer;function Zce(t,e){for(var r in t)e[r]=t[r]}tc.from&&tc.alloc&&tc.allocUnsafe&&tc.allocUnsafeSlow?Jce.exports=C_:(Zce(C_,IN),IN.Buffer=Pd);function Pd(t,e,r){return tc(t,e,r)}Pd.prototype=Object.create(tc.prototype);Zce(tc,Pd);Pd.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return tc(t,e,r)};Pd.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=tc(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};Pd.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return tc(t)};Pd.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return C_.SlowBuffer(t)}});var tle=x((SRt,PN)=>{"use strict";c();var CN=65536,fNe=4294967295;function hNe(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var dNe=ele().Buffer,P_=globalThis.crypto||globalThis.msCrypto;P_&&P_.getRandomValues?PN.exports=pNe:PN.exports=hNe;function pNe(t,e){if(t>fNe)throw new RangeError("requested too many random bytes");var r=dNe.allocUnsafe(t);if(t>0)if(t>CN)for(var n=0;n<t;n+=CN)P_.getRandomValues(r.slice(n,n+CN));else P_.getRandomValues(r);return typeof e=="function"?process.nextTick(function(){e(null,r)}):r}});var ile=x((xRt,nle)=>{"use strict";c();var mNe=tle(),{EventEmitter:gNe}=In();function rle(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;++r)if(t[r]!==e[r])return!1;return!0}function NN(){return{contacts:[],dontSplit:!1,left:null,right:null}}function _3(t,e){if(!(e instanceof Uint8Array))throw new TypeError(t+" is not a Uint8Array")}var X1=class extends gNe{constructor(e={}){super(),this.localNodeId=e.localNodeId||mNe(20),this.numberOfNodesPerKBucket=e.numberOfNodesPerKBucket||20,this.numberOfNodesToPing=e.numberOfNodesToPing||3,this.distance=e.distance||X1.distance,this.arbiter=e.arbiter||X1.arbiter,this.metadata=Object.assign({},e.metadata),_3("option.localNodeId as parameter 1",this.localNodeId),this.root=NN()}static arbiter(e,r){return e.vectorClock>r.vectorClock?e:r}static distance(e,r){let n=0,i=0,o=Math.min(e.length,r.length),s=Math.max(e.length,r.length);for(;i<o;++i)n=n*256+(e[i]^r[i]);for(;i<s;++i)n=n*256+255;return n}add(e){_3("contact.id",(e||{}).id);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e.id,r++);let i=this._indexOf(n,e.id);return i>=0?(this._update(n,i,e),this):n.contacts.length<this.numberOfNodesPerKBucket?(n.contacts.push(e),this.emit("added",e),this):n.dontSplit?(this.emit("ping",n.contacts.slice(0,this.numberOfNodesToPing),e),this):(this._split(n,r),this.add(e))}closest(e,r=1/0){if(_3("id",e),!Number.isInteger(r)&&r!==1/0||r<=0)throw new TypeError("n is not positive number");let n=[];for(let i=[this.root],o=0;i.length>0&&n.length<r;){let s=i.pop();if(s.contacts===null){let a=this._determineNode(s,e,o++);i.push(s.left===a?s.right:s.left),i.push(a)}else n=n.concat(s.contacts)}return n.map(i=>[this.distance(i.id,e),i]).sort((i,o)=>i[0]-o[0]).slice(0,r).map(i=>i[1])}count(){let e=0;for(let r=[this.root];r.length>0;){let n=r.pop();n.contacts===null?r.push(n.right,n.left):e+=n.contacts.length}return e}_determineNode(e,r,n){let i=n>>3,o=n%8;return r.length<=i&&o!==0?e.left:r[i]&1<<7-o?e.right:e.left}get(e){_3("id",e);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e,r++);let i=this._indexOf(n,e);return i>=0?n.contacts[i]:null}_indexOf(e,r){for(let n=0;n<e.contacts.length;++n)if(rle(e.contacts[n].id,r))return n;return-1}remove(e){_3("the id as parameter 1",e);let r=0,n=this.root;for(;n.contacts===null;)n=this._determineNode(n,e,r++);let i=this._indexOf(n,e);if(i>=0){let o=n.contacts.splice(i,1)[0];this.emit("removed",o)}return this}_split(e,r){e.left=NN(),e.right=NN();for(let o of e.contacts)this._determineNode(e,o.id,r).contacts.push(o);e.contacts=null;let n=this._determineNode(e,this.localNodeId,r),i=e.left===n?e.right:e.left;i.dontSplit=!0}toArray(){let e=[];for(let r=[this.root];r.length>0;){let n=r.pop();n.contacts===null?r.push(n.right,n.left):e=e.concat(n.contacts)}return e}*toIterable(){for(let e=[this.root];e.length>0;){let r=e.pop();r.contacts===null?e.push(r.right,r.left):yield*r.contacts}}_update(e,r,n){if(!rle(e.contacts[r].id,n.id))throw new Error("wrong index for _update");let i=e.contacts[r],o=this.arbiter(i,n);o===i&&i!==n||(e.contacts.splice(r,1),e.contacts.push(o),this.emit("updated",i,o))}};nle.exports=X1});var lue=x(u7=>{"use strict";c();Object.defineProperty(u7,"__esModule",{value:!0});var jN=class{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(e){if(this.isStopped)return;let r={value:e,done:!1};if(this.pullQueue.length){let n=this.pullQueue.shift();n&&n.resolve(r)}else this.pushQueue.push(Promise.resolve(r)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(let e of this.pullQueue)e.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(e){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(let r of this.pullQueue)r.reject(e);this.pullQueue.length=0}else{let r=Promise.reject(e);r.catch(()=>{}),this.pushQueue.push(r)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:e=>{let r=this.pushQueue.shift();return r?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),r):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((n,i)=>{this.pullQueue.push({resolve:n,reject:i})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}},l7=class{constructor(e,{highWaterMark:r=100,lowWaterMark:n=1}={}){let i=new jN;i.highWaterMark=r,i.lowWaterMark=n,i.removeCallback=e({push:o=>i.push(o),stop:()=>i.stop(),fail:o=>i.fail(o),on:(o,s)=>{i.eventHandlers[o]=s}})||(()=>{}),this[Symbol.asyncIterator]=()=>i[Symbol.asyncIterator](),Object.freeze(this)}};u7.EventIterator=l7;u7.default=l7});var uue=x(B3=>{"use strict";c();Object.defineProperty(B3,"__esModule",{value:!0});var YN=lue();B3.EventIterator=YN.EventIterator;function ONe(t,e,r){return new YN.EventIterator(({push:n})=>(this.addEventListener(t,n,e),()=>this.removeEventListener(t,n,e)),r)}B3.subscribe=ONe;B3.default=YN.EventIterator});var zue=x(sk=>{"use strict";c();Object.defineProperty(sk,"__esModule",{value:!0});function $Ne(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}sk.isSerializableHash=$Ne});var w7=x(lm=>{"use strict";c();Object.defineProperty(lm,"__esModule",{value:!0});function GNe(t,e,r){return~(t-1)&e|t-1&r}lm.select=GNe;function WNe(t,e){return(t|0)-(e|0)-1>>>31&1}lm.lessOrEqual=WNe;function Hue(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}lm.compare=Hue;function jNe(t,e){return t.length===0||e.length===0?!1:Hue(t,e)!==0}lm.equal=jNe});var nc=x(ak=>{"use strict";c();Object.defineProperty(ak,"__esModule",{value:!0});function YNe(t){for(var e=0;e<t.length;e++)t[e]=0;return t}ak.wipe=YNe});var Gue=x(M3=>{"use strict";c();Object.defineProperty(M3,"__esModule",{value:!0});var ic=zue(),QNe=w7(),XNe=nc(),$ue=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),ic.isSerializableHash(this._inner)&&ic.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),XNe.wipe(n)}return t.prototype.reset=function(){if(!ic.isSerializableHash(this._inner)||!ic.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){ic.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ic.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!ic.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!ic.isSerializableHash(this._inner)||!ic.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!ic.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();M3.HMAC=$ue;function ZNe(t,e,r){var n=new $ue(t,e);n.update(r);var i=n.digest();return n.clean(),i}M3.hmac=ZNe;M3.equal=QNe.equal});var Yue=x(ck=>{"use strict";c();Object.defineProperty(ck,"__esModule",{value:!0});var Wue=Gue(),jue=nc(),JNe=function(){function t(e,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var o=Wue.hmac(this._hash,n,r);this._hmac=new Wue.HMAC(e,o),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),jue.wipe(this._buffer),jue.wipe(this._counter),this._bufpos=0},t}();ck.HKDF=JNe});var Xue=x(lk=>{"use strict";c();Object.defineProperty(lk,"__esModule",{value:!0});var Que=65536,eke=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),n=0;n<r.length;n+=Que)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Que)));return r},t}();lk.BrowserRandomSource=eke});var Zue=x(uk=>{"use strict";c();Object.defineProperty(uk,"__esModule",{value:!0});var tke=nc(),rke=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Bd<"u"){var e=Yf();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var n=new Uint8Array(e),i=0;i<n.length;i++)n[i]=r[i];return tke.wipe(r),n},t}();uk.NodeRandomSource=rke});var Jue=x(fk=>{"use strict";c();Object.defineProperty(fk,"__esModule",{value:!0});var nke=Xue(),ike=Zue(),oke=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new nke.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ike.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();fk.SystemRandomSource=oke});var efe=x(No=>{"use strict";c();Object.defineProperty(No,"__esModule",{value:!0});function ske(t,e){var r=t>>>16&65535,n=t&65535,i=e>>>16&65535,o=e&65535;return n*o+(r*o+n*i<<16>>>0)|0}No.mul=Math.imul||ske;function ake(t,e){return t+e|0}No.add=ake;function cke(t,e){return t-e|0}No.sub=cke;function lke(t,e){return t<<e|t>>>32-e}No.rotl=lke;function uke(t,e){return t<<32-e|t>>>e}No.rotr=uke;function fke(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}No.isInteger=Number.isInteger||fke;No.MAX_SAFE_INTEGER=9007199254740991;No.isSafeInteger=function(t){return No.isInteger(t)&&t>=-No.MAX_SAFE_INTEGER&&t<=No.MAX_SAFE_INTEGER}});var U3=x(yt=>{"use strict";c();Object.defineProperty(yt,"__esModule",{value:!0});var tfe=efe();function hke(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}yt.readInt16BE=hke;function dke(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}yt.readUint16BE=dke;function pke(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}yt.readInt16LE=pke;function mke(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}yt.readUint16LE=mke;function rfe(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}yt.writeUint16BE=rfe;yt.writeInt16BE=rfe;function nfe(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}yt.writeUint16LE=nfe;yt.writeInt16LE=nfe;function hk(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}yt.readInt32BE=hk;function dk(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}yt.readUint32BE=dk;function pk(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}yt.readInt32LE=pk;function mk(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}yt.readUint32LE=mk;function E7(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}yt.writeUint32BE=E7;yt.writeInt32BE=E7;function b7(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}yt.writeUint32LE=b7;yt.writeInt32LE=b7;function gke(t,e){e===void 0&&(e=0);var r=hk(t,e),n=hk(t,e+4);return r*4294967296+n-(n>>31)*4294967296}yt.readInt64BE=gke;function yke(t,e){e===void 0&&(e=0);var r=dk(t,e),n=dk(t,e+4);return r*4294967296+n}yt.readUint64BE=yke;function wke(t,e){e===void 0&&(e=0);var r=pk(t,e),n=pk(t,e+4);return n*4294967296+r-(r>>31)*4294967296}yt.readInt64LE=wke;function Eke(t,e){e===void 0&&(e=0);var r=mk(t,e),n=mk(t,e+4);return n*4294967296+r}yt.readUint64LE=Eke;function ife(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),E7(t/4294967296>>>0,e,r),E7(t>>>0,e,r+4),e}yt.writeUint64BE=ife;yt.writeInt64BE=ife;function ofe(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),b7(t>>>0,e,r),b7(t/4294967296>>>0,e,r+4),e}yt.writeUint64LE=ofe;yt.writeInt64LE=ofe;function bke(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,o=t/8+r-1;o>=r;o--)n+=e[o]*i,i*=256;return n}yt.readUintBE=bke;function _ke(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,o=r;o<r+t/8;o++)n+=e[o]*i,i*=256;return n}yt.readUintLE=_ke;function vke(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!tfe.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var i=1,o=t/8+n-1;o>=n;o--)r[o]=e/i&255,i*=256;return r}yt.writeUintBE=vke;function Ske(t,e,r,n){if(r===void 0&&(r=new Uint8Array(t/8)),n===void 0&&(n=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!tfe.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var i=1,o=n;o<n+t/8;o++)r[o]=e/i&255,i*=256;return r}yt.writeUintLE=Ske;function xke(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}yt.readFloat32BE=xke;function Rke(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}yt.readFloat32LE=Rke;function Tke(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}yt.readFloat64BE=Tke;function Ake(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}yt.readFloat64LE=Ake;function Ike(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t),e}yt.writeFloat32BE=Ike;function Cke(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat32(r,t,!0),e}yt.writeFloat32LE=Cke;function Pke(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t),e}yt.writeFloat64BE=Pke;function Nke(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(e.buffer,e.byteOffset,e.byteLength);return n.setFloat64(r,t,!0),e}yt.writeFloat64LE=Nke});var lfe=x(ra=>{"use strict";c();Object.defineProperty(ra,"__esModule",{value:!0});var kke=Jue(),Dke=U3(),sfe=nc();ra.defaultRandomSource=new kke.SystemRandomSource;function gk(t,e){return e===void 0&&(e=ra.defaultRandomSource),e.randomBytes(t)}ra.randomBytes=gk;function Oke(t){t===void 0&&(t=ra.defaultRandomSource);var e=gk(4,t),r=Dke.readUint32LE(e);return sfe.wipe(e),r}ra.randomUint32=Oke;var afe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function cfe(t,e,r){if(e===void 0&&(e=afe),r===void 0&&(r=ra.defaultRandomSource),e.length<2)throw new Error("randomString charset is too short");if(e.length>256)throw new Error("randomString charset is too long");for(var n="",i=e.length,o=256-256%i;t>0;){for(var s=gk(Math.ceil(t*256/o),r),a=0;a<s.length&&t>0;a++){var l=s[a];l<o&&(n+=e.charAt(l%i),t--)}sfe.wipe(s)}return n}ra.randomString=cfe;function Lke(t,e,r){e===void 0&&(e=afe),r===void 0&&(r=ra.defaultRandomSource);var n=Math.ceil(t/(Math.log(e.length)/Math.LN2));return cfe(n,e,r)}ra.randomStringForEntropy=Lke});var dfe=x(Qi=>{"use strict";c();Object.defineProperty(Qi,"__esModule",{value:!0});var Bke=lfe(),Mke=nc();Qi.PUBLIC_KEY_LENGTH=32;Qi.SECRET_KEY_LENGTH=32;Qi.SHARED_KEY_LENGTH=32;function oc(t){var e=new Float64Array(16);if(t)for(var r=0;r<t.length;r++)e[r]=t[r];return e}var ufe=new Uint8Array(32);ufe[0]=9;var Uke=oc([56129,1]);function yk(t){for(var e=1,r=0;r<16;r++){var n=t[r]+e+65535;e=Math.floor(n/65536),t[r]=n-e*65536}t[0]+=e-1+37*(e-1)}function F3(t,e,r){for(var n=~(r-1),i=0;i<16;i++){var o=n&(t[i]^e[i]);t[i]^=o,e[i]^=o}}function Fke(t,e){for(var r=oc(),n=oc(),i=0;i<16;i++)n[i]=e[i];yk(n),yk(n),yk(n);for(var o=0;o<2;o++){r[0]=n[0]-65517;for(var i=1;i<15;i++)r[i]=n[i]-65535-(r[i-1]>>16&1),r[i-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);var s=r[15]>>16&1;r[14]&=65535,F3(n,r,1-s)}for(var i=0;i<16;i++)t[2*i]=n[i]&255,t[2*i+1]=n[i]>>8}function Kke(t,e){for(var r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function _7(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]+r[n]}function v7(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]-r[n]}function El(t,e,r){var n,i,o=0,s=0,a=0,l=0,u=0,f=0,h=0,p=0,d=0,m=0,g=0,y=0,w=0,b=0,v=0,S=0,R=0,I=0,A=0,L=0,q=0,G=0,j=0,se=0,re=0,Ge=0,me=0,Ce=0,z=0,He=0,or=0,nt=r[0],it=r[1],J=r[2],ue=r[3],ce=r[4],Te=r[5],Le=r[6],De=r[7],$t=r[8],sr=r[9],Xe=r[10],lt=r[11],ar=r[12],Br=r[13],Xr=r[14],Zr=r[15];n=e[0],o+=n*nt,s+=n*it,a+=n*J,l+=n*ue,u+=n*ce,f+=n*Te,h+=n*Le,p+=n*De,d+=n*$t,m+=n*sr,g+=n*Xe,y+=n*lt,w+=n*ar,b+=n*Br,v+=n*Xr,S+=n*Zr,n=e[1],s+=n*nt,a+=n*it,l+=n*J,u+=n*ue,f+=n*ce,h+=n*Te,p+=n*Le,d+=n*De,m+=n*$t,g+=n*sr,y+=n*Xe,w+=n*lt,b+=n*ar,v+=n*Br,S+=n*Xr,R+=n*Zr,n=e[2],a+=n*nt,l+=n*it,u+=n*J,f+=n*ue,h+=n*ce,p+=n*Te,d+=n*Le,m+=n*De,g+=n*$t,y+=n*sr,w+=n*Xe,b+=n*lt,v+=n*ar,S+=n*Br,R+=n*Xr,I+=n*Zr,n=e[3],l+=n*nt,u+=n*it,f+=n*J,h+=n*ue,p+=n*ce,d+=n*Te,m+=n*Le,g+=n*De,y+=n*$t,w+=n*sr,b+=n*Xe,v+=n*lt,S+=n*ar,R+=n*Br,I+=n*Xr,A+=n*Zr,n=e[4],u+=n*nt,f+=n*it,h+=n*J,p+=n*ue,d+=n*ce,m+=n*Te,g+=n*Le,y+=n*De,w+=n*$t,b+=n*sr,v+=n*Xe,S+=n*lt,R+=n*ar,I+=n*Br,A+=n*Xr,L+=n*Zr,n=e[5],f+=n*nt,h+=n*it,p+=n*J,d+=n*ue,m+=n*ce,g+=n*Te,y+=n*Le,w+=n*De,b+=n*$t,v+=n*sr,S+=n*Xe,R+=n*lt,I+=n*ar,A+=n*Br,L+=n*Xr,q+=n*Zr,n=e[6],h+=n*nt,p+=n*it,d+=n*J,m+=n*ue,g+=n*ce,y+=n*Te,w+=n*Le,b+=n*De,v+=n*$t,S+=n*sr,R+=n*Xe,I+=n*lt,A+=n*ar,L+=n*Br,q+=n*Xr,G+=n*Zr,n=e[7],p+=n*nt,d+=n*it,m+=n*J,g+=n*ue,y+=n*ce,w+=n*Te,b+=n*Le,v+=n*De,S+=n*$t,R+=n*sr,I+=n*Xe,A+=n*lt,L+=n*ar,q+=n*Br,G+=n*Xr,j+=n*Zr,n=e[8],d+=n*nt,m+=n*it,g+=n*J,y+=n*ue,w+=n*ce,b+=n*Te,v+=n*Le,S+=n*De,R+=n*$t,I+=n*sr,A+=n*Xe,L+=n*lt,q+=n*ar,G+=n*Br,j+=n*Xr,se+=n*Zr,n=e[9],m+=n*nt,g+=n*it,y+=n*J,w+=n*ue,b+=n*ce,v+=n*Te,S+=n*Le,R+=n*De,I+=n*$t,A+=n*sr,L+=n*Xe,q+=n*lt,G+=n*ar,j+=n*Br,se+=n*Xr,re+=n*Zr,n=e[10],g+=n*nt,y+=n*it,w+=n*J,b+=n*ue,v+=n*ce,S+=n*Te,R+=n*Le,I+=n*De,A+=n*$t,L+=n*sr,q+=n*Xe,G+=n*lt,j+=n*ar,se+=n*Br,re+=n*Xr,Ge+=n*Zr,n=e[11],y+=n*nt,w+=n*it,b+=n*J,v+=n*ue,S+=n*ce,R+=n*Te,I+=n*Le,A+=n*De,L+=n*$t,q+=n*sr,G+=n*Xe,j+=n*lt,se+=n*ar,re+=n*Br,Ge+=n*Xr,me+=n*Zr,n=e[12],w+=n*nt,b+=n*it,v+=n*J,S+=n*ue,R+=n*ce,I+=n*Te,A+=n*Le,L+=n*De,q+=n*$t,G+=n*sr,j+=n*Xe,se+=n*lt,re+=n*ar,Ge+=n*Br,me+=n*Xr,Ce+=n*Zr,n=e[13],b+=n*nt,v+=n*it,S+=n*J,R+=n*ue,I+=n*ce,A+=n*Te,L+=n*Le,q+=n*De,G+=n*$t,j+=n*sr,se+=n*Xe,re+=n*lt,Ge+=n*ar,me+=n*Br,Ce+=n*Xr,z+=n*Zr,n=e[14],v+=n*nt,S+=n*it,R+=n*J,I+=n*ue,A+=n*ce,L+=n*Te,q+=n*Le,G+=n*De,j+=n*$t,se+=n*sr,re+=n*Xe,Ge+=n*lt,me+=n*ar,Ce+=n*Br,z+=n*Xr,He+=n*Zr,n=e[15],S+=n*nt,R+=n*it,I+=n*J,A+=n*ue,L+=n*ce,q+=n*Te,G+=n*Le,j+=n*De,se+=n*$t,re+=n*sr,Ge+=n*Xe,me+=n*lt,Ce+=n*ar,z+=n*Br,He+=n*Xr,or+=n*Zr,o+=38*R,s+=38*I,a+=38*A,l+=38*L,u+=38*q,f+=38*G,h+=38*j,p+=38*se,d+=38*re,m+=38*Ge,g+=38*me,y+=38*Ce,w+=38*z,b+=38*He,v+=38*or,i=1,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=S+i+65535,i=Math.floor(n/65536),S=n-i*65536,o+=i-1+37*(i-1),i=1,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=S+i+65535,i=Math.floor(n/65536),S=n-i*65536,o+=i-1+37*(i-1),t[0]=o,t[1]=s,t[2]=a,t[3]=l,t[4]=u,t[5]=f,t[6]=h,t[7]=p,t[8]=d,t[9]=m,t[10]=g,t[11]=y,t[12]=w,t[13]=b,t[14]=v,t[15]=S}function K3(t,e){El(t,e,e)}function Vke(t,e){for(var r=oc(),n=0;n<16;n++)r[n]=e[n];for(var n=253;n>=0;n--)K3(r,r),n!==2&&n!==4&&El(r,r,e);for(var n=0;n<16;n++)t[n]=r[n]}function wk(t,e){for(var r=new Uint8Array(32),n=new Float64Array(80),i=oc(),o=oc(),s=oc(),a=oc(),l=oc(),u=oc(),f=0;f<31;f++)r[f]=t[f];r[31]=t[31]&127|64,r[0]&=248,Kke(n,e);for(var f=0;f<16;f++)o[f]=n[f];i[0]=a[0]=1;for(var f=254;f>=0;--f){var h=r[f>>>3]>>>(f&7)&1;F3(i,o,h),F3(s,a,h),_7(l,i,s),v7(i,i,s),_7(s,o,a),v7(o,o,a),K3(a,l),K3(u,i),El(i,s,i),El(s,o,l),_7(l,i,s),v7(i,i,s),K3(o,i),v7(s,a,u),El(i,s,Uke),_7(i,i,a),El(s,s,i),El(i,a,u),El(a,o,n),K3(o,l),F3(i,o,h),F3(s,a,h)}for(var f=0;f<16;f++)n[f+16]=i[f],n[f+32]=s[f],n[f+48]=o[f],n[f+64]=a[f];var p=n.subarray(32),d=n.subarray(16);Vke(p,p),El(d,d,p);var m=new Uint8Array(32);return Fke(m,d),m}Qi.scalarMult=wk;function ffe(t){return wk(t,ufe)}Qi.scalarMultBase=ffe;function hfe(t){if(t.length!==Qi.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+Qi.SECRET_KEY_LENGTH+" bytes");var e=new Uint8Array(t),r=ffe(e);return{publicKey:r,secretKey:e}}Qi.generateKeyPairFromSeed=hfe;function qke(t){var e=Bke.randomBytes(32,t),r=hfe(e);return Mke.wipe(e),r}Qi.generateKeyPair=qke;function zke(t,e,r){if(r===void 0&&(r=!1),t.length!==Qi.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(e.length!==Qi.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var n=wk(t,e);if(r){for(var i=0,o=0;o<n.length;o++)i|=n[o];if(i===0)throw new Error("X25519: invalid shared key")}return n}Qi.sharedKey=zke});var mfe=x(Ef=>{"use strict";c();Object.defineProperty(Ef,"__esModule",{value:!0});var x7=U3(),S7=nc();Ef.DIGEST_LENGTH=32;Ef.BLOCK_SIZE=64;var pfe=function(){function t(){this.digestLength=Ef.DIGEST_LENGTH,this.blockSize=Ef.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return t.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},t.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},t.prototype.clean=function(){S7.wipe(this._buffer),S7.wipe(this._temp),this.reset()},t.prototype.update=function(e,r){if(r===void 0&&(r=e.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=e[n++],r--;this._bufferLength===this.blockSize&&(Ek(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=Ek(this._temp,this._state,e,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=e[n++],r--;return this},t.prototype.finish=function(e){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,o=r<<3,s=r%64<56?64:128;this._buffer[n]=128;for(var a=n+1;a<s-8;a++)this._buffer[a]=0;x7.writeUint32BE(i,this._buffer,s-8),x7.writeUint32BE(o,this._buffer,s-4),Ek(this._temp,this._state,this._buffer,0,s),this._finished=!0}for(var a=0;a<this.digestLength/4;a++)x7.writeUint32BE(this._state[a],e,a*4);return this},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},t.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},t.prototype.cleanSavedState=function(e){S7.wipe(e.state),e.buffer&&S7.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},t}();Ef.SHA256=pfe;var Hke=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Ek(t,e,r,n,i){for(;i>=64;){for(var o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],f=e[5],h=e[6],p=e[7],d=0;d<16;d++){var m=n+d*4;t[d]=x7.readUint32BE(r,m)}for(var d=16;d<64;d++){var g=t[d-2],y=(g>>>17|g<<32-17)^(g>>>19|g<<32-19)^g>>>10;g=t[d-15];var w=(g>>>7|g<<32-7)^(g>>>18|g<<32-18)^g>>>3;t[d]=(y+t[d-7]|0)+(w+t[d-16]|0)}for(var d=0;d<64;d++){var y=(((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+(u&f^~u&h)|0)+(p+(Hke[d]+t[d]|0)|0)|0,w=((o>>>2|o<<32-2)^(o>>>13|o<<32-13)^(o>>>22|o<<32-22))+(o&s^o&a^s&a)|0;p=h,h=f,f=u,u=l+y|0,l=a,a=s,s=o,o=y+w|0}e[0]+=o,e[1]+=s,e[2]+=a,e[3]+=l,e[4]+=u,e[5]+=f,e[6]+=h,e[7]+=p,n+=64,i-=64}return n}function $ke(t){var e=new pfe;e.update(t);var r=e.digest();return e.clean(),r}Ef.hash=$ke});var yfe=x(R7=>{"use strict";c();Object.defineProperty(R7,"__esModule",{value:!0});var Ei=U3(),bk=nc(),Gke=20;function Wke(t,e,r){for(var n=1634760805,i=857760878,o=2036477234,s=1797285236,a=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],p=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],m=r[31]<<24|r[30]<<16|r[29]<<8|r[28],g=e[3]<<24|e[2]<<16|e[1]<<8|e[0],y=e[7]<<24|e[6]<<16|e[5]<<8|e[4],w=e[11]<<24|e[10]<<16|e[9]<<8|e[8],b=e[15]<<24|e[14]<<16|e[13]<<8|e[12],v=n,S=i,R=o,I=s,A=a,L=l,q=u,G=f,j=h,se=p,re=d,Ge=m,me=g,Ce=y,z=w,He=b,or=0;or<Gke;or+=2)v=v+A|0,me^=v,me=me>>>32-16|me<<16,j=j+me|0,A^=j,A=A>>>32-12|A<<12,S=S+L|0,Ce^=S,Ce=Ce>>>32-16|Ce<<16,se=se+Ce|0,L^=se,L=L>>>32-12|L<<12,R=R+q|0,z^=R,z=z>>>32-16|z<<16,re=re+z|0,q^=re,q=q>>>32-12|q<<12,I=I+G|0,He^=I,He=He>>>32-16|He<<16,Ge=Ge+He|0,G^=Ge,G=G>>>32-12|G<<12,R=R+q|0,z^=R,z=z>>>32-8|z<<8,re=re+z|0,q^=re,q=q>>>32-7|q<<7,I=I+G|0,He^=I,He=He>>>32-8|He<<8,Ge=Ge+He|0,G^=Ge,G=G>>>32-7|G<<7,S=S+L|0,Ce^=S,Ce=Ce>>>32-8|Ce<<8,se=se+Ce|0,L^=se,L=L>>>32-7|L<<7,v=v+A|0,me^=v,me=me>>>32-8|me<<8,j=j+me|0,A^=j,A=A>>>32-7|A<<7,v=v+L|0,He^=v,He=He>>>32-16|He<<16,re=re+He|0,L^=re,L=L>>>32-12|L<<12,S=S+q|0,me^=S,me=me>>>32-16|me<<16,Ge=Ge+me|0,q^=Ge,q=q>>>32-12|q<<12,R=R+G|0,Ce^=R,Ce=Ce>>>32-16|Ce<<16,j=j+Ce|0,G^=j,G=G>>>32-12|G<<12,I=I+A|0,z^=I,z=z>>>32-16|z<<16,se=se+z|0,A^=se,A=A>>>32-12|A<<12,R=R+G|0,Ce^=R,Ce=Ce>>>32-8|Ce<<8,j=j+Ce|0,G^=j,G=G>>>32-7|G<<7,I=I+A|0,z^=I,z=z>>>32-8|z<<8,se=se+z|0,A^=se,A=A>>>32-7|A<<7,S=S+q|0,me^=S,me=me>>>32-8|me<<8,Ge=Ge+me|0,q^=Ge,q=q>>>32-7|q<<7,v=v+L|0,He^=v,He=He>>>32-8|He<<8,re=re+He|0,L^=re,L=L>>>32-7|L<<7;Ei.writeUint32LE(v+n|0,t,0),Ei.writeUint32LE(S+i|0,t,4),Ei.writeUint32LE(R+o|0,t,8),Ei.writeUint32LE(I+s|0,t,12),Ei.writeUint32LE(A+a|0,t,16),Ei.writeUint32LE(L+l|0,t,20),Ei.writeUint32LE(q+u|0,t,24),Ei.writeUint32LE(G+f|0,t,28),Ei.writeUint32LE(j+h|0,t,32),Ei.writeUint32LE(se+p|0,t,36),Ei.writeUint32LE(re+d|0,t,40),Ei.writeUint32LE(Ge+m|0,t,44),Ei.writeUint32LE(me+g|0,t,48),Ei.writeUint32LE(Ce+y|0,t,52),Ei.writeUint32LE(z+w|0,t,56),Ei.writeUint32LE(He+b|0,t,60)}function gfe(t,e,r,n,i){if(i===void 0&&(i=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var o,s;if(i===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");o=new Uint8Array(16),s=o.length-e.length,o.set(e,s)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");o=e,s=i}for(var a=new Uint8Array(64),l=0;l<r.length;l+=64){Wke(a,o,t);for(var u=l;u<l+64&&u<r.length;u++)n[u]=r[u]^a[u-l];Yke(o,0,s)}return bk.wipe(a),i===0&&bk.wipe(o),n}R7.streamXOR=gfe;function jke(t,e,r,n){return n===void 0&&(n=0),bk.wipe(r),gfe(t,e,r,r,n)}R7.stream=jke;function Yke(t,e,r){for(var n=1;r--;)n=n+(t[e]&255)|0,t[e]=n&255,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}});var Efe=x(bl=>{"use strict";c();Object.defineProperty(bl,"__esModule",{value:!0});var Qke=w7(),T7=nc();bl.DIGEST_LENGTH=16;var wfe=function(){function t(e){this.digestLength=bl.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=r&8191;var n=e[2]|e[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=e[4]|e[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var o=e[6]|e[7]<<8;this._r[3]=(i>>>7|o<<9)&8191;var s=e[8]|e[9]<<8;this._r[4]=(o>>>4|s<<12)&255,this._r[5]=s>>>1&8190;var a=e[10]|e[11]<<8;this._r[6]=(s>>>14|a<<2)&8191;var l=e[12]|e[13]<<8;this._r[7]=(a>>>11|l<<5)&8065;var u=e[14]|e[15]<<8;this._r[8]=(l>>>8|u<<8)&8191,this._r[9]=u>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return t.prototype._blocks=function(e,r,n){for(var i=this._fin?0:2048,o=this._h[0],s=this._h[1],a=this._h[2],l=this._h[3],u=this._h[4],f=this._h[5],h=this._h[6],p=this._h[7],d=this._h[8],m=this._h[9],g=this._r[0],y=this._r[1],w=this._r[2],b=this._r[3],v=this._r[4],S=this._r[5],R=this._r[6],I=this._r[7],A=this._r[8],L=this._r[9];n>=16;){var q=e[r+0]|e[r+1]<<8;o+=q&8191;var G=e[r+2]|e[r+3]<<8;s+=(q>>>13|G<<3)&8191;var j=e[r+4]|e[r+5]<<8;a+=(G>>>10|j<<6)&8191;var se=e[r+6]|e[r+7]<<8;l+=(j>>>7|se<<9)&8191;var re=e[r+8]|e[r+9]<<8;u+=(se>>>4|re<<12)&8191,f+=re>>>1&8191;var Ge=e[r+10]|e[r+11]<<8;h+=(re>>>14|Ge<<2)&8191;var me=e[r+12]|e[r+13]<<8;p+=(Ge>>>11|me<<5)&8191;var Ce=e[r+14]|e[r+15]<<8;d+=(me>>>8|Ce<<8)&8191,m+=Ce>>>5|i;var z=0,He=z;He+=o*g,He+=s*(5*L),He+=a*(5*A),He+=l*(5*I),He+=u*(5*R),z=He>>>13,He&=8191,He+=f*(5*S),He+=h*(5*v),He+=p*(5*b),He+=d*(5*w),He+=m*(5*y),z+=He>>>13,He&=8191;var or=z;or+=o*y,or+=s*g,or+=a*(5*L),or+=l*(5*A),or+=u*(5*I),z=or>>>13,or&=8191,or+=f*(5*R),or+=h*(5*S),or+=p*(5*v),or+=d*(5*b),or+=m*(5*w),z+=or>>>13,or&=8191;var nt=z;nt+=o*w,nt+=s*y,nt+=a*g,nt+=l*(5*L),nt+=u*(5*A),z=nt>>>13,nt&=8191,nt+=f*(5*I),nt+=h*(5*R),nt+=p*(5*S),nt+=d*(5*v),nt+=m*(5*b),z+=nt>>>13,nt&=8191;var it=z;it+=o*b,it+=s*w,it+=a*y,it+=l*g,it+=u*(5*L),z=it>>>13,it&=8191,it+=f*(5*A),it+=h*(5*I),it+=p*(5*R),it+=d*(5*S),it+=m*(5*v),z+=it>>>13,it&=8191;var J=z;J+=o*v,J+=s*b,J+=a*w,J+=l*y,J+=u*g,z=J>>>13,J&=8191,J+=f*(5*L),J+=h*(5*A),J+=p*(5*I),J+=d*(5*R),J+=m*(5*S),z+=J>>>13,J&=8191;var ue=z;ue+=o*S,ue+=s*v,ue+=a*b,ue+=l*w,ue+=u*y,z=ue>>>13,ue&=8191,ue+=f*g,ue+=h*(5*L),ue+=p*(5*A),ue+=d*(5*I),ue+=m*(5*R),z+=ue>>>13,ue&=8191;var ce=z;ce+=o*R,ce+=s*S,ce+=a*v,ce+=l*b,ce+=u*w,z=ce>>>13,ce&=8191,ce+=f*y,ce+=h*g,ce+=p*(5*L),ce+=d*(5*A),ce+=m*(5*I),z+=ce>>>13,ce&=8191;var Te=z;Te+=o*I,Te+=s*R,Te+=a*S,Te+=l*v,Te+=u*b,z=Te>>>13,Te&=8191,Te+=f*w,Te+=h*y,Te+=p*g,Te+=d*(5*L),Te+=m*(5*A),z+=Te>>>13,Te&=8191;var Le=z;Le+=o*A,Le+=s*I,Le+=a*R,Le+=l*S,Le+=u*v,z=Le>>>13,Le&=8191,Le+=f*b,Le+=h*w,Le+=p*y,Le+=d*g,Le+=m*(5*L),z+=Le>>>13,Le&=8191;var De=z;De+=o*L,De+=s*A,De+=a*I,De+=l*R,De+=u*S,z=De>>>13,De&=8191,De+=f*v,De+=h*b,De+=p*w,De+=d*y,De+=m*g,z+=De>>>13,De&=8191,z=(z<<2)+z|0,z=z+He|0,He=z&8191,z=z>>>13,or+=z,o=He,s=or,a=nt,l=it,u=J,f=ue,h=ce,p=Te,d=Le,m=De,r+=16,n-=16}this._h[0]=o,this._h[1]=s,this._h[2]=a,this._h[3]=l,this._h[4]=u,this._h[5]=f,this._h[6]=h,this._h[7]=p,this._h[8]=d,this._h[9]=m},t.prototype.finish=function(e,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,o,s,a;if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=i,i=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,a=1;a<10;a++)n[a]=this._h[a]+i,i=n[a]>>>13,n[a]&=8191;for(n[9]-=1<<13,o=(i^1)-1,a=0;a<10;a++)n[a]&=o;for(o=~o,a=0;a<10;a++)this._h[a]=this._h[a]&o|n[a];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,s=this._h[0]+this._pad[0],this._h[0]=s&65535,a=1;a<8;a++)s=(this._h[a]+this._pad[a]|0)+(s>>>16)|0,this._h[a]=s&65535;return e[r+0]=this._h[0]>>>0,e[r+1]=this._h[0]>>>8,e[r+2]=this._h[1]>>>0,e[r+3]=this._h[1]>>>8,e[r+4]=this._h[2]>>>0,e[r+5]=this._h[2]>>>8,e[r+6]=this._h[3]>>>0,e[r+7]=this._h[3]>>>8,e[r+8]=this._h[4]>>>0,e[r+9]=this._h[4]>>>8,e[r+10]=this._h[5]>>>0,e[r+11]=this._h[5]>>>8,e[r+12]=this._h[6]>>>0,e[r+13]=this._h[6]>>>8,e[r+14]=this._h[7]>>>0,e[r+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(e){var r=0,n=e.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var o=0;o<i;o++)this._buffer[this._leftover+o]=e[r+o];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(e,r,i),r+=i,n-=i),n){for(var o=0;o<n;o++)this._buffer[this._leftover+o]=e[r+o];this._leftover+=n}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},t.prototype.clean=function(){return T7.wipe(this._buffer),T7.wipe(this._r),T7.wipe(this._h),T7.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();bl.Poly1305=wfe;function Xke(t,e){var r=new wfe(t);r.update(e);var n=r.digest();return r.clean(),n}bl.oneTimeAuth=Xke;function Zke(t,e){return t.length!==bl.DIGEST_LENGTH||e.length!==bl.DIGEST_LENGTH?!1:Qke.equal(t,e)}bl.equal=Zke});var vfe=x(_l=>{"use strict";c();Object.defineProperty(_l,"__esModule",{value:!0});var A7=yfe(),Jke=Efe(),V3=nc(),bfe=U3(),eDe=w7();_l.KEY_LENGTH=32;_l.NONCE_LENGTH=12;_l.TAG_LENGTH=16;var _fe=new Uint8Array(16),tDe=function(){function t(e){if(this.nonceLength=_l.NONCE_LENGTH,this.tagLength=_l.TAG_LENGTH,e.length!==_l.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return t.prototype.seal=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var o=new Uint8Array(16);o.set(e,o.length-e.length);var s=new Uint8Array(32);A7.stream(this._key,o,s,4);var a=r.length+this.tagLength,l;if(i){if(i.length!==a)throw new Error("ChaCha20Poly1305: incorrect destination length");l=i}else l=new Uint8Array(a);return A7.streamXOR(this._key,o,r,l,4),this._authenticate(l.subarray(l.length-this.tagLength,l.length),s,l.subarray(0,l.length-this.tagLength),n),V3.wipe(o),l},t.prototype.open=function(e,r,n,i){if(e.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var o=new Uint8Array(16);o.set(e,o.length-e.length);var s=new Uint8Array(32);A7.stream(this._key,o,s,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,s,r.subarray(0,r.length-this.tagLength),n),!eDe.equal(a,r.subarray(r.length-this.tagLength,r.length)))return null;var l=r.length-this.tagLength,u;if(i){if(i.length!==l)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(l);return A7.streamXOR(this._key,o,r.subarray(0,r.length-this.tagLength),u,4),V3.wipe(o),u},t.prototype.clean=function(){return V3.wipe(this._key),this},t.prototype._authenticate=function(e,r,n,i){var o=new Jke.Poly1305(r);i&&(o.update(i),i.length%16>0&&o.update(_fe.subarray(i.length%16))),o.update(n),n.length%16>0&&o.update(_fe.subarray(n.length%16));var s=new Uint8Array(8);i&&bfe.writeUint64LE(i.length,s),o.update(s),bfe.writeUint64LE(n.length,s),o.update(s);for(var a=o.digest(),l=0;l<a.length;l++)e[l]=a[l];o.clean(),V3.wipe(a),V3.wipe(s)},t}();_l.ChaCha20Poly1305=tDe});var zfe=x((Nkt,qfe)=>{c();qfe.exports=Vfe;var Kfe=128,mDe=127,gDe=~mDe,yDe=Math.pow(2,31);function Vfe(t,e,r){e=e||[],r=r||0;for(var n=r;t>=yDe;)e[r++]=t&255|Kfe,t/=128;for(;t&gDe;)e[r++]=t&255|Kfe,t>>>=7;return e[r]=t|0,Vfe.bytes=r-n+1,e}});var Gfe=x((kkt,$fe)=>{c();$fe.exports=xk;var wDe=128,Hfe=127;function xk(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw xk.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&Hfe)<<i:(s&Hfe)*Math.pow(2,i),i+=7}while(s>=wDe);return xk.bytes=o-n,r}});var jfe=x((Dkt,Wfe)=>{c();var EDe=Math.pow(2,7),bDe=Math.pow(2,14),_De=Math.pow(2,21),vDe=Math.pow(2,28),SDe=Math.pow(2,35),xDe=Math.pow(2,42),RDe=Math.pow(2,49),TDe=Math.pow(2,56),ADe=Math.pow(2,63);Wfe.exports=function(t){return t<EDe?1:t<bDe?2:t<_De?3:t<vDe?4:t<SDe?5:t<xDe?6:t<RDe?7:t<TDe?8:t<ADe?9:10}});var Qfe=x((Okt,Yfe)=>{c();Yfe.exports={encode:zfe(),decode:Gfe(),encodingLength:jfe()}});var Jfe=x((Lkt,Zfe)=>{"use strict";c();var Xfe=Qfe();Zfe.exports=t=>{if(!(t instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");let e=[];for(;t.length>0;){let r=Xfe.decode(t);e.push(r),t=t.slice(Xfe.decode.bytes)}return e}});var mhe=x((dhe,phe)=>{"use strict";c();var MDe=Math.exp;dhe=phe.exports=function(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let r,n=0,i=0,o=0,s,a={};function l(u,f){return 1-MDe(-(u-f)/e)}return a.push=function(f,h){if(s){let p=l(f,s),d=h-r,m=p*d;r=p*h+(1-p)*r,n=(1-p)*(n+d*m),i=Math.sqrt(n),o=r+p*d}else r=h;s=f},a.movingAverage=function(){return r},a.variance=function(){return n},a.deviation=function(){return i},a.forecast=function(){return o},a}});var XDe={};_t(XDe,{create:()=>WDe,globSource:()=>jDe,path:()=>QDe,urlSource:()=>YDe});c();c();c();c();var yD=E(mv(),1),Ye=yD.default;var Bhe=E(l4(),1);c();var fa=E(Oi(),1);en();si();Cl();fa.default.formatters.b=t=>t==null?"undefined":Oe.baseEncode(t);fa.default.formatters.t=t=>t==null?"undefined":xt.baseEncode(t);fa.default.formatters.m=t=>t==null?"undefined":ua.baseEncode(t);fa.default.formatters.p=t=>t==null?"undefined":t.toString();fa.default.formatters.c=t=>t==null?"undefined":t.toString();fa.default.formatters.k=t=>t==null?"undefined":t.toString();function C(t){return Object.assign((0,fa.default)(t),{error:(0,fa.default)(`${t}:error`),trace:(0,fa.default)(`${t}:trace`)})}var ev=E(V(),1);c();var w4=E(V(),1);c();var uc=E(pa(),1),Qd=uc.default.Reader,Kv=uc.default.Writer,Fe=uc.default.util,Zn=uc.default.roots["ipfs-unixfs"]||(uc.default.roots["ipfs-unixfs"]={}),RO=Zn.Data=(()=>{function t(e){if(this.blocksizes=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Type=0,t.prototype.Data=Fe.newBuffer([]),t.prototype.filesize=Fe.Long?Fe.Long.fromBits(0,0,!0):0,t.prototype.blocksizes=Fe.emptyArray,t.prototype.hashType=Fe.Long?Fe.Long.fromBits(0,0,!0):0,t.prototype.fanout=Fe.Long?Fe.Long.fromBits(0,0,!0):0,t.prototype.mode=0,t.prototype.mtime=null,t.encode=function(r,n){if(n||(n=Kv.create()),n.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&n.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&n.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var i=0;i<r.blocksizes.length;++i)n.uint32(32).uint64(r.blocksizes[i]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&n.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&n.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&n.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&Zn.UnixTime.encode(r.mtime,n.uint32(66).fork()).ldelim(),n},t.decode=function(r,n){r instanceof Qd||(r=Qd.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Zn.Data;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.Type=r.int32();break;case 2:o.Data=r.bytes();break;case 3:o.filesize=r.uint64();break;case 4:if(o.blocksizes&&o.blocksizes.length||(o.blocksizes=[]),(s&7)===2)for(var a=r.uint32()+r.pos;r.pos<a;)o.blocksizes.push(r.uint64());else o.blocksizes.push(r.uint64());break;case 5:o.hashType=r.uint64();break;case 6:o.fanout=r.uint64();break;case 7:o.mode=r.uint32();break;case 8:o.mtime=Zn.UnixTime.decode(r,r.uint32());break;default:r.skipType(s&7);break}}if(!o.hasOwnProperty("Type"))throw Fe.ProtocolError("missing required 'Type'",{instance:o});return o},t.fromObject=function(r){if(r instanceof Zn.Data)return r;var n=new Zn.Data;switch(r.Type){case"Raw":case 0:n.Type=0;break;case"Directory":case 1:n.Type=1;break;case"File":case 2:n.Type=2;break;case"Metadata":case 3:n.Type=3;break;case"Symlink":case 4:n.Type=4;break;case"HAMTShard":case 5:n.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?Fe.base64.decode(r.Data,n.Data=Fe.newBuffer(Fe.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),r.filesize!=null&&(Fe.Long?(n.filesize=Fe.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?n.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?n.filesize=r.filesize:typeof r.filesize=="object"&&(n.filesize=new Fe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");n.blocksizes=[];for(var i=0;i<r.blocksizes.length;++i)Fe.Long?(n.blocksizes[i]=Fe.Long.fromValue(r.blocksizes[i])).unsigned=!0:typeof r.blocksizes[i]=="string"?n.blocksizes[i]=parseInt(r.blocksizes[i],10):typeof r.blocksizes[i]=="number"?n.blocksizes[i]=r.blocksizes[i]:typeof r.blocksizes[i]=="object"&&(n.blocksizes[i]=new Fe.LongBits(r.blocksizes[i].low>>>0,r.blocksizes[i].high>>>0).toNumber(!0))}if(r.hashType!=null&&(Fe.Long?(n.hashType=Fe.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?n.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?n.hashType=r.hashType:typeof r.hashType=="object"&&(n.hashType=new Fe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&(Fe.Long?(n.fanout=Fe.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?n.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?n.fanout=r.fanout:typeof r.fanout=="object"&&(n.fanout=new Fe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(n.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");n.mtime=Zn.UnixTime.fromObject(r.mtime)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.blocksizes=[]),n.defaults){if(i.Type=n.enums===String?"Raw":0,n.bytes===String?i.Data="":(i.Data=[],n.bytes!==Array&&(i.Data=Fe.newBuffer(i.Data))),Fe.Long){var o=new Fe.Long(0,0,!0);i.filesize=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.filesize=n.longs===String?"0":0;if(Fe.Long){var o=new Fe.Long(0,0,!0);i.hashType=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.hashType=n.longs===String?"0":0;if(Fe.Long){var o=new Fe.Long(0,0,!0);i.fanout=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.fanout=n.longs===String?"0":0;i.mode=0,i.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(i.Type=n.enums===String?Zn.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(i.Data=n.bytes===String?Fe.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?i.filesize=n.longs===String?String(r.filesize):r.filesize:i.filesize=n.longs===String?Fe.Long.prototype.toString.call(r.filesize):n.longs===Number?new Fe.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){i.blocksizes=[];for(var s=0;s<r.blocksizes.length;++s)typeof r.blocksizes[s]=="number"?i.blocksizes[s]=n.longs===String?String(r.blocksizes[s]):r.blocksizes[s]:i.blocksizes[s]=n.longs===String?Fe.Long.prototype.toString.call(r.blocksizes[s]):n.longs===Number?new Fe.LongBits(r.blocksizes[s].low>>>0,r.blocksizes[s].high>>>0).toNumber(!0):r.blocksizes[s]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?i.hashType=n.longs===String?String(r.hashType):r.hashType:i.hashType=n.longs===String?Fe.Long.prototype.toString.call(r.hashType):n.longs===Number?new Fe.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?i.fanout=n.longs===String?String(r.fanout):r.fanout:i.fanout=n.longs===String?Fe.Long.prototype.toString.call(r.fanout):n.longs===Number?new Fe.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(i.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(i.mtime=Zn.UnixTime.toObject(r.mtime,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,uc.default.util.toJSONOptions)},t.DataType=function(){let e={},r=Object.create(e);return r[e[0]="Raw"]=0,r[e[1]="Directory"]=1,r[e[2]="File"]=2,r[e[3]="Metadata"]=3,r[e[4]="Symlink"]=4,r[e[5]="HAMTShard"]=5,r}(),t})(),KOe=Zn.UnixTime=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.Seconds=Fe.Long?Fe.Long.fromBits(0,0,!1):0,t.prototype.FractionalNanoseconds=0,t.encode=function(r,n){return n||(n=Kv.create()),n.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&n.uint32(21).fixed32(r.FractionalNanoseconds),n},t.decode=function(r,n){r instanceof Qd||(r=Qd.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Zn.UnixTime;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.Seconds=r.int64();break;case 2:o.FractionalNanoseconds=r.fixed32();break;default:r.skipType(s&7);break}}if(!o.hasOwnProperty("Seconds"))throw Fe.ProtocolError("missing required 'Seconds'",{instance:o});return o},t.fromObject=function(r){if(r instanceof Zn.UnixTime)return r;var n=new Zn.UnixTime;return r.Seconds!=null&&(Fe.Long?(n.Seconds=Fe.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?n.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?n.Seconds=r.Seconds:typeof r.Seconds=="object"&&(n.Seconds=new Fe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(n.FractionalNanoseconds=r.FractionalNanoseconds>>>0),n},t.toObject=function(r,n){n||(n={});var i={};if(n.defaults){if(Fe.Long){var o=new Fe.Long(0,0,!1);i.Seconds=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.Seconds=n.longs===String?"0":0;i.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?i.Seconds=n.longs===String?String(r.Seconds):r.Seconds:i.Seconds=n.longs===String?Fe.Long.prototype.toString.call(r.Seconds):n.longs===Number?new Fe.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(i.FractionalNanoseconds=r.FractionalNanoseconds),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,uc.default.util.toJSONOptions)},t})(),VOe=Zn.Metadata=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.MimeType="",t.encode=function(r,n){return n||(n=Kv.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&n.uint32(10).string(r.MimeType),n},t.decode=function(r,n){r instanceof Qd||(r=Qd.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Zn.Metadata;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.MimeType=r.string();break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof Zn.Metadata)return r;var n=new Zn.Metadata;return r.MimeType!=null&&(n.MimeType=String(r.MimeType)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(i.MimeType=r.MimeType),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,uc.default.util.toJSONOptions)},t})();var fc=RO,TO=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],Cpe=["directory","hamt-sharded-directory"],AO=parseInt("0644",8),IO=parseInt("0755",8);function hc(t){if(t!=null)return typeof t=="number"?t&4095:(t=t.toString(),t.substring(0,1)==="0"?parseInt(t,8)&4095:parseInt(t,10)&4095)}function Dl(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),n=Math.floor(r/1e3);e={secs:n,nsecs:(r-n*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,w4.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}var Qe=class{static unmarshal(e){let r=fc.decode(e),n=fc.toObject(r,{defaults:!1,arrays:!0,longs:Number,objects:!1}),i=new Qe({type:TO[n.Type],data:n.Data,blockSizes:n.blocksizes,mode:n.mode,mtime:n.mtime?{secs:n.mtime.Seconds,nsecs:n.mtime.FractionalNanoseconds}:void 0});return i._originalMode=n.mode||0,i}constructor(e={type:"file"}){let{type:r,data:n,blockSizes:i,hashType:o,fanout:s,mtime:a,mode:l}=e;if(r&&!TO.includes(r))throw(0,w4.default)(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r||"file",this.data=n,this.hashType=o,this.fanout=s,this.blockSizes=i||[],this._originalMode=0,this.mode=hc(l),a&&(this.mtime=Dl(a),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(e){this._mode=this.isDirectory()?IO:AO;let r=hc(e);r!==void 0&&(this._mode=r)}get mode(){return this._mode}isDirectory(){return Boolean(this.type&&Cpe.includes(this.type))}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0;let e=0;return this.blockSizes.forEach(r=>{e+=r}),this.data&&(e+=this.data.length),e}marshal(){let e;switch(this.type){case"raw":e=fc.DataType.Raw;break;case"directory":e=fc.DataType.Directory;break;case"file":e=fc.DataType.File;break;case"metadata":e=fc.DataType.Metadata;break;case"symlink":e=fc.DataType.Symlink;break;case"hamt-sharded-directory":e=fc.DataType.HAMTShard;break;default:throw(0,w4.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE")}let r=this.data;(!this.data||!this.data.length)&&(r=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(hc(this.mode)||0),n===AO&&!this.isDirectory()&&(n=void 0),n===IO&&this.isDirectory()&&(n=void 0));let i;if(this.mtime!=null){let s=Dl(this.mtime);s&&(i={Seconds:s.secs,FractionalNanoseconds:s.nsecs},i.FractionalNanoseconds===0&&delete i.FractionalNanoseconds)}let o={Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i};return fc.encode(o).finish()}};var Tt={};_t(Tt,{code:()=>ht,createLink:()=>HO,createNode:()=>zO,decode:()=>Rt,encode:()=>je,name:()=>f0e,prepare:()=>Ln,validate:()=>$v});c();te();c();var t0e=new TextDecoder;function zv(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let i=t[e++];if(r+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[r,e]}function S4(t,e){let r;[r,e]=zv(t,e);let n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function LO(t,e){let r;return[r,e]=zv(t,e),[r&7,r>>3,e]}function r0e(t){let e={},r=t.length,n=0;for(;n<r;){let i,o;if([i,o,n]=LO(t,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=S4(t,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=S4(t,n),e.Name=t0e.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=zv(t,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function BO(t){let e=t.length,r=0,n,i=!1,o;for(;r<e;){let a,l;if([a,l,r]=LO(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(l===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,r]=S4(t,r),n&&(i=!0)}else if(l===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,r]=S4(t,r),n.push(r0e(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${l}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}c();var UO=new TextEncoder,MO=2**32,n0e=2**31;function i0e(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=km(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let n=UO.encode(t.Name);r-=n.length,e.set(n,r),r=km(e,r,n.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=km(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function FO(t){let e=s0e(t),r=new Uint8Array(e),n=e;if(t.Data&&(n-=t.Data.length,r.set(t.Data,n),n=km(r,n,t.Data.length)-1,r[n]=10),t.Links)for(let i=t.Links.length-1;i>=0;i--){let o=i0e(t.Links[i],r.subarray(0,n));n-=o,n=km(r,n,o)-1,r[n]=18}return r}function o0e(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+Jd(r)}if(typeof t.Name=="string"){let r=UO.encode(t.Name).length;e+=1+r+Jd(r)}return typeof t.Tsize=="number"&&(e+=1+Jd(t.Tsize)),e}function s0e(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+Jd(r)}if(t.Links)for(let r of t.Links){let n=o0e(r);e+=1+n+Jd(n)}return e}function km(t,e,r){e-=Jd(r);let n=e;for(;r>=n0e;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,n}function Jd(t){return t%2===0&&t++,Math.floor((a0e(t)+6)/7)}function a0e(t){let e=0;return t>=MO&&(t=Math.floor(t/MO),e=32),t>=1<<16&&(t>>>=16,e+=16),t>=1<<8&&(t>>>=8,e+=8),e+c0e[t]}var c0e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];c();te();var l0e=["Data","Links"],u0e=["Hash","Name","Tsize"],Hv=new TextEncoder;function VO(t,e){if(t===e)return 0;let r=t.Name?Hv.encode(t.Name):[],n=e.Name?Hv.encode(e.Name):[],i=r.length,o=n.length;for(let s=0,a=Math.min(i,o);s<a;++s)if(r[s]!==n[s]){i=r[s],o=n[s];break}return i<o?-1:o<i?1:0}function KO(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function qO(t){if(typeof t.asCID=="object"){let r=T.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=T.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=T.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=T.decode(t.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function Ln(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=Hv.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(qO),e.Links.sort(VO);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function $v(t){if(!t||typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");if(!KO(t,l0e))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!KO(r,u0e))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!r.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash.asCID!==r.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0&&(typeof r.Tsize!="number"||r.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e>0&&VO(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function zO(t,e=[]){return Ln({Data:t,Links:e})}function HO(t,e,r){return qO({Hash:r,Name:t,Tsize:e})}var f0e="dag-pb",ht=112;function je(t){$v(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),t.Data&&(e.Data=t.Data),FO(e)}function Rt(t){let e=BO(t),r={};return e.Data&&(r.Data=e.Data),e.Links&&(r.Links=e.Links.map(n=>{let i={};try{i.Hash=T.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),r}var mc={};_t(mc,{code:()=>Lf,decode:()=>Bf,encode:()=>l9,name:()=>H0e});c();Of();te();var QL=42;function F0e(t){if(t.asCID!==t)return null;let e=T.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Q(O.tag,QL),new Q(O.bytes,r)]}function K0e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function V0e(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var q0e={float64:!0,typeEncoders:{Object:F0e,undefined:K0e,number:V0e}};function z0e(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return T.decode(t.subarray(1))}var XL={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};XL.tags[QL]=z0e;var H0e="dag-cbor",Lf=113,l9=t=>no(t,q0e),Bf=t=>Mn(t,XL);var lp={};_t(lp,{code:()=>g9,decode:()=>e1e,encode:()=>J0e,name:()=>Z0e});c();ap();Cl();Of();c();c();_i();s9();Zi();Ol();var f9=class extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){let r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===O.array&&(r.elements++,r.elements!==1&&e.push([44])),r.type===O.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?e.push([44]):e.push([58]))))}[O.uint.major](e,r){this.prefix(e);let n=String(r.value),i=[];for(let o=0;o<n.length;o++)i[o]=n.charCodeAt(o);e.push(i)}[O.negint.major](e,r){this[O.uint.major](e,r)}[O.bytes.major](e,r){throw new Error(`${dc} unsupported type: Uint8Array`)}[O.string.major](e,r){this.prefix(e);let n=R4(JSON.stringify(r.value));e.push(n.length>32?Dm(n):n)}[O.array.major](e,r){this.prefix(e),this.inRecursive.push({type:O.array,elements:0}),e.push([91])}[O.map.major](e,r){this.prefix(e),this.inRecursive.push({type:O.map,elements:0}),e.push([123])}[O.tag.major](e,r){}[O.float.major](e,r){if(r.type.name==="break"){let s=this.inRecursive.pop();if(s){if(s.type===O.array)e.push([93]);else if(s.type===O.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${dc} unsupported type: undefined`);if(this.prefix(e),r.type.name==="true"){e.push([116,114,117,101]);return}else if(r.type.name==="false"){e.push([102,97,108,115,101]);return}else if(r.type.name==="null"){e.push([110,117,108,108]);return}let n=String(r.value),i=[],o=!1;for(let s=0;s<n.length;s++)i[s]=n.charCodeAt(s),!o&&(i[s]===46||i[s]===101||i[s]===69)&&(o=!0);o||(i.push(46),i.push(48)),e.push(i)}};function $0e(t,e){if(Array.isArray(t[0])||Array.isArray(e[0]))throw new Error(`${dc} complex map keys are not supported`);let r=t[0],n=e[0];if(r.type!==O.string||n.type!==O.string)throw new Error(`${dc} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${dc} unexpected duplicate map keys, this is not supported`)}var G0e={addBreakTokens:!0,mapSorter:$0e};function h9(t,e){return e=Object.assign({},G0e,e),o9(t,new f9,e)}c();c9();_i();Ol();Zi();var cp=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r,this.modeStack=["value"],this.lastToken=""}done(){return this.pos>=this.data.length}ch(){return this.data[this.pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this.pos]}expect(e){if(this.data.length-this.pos<e.length)throw new Error(`${xe} unexpected end of input at position ${this.pos}`);for(let r=0;r<e.length;r++)if(this.data[this.pos++]!==e[r])throw new Error(`${xe} unexpected token at position ${this.pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){let e=this.pos,r=!1,n=!1,i=a=>{for(;!this.done();){let l=this.ch();if(a.includes(l))this.pos++;else break}};if(this.ch()===45&&(r=!0,this.pos++),this.ch()===48)if(this.pos++,this.ch()===46)this.pos++,n=!0;else return new Q(O.uint,0,this.pos-e);if(i([48,49,50,51,52,53,54,55,56,57]),r&&this.pos===e+1)throw new Error(`${xe} unexpected token at position ${this.pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${xe} unexpected token at position ${this.pos}`);n=!0,this.pos++,i([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this.pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this.pos++,i([48,49,50,51,52,53,54,55,56,57]));let o=String.fromCharCode.apply(null,this.data.subarray(e,this.pos)),s=parseFloat(o);return n?new Q(O.float,s,this.pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(s)?new Q(s>=0?O.uint:O.negint,s,this.pos-e):new Q(s>=0?O.uint:O.negint,BigInt(o),this.pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${xe} unexpected character at position ${this.pos}; this shouldn't happen`);this.pos++;for(let o=this.pos,s=0;o<this.data.length&&s<65536;o++,s++){let a=this.data[o];if(a===92||a<32||a>=128)break;if(a===34){let l=String.fromCharCode.apply(null,this.data.subarray(this.pos,o));return this.pos=o+1,new Q(O.string,l,s)}}let e=this.pos,r=[],n=()=>{if(this.pos+4>=this.data.length)throw new Error(`${xe} unexpected end of unicode escape sequence at position ${this.pos}`);let o=0;for(let s=0;s<4;s++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${xe} unexpected unicode escape character at position ${this.pos}`);o=o*16+a,this.pos++}return o},i=()=>{let o=this.ch(),s=null,a=o>239?4:o>223?3:o>191?2:1;if(this.pos+a>this.data.length)throw new Error(`${xe} unexpected unicode sequence at position ${this.pos}`);let l,u,f,h;switch(a){case 1:o<128&&(s=o);break;case 2:l=this.data[this.pos+1],(l&192)===128&&(h=(o&31)<<6|l&63,h>127&&(s=h));break;case 3:l=this.data[this.pos+1],u=this.data[this.pos+2],(l&192)===128&&(u&192)===128&&(h=(o&15)<<12|(l&63)<<6|u&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:l=this.data[this.pos+1],u=this.data[this.pos+2],f=this.data[this.pos+3],(l&192)===128&&(u&192)===128&&(f&192)===128&&(h=(o&15)<<18|(l&63)<<12|(u&63)<<6|f&63,h>65535&&h<1114112&&(s=h))}s===null?(s=65533,a=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|s&1023),r.push(s),this.pos+=a};for(;!this.done();){let o=this.ch(),s;switch(o){case 92:if(this.pos++,this.done())throw new Error(`${xe} unexpected string termination at position ${this.pos}`);switch(s=this.ch(),this.pos++,s){case 34:case 39:case 92:case 47:r.push(s);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${xe} unexpected string escape character at position ${this.pos}`)}break;case 34:return this.pos++,new Q(O.string,Gv(r),this.pos-e);default:if(o<32)throw new Error(`${xe} invalid control character at position ${this.pos}`);o<128?(r.push(o),this.pos++):i()}}throw new Error(`${xe} unexpected end of string at position ${this.pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this.pos++,new Q(O.map,1/0,1);case 91:return this.modeStack.push("array-start"),this.pos++,new Q(O.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Q(O.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Q(O.false,!1,5);case 116:return this.expect([116,114,117,101]),new Q(O.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${xe} unexpected character at position ${this.pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this.pos++,this.skipWhitespace(),new Q(O.break,void 0,1);if(this.ch()!==44)throw new Error(`${xe} unexpected character at position ${this.pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this.pos++,this.skipWhitespace(),new Q(O.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this.pos++,this.skipWhitespace(),new Q(O.break,void 0,1);if(this.ch()!==44)throw new Error(`${xe} unexpected character at position ${this.pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this.pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this.pos++,this.skipWhitespace(),new Q(O.break,void 0,1);let e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${xe} unexpected character at position ${this.pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this.pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${xe} unexpected parse state at position ${this.pos}; this shouldn't happen`)}}};function d9(t,e){return e=Object.assign({tokenizer:new cp(t,e)},e),Mn(t,e)}function j0e(t){if(t.asCID!==t)return null;let e=T.asCID(t);if(!e)return null;let r=e.toString();return[new Q(O.map,1/0,1),new Q(O.string,"/",1),new Q(O.string,r,r.length),new Q(O.break,void 0,1)]}function JL(t){let e=ua.encode(t).slice(1);return[new Q(O.map,1/0,1),new Q(O.string,"/",1),new Q(O.map,1/0,1),new Q(O.string,"bytes",5),new Q(O.string,e,e.length),new Q(O.break,void 0,1),new Q(O.break,void 0,1)]}function Y0e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Q0e(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var X0e={typeEncoders:{Object:j0e,Uint8Array:JL,Buffer:JL,undefined:Y0e,number:Q0e}},p9=class extends cp{constructor(e,r){super(e,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){let e=this._next();if(e.type===O.map){let r=this._next();if(r.type===O.string&&r.value==="/"){let n=this._next();if(n.type===O.string){if(this._next().type!==O.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new Q(O.tag,42,0)}if(n.type===O.map){let i=this._next();if(i.type===O.string&&i.value==="bytes"){let o=this._next();if(o.type===O.string){for(let a=0;a<2;a++)if(this._next().type!==O.break)throw new Error("Invalid encoded Bytes form");let s=ua.decode(`m${o.value}`);return new Q(O.bytes,s,o.value.length)}this.tokenBuffer.push(o)}this.tokenBuffer.push(i)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return e}},m9={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};m9.tags[42]=T.parse;var Z0e="dag-json",g9=297,J0e=t=>h9(t,X0e),e1e=t=>{let e=Object.assign(m9,{tokenizer:new p9(t,m9)});return d9(t,e)};var zDe=E(S9(),1);gc();Vm();c();c();var yc=class extends Error{constructor(e="not initialized"){super(e),this.name="NotInitializedError",this.code=yc.code}};yc.code="ERR_NOT_INITIALIZED";var O9=class extends Error{constructor(e="cannot initialize an initializing node"){super(e),this.name="AlreadyInitializingError",this.code=vs.code}};O9.code="ERR_ALREADY_INITIALIZING";var vs=class extends Error{constructor(e="cannot re-initialize an initialized node"){super(e),this.name="AlreadyInitializedError",this.code=vs.code}};vs.code="ERR_ALREADY_INITIALIZED";var wc=class extends Error{constructor(e="not started"){super(e),this.name="NotStartedError",this.code=wc.code}};wc.code="ERR_NOT_STARTED";var Uf=class extends Error{constructor(e="cannot start, already startin"){super(e),this.name="AlreadyStartingError",this.code=Uf.code}};Uf.code="ERR_ALREADY_STARTING";var Ff=class extends Error{constructor(e="cannot start, already started"){super(e),this.name="AlreadyStartedError",this.code=Ff.code}};Ff.code="ERR_ALREADY_STARTED";var Ss=class extends Error{constructor(e="not enabled"){super(e),this.name="NotEnabledError",this.code=Ss.code}};Ss.code="ERR_NOT_ENABLED";Ae();c();c();c();var iU=E(Xm(),1);te();c();vp();Re();Ae();var Ec="/",WM=new TextEncoder().encode(Ec),ew=WM[0],ae=class{constructor(e,r){if(typeof e=="string")this._buf=U(e);else if(e instanceof Uint8Array)this._buf=e;else throw new Error("Invalid key, should be String of Uint8Array");if(r==null&&(r=!0),r&&this.clean(),this._buf.byteLength===0||this._buf[0]!==ew)throw new Error("Invalid key")}toString(e="utf8"){return F(this._buf,e)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(e){return new ae(e.join(Ec))}static random(){return new ae(Vf().replace(/-/g,""))}static asKey(e){return e instanceof Uint8Array||typeof e=="string"?new ae(e):e.uint8Array?new ae(e.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=WM),this._buf[0]!==ew){let e=new Uint8Array(this._buf.byteLength+1);e.fill(ew,0,1),e.set(this._buf,1),this._buf=e}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===ew;)this._buf=this._buf.subarray(0,-1)}less(e){let r=this.list(),n=e.list();for(let i=0;i<r.length;i++){if(n.length<i+1)return!1;let o=r[i],s=n[i];if(o<s)return!0;if(o>s)return!1}return r.length<n.length}reverse(){return ae.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){let e=this.namespaces();return e[e.length-1]}list(){return this.toString().split(Ec).slice(1)}type(){return e2e(this.baseNamespace())}name(){return t2e(this.baseNamespace())}instance(e){return new ae(this.toString()+":"+e)}path(){let e=this.parent().toString();return e.endsWith(Ec)||(e+=Ec),e+=this.type(),new ae(e)}parent(){let e=this.list();return e.length===1?new ae(Ec):new ae(e.slice(0,-1).join(Ec))}child(e){return this.toString()===Ec?e:e.toString()===Ec?this:new ae(this.toString()+e.toString(),!1)}isAncestorOf(e){return e.toString()===this.toString()?!1:e.toString().startsWith(this.toString())}isDecendantOf(e){return e.toString()===this.toString()?!1:this.toString().startsWith(e.toString())}isTopLevel(){return this.list().length===1}concat(...e){return ae.withNamespaces([...this.namespaces(),...r2e(e.map(r=>r.namespaces()))])}};function e2e(t){let e=t.split(":");return e.length<2?"":e.slice(0,-1).join(":")}function t2e(t){let e=t.split(":");return e[e.length-1]}function r2e(t){return[].concat(...t)}var rw=E(V(),1);c();var tU=E(Vo(),1),rU=E(Ui(),1);c();var o2e=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;dt.nanosecond=dt.ns=1/1e6;dt.\u00B5s=dt.\u03BCs=dt.us=dt.microsecond=1/1e3;dt.millisecond=dt.ms=dt[""]=1;dt.second=dt.sec=dt.s=dt.ms*1e3;dt.minute=dt.min=dt.m=dt.s*60;dt.hour=dt.hr=dt.h=dt.m*60;dt.day=dt.d=dt.h*24;dt.week=dt.wk=dt.w=dt.d*7;dt.month=dt.b=dt.d*(365.25/12);dt.year=dt.yr=dt.y=dt.d*365.25;function dt(t="",e="ms"){var r=null;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(o2e,function(n,i,o){o=eU(o),o&&(r=(r||0)+parseFloat(i,10)*o)}),r&&r/(eU(e)||1)}function eU(t){return dt[t]||dt[t.toLowerCase().replace(/s$/,"")]}var Fl=dt;c();var bc=class extends Error{constructor(e="request timed out"){super(e),this.name="TimeoutError",this.code=bc.code}};bc.code="ERR_TIMEOUT";function B(t,e){return(...r)=>{let n=r[e??r.length-1];if(!n||!n.timeout)return t(...r);let i=typeof n.timeout=="string"?Fl(n.timeout):n.timeout,o=new tU.TimeoutController(i);n.signal=(0,rU.anySignal)([n.signal,o.signal]);let s=t(...r),a=new Promise((f,h)=>{o.signal.addEventListener("abort",()=>{h(new bc)})}),l=Date.now(),u=()=>{if(o.signal.aborted)throw new bc;if(Date.now()-l>i)throw o.abort(),new bc};return s[Symbol.asyncIterator]?async function*(){let f=s[Symbol.asyncIterator]();try{for(;;){let{value:h,done:p}=await Promise.race([f.next(),a]);if(p)break;u(),yield h}}catch(h){throw u(),h}finally{o.clear(),f.return&&f.return()}}():(async()=>{try{let f=await Promise.race([s,a]);return u(),f}catch(f){throw u(),f}finally{o.clear()}})()}}c();te();var uS=E(V(),1),nU="/ipfs/";function _c(t){if(t instanceof Uint8Array)try{t=T.decode(t)}catch(i){throw(0,uS.default)(i,"ERR_INVALID_CID")}let e=T.asCID(t);if(e)return{cid:e,path:void 0};t=t.toString(),t.startsWith(nU)&&(t=t.substring(nU.length));let r=t.split("/"),n;try{e=T.parse(r.shift()||"")}catch(i){throw(0,uS.default)(i,"ERR_INVALID_CID")}return r.length&&(n=`/${r.join("/")}`),{cid:e,path:n}}var s2e="ERR_BAD_PATH",nw="This command must be run in online mode. Try running 'ipfs daemon' first.",e2=new ae("/local/filesroot"),t2=262144;var oU=t=>{if(T.asCID(t))return`/ipfs/${t}`;let r=t.toString();try{return`/ipfs/${T.parse(r)}`}catch{}if(iU.default.path(r))return r;throw(0,rw.default)(new Error(`invalid path: ${t}`),s2e)},Sp=t=>t instanceof Uint8Array?T.decode(t).toString():(t=t.toString(),t.indexOf("/ipfs/")===0&&(t=t.substring(6)),t.charAt(t.length-1)==="/"&&(t=t.substring(0,t.length-1)),t),Kl=async function(t,e,r,n={}){let{cid:i,path:o}=_c(r);o&&(n.path=o);let s=i,a=n.path||"";if(a.startsWith("/")&&(a=a.substring(1)),n.path)try{for await(let{value:l,remainderPath:u}of Vl(i,n.path,e,t,{signal:n.signal})){if(!T.asCID(l))break;a=u,s=l}}catch(l){throw l.message.startsWith("Object has no property")&&(l.message=`no link named "${a.split("/")[0]}" under ${s}`,l.code="ERR_NO_LINK"),l}return{cid:s,remainderPath:a||""}},fS=t=>{if(t.type!=="file"&&t.type!=="directory"&&t.type!=="raw")throw new Error(`Unknown node type '${t.type}'`);let e={cid:t.cid,path:t.path,name:t.name,size:t.size,type:"file"};return t.type==="directory"&&(e.type="dir"),t.type==="file"&&(e.size=t.unixfs.fileSize()),(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,t.unixfs.mtime!==void 0&&(e.mtime=t.unixfs.mtime)),e},sU=B(async(t,e)=>await t),Vl=async function*(t,e,r,n,i){let o=async u=>{let f=await r.getCodec(u.code),h=await n.blocks.get(u,i);return f.decode(h)},s=e.split("/").filter(Boolean),a=await o(t),l=t;for(;s.length;){let u=s.shift();if(!u)throw(0,rw.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(t.code===ht&&Array.isArray(a.Links)){let f=a.Links.find(h=>h.Name===u);if(f){yield{value:f.Hash,remainderPath:s.join("/")},a=await o(f.Hash),l=f.Hash;continue}}if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:s.join("/")};else throw(0,rw.default)(new Error(`no link named "${u}" under ${l}`),"ERR_NO_LINK");T.asCID(a)&&(l=a,a=await o(a))}yield{value:a,remainderPath:""}};var ui=class{static create({start:e,stop:r}){return new ui(e,r)}static async start(e,r){let{state:n,activate:i}=e;switch(n.status){case"stopped":try{let o=i(r);e.state={status:"starting",ready:o};let s=await o;return e.state={status:"started",value:s},s}catch(o){throw e.state={status:"stopped"},o}case"starting":throw new Uf;case"started":throw new Ff;case"stopping":return await n.ready,await ui.start(e,r);default:return ui.panic(e)}}static async stop(e){let{state:r,deactivate:n}=e;switch(r.status){case"stopped":break;case"starting":{try{await r.ready}catch{}return await ui.stop(e)}case"stopping":return await r.ready;case"started":{n&&await n(r.value),e.state={status:"stopped"};break}default:ui.panic(r)}}static try({state:e}){switch(e.status){case"started":return e.value;default:return null}}static async use({state:e},r){switch(e.status){case"started":return e.value;case"starting":return await sU(e.ready,r);default:throw new wc}}static panic({state:e}){let r=JSON.stringify({status:e.status});throw RangeError(`Service in invalid state ${r}, should never happen if you see this please report a bug`)}constructor(e,r){this.activate=e,this.deactivate=r,this.state={status:"stopped"}}async use(e){return await ui.use(this,e)}try(){return ui.try(this)}};function aU({network:t,preload:e,peerId:r,keychain:n,repo:i,ipns:o,mfsPreload:s,print:a,hashers:l,options:u}){return async()=>{let{libp2p:h}=await ui.start(t,{peerId:r,repo:i,print:a,hashers:l,options:u});await Promise.all([o.startOnline({keychain:n,libp2p:h,peerId:r,repo:i}),e.start(),s.start()])}}c();function cU({network:t,preload:e,ipns:r,repo:n,mfsPreload:i}){return async()=>{await Promise.all([e.stop(),r.stop(),i.stop()]),await ui.stop(t),await n.close()}}c();c();c();var uU=E(xp(),1),iw=class{constructor(e){this.lru=(0,uU.default)(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,n){this.lru.set(e,{value:r,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};c();var bU=E(ql(),1);c();var hi=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},dS=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},hU=t=>globalThis.DOMException===void 0?new dS(t):new DOMException(t),dU=t=>{let e=t.reason===void 0?hU("This operation was aborted."):t.reason;return e instanceof Error?e:hU(e)};function rn(t,e,r,n){let i,o=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(t);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:l}=n;l.aborted&&a(dU(l)),l.addEventListener("abort",()=>{a(dU(l))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{s(r())}catch(f){a(f)}return}let l=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new hi(l);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{s(await t)}catch(l){a(l)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}c();c();function pS(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var qf=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},vc,n2=class{constructor(){vc.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&qf(this,vc,"f")[this.size-1].priority>=r.priority){qf(this,vc,"f").push(n);return}let i=pS(qf(this,vc,"f"),n,(o,s)=>s.priority-o.priority);qf(this,vc,"f").splice(i,0,n)}dequeue(){let e=qf(this,vc,"f").shift();return e?.run}filter(e){return qf(this,vc,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return qf(this,vc,"f").length}};vc=new WeakMap;var Zt=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ge=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Fn,o2,s2,Hl,uw,a2,sw,Ts,i2,io,aw,oo,c2,zl,Rp,Tp,zf,cw,pU,mU,EU,gU,yU,wU,lw,mS,gS,fw,hw=()=>{},l2e=new hi,yS=class extends Error{},As=class extends bU.default{constructor(e){var r,n,i,o;if(super(),Fn.add(this),o2.set(this,void 0),s2.set(this,void 0),Hl.set(this,0),uw.set(this,void 0),a2.set(this,void 0),sw.set(this,0),Ts.set(this,void 0),i2.set(this,void 0),io.set(this,void 0),aw.set(this,void 0),oo.set(this,0),c2.set(this,void 0),zl.set(this,void 0),Rp.set(this,hw),Tp.set(this,hw),zf.set(this,void 0),cw.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:n2,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);Zt(this,o2,e.carryoverConcurrencyCount,"f"),Zt(this,s2,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),Zt(this,uw,e.intervalCap,"f"),Zt(this,a2,e.interval,"f"),Zt(this,io,new e.queueClass,"f"),Zt(this,aw,e.queueClass,"f"),this.concurrency=e.concurrency,Zt(this,zf,e.timeout,"f"),Zt(this,cw,e.throwOnTimeout===!0,"f"),Zt(this,zl,e.autoStart===!1,"f")}get concurrency(){return ge(this,c2,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Zt(this,c2,e,"f"),ge(this,Fn,"m",fw).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;Zt(this,oo,(a=ge(this,oo,"f"),a++,a),"f"),Zt(this,Hl,(l=ge(this,Hl,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new yS("The task was aborted."));return}let f=await(ge(this,zf,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?ge(this,zf,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?ge(this,cw,"f"):r.throwOnTimeout)&&i(l2e)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}ge(this,Fn,"m",EU).call(this)};ge(this,io,"f").enqueue(o,r),ge(this,Fn,"m",lw).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return ge(this,zl,"f")?(Zt(this,zl,!1,"f"),ge(this,Fn,"m",fw).call(this),this):this}pause(){Zt(this,zl,!0,"f")}clear(){Zt(this,io,new(ge(this,aw,"f")),"f")}async onEmpty(){if(ge(this,io,"f").size!==0)return new Promise(e=>{let r=ge(this,Rp,"f");Zt(this,Rp,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(ge(this,io,"f").size<e))return new Promise(r=>{let n=()=>{ge(this,io,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(ge(this,oo,"f")===0&&ge(this,io,"f").size===0))return new Promise(e=>{let r=ge(this,Tp,"f");Zt(this,Tp,()=>{r(),e()},"f")})}get size(){return ge(this,io,"f").size}sizeBy(e){return ge(this,io,"f").filter(e).length}get pending(){return ge(this,oo,"f")}get isPaused(){return ge(this,zl,"f")}get timeout(){return ge(this,zf,"f")}set timeout(e){Zt(this,zf,e,"f")}};o2=new WeakMap,s2=new WeakMap,Hl=new WeakMap,uw=new WeakMap,a2=new WeakMap,sw=new WeakMap,Ts=new WeakMap,i2=new WeakMap,io=new WeakMap,aw=new WeakMap,oo=new WeakMap,c2=new WeakMap,zl=new WeakMap,Rp=new WeakMap,Tp=new WeakMap,zf=new WeakMap,cw=new WeakMap,Fn=new WeakSet,pU=function(){return ge(this,s2,"f")||ge(this,Hl,"f")<ge(this,uw,"f")},mU=function(){return ge(this,oo,"f")<ge(this,c2,"f")},EU=function(){var e;Zt(this,oo,(e=ge(this,oo,"f"),e--,e),"f"),ge(this,Fn,"m",lw).call(this),this.emit("next")},gU=function(){ge(this,Rp,"f").call(this),Zt(this,Rp,hw,"f"),ge(this,oo,"f")===0&&(ge(this,Tp,"f").call(this),Zt(this,Tp,hw,"f"),this.emit("idle"))},yU=function(){ge(this,Fn,"m",gS).call(this),ge(this,Fn,"m",mS).call(this),Zt(this,i2,void 0,"f")},wU=function(){let e=Date.now();if(ge(this,Ts,"f")===void 0){let r=ge(this,sw,"f")-e;if(r<0)Zt(this,Hl,ge(this,o2,"f")?ge(this,oo,"f"):0,"f");else return ge(this,i2,"f")===void 0&&Zt(this,i2,setTimeout(()=>{ge(this,Fn,"m",yU).call(this)},r),"f"),!0}return!1},lw=function(){if(ge(this,io,"f").size===0)return ge(this,Ts,"f")&&clearInterval(ge(this,Ts,"f")),Zt(this,Ts,void 0,"f"),ge(this,Fn,"m",gU).call(this),!1;if(!ge(this,zl,"f")){let e=!ge(this,Fn,"m",wU).call(this);if(ge(this,Fn,"a",pU)&&ge(this,Fn,"a",mU)){let r=ge(this,io,"f").dequeue();return r?(this.emit("active"),r(),e&&ge(this,Fn,"m",mS).call(this),!0):!1}}return!1},mS=function(){ge(this,s2,"f")||ge(this,Ts,"f")!==void 0||(Zt(this,Ts,setInterval(()=>{ge(this,Fn,"m",gS).call(this)},ge(this,a2,"f")),"f"),Zt(this,sw,Date.now()+ge(this,a2,"f"),"f"))},gS=function(){ge(this,Hl,"f")===0&&ge(this,oo,"f")===0&&ge(this,Ts,"f")&&(clearInterval(ge(this,Ts,"f")),Zt(this,Ts,void 0,"f")),Zt(this,Hl,ge(this,o2,"f")?ge(this,oo,"f"):0,"f"),ge(this,Fn,"m",fw).call(this)},fw=function(){for(;ge(this,Fn,"m",lw).call(this););};var LU=E(Ip(),1),AS=new iw(1e3),P2e=60*1e3,N2e=As.default?As.default:As,k2e=new N2e({concurrency:4}),OU=t=>{if(t.Path)return t.Path;throw new Error(t.Message)};async function BU(t,e){return(async(n,i={})=>{let o=new URLSearchParams(i);o.set("arg",n);let s=o.toString();if(!i.nocache&&AS.has(s)){let l=AS.get(s);return OU(l)}let a=await k2e.add(async()=>{let l=await LU.default.get("https://ipfs.io/api/v0/dns",{searchParams:o}),u=new URL(l.url).search.slice(1),f=await l.json();return AS.set(u,f,P2e),f});return OU(a)})(t,e)}function D2e(t){return t.endsWith(".eth")&&(t=t.replace(/.eth$/,".eth.link")),t}function MU(){return B(async(e,r={recursive:!0})=>{if(typeof e!="string")throw new Error("Invalid arguments, domain must be a string");return e=D2e(e),BU(e,r)})}c();function UU({network:t}){return()=>{let e=t.try();return e!=null&&Boolean(e.libp2p.isStarted())}}c();var PS=E(Xm(),1);te();c();te();Vm();en();On();gc();Mr();zr();var VU=E(V(),1);c();var FU=Symbol.for("@libp2p/peer-id");var KU=Object.values(ya).map(t=>t.decoder).reduce((t,e)=>t.or(e),ya.identity.decoder),qU=114,IS=36,CS=37,u2=class{constructor(e){this.type=e.type,this.multihash=e.multihash,this.privateKey=e.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[FU](){return!0}toString(){return this.string==null&&(this.string=Oe.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return T.createV1(qU,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(e){if(e instanceof Uint8Array)return Me(this.multihash.bytes,e);if(typeof e=="string")return he(e).equals(this);if(e?.multihash?.bytes!=null)return Me(this.multihash.bytes,e.multihash.bytes);throw new Error("not valid Id")}},Hf=class extends u2{constructor(e){super({...e,type:"RSA"}),this.type="RSA",this.publicKey=e.publicKey}},$f=class extends u2{constructor(e){super({...e,type:"Ed25519"}),this.type="Ed25519",this.publicKey=e.multihash.digest}},Gf=class extends u2{constructor(e){super({...e,type:"secp256k1"}),this.type="secp256k1",this.publicKey=e.multihash.digest}};function nn(t){let e=(0,VU.default)(new Error("Not a PeerId"),"ERR_INVALID_PARAMETERS");if(t.type==="RSA")return new Hf(t);if(t.type==="Ed25519")return new $f(t);if(t.type==="secp256k1")return new Gf(t);throw e}function he(t,e){if(e=e??KU,t.charAt(0)==="1"||t.charAt(0)==="Q"){let r=wr(Oe.decode(`z${t}`));return t.startsWith("12D")?new $f({multihash:r}):t.startsWith("16U")?new Gf({multihash:r}):new Hf({multihash:r})}return Rr(KU.decode(t))}function Rr(t){try{let e=wr(t);if(e.code===hn.code){if(e.digest.length===IS)return new $f({multihash:e});if(e.digest.length===CS)return new Gf({multihash:e})}if(e.code===Be.code)return new Hf({multihash:e})}catch{return O2e(T.decode(t))}throw new Error("Supplied PeerID CID is invalid")}function O2e(t){if(t==null||t.multihash==null||t.version==null||t.version===1&&t.code!==qU)throw new Error("Supplied PeerID CID is invalid");let e=t.multihash;if(e.code===Be.code)return new Hf({multihash:t.multihash});if(e.code===hn.code){if(e.digest.length===IS)return new $f({multihash:t.multihash});if(e.digest.length===CS)return new Gf({multihash:t.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function on(t,e){return t.length===IS?new $f({multihash:Es(hn.code,t),privateKey:e}):t.length===CS?new Gf({multihash:Es(hn.code,t),privateKey:e}):new Hf({multihash:await Be.digest(t),publicKey:t,privateKey:e})}function zU({repo:t,codecs:e,bases:r,name:n}){async function i(o,s={}){if(!PS.default.path(o))throw new Error("invalid argument "+o);if(PS.default.ipnsPath(o))for await(let y of n.resolve(o,s))o=y;let[,a,l,...u]=o.split("/"),f=s.cidBase?await r.getBase(s.cidBase):void 0,h=L2e(l);if(u.length===0){let y=f?f.encoder.encode(h):l;return`/${a}/${y}`}let p=T.decode(h);o=u.join("/");let d=Vl(p,o,e,t,s),m=p,g=o;for await(let y of d)T.asCID(y.value)&&(m=y.value,g=y.remainderPath);return`/ipfs/${m.toString(f&&f.encoder)}${g?"/"+g:""}`}return B(i)}function L2e(t){try{return he(t).toBytes()}catch{return T.parse(t).bytes}}c();c();var $U=E(Fi(),1);te();function GU({addAll:t}){return(e,r={})=>{let n,i=T.asCID(e);return i?n=t([{cid:i,...r}],r):n=t([{path:e.toString(),...r}],r),(0,$U.default)(n)}}c();c();var Cp=E(V(),1);te();async function*wa(t){if(t==null)throw(0,Cp.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");let e=T.asCID(t);if(e){yield Is({cid:e});return}if(t instanceof String||typeof t=="string"){yield Is({path:t});return}if(t.cid!=null||t.path!=null)return yield Is(t);if(Symbol.iterator in t){let r=t[Symbol.iterator](),n=r.next();if(n.done)return r;if(T.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield Is({cid:n.value});for(let i of r)yield Is({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield Is(n.value);for(let i of r)yield Is(i);return}throw(0,Cp.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in t){let r=t[Symbol.asyncIterator](),n=await r.next();if(n.done)return r;if(T.asCID(n.value)||n.value instanceof String||typeof n.value=="string"){yield Is({cid:n.value});for await(let i of r)yield Is({cid:i});return}if(n.value.cid!=null||n.value.path!=null){yield Is(n.value);for await(let i of r)yield Is(i);return}throw(0,Cp.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}throw(0,Cp.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}function Is(t){let e=t.cid||`${t.path}`;if(!e)throw(0,Cp.default)(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");let r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}c();var vt={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};function WU({repo:t,codecs:e}){async function*r(n,i={}){let o=async function*(){for await(let{path:l,recursive:u,metadata:f}of wa(n)){let{cid:h}=await Kl(t,e,l),{reason:p}=await t.pins.isPinnedWithType(h,[vt.recursive,vt.direct]);if(p==="recursive"&&!u)throw new Error(`${h} already pinned recursively`);u?await t.pins.pinRecursively(h,{metadata:f}):await t.pins.pinDirectly(h,{metadata:f}),yield h}};if(!Boolean(i.lock)){yield*o();return}let a=await t.gcLock.readLock();try{yield*o()}finally{a()}}return B(r)}c();var NS=E(V(),1);function f2(t,e,r){let n={type:t,cid:e};return r&&(n.metadata=r),n}function jU({repo:t,codecs:e}){async function*r(n={}){let i=vt.all;if(n.type&&(i=n.type,!Object.keys(vt).includes(i)))throw(0,NS.default)(new Error("Invalid pin type"),"ERR_INVALID_PIN_TYPE");if(n.paths){let o=!1;for await(let{path:s}of wa(n.paths)){let{cid:a}=await Kl(t,e,s),{reason:l,pinned:u,parent:f,metadata:h}=await t.pins.isPinnedWithType(a,i);if(!u)throw(0,NS.default)(new Error(`path '${s}' is not pinned`),"ERR_NOT_PINNED");switch(l){case vt.direct:case vt.recursive:o=!0,yield f2(l,a,h);break;default:o=!0,yield f2(`${vt.indirect} through ${f}`,a,h)}}if(!o)throw new Error("No match found");return}if(i===vt.recursive||i===vt.all)for await(let{cid:o,metadata:s}of t.pins.recursiveKeys())yield f2(vt.recursive,o,s);if(i===vt.indirect||i===vt.all)for await(let o of t.pins.indirectKeys(n))yield f2(vt.indirect,o);if(i===vt.direct||i===vt.all)for await(let{cid:o,metadata:s}of t.pins.directKeys())yield f2(vt.direct,o,s)}return B(r)}c();var YU=E(Fi(),1);function QU({rmAll:t}){async function e(r,n={}){let i=await(0,YU.default)(t([{path:r,...n}],n));if(!i)throw new Error("CID expected");return i}return e}c();function XU({repo:t,codecs:e}){async function*r(n,i={}){let o=await t.gcLock.readLock();try{for await(let{path:s,recursive:a}of wa(n)){let{cid:l}=await Kl(t,e,s),{pinned:u,reason:f}=await t.pins.isPinnedWithType(l,vt.all);if(!u)throw new Error(`${l} is not pinned`);switch(f){case vt.recursive:if(!a)throw new Error(`${l} is pinned recursively`);await t.pins.unpin(l),yield l;break;case vt.direct:await t.pins.unpin(l),yield l;break;default:throw new Error(`${l} is pinned indirectly under ${f}`)}}}finally{o()}}return B(r)}var pw=class{constructor({codecs:e,repo:r}){let n=WU({codecs:e,repo:r});this.addAll=n,this.add=GU({addAll:n});let i=XU({codecs:e,repo:r});this.rmAll=i,this.rm=QU({rmAll:i}),this.ls=jU({codecs:e,repo:r}),this.remote={add:(o,s={})=>Promise.reject(new Error("Not implemented")),ls:async function*(o,s={}){return Promise.reject(new Error("Not implemented"))},rm:(o,s={})=>Promise.reject(new Error("Not implemented")),rmAll:(o,s={})=>Promise.reject(new Error("Not implemented")),service:{add:(o,s)=>Promise.reject(new Error("Not implemented")),rm:(o,s={})=>Promise.reject(new Error("Not implemented")),ls:(o={})=>Promise.reject(new Error("Not implemented"))}}}};c();c();var sq=E(V(),1);c();c();var M2e=Symbol.for("@libp2p/peer-id");function qo(t){return t!=null&&Boolean(t[M2e])}var $l={};_t($l,{abortedError:()=>U2e,dbDeleteFailedError:()=>gw,dbOpenFailedError:()=>mw,dbWriteFailedError:()=>yw,notFoundError:()=>Rn});c();var Pp=E(V(),1);function mw(t){return t=t||new Error("Cannot open database"),(0,Pp.default)(t,"ERR_DB_OPEN_FAILED")}function gw(t){return t=t||new Error("Delete failed"),(0,Pp.default)(t,"ERR_DB_DELETE_FAILED")}function yw(t){return t=t||new Error("Write failed"),(0,Pp.default)(t,"ERR_DB_WRITE_FAILED")}function Rn(t){return t=t||new Error("Not Found"),(0,Pp.default)(t,"ERR_NOT_FOUND")}function U2e(t){return t=t||new Error("Aborted"),(0,Pp.default)(t,"ERR_ABORTED")}var jo=E(V(),1);Re();Mr();c();var QV=E(ZU(),1);var Zw={};_t(Zw,{generateEphemeralKeyPair:()=>MK,generateKeyPair:()=>Yp,generateKeyPairFromSeed:()=>swe,importKey:()=>Nc,keyStretcher:()=>NK,keysPBM:()=>Np,marshalPrivateKey:()=>Ox,marshalPublicKey:()=>Dx,supportedKeys:()=>Ia,unmarshalPrivateKey:()=>Hn,unmarshalPublicKey:()=>qi});c();var Np={};_t(Np,{KeyType:()=>Ur,PrivateKey:()=>Ps,PublicKey:()=>Cs});c();c();c();c();c();c();function Wf(t,e){for(let r=0;r<t.byteLength;r++){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0}Pr();Mr();Ae();Re();c();function xc(t,e){if(t.length!==e.length)throw new Error("Inputs should have the same length");let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}var eF=Symbol.for("@achingbrain/uint8arraylist");function JU(t,e,r){if(e==null||e<0||e>=r)throw new RangeError("index is out of bounds");let n=0;for(let i of t){let o=n+i.byteLength;if(e<o)return{buf:i,index:e-n};n=o}throw new RangeError("index is out of bounds")}function Gl(t){return Boolean(t?.[eF])}var Ve=class{constructor(...e){Object.defineProperty(this,eF,{value:!0}),this.bufs=[],this.length=0,this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(Gl(n))r+=n.length,this.bufs=this.bufs.concat(n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=JU(this.bufs,e,this.length);return r.buf[r.index]}set(e,r){let n=JU(this.bufs,e,this.length);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(Gl(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0))for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return Pe(n,i)}subarray(e,r){let{bufs:n}=this._subList(e,r),i=new Ve;return i.appendAll(n),i}_subList(e,r){if(e==null&&r==null)return{bufs:this.bufs,length:this.length};if(e=e??0,r=r??(this.length>0?this.length:0),e<0||r>this.length)throw new RangeError("index out of bounds");if(e===r)return{bufs:[],length:0};let n=[],i=0;for(let o of this.bufs){let s=i,a=s+o.byteLength,l=e>=s&&e<a,u=r>s&&r<=a,f=e<s&&r>=a;i=a;let h,p;if(l&&(h=e-s,p=o.byteLength),u&&(p=r-s,h==null&&(h=0)),f&&(h=0,p=o.byteLength),h!=null&&p!=null&&n.push(o.subarray(h,p)),u)break}return{bufs:n,length:r-e}}getInt8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.slice(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=new Uint8Array(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.slice(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=new Uint8Array(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.slice(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=new Uint8Array(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.slice(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=new Uint8Array(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}};c();c();function Ea(t){return t instanceof Uint8Array?{get(e){return t[e]},set(e,r){t[e]=r}}:{get(e){return t.get(e)},set(e,r){t.set(e,r)}}}c();var tF=4294967296,Kn=class{constructor(e=0,r=0){this.hi=e,this.lo=r}toBigInt(e){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31!==0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}zzDecode(){let e=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^e)>>>0,n=(this.hi>>>1^e)>>>0;return new Kn(n,r)}zzEncode(){let e=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^e)>>>0,n=(this.lo<<1^e)>>>0;return new Kn(r,n)}toBytes(e,r=0){let n=Ea(e);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(e){if(e===0n)return new Kn;let r=e<0;r&&(e=-e);let n=Number(e>>32n)|0,i=Number(e-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>tF&&(i=0,++n>tF&&(n=0))),new Kn(n,i)}static fromNumber(e){if(e===0)return new Kn;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new Kn(i,n)}static fromBytes(e,r){let n=Ea(e),i=new Kn,o=0;if(e.length-r>4){for(;o<4;++o)if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;o=0}else{for(;o<3;++o){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<o*7)>>>0,n.get(r++)<128)return i}return i.lo=(i.lo|(n.get(r++)&127)<<o*7)>>>0,i}if(e.length-r>4){for(;o<5;++o)if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}else for(;o<5;++o){if(r>=e.length)throw RangeError(`index out of range: ${r} > ${e.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<o*7+3)>>>0,n.get(r++)<128)return i}throw Error("invalid varint encoding")}};var rF=128,F2e=127,K2e=~F2e,V2e=Math.pow(2,31),q2e=Math.pow(2,7),z2e=Math.pow(2,14),H2e=Math.pow(2,21),$2e=Math.pow(2,28),G2e=Math.pow(2,35),W2e=Math.pow(2,42),j2e=Math.pow(2,49),Y2e=Math.pow(2,56),Q2e=Math.pow(2,63),We={encodingLength(t){return t<q2e?1:t<z2e?2:t<H2e?3:t<$2e?4:t<G2e?5:t<W2e?6:t<j2e?7:t<Y2e?8:t<Q2e?9:10},encode(t,e){let r=0,n=Ea(e);for(;t>=V2e;)n.set(r++,t&255|rF),t/=128;for(;(t&K2e)>0;)n.set(r++,t&255|rF),t>>>=7;n.set(r,t|0)},decode(t,e=0){let r=Ea(t),n=4294967295;if(n=(r.get(e)&127)>>>0,r.get(e++)<128||(n=(n|(r.get(e)&127)<<7)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&127)<<14)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&127)<<21)>>>0,r.get(e++)<128)||(n=(n|(r.get(e)&15)<<28)>>>0,r.get(e++)<128))return n;if((e+=5)>t.length)throw RangeError(`index out of range: ${e} > ${t.length}`);return n}},ww={encodingLength(t){return t<0?10:We.encodingLength(t)},encode(t,e){if(t<0){let r=0,n=Ea(e),i=Kn.fromNumber(t);for(;i.hi>0;)n.set(r++,i.lo&127|128),i.lo=(i.lo>>>7|i.hi<<25)>>>0,i.hi>>>=7;for(;i.lo>127;)n.set(r++,i.lo&127|128),i.lo=i.lo>>>7;n.set(r++,i.lo);return}We.encode(t,e)},decode(t,e=0){return We.decode(t,e)|0}},Ew={encodingLength(t){return t=(t<<1^t>>31)>>>0,We.encodingLength(t)},encode(t,e,r=0){return t=(t<<1^t>>31)>>>0,We.encode(t,e)},decode(t,e=0){let r=We.decode(t,e);return r>>>1^-(r&1)|0}};function Ze(t,e){let r=new Uint8Array(We.encodingLength(t.length));return We.encode(t.length,r),e.decode(new Ve(r,t),0)}c();function Je(t,e){let r=e.encode(t),n=We.encodingLength(We.decode(r));return r.slice(n)}c();c();var ot;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(ot||(ot={}));function Ct(t,e,r,n,i){return{name:t,type:e,encode:r,decode:n,encodingLength:i}}var X2e=function(){return 1},Z2e=function(e){return Uint8Array.from([e?1:0])},J2e=function(e,r){return e.get(r)>0},h2=Ct("bool",ot.VARINT,Z2e,J2e,X2e);c();var ege=function(e){let r=e.byteLength;return We.encodingLength(r)+r},tge=function(e){let r=new Uint8Array(We.encodingLength(e.byteLength));return We.encode(e.byteLength,r),new Ve(r,e)},rge=function(e,r){let n=We.decode(e,r);return r+=We.encodingLength(n),e.slice(r,r+n)},ve=Ct("bytes",ot.LENGTH_DELIMITED,tge,rge,ege);c();var nF=function(){return 8},nge=function(e){let r=new Ve(new Uint8Array(nF(e)));return r.setFloat64(0,e,!0),r},ige=function(e,r){return e.getFloat64(r,!0)},oge=Ct("double",ot.BIT64,nge,ige,nF);c();function so(t){function e(o){if(t[o.toString()]==null)throw new Error("Invalid enum value");return typeof o=="number"?o:t[o]}let r=function(s){return We.encodingLength(e(s))},n=function(s){let a=e(s),l=new Uint8Array(We.encodingLength(a));return We.encode(a,l),l},i=function(s,a){let u=We.decode(s,a).toString();if(t[u]==null)throw new Error("Invalid enum value");return t[u]};return Ct("enum",ot.VARINT,n,i,r)}c();var iF=function(){return 4},sge=function(e){let r=new Ve(new Uint8Array(iF(e)));return r.setInt32(0,e,!0),r},age=function(e,r){return e.getInt32(r,!0)},cge=Ct("fixed32",ot.BIT32,sge,age,iF);c();var oF=function(e){return 8},lge=function(e){let r=new Ve(new Uint8Array(oF(e)));return r.setBigInt64(0,e,!0),r},uge=function(e,r){return e.getBigInt64(r,!0)},fge=Ct("fixed64",ot.BIT64,lge,uge,oF);c();var sF=function(){return 4},hge=function(e){let r=new Ve(new Uint8Array(sF(1)));return r.setFloat32(0,e,!0),r},dge=function(e,r){return e.getFloat32(r,!0)},pge=Ct("float",ot.BIT32,hge,dge,sF);c();var aF=function(e){return ww.encodingLength(e)},mge=function(e){let r=new Uint8Array(aF(e));return ww.encode(e,r),r},gge=function(e,r){return ww.decode(e,r)},DS=Ct("int32",ot.VARINT,mge,gge,aF);c();c();var cF=0x7fn,Wl={encodingLength(t){let e=0;for(;t>=0x80n;e++)t>>=7n;return e+1},encode(t,e){let r=Ea(e),n=0;for(;cF<t;)r.set(n++,Number(t&cF)|128),t>>=7n;r.set(n,Number(t))},decode(t,e=0){return Kn.fromBytes(t,e).toBigInt(!0)}},bw={encodingLength(t){return t<0n?10:Wl.encodingLength(t)},encode(t,e,r=0){if(t<0n){Kn.fromBigInt(t).toBytes(e,r);return}return Wl.encode(t,e)},decode(t,e=0){return Kn.fromBytes(t,e).toBigInt(!1)}},_w={encodingLength(t){return Wl.encodingLength(t>=0?t*2n:t*-2n-1n)},encode(t,e,r=0){Kn.fromBigInt(t).zzEncode().toBytes(e,r)},decode(t,e=0){return Kn.fromBytes(t,e).zzDecode().toBigInt(!1)}};var lF=function(e){return bw.encodingLength(e)},yge=function(e){let r=new Uint8Array(lF(e));return bw.encode(e,r),r},wge=function(e,r){return bw.decode(e,r)|0n},Ege=Ct("int64",ot.VARINT,yge,wge,lF);c();function et(t){let e=function(o){let s=0;for(let a of Object.values(t))s+=a.codec.encodingLength(o[a.name]);return We.encodingLength(s)+s},r=function(o){let s=new Ve;function a(u,f,h){if(u==null){if(h.optional===!0)return;throw new Error(`Non optional field "${h.name}" was ${u===null?"null":"undefined"}`)}let p=f<<3|h.codec.type,d=new Uint8Array(We.encodingLength(p));We.encode(p,d);let m=h.codec.encode(u);s.append(d),s.append(m)}for(let[u,f]of Object.entries(t)){let h=parseInt(u);if(f.repeats===!0){if(!Array.isArray(o[f.name]))throw new Error(`Repeating field "${f.name}" was not an array`);for(let p of o[f.name])a(p,h,f)}else a(o[f.name],h,f)}let l=new Uint8Array(We.encodingLength(s.length));return We.encode(s.length,l),new Ve(l,s)},n=function(o,s){let a=We.decode(o,s);s+=We.encodingLength(a);let l=s+a,u={};for(;s<l;){let f=We.decode(o,s);s+=We.encodingLength(f);let h=f&7,p=f>>3,d=t[p],m=0;if(h===ot.VARINT)if(d!=null){let g=d.codec.decode(o,s);m=d.codec.encodingLength(g)}else{let g=We.decode(o,s);m=We.encodingLength(g)}else if(h===ot.BIT64)m=8;else if(h===ot.LENGTH_DELIMITED){let g=We.decode(o,s);m=g+We.encodingLength(g)}else if(h===ot.BIT32)m=4;else{if(h===ot.START_GROUP)throw new Error("Unsupported wire type START_GROUP");if(h===ot.END_GROUP)throw new Error("Unsupported wire type END_GROUP")}if(d!=null){let g=d.codec.decode(o,s);d.repeats===!0?(u[d.name]==null&&(u[d.name]=[]),u[d.name].push(g)):u[d.name]=g}s+=m}for(let f of Object.values(t))f.repeats===!0&&u[f.name]==null&&(u[f.name]=[]);return u};return Ct("message",ot.LENGTH_DELIMITED,r,n,e)}c();var uF=function(){return 4},bge=function(e){let r=new Ve(new Uint8Array(uF(e)));return r.setInt32(0,e,!0),r},_ge=function(e,r){return e.getInt32(r,!0)},vge=Ct("sfixed32",ot.BIT32,bge,_ge,uF);c();var fF=function(){return 8},Sge=function(e){let r=new Ve(new Uint8Array(fF(e)));return r.setBigInt64(0,e,!0),r},xge=function(e,r){return e.getBigInt64(r,!0)},Rge=Ct("sfixed64",ot.BIT64,Sge,xge,fF);c();var hF=function(e){return Ew.encodingLength(e)},Tge=function(e){let r=new Uint8Array(hF(e));return Ew.encode(e,r),r},Age=function(e,r){return Ew.decode(e,r)},Ige=Ct("sint32",ot.VARINT,Tge,Age,hF);c();var dF=function(e){return _w.encodingLength(e)},Cge=function(e){let r=new Uint8Array(dF(e));return _w.encode(e,r),r},Pge=function(e,r){return _w.decode(e,r)},Nge=Ct("sint64",ot.VARINT,Cge,Pge,dF);c();Ae();Re();var kge=function(e){let r=U(e).byteLength;return We.encodingLength(r)+r},Dge=function(e){let r=U(e),n=new Uint8Array(We.encodingLength(r.byteLength));return We.encode(r.length,n),new Ve(n,r)},Oge=function(e,r){let n=We.decode(e,r);return r+=We.encodingLength(n),F(e.slice(r,r+n))},pn=Ct("string",ot.LENGTH_DELIMITED,Dge,Oge,kge);c();var pF=function(e){return We.encodingLength(e)},Lge=function(e){let r=new Uint8Array(pF(e));return We.encode(e,r),r},Bge=function(e,r){return We.decode(e,r)},Mge=Ct("uint32",ot.VARINT,Lge,Bge,pF);c();var Uge=function(e){return Wl.encodingLength(e)},Fge=function(e){let r=new Uint8Array(Wl.encodingLength(e));return Wl.encode(e,r),r},Kge=function(e,r){return Wl.decode(e,r)},jl=Ct("uint64",ot.VARINT,Fge,Kge,Uge);var Ur;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(Ur||(Ur={}));var OS;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(OS||(OS={}));(function(t){t.codec=()=>so(OS)})(Ur||(Ur={}));var Cs;(function(t){t.codec=()=>et({1:{name:"Type",codec:Ur.codec()},2:{name:"Data",codec:ve}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(Cs||(Cs={}));var Ps;(function(t){t.codec=()=>et({1:{name:"Type",codec:Ur.codec()},2:{name:"Data",codec:ve}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(Ps||(Ps={}));var wqe=E(Xl(),1),Eqe=E(nx(),1),Qw=E(wt(),1),Xw=E(V(),1);Ae();c();var ix=E(V(),1);Pr();Ae();c();c();var sn={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};c();var AK={SHA1:20,SHA256:32,SHA512:64};var f4e={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},h4e=async(t,e)=>{let r=await sn.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function IK(t,e){let r=f4e[t],n=await sn.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return await h4e(n,i)},length:AK[t]}}var PK={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function NK(t,e,r){let n=PK[t];if(n==null){let b=Object.keys(PK).join(" / ");throw(0,ix.default)(new Error(`unknown cipher type '${t}'. Must be ${b}`),"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw(0,ix.default)(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");let i=n.keySize,o=n.ivSize,s=20,a=U("key expansion"),l=2*(o+i+s),u=await IK(e,r),f=await u.digest(a),h=[],p=0;for(;p<l;){let b=await u.digest(Pe([f,a])),v=b.length;p+v>l&&(v=l-p),h.push(b),p+=v,f=await u.digest(f)}let d=l/2,m=Pe(h),g=m.slice(0,d),y=m.slice(d,l),w=b=>({iv:b.slice(0,o),cipherKey:b.slice(o,o+i),macKey:b.slice(o+i)});return{k1:w(g),k2:w(y)}}c();c();var Up=E(V(),1);c();var EVe=E(Er(),1),bVe=E(Bw(),1),kK=E(wt(),1);Ae();Re();Pr();function Ds(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.slice(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Pe([new Uint8Array(e-r.length),r])}return F(r,"base64url")}function ao(t){let e=Fw(t);return new kK.default.jsbn.BigInteger(F(e,"base16"),16)}function Fw(t,e){let r=U(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=Pe([new Uint8Array(e-r.length),r])}return r}Re();Pr();Mr();var DK={"P-256":256,"P-384":384,"P-521":521},d4e=Object.keys(DK),ox=d4e.join(" / ");async function OK(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw(0,Up.default)(new Error(`Unknown curve: ${t}. Must be ${ox}`),"ERR_INVALID_CURVE");let e=await sn.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(o,s)=>{let a;s!=null?a=await sn.get().subtle.importKey("jwk",m4e(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):a=e.privateKey;let l=await sn.get().subtle.importKey("jwk",BK(t,o),{name:"ECDH",namedCurve:t},!1,[]),u=await sn.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:l},a,DK[t]);return new Uint8Array(u,0,u.byteLength)},n=await sn.get().subtle.exportKey("jwk",e.publicKey);return{key:p4e(n),genSharedKey:r}}var LK={"P-256":32,"P-384":48,"P-521":66};function p4e(t){if(t.crv==null||t.x==null||t.y==null)throw(0,Up.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw(0,Up.default)(new Error(`Unknown curve: ${t.crv}. Must be ${ox}`),"ERR_INVALID_CURVE");let e=LK[t.crv];return Pe([Uint8Array.from([4]),Fw(t.x,e),Fw(t.y,e)],1+e*2)}function BK(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw(0,Up.default)(new Error(`Unknown curve: ${t}. Must be ${ox}`),"ERR_INVALID_CURVE");let r=LK[t];if(!Me(e.slice(0,1),Uint8Array.from([4])))throw(0,Up.default)(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:F(e.slice(1,r+1),"base64url"),y:F(e.slice(1+r),"base64url"),ext:!0}}var m4e=(t,e)=>({...BK(t,e.public),d:F(e.private,"base64url")});var MK=OK;c();Cl();c();Pr();Ae();function Kw(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",o=t?.saltLength??16,s=t?.iterations??32767,a=sn.get();r*=8;async function l(h,p){let d=a.getRandomValues(new Uint8Array(o)),m=a.getRandomValues(new Uint8Array(n)),g={name:e,iv:m};typeof p=="string"&&(p=U(p));let y={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},w=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await a.subtle.deriveKey(y,w,{name:e,length:r},!0,["encrypt"]),v=await a.subtle.encrypt(g,b,h);return Pe([d,g.iv,new Uint8Array(v)])}async function u(h,p){let d=h.slice(0,o),m=h.slice(o,o+n),g=h.slice(o+n),y={name:e,iv:m};typeof p=="string"&&(p=U(p));let w={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},b=await a.subtle.importKey("raw",p,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),v=await a.subtle.deriveKey(w,b,{name:e,length:r},!0,["decrypt"]),S=await a.subtle.decrypt(y,v,g);return new Uint8Array(S)}return{encrypt:l,decrypt:u}}async function FK(t,e){let r=ua.decode(t);return await Kw().decrypt(r,e)}var hx={};_t(hx,{RsaPrivateKey:()=>Vp,RsaPublicKey:()=>b2,fromJwk:()=>T4e,generateKeyPair:()=>A4e,unmarshalRsaPrivateKey:()=>x4e,unmarshalRsaPublicKey:()=>R4e});c();zr();var fx=E(V(),1);Mr();Re();var oqe=E(HK(),1),E2=E(wt(),1);c();c();var GK=E(Fp(),1),WK=E(V(),1);function Os(t){if(isNaN(t)||t<=0)throw(0,WK.default)(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return(0,GK.default)(t)}Re();Ae();var th={};_t(th,{jwkToPkcs1:()=>E4e,jwkToPkix:()=>_4e,pkcs1ToJwk:()=>w4e,pkixToJwk:()=>b4e});c();var VVe=E(Xl(),1),qVe=E(y2(),1),Ic=E(wt(),1);Ae();Re();var cx=E(V(),1);function w4e(t){let e=Ic.default.asn1.fromDer(F(t,"ascii")),r=Ic.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Ds(r.n),e:Ds(r.e),d:Ds(r.d),p:Ds(r.p),q:Ds(r.q),dp:Ds(r.dP),dq:Ds(r.dQ),qi:Ds(r.qInv),alg:"RS256"}}function E4e(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw(0,cx.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Ic.default.pki.privateKeyToAsn1({n:ao(t.n),e:ao(t.e),d:ao(t.d),p:ao(t.p),q:ao(t.q),dP:ao(t.dp),dQ:ao(t.dq),qInv:ao(t.qi)});return U(Ic.default.asn1.toDer(e).getBytes(),"ascii")}function b4e(t){let e=Ic.default.asn1.fromDer(F(t,"ascii")),r=Ic.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Ds(r.n),e:Ds(r.e)}}function _4e(t){if(t.n==null||t.e==null)throw(0,cx.default)(new Error("JWK was missing components"),"ERR_INVALID_PARAMETERS");let e=Ic.default.pki.publicKeyToAsn1({n:ao(t.n),e:ao(t.e)});return U(Ic.default.asn1.toDer(e).getBytes(),"ascii")}c();var GVe=E(y2(),1),lx=E(wt(),1);function jK(t,e){return e.map(r=>ao(t[r]))}function YK(t){return lx.default.pki.setRsaPrivateKey(...jK(t,["n","e","d","p","q","dp","dq","qi"]))}function QK(t){return lx.default.pki.setRsaPublicKey(...jK(t,["n","e"]))}var XK=E(V(),1);async function ZK(t){let e=await sn.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await tV(e);return{privateKey:r[0],publicKey:r[1]}}async function ux(t){let r=[await sn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await v4e(t)],n=await tV({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function JK(t,e){let r=await sn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await sn.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function eV(t,e,r){let n=await sn.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await sn.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function tV(t){if(t.privateKey==null||t.publicKey==null)throw(0,XK.default)(new Error("Private and public key are required"),"ERR_INVALID_PARAMETERS");return await Promise.all([sn.get().subtle.exportKey("jwk",t.privateKey),sn.get().subtle.exportKey("jwk",t.publicKey)])}async function v4e(t){return await sn.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function rV(t,e,r,n){let i=e?QK(t):YK(t),o=F(Uint8Array.from(r),"ascii"),s=n(o,i);return U(s,"ascii")}function nV(t,e){return rV(t,!0,e,(r,n)=>n.encrypt(r))}function iV(t,e){return rV(t,!1,e,(r,n)=>n.decrypt(r))}c();Cl();async function Kp(t,e){let n=await Kw().encrypt(t,e);return ua.encode(n)}var b2=class{constructor(e){this._key=e}async verify(e,r){return await eV(this._key,r,e)}marshal(){return th.jwkToPkix(this._key)}get bytes(){return Cs.encode({Type:Ur.RSA,Data:this.marshal()})}encrypt(e){return nV(this._key,e)}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}},Vp=class{constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return Os(16)}async sign(e){return await JK(this._key,e)}get public(){if(this._publicKey==null)throw(0,fx.default)(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new b2(this._publicKey)}decrypt(e){return iV(this._key,e)}marshal(){return th.jwkToPkcs1(this._key)}get bytes(){return Ps.encode({Type:Ur.RSA,Data:this.marshal()})}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}async id(){let e=await this.public.hash();return F(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new E2.default.util.ByteBuffer(this.marshal()),i=E2.default.asn1.fromDer(n),o=E2.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return E2.default.pki.encryptRsaPrivateKey(o,e,s)}else{if(r==="libp2p-key")return await Kp(this.bytes,e);throw(0,fx.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function x4e(t){let e=th.pkcs1ToJwk(t),r=await ux(e);return new Vp(r.privateKey,r.publicKey)}function R4e(t){let e=th.pkixToJwk(t);return new b2(e)}async function T4e(t){let e=await ux(t);return new Vp(e.privateKey,e.publicKey)}async function A4e(t){let e=await ZK(t);return new Vp(e.privateKey,e.publicKey)}var vx={};_t(vx,{Ed25519PrivateKey:()=>nh,Ed25519PublicKey:()=>R2,generateKeyPair:()=>q4e,generateKeyPairFromSeed:()=>_x,unmarshalEd25519PrivateKey:()=>K4e,unmarshalEd25519PublicKey:()=>V4e});c();var bx=E(V(),1);Mr();zr();en();gc();c();c();var cV=E(Yf(),1);var Tn=BigInt(0),kt=BigInt(1),Ri=BigInt(2),lV=BigInt(255),oV=Ri**BigInt(252)+BigInt("27742317777372353535851937790883648493"),Ir={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:Ri**lV-BigInt(19),l:oV,n:oV,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")};var uV=Ri**BigInt(256),_2=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),aqe=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),I4e=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),C4e=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),P4e=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),N4e=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Nt=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof Fr))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(Fr.ZERO)?Nt.ZERO:new Nt(e.x,e.y,kt,X(e.x*e.y))}static toAffineBatch(e){let r=O4e(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){sV(e);let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e,l=X(r*a),u=X(o*i),f=X(n*a),h=X(s*i);return l===u&&f===h}negate(){return new Nt(X(-this.x),this.y,this.z,X(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=Ir,o=X(e**Ri),s=X(r**Ri),a=X(Ri*X(n**Ri)),l=X(i*o),u=X(X((e+r)**Ri)-o-s),f=l+s,h=f-a,p=l-s,d=X(u*h),m=X(f*p),g=X(u*p),y=X(h*f);return new Nt(d,m,y,g)}add(e){sV(e);let{x:r,y:n,z:i,t:o}=this,{x:s,y:a,z:l,t:u}=e,f=X((n-r)*(a+s)),h=X((n+r)*(a-s)),p=X(h-f);if(p===Tn)return this.double();let d=X(i*Ri*u),m=X(o*Ri*l),g=m+d,y=h+f,w=m-d,b=X(g*p),v=X(y*w),S=X(g*w),R=X(p*y);return new Nt(b,v,R,S)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(e-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(e,r){!r&&this.equals(Nt.BASE)&&(r=Fr.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&gx.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Nt.normalizeZ(i),gx.set(r,i)));let o=Nt.ZERO,s=Nt.ZERO,a=1+256/n,l=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let p=0;p<a;p++){let d=p*l,m=Number(e&u);if(e>>=h,m>l&&(m-=f,e+=kt),m===0){let g=i[d];p%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(m)-1];m<0&&(g=g.negate()),o=o.add(g)}}return Nt.normalizeZ([o,s])[0]}multiply(e,r){return this.wNAF(Vw(e,Ir.l),r)}multiplyUnsafe(e){let r=Vw(e,Ir.l,!1),n=Nt.BASE,i=Nt.ZERO;if(r===Tn)return i;if(this.equals(i)||r===kt)return this;if(this.equals(n))return this.wNAF(r);let o=i,s=this;for(;r>Tn;)r&kt&&(o=o.add(s)),s=s.double(),r>>=kt;return o}isSmallOrder(){return this.multiplyUnsafe(Ir.h).equals(Nt.ZERO)}isTorsionFree(){return this.multiplyUnsafe(Ir.l).equals(Nt.ZERO)}toAffine(e=qw(this.z)){let{x:r,y:n,z:i}=this,o=X(r*e),s=X(n*e);if(X(i*e)!==kt)throw new Error("invZ was invalid");return new Fr(o,s)}fromRistrettoBytes(){px()}toRistrettoBytes(){px()}fromRistrettoHash(){px()}};Nt.BASE=new Nt(Ir.Gx,Ir.Gy,kt,X(Ir.Gx*Ir.Gy));Nt.ZERO=new Nt(Tn,kt,kt,Tn);function sV(t){if(!(t instanceof Nt))throw new TypeError("ExtendedPoint expected")}function dx(t){if(!(t instanceof Vi))throw new TypeError("RistrettoPoint expected")}function px(){throw new Error("Legacy method: switch to RistrettoPoint")}var Vi=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=Ir,n=X(_2*e*e),i=X((n+kt)*P4e),o=BigInt(-1),s=X((o-r*n)*X(n+r)),{isValid:a,value:l}=wx(i,s),u=X(l*e);ru(u)||(u=X(-u)),a||(l=u),a||(o=n);let f=X(o*(n-kt)*N4e-s),h=l*l,p=X((l+l)*s),d=X(f*I4e),m=X(kt-h),g=X(kt+h);return new Nt(X(p*g),X(m*d),X(d*g),X(p*m))}static hashToCurve(e){e=nu(e,64);let r=mx(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=mx(e.slice(32,64)),o=this.calcElligatorRistrettoMap(i);return new Vi(n.add(o))}static fromHex(e){e=nu(e,32);let{a:r,d:n}=Ir,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",o=mx(e);if(!B4e(v2(o),e)||ru(o))throw new Error(i);let s=X(o*o),a=X(kt+r*s),l=X(kt-r*s),u=X(a*a),f=X(l*l),h=X(r*n*u-f),{isValid:p,value:d}=aV(X(h*f)),m=X(d*l),g=X(d*m*h),y=X((o+o)*m);ru(y)&&(y=X(-y));let w=X(a*g),b=X(y*w);if(!p||ru(b)||w===Tn)throw new Error(i);return new Vi(new Nt(y,w,kt,b))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,o=X(X(n+r)*X(n-r)),s=X(e*r),{value:a}=aV(X(o*s**Ri)),l=X(a*o),u=X(a*s),f=X(l*u*i),h;if(ru(i*f)){let d=X(r*_2),m=X(e*_2);e=d,r=m,h=X(l*C4e)}else h=u;ru(e*f)&&(r=X(-r));let p=X((n-r)*h);return ru(p)&&(p=X(-p)),v2(p)}toHex(){return S2(this.toRawBytes())}toString(){return this.toHex()}equals(e){dx(e);let r=this.ep,n=e.ep,i=X(r.x*n.y)===X(r.y*n.x),o=X(r.y*n.y)===X(r.x*n.x);return i||o}add(e){return dx(e),new Vi(this.ep.add(e.ep))}subtract(e){return dx(e),new Vi(this.ep.subtract(e.ep))}multiply(e){return new Vi(this.ep.multiply(e))}multiplyUnsafe(e){return new Vi(this.ep.multiplyUnsafe(e))}};Vi.BASE=new Vi(Nt.BASE);Vi.ZERO=new Vi(Nt.ZERO);var gx=new WeakMap,Fr=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,gx.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=Ir;e=nu(e,32);let o=e.slice();o[31]=e[31]&-129;let s=qp(o);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=uV)throw new Error("Expected 0 < hex < 2**256");let a=X(s*s),l=X(a-kt),u=X(n*a+kt),{isValid:f,value:h}=wx(l,u);if(!f)throw new Error("Point.fromHex: invalid y coordinate");let p=(h&kt)===kt;return(e[31]&128)!==0!==p&&(h=X(-h)),new Fr(h,s)}static async fromPrivateKey(e){return(await zw(e)).point}toRawBytes(){let e=v2(this.y);return e[31]|=this.x&kt?128:0,e}toHex(){return S2(this.toRawBytes())}toX25519(){let{y:e}=this,r=X((kt+e)*qw(kt-e));return v2(r)}isTorsionFree(){return Nt.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new Fr(X(-this.x),this.y)}add(e){return Nt.fromAffine(this).add(Nt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Nt.fromAffine(this).multiply(e,this).toAffine()}};Fr.BASE=new Fr(Ir.Gx,Ir.Gy);Fr.ZERO=new Fr(Tn,kt);var rh=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=nu(e,64),n=Fr.fromHex(r.slice(0,32),!1),i=qp(r.slice(32,64));return new rh(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof Fr))throw new Error("Expected Point instance");return Vw(r,Ir.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(v2(this.s),32),e}toHex(){return S2(this.toRawBytes())}};function k4e(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var D4e=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function S2(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=D4e[t[r]];return e}function fV(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[r]=o}return e}function hV(t){let r=t.toString(16).padStart(64,"0");return fV(r)}function v2(t){return hV(t).reverse()}function ru(t){return(X(t)&kt)===kt}function qp(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+S2(Uint8Array.from(t).reverse()))}function mx(t){return X(qp(t)&Ri**lV-kt)}function X(t,e=Ir.P){let r=t%e;return r>=Tn?r:e+r}function qw(t,e=Ir.P){if(t===Tn||e<=Tn)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=X(t,e),n=e,i=Tn,o=kt,s=kt,a=Tn;for(;r!==Tn;){let u=n/r,f=n%r,h=i-s*u,p=o-a*u;n=r,r=f,i=s,o=a,s=h,a=p}if(n!==kt)throw new Error("invert: does not exist");return X(i,e)}function O4e(t,e=Ir.P){let r=new Array(t.length),n=t.reduce((o,s,a)=>s===Tn?o:(r[a]=o,X(o*s,e)),kt),i=qw(n,e);return t.reduceRight((o,s,a)=>s===Tn?o:(r[a]=X(o*r[a],e),X(o*s,e)),i),r}function Ta(t,e){let{P:r}=Ir,n=t;for(;e-- >Tn;)n*=n,n%=r;return n}function L4e(t){let{P:e}=Ir,r=BigInt(5),n=BigInt(10),i=BigInt(20),o=BigInt(40),s=BigInt(80),l=t*t%e*t%e,u=Ta(l,Ri)*l%e,f=Ta(u,kt)*t%e,h=Ta(f,r)*f%e,p=Ta(h,n)*h%e,d=Ta(p,i)*p%e,m=Ta(d,o)*d%e,g=Ta(m,s)*m%e,y=Ta(g,s)*m%e,w=Ta(y,n)*h%e;return{pow_p_5_8:Ta(w,Ri)*t%e,b2:l}}function wx(t,e){let r=X(e*e*e),n=X(r*r*e),i=L4e(t*n).pow_p_5_8,o=X(t*r*i),s=X(e*o*o),a=o,l=X(o*_2),u=s===t,f=s===X(-t),h=s===X(-t*_2);return u&&(o=a),(f||h)&&(o=l),ru(o)&&(o=X(-o)),{isValid:u||f,value:o}}function aV(t){return wx(kt,t)}async function yx(...t){let e=await x2.sha512(k4e(...t)),r=qp(e);return X(r,Ir.l)}function B4e(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function nu(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):fV(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function Vw(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(Tn<t)return t}else if(Tn<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function M4e(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}async function zw(t){if(t=typeof t=="bigint"||typeof t=="number"?hV(Vw(t,uV)):nu(t),t.length!==32)throw new Error("Expected 32 bytes");let e=await x2.sha512(t),r=M4e(e.slice(0,32)),n=e.slice(32,64),i=X(qp(r),Ir.l),o=Fr.BASE.multiply(i),s=o.toRawBytes();return{head:r,prefix:n,scalar:i,point:o,pointBytes:s}}async function Ex(t){return(await zw(t)).pointBytes}async function dV(t,e){t=nu(t);let{prefix:r,scalar:n,pointBytes:i}=await zw(e),o=await yx(r,t),s=Fr.BASE.multiply(o),a=await yx(s.toRawBytes(),i,t),l=X(o+a*n,Ir.l);return new rh(s,l).toRawBytes()}async function pV(t,e,r){e=nu(e),r instanceof Fr||(r=Fr.fromHex(r,!1));let{r:n,s:i}=t instanceof rh?t.assertValidity():rh.fromHex(t),o=Nt.BASE.multiplyUnsafe(i),s=await yx(n.toRawBytes(),r.toRawBytes(),e),a=Nt.fromAffine(r).multiplyUnsafe(s);return Nt.fromAffine(n).add(a).subtract(o).multiplyUnsafe(Ir.h).equals(Nt.ZERO)}Fr.BASE._setWindowSize(8);var tu={node:cV.default,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},x2={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],bytesToHex:S2,getExtendedPublicKey:zw,mod:X,invert:qw,hashToPrivateScalar:t=>{if(t=nu(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=X(qp(t),Ir.l);if(e===Tn||e===kt)throw new Error("Invalid private key");return e},randomBytes:(t=32)=>{if(tu.web)return tu.web.getRandomValues(new Uint8Array(t));if(tu.node){let{randomBytes:e}=tu.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>x2.randomBytes(32),sha512:async t=>{if(tu.web){let e=await tu.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(e)}else{if(tu.node)return Uint8Array.from(tu.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=Fr.BASE){let r=e.equals(Fr.BASE)?e:new Fr(e.x,e.y);return r._setWindowSize(t),r.multiply(Ri),r}};var zp=32,Cc=64,Hw=32;async function mV(){let t=x2.randomPrivateKey(),e=await Ex(t);return{privateKey:EV(t,e),publicKey:e}}async function gV(t){if(t.length!==Hw)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Ex(e);return{privateKey:EV(e,r),publicKey:r}}async function yV(t,e){let r=t.slice(0,Hw);return await dV(e,r)}async function wV(t,e,r){return await pV(e,r,t)}function EV(t,e){let r=new Uint8Array(Cc);for(let n=0;n<Hw;n++)r[n]=t[n],r[Hw+n]=e[n];return r}var R2=class{constructor(e){this._key=Hp(e,zp)}async verify(e,r){return await wV(this._key,r,e)}marshal(){return this._key}get bytes(){return Cs.encode({Type:Ur.Ed25519,Data:this.marshal()})}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}},nh=class{constructor(e,r){this._key=Hp(e,Cc),this._publicKey=Hp(r,zp)}async sign(e){return await yV(this._key,e)}get public(){return new R2(this._publicKey)}marshal(){return this._key}get bytes(){return Ps.encode({Type:Ur.Ed25519,Data:this.marshal()})}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}async id(){let e=await hn.digest(this.public.bytes);return Oe.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Kp(this.bytes,e);throw(0,bx.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function K4e(t){if(t.length>Cc){t=Hp(t,Cc+zp);let n=t.slice(0,Cc),i=t.slice(Cc,t.length);return new nh(n,i)}t=Hp(t,Cc);let e=t.slice(0,Cc),r=t.slice(zp);return new nh(e,r)}function V4e(t){return t=Hp(t,zp),new R2(t)}async function q4e(){let{privateKey:t,publicKey:e}=await mV();return new nh(t,e)}async function _x(t){let{privateKey:e,publicKey:r}=await gV(t);return new nh(e,r)}function Hp(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw(0,bx.default)(new Error(`Key must be a Uint8Array of length ${e}, got ${t.length}`),"ERR_INVALID_KEY_TYPE");return t}var Px={};_t(Px,{Secp256k1PrivateKey:()=>N2,Secp256k1PublicKey:()=>P2,generateKeyPair:()=>owe,unmarshalSecp256k1PrivateKey:()=>nwe,unmarshalSecp256k1PublicKey:()=>iwe});c();zr();var UV=E(V(),1);Mr();Re();c();var jp=E(V(),1);c();var z4e=E(Yf(),1);var Dt=BigInt(0),mr=BigInt(1),an=BigInt(2),A2=BigInt(3),H4e=BigInt(8),Rx=an**BigInt(256),_r={a:Dt,b:BigInt(7),P:Rx-an**BigInt(32)-BigInt(977),n:Rx-BigInt("432420386565659656852420866394968145599"),h:mr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")};function bV(t){let{a:e,b:r}=_r,n=pe(t*t),i=pe(n*t);return pe(i+e*t+r)}var $w=_r.a===Dt,Vt=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof qt))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new Vt(e.x,e.y,mr)}static toAffineBatch(e){let r=j4e(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Vt.toAffineBatch(e).map(Vt.fromAffine)}equals(e){if(!(e instanceof Vt))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e,l=pe(i**an),u=pe(a**an),f=pe(r*u),h=pe(o*l),p=pe(pe(n*a)*u),d=pe(pe(s*i)*l);return f===h&&p===d}negate(){return new Vt(this.x,pe(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=pe(e**an),o=pe(r**an),s=pe(o**an),a=pe(an*(pe((e+o)**an)-i-s)),l=pe(A2*i),u=pe(l**an),f=pe(u-an*a),h=pe(l*(a-f)-H4e*s),p=pe(an*r*n);return new Vt(f,h,p)}add(e){if(!(e instanceof Vt))throw new TypeError("JacobianPoint expected");let{x:r,y:n,z:i}=this,{x:o,y:s,z:a}=e;if(o===Dt||s===Dt)return this;if(r===Dt||n===Dt)return e;let l=pe(i**an),u=pe(a**an),f=pe(r*u),h=pe(o*l),p=pe(pe(n*a)*u),d=pe(pe(s*i)*l),m=pe(h-f),g=pe(d-p);if(m===Dt)return g===Dt?this.double():Vt.ZERO;let y=pe(m**an),w=pe(m*y),b=pe(f*y),v=pe(g**an-w-an*b),S=pe(g*(b-v)-p*w),R=pe(i*a*m);return new Vt(v,S,R)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=SV(e),n=Vt.BASE,i=Vt.ZERO;if(r===Dt)return i;if(r===mr)return this;if(!$w){let p=i,d=this;for(;r>Dt;)r&mr&&(p=p.add(d)),d=d.double(),r>>=mr;return p}let{k1neg:o,k1:s,k2neg:a,k2:l}=RV(r),u=i,f=i,h=this;for(;s>Dt||l>Dt;)s&mr&&(u=u.add(h)),l&mr&&(f=f.add(h)),h=h.double(),s>>=mr,l>>=mr;return o&&(u=u.negate()),a&&(f=f.negate()),f=new Vt(pe(f.x*_r.beta),f.y,f.z),u.add(f)}precomputeWindow(e){let r=$w?128/e+1:256/e+1,n=[],i=this,o=i;for(let s=0;s<r;s++){o=i,n.push(o);for(let a=1;a<2**(e-1);a++)o=o.add(i),n.push(o);i=o.double()}return n}wNAF(e,r){!r&&this.equals(Vt.BASE)&&(r=qt.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Tx.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Vt.normalizeZ(i),Tx.set(r,i)));let o=Vt.ZERO,s=Vt.ZERO,a=1+($w?128/n:256/n),l=2**(n-1),u=BigInt(2**n-1),f=2**n,h=BigInt(n);for(let p=0;p<a;p++){let d=p*l,m=Number(e&u);if(e>>=h,m>l&&(m-=f,e+=mr),m===0){let g=i[d];p%2&&(g=g.negate()),s=s.add(g)}else{let g=i[d+Math.abs(m)-1];m<0&&(g=g.negate()),o=o.add(g)}}return{p:o,f:s}}multiply(e,r){let n=SV(e),i,o;if($w){let{k1neg:s,k1:a,k2neg:l,k2:u}=RV(n),{p:f,f:h}=this.wNAF(a,r),{p,f:d}=this.wNAF(u,r);s&&(f=f.negate()),l&&(p=p.negate()),p=new Vt(pe(p.x*_r.beta),p.y,p.z),i=f.add(p),o=h.add(d)}else{let{p:s,f:a}=this.wNAF(n,r);i=s,o=a}return Vt.normalizeZ([i,o])[0]}toAffine(e=Wp(this.z)){let{x:r,y:n,z:i}=this,o=e,s=pe(o*o),a=pe(s*o),l=pe(r*s),u=pe(n*a);if(pe(i*o)!==mr)throw new Error("invZ was invalid");return new qt(l,u)}};Vt.BASE=new Vt(_r.Gx,_r.Gy,mr);Vt.ZERO=new Vt(Dt,mr,Dt);var Tx=new WeakMap,qt=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Tx.delete(this)}static fromCompressedHex(e){let r=e.length===32,n=Go(r?e:e.subarray(1));if(!xx(n))throw new Error("Point is not on curve");let i=bV(n),o=W4e(i),s=(o&mr)===mr;r?s&&(o=pe(-o)):(e[0]&1)===1!==s&&(o=pe(-o));let a=new qt(n,o);return a.assertValidity(),a}static fromUncompressedHex(e){let r=Go(e.subarray(1,33)),n=Go(e.subarray(33,65)),i=new qt(r,n);return i.assertValidity(),i}static fromHex(e){let r=Pc(e),n=r.length,i=r[0];if(n===32||n===33&&(i===2||i===3))return this.fromCompressedHex(r);if(n===65&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return qt.BASE.multiply(I2(e))}static fromSignature(e,r,n){e=Pc(e);let i=TV(e),{r:o,s}=AV(r);if(n!==0&&n!==1)throw new Error("Cannot recover signature: invalid recovery bit");if(i===Dt)throw new Error("Cannot recover signature: msgHash cannot be 0");let a=n&1?"03":"02",l=qt.fromHex(a+ih(o)),{n:u}=_r,f=Wp(o,u),h=pe(-i*f,u),p=pe(s*f,u),d=qt.BASE.multiplyAndAddUnsafe(l,h,p);if(!d)throw new Error("Cannot recover signature: point at infinify");return d.assertValidity(),d}toRawBytes(e=!1){return iu(this.toHex(e))}toHex(e=!1){let r=ih(this.x);return e?`${this.y&mr?"03":"02"}${r}`:`04${r}${ih(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!xx(r)||!xx(n))throw new Error(e);let i=pe(n*n),o=bV(r);if(pe(i-o)!==Dt)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new qt(this.x,pe(-this.y))}double(){return Vt.fromAffine(this).double().toAffine()}add(e){return Vt.fromAffine(this).add(Vt.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Vt.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=Vt.fromAffine(this),o=r===Dt||r===mr||this!==qt.BASE?i.multiplyUnsafe(r):i.multiply(r),s=Vt.fromAffine(e).multiplyUnsafe(n),a=o.add(s);return a.equals(Vt.ZERO)?void 0:a.toAffine()}};qt.BASE=new qt(_r.Gx,_r.Gy);qt.ZERO=new qt(Dt,Dt);function _V(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function vV(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${Gp(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Go(r),left:t.subarray(e+2)}}function $4e(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${Gp(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=vV(t.subarray(2)),{data:n,left:i}=vV(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${Gp(i)}`);return{r:e,s:n}}var Aa=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=jw(e),n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?Gp(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Aa(Yw(i.slice(0,64)),Yw(i.slice(64,128)))}static fromDER(e){let r=jw(e);if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=$4e(r?e:iu(e));return new Aa(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!C2(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!C2(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=_r.n>>mr;return this.s>e}normalizeS(){return this.hasHighS()?new Aa(this.r,_r.n-this.s):this}toDERRawBytes(e=!1){return iu(this.toDERHex(e))}toDERHex(e=!1){let r=_V(T2(this.s));if(e)return r;let n=_V(T2(this.r)),i=T2(n.length/2),o=T2(r.length/2);return`30${T2(n.length/2+r.length/2+4)}02${i}${n}02${o}${r}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return iu(this.toCompactHex())}toCompactHex(){return ih(this.r)+ih(this.s)}};function $p(...t){if(!t.every(jw))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}function jw(t){return t instanceof Uint8Array}var G4e=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gp(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=G4e[t[r]];return e}function ih(t){if(t>Rx)throw new Error("Expected number < 2^256");return t.toString(16).padStart(64,"0")}function Sx(t){return iu(ih(t))}function T2(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Yw(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function iu(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");e[r]=o}return e}function Go(t){return Yw(Gp(t))}function Pc(t){return t instanceof Uint8Array?Uint8Array.from(t):iu(t)}function SV(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&C2(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function pe(t,e=_r.P){let r=t%e;return r>=Dt?r:e+r}function $o(t,e){let{P:r}=_r,n=t;for(;e-- >Dt;)n*=n,n%=r;return n}function W4e(t){let{P:e}=_r,r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),s=BigInt(44),a=BigInt(88),l=t*t*t%e,u=l*l*t%e,f=$o(u,A2)*u%e,h=$o(f,A2)*u%e,p=$o(h,an)*l%e,d=$o(p,n)*p%e,m=$o(d,i)*d%e,g=$o(m,s)*m%e,y=$o(g,a)*g%e,w=$o(y,s)*m%e,b=$o(w,A2)*u%e,v=$o(b,o)*d%e,S=$o(v,r)*l%e;return $o(S,an)}function Wp(t,e=_r.P){if(t===Dt||e<=Dt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=pe(t,e),n=e,i=Dt,o=mr,s=mr,a=Dt;for(;r!==Dt;){let u=n/r,f=n%r,h=i-s*u,p=o-a*u;n=r,r=f,i=s,o=a,s=h,a=p}if(n!==mr)throw new Error("invert: does not exist");return pe(i,e)}function j4e(t,e=_r.P){let r=new Array(t.length),n=t.reduce((o,s,a)=>s===Dt?o:(r[a]=o,pe(o*s,e)),mr),i=Wp(n,e);return t.reduceRight((o,s,a)=>s===Dt?o:(r[a]=pe(o*r[a],e),pe(o*s,e)),i),r}var xV=(t,e)=>(t+e/an)/e,Gw=an**BigInt(128);function RV(t){let{n:e}=_r,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-mr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=xV(o*t,e),a=xV(-n*t,e),l=pe(t-s*r-a*i,e),u=pe(-s*n-a*o,e),f=l>Gw,h=u>Gw;if(f&&(l=e-l),h&&(u=e-u),l>Gw||u>Gw)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:f,k1:l,k2neg:h,k2:u}}function TV(t){let{n:e}=_r,n=t.length*8-256,i=Go(t);return n>0&&(i=i>>BigInt(n)),i>=e&&(i-=e),i}var Ax=class{constructor(){this.v=new Uint8Array(32).fill(1),this.k=new Uint8Array(32).fill(0),this.counter=0}hmac(...e){return lo.hmacSha256(this.k,...e)}hmacSync(...e){if(typeof lo.hmacSha256Sync!="function")throw new Error("utils.hmacSha256Sync is undefined, you need to set it");let r=lo.hmacSha256Sync(this.k,...e);if(r instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");return r}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){return this.incr(),this.v=await this.hmac(this.v),this.v}generateSync(){return this.incr(),this.v=this.hmacSync(this.v),this.v}};function C2(t){return Dt<t&&t<_r.n}function xx(t){return Dt<t&&t<_r.P}function Y4e(t,e,r){let n=Go(t);if(!C2(n))return;let{n:i}=_r,o=qt.BASE.multiply(n),s=pe(o.x,i);if(s===Dt)return;let a=pe(Wp(n,i)*pe(e+r*s,i),i);if(a===Dt)return;let l=new Aa(s,a),u=(o.x===l.r?0:2)|Number(o.y&mr);return{sig:l,recovery:u}}function I2(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==64)throw new Error("Expected 32 bytes of private key");e=Yw(t)}else if(jw(t)){if(t.length!==32)throw new Error("Expected 32 bytes of private key");e=Go(t)}else throw new TypeError("Expected valid private key");if(!C2(e))throw new Error("Expected private key: 0 < key < n");return e}function Q4e(t){return t instanceof qt?(t.assertValidity(),t):qt.fromHex(t)}function AV(t){if(t instanceof Aa)return t.assertValidity(),t;try{return Aa.fromDER(t)}catch{return Aa.fromCompact(t)}}function Ix(t,e=!1){return qt.fromPrivateKey(t).toRawBytes(e)}function IV(t){let e=t.length>32?t.slice(0,32):t;return Go(e)}function X4e(t){let e=IV(t),r=pe(e,_r.n);return CV(r<Dt?e:r)}function CV(t){if(typeof t!="bigint")throw new Error("Expected bigint");let e=ih(t);return iu(e)}function Z4e(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=Pc(t),i=I2(e),o=[CV(i),X4e(n)];if(r!=null){r===!0&&(r=lo.randomBytes(32));let l=Pc(r);if(l.length!==32)throw new Error("sign: Expected 32 bytes of extra data");o.push(l)}let s=$p(...o),a=IV(n);return{seed:s,m:a,d:i}}function J4e(t,e){let{sig:r,recovery:n}=t,{canonical:i,der:o,recovered:s}=Object.assign({canonical:!0,der:!0},e);i&&r.hasHighS()&&(r=r.normalizeS(),n^=1);let a=o?r.toDERRawBytes():r.toCompactRawBytes();return s?[a,n]:a}async function PV(t,e,r={}){let{seed:n,m:i,d:o}=Z4e(t,e,r.extraEntropy),s,a=new Ax;for(await a.reseed(n);!(s=Y4e(await a.generate(),i,o));)await a.reseed();return J4e(s,r)}var ewe={strict:!0};function NV(t,e,r,n=ewe){let i;try{i=AV(t),e=Pc(e)}catch{return!1}let{r:o,s}=i;if(n.strict&&i.hasHighS())return!1;let a=TV(e);if(a===Dt)return!1;let l;try{l=Q4e(r)}catch{return!1}let{n:u}=_r,f=Wp(s,u),h=pe(a*f,u),p=pe(o*f,u),d=qt.BASE.multiplyAndAddUnsafe(l,h,p);return d?pe(d.x,u)===o:!1}qt.BASE._setWindowSize(8);var co={node:z4e,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var Ww={},lo={isValidPrivateKey(t){try{return I2(t),!0}catch{return!1}},privateAdd:(t,e)=>{let r=I2(t),n=Go(Pc(e));return Sx(pe(r+n,_r.n))},privateNegate:t=>{let e=I2(t);return Sx(_r.n-e)},pointAddScalar:(t,e,r)=>{let n=qt.fromHex(t),i=Go(Pc(e)),o=qt.BASE.multiplyAndAddUnsafe(n,i,mr);if(!o)throw new Error("Tweaked point at infinity");return o.toRawBytes(r)},pointMultiply:(t,e,r)=>{let n=qt.fromHex(t),i=Go(Pc(e));return n.multiply(i).toRawBytes(r)},hashToPrivateKey:t=>{if(t=Pc(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");let e=pe(Go(t),_r.n-mr)+mr;return Sx(e)},randomBytes:(t=32)=>{if(co.web)return co.web.getRandomValues(new Uint8Array(t));if(co.node){let{randomBytes:e}=co.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>lo.hashToPrivateKey(lo.randomBytes(40)),bytesToHex:Gp,hexToBytes:iu,concatBytes:$p,mod:pe,invert:Wp,sha256:async(...t)=>{if(co.web){let e=await co.web.subtle.digest("SHA-256",$p(...t));return new Uint8Array(e)}else if(co.node){let{createHash:e}=co.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(co.web){let r=await co.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=$p(...e),i=await co.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(co.node){let{createHmac:r}=co.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=Ww[t];if(r===void 0){let n=await lo.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=$p(n,n),Ww[t]=r}return lo.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof lo.sha256Sync!="function")throw new Error("utils.sha256Sync is undefined, you need to set it");let r=Ww[t];if(r===void 0){let n=lo.sha256Sync(Uint8Array.from(t,i=>i.charCodeAt(0)));r=$p(n,n),Ww[t]=r}return lo.sha256Sync(r,...e)},precompute(t=8,e=qt.BASE){let r=e===qt.BASE?e:new qt(e.x,e.y);return r._setWindowSize(t),r.multiply(A2),r}};zr();function kV(){return lo.randomPrivateKey()}async function DV(t,e){let{digest:r}=await Be.digest(e);try{return await PV(r,t)}catch(n){throw(0,jp.default)(n,"ERR_INVALID_INPUT")}}async function OV(t,e,r){try{let{digest:n}=await Be.digest(r);return NV(e,n,t)}catch(n){throw(0,jp.default)(n,"ERR_INVALID_INPUT")}}function LV(t){return qt.fromHex(t).toRawBytes(!0)}function BV(t){try{Ix(t,!0)}catch(e){throw(0,jp.default)(e,"ERR_INVALID_PRIVATE_KEY")}}function Cx(t){try{qt.fromHex(t)}catch(e){throw(0,jp.default)(e,"ERR_INVALID_PUBLIC_KEY")}}function MV(t){try{return Ix(t,!0)}catch(e){throw(0,jp.default)(e,"ERR_INVALID_PRIVATE_KEY")}}var P2=class{constructor(e){Cx(e),this._key=e}async verify(e,r){return await OV(this._key,r,e)}marshal(){return LV(this._key)}get bytes(){return Cs.encode({Type:Ur.Secp256k1,Data:this.marshal()})}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}},N2=class{constructor(e,r){this._key=e,this._publicKey=r??MV(e),BV(this._key),Cx(this._publicKey)}async sign(e){return await DV(this._key,e)}get public(){return new P2(this._publicKey)}marshal(){return this._key}get bytes(){return Ps.encode({Type:Ur.Secp256k1,Data:this.marshal()})}equals(e){return Me(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Be.digest(this.bytes);return e}async id(){let e=await this.public.hash();return F(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return await Kp(this.bytes,e);throw(0,UV.default)(new Error(`export format '${r}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function nwe(t){return new N2(t)}function iwe(t){return new P2(t)}async function owe(){let t=await kV();return new N2(t)}var Ia={rsa:hx,ed25519:vx,secp256k1:Px};function Nx(t){let e=Object.keys(Ia).join(" / ");return(0,Xw.default)(new Error(`invalid or unsupported key type ${t}. Must be ${e}`),"ERR_UNSUPPORTED_KEY_TYPE")}function kx(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return Ia[t];throw Nx(t)}async function Yp(t,e){return await kx(t).generateKeyPair(e??2048)}async function swe(t,e,r){if(t.toLowerCase()!=="ed25519")throw(0,Xw.default)(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return await _x(e)}function qi(t){let e=Cs.decode(t),r=e.Data;switch(e.Type){case Ur.RSA:return Ia.rsa.unmarshalRsaPublicKey(r);case Ur.Ed25519:return Ia.ed25519.unmarshalEd25519PublicKey(r);case Ur.Secp256k1:return Ia.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Nx(e.Type)}}function Dx(t,e){return e=(e??"rsa").toLowerCase(),kx(e),t.bytes}async function Hn(t){let e=Ps.decode(t),r=e.Data;switch(e.Type){case Ur.RSA:return await Ia.rsa.unmarshalRsaPrivateKey(r);case Ur.Ed25519:return Ia.ed25519.unmarshalEd25519PrivateKey(r);case Ur.Secp256k1:return Ia.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Nx(e.Type)}}function Ox(t,e){return e=(e??"rsa").toLowerCase(),kx(e),t.bytes}async function Nc(t,e){try{let i=await FK(t,e);return await Hn(i)}catch{}let r=Qw.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw(0,Xw.default)(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let n=Qw.default.asn1.toDer(Qw.default.pki.privateKeyToAsn1(r));return n=U(n.getBytes(),"ascii"),await Ia.rsa.unmarshalRsaPrivateKey(n)}var Fx=E(V(),1);si();Ae();c();var Qp=E(V(),1);c();var FV="ERR_IPNS_EXPIRED_RECORD",k2="ERR_UNRECOGNIZED_VALIDITY",KV="ERR_SIGNATURE_CREATION",oh="ERR_SIGNATURE_VERIFICATION",VV="ERR_UNRECOGNIZED_FORMAT";var Lx="ERR_UNDEFINED_PARAMETER",qV="ERR_INVALID_RECORD_DATA",zV="ERR_INVALID_EMBEDDED_KEY",HV="ERR_MISSING_PRIVATE_KEY";c();var zi;(function(t){let e;(function(n){n.EOL="EOL"})(e=t.ValidityType||(t.ValidityType={}));let r;(function(n){n[n.EOL=0]="EOL"})(r||(r={})),function(n){n.codec=()=>so(r)}(e=t.ValidityType||(t.ValidityType={})),t.codec=()=>et({1:{name:"value",codec:ve,optional:!0},2:{name:"signature",codec:ve,optional:!0},3:{name:"validityType",codec:t.ValidityType.codec(),optional:!0},4:{name:"validity",codec:ve,optional:!0},5:{name:"sequence",codec:jl,optional:!0},6:{name:"ttl",codec:jl,optional:!0},7:{name:"pubKey",codec:ve,optional:!0},8:{name:"signatureV2",codec:ve,optional:!0},9:{name:"data",codec:ve,optional:!0}}),t.encode=n=>Je(n,t.codec()),t.decode=n=>Ze(n,t.codec())})(zi||(zi={}));Ae();Pr();Of();var $V=C("ipns:utils"),GV=U("/ipns/");function D2(t){let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(r==null)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,o=parseInt(r[3],10),s=parseInt(r[4],10),a=parseInt(r[5],10),l=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,o,s,a,l,u))}var WV=async(t,e)=>{if(e==null||t==null){let n=new Error("one or more of the provided parameters are not defined");throw $V.error(n),(0,Qp.default)(n,Lx)}let r;if(e.pubKey!=null){try{r=qi(e.pubKey)}catch(i){throw $V.error(i),i}if(!(await on(e.pubKey)).equals(t))throw(0,Qp.default)(new Error("Embedded public key did not match PeerID"),zV)}else t.publicKey!=null&&(r=qi(t.publicKey));if(r!=null)return r;throw(0,Qp.default)(new Error("no public key is available"),Lx)},Jw=(t,e,r)=>{let n=U(e);return Pe([t,r,n])},e6=t=>{let e=U("ipns-signature:");return Pe([e,t])},Mx=t=>zi.encode(t),kc=t=>{let e=zi.decode(t);return{value:e.value??new Uint8Array(0),signature:e.signature??new Uint8Array(0),validityType:e.validityType??zi.ValidityType.EOL,validity:e.validity??new Uint8Array(0),sequence:e.sequence??0n,pubKey:e.pubKey,ttl:e.ttl??void 0,signatureV2:e.signatureV2,data:e.data}},ou=t=>Pe([GV,t.toBytes()]),Ux=t=>Rr(t.slice(GV.length)),jV=(t,e,r,n,i)=>{let o;if(r===zi.ValidityType.EOL)o=0;else throw(0,Qp.default)(new Error("Unknown validity type"),k2);return no({Value:t,Validity:e,ValidityType:o,Sequence:n,TTL:i})},YV=t=>{let e=Mn(t);if(e.ValidityType===0)e.ValidityType=zi.ValidityType.EOL;else throw(0,Qp.default)(new Error("Unknown validity type"),k2);return Number.isInteger(e.Sequence)&&(e.Sequence=BigInt(e.Sequence)),Number.isInteger(e.TTL)&&(e.TTL=BigInt(e.TTL)),e};Mr();On();gc();var XV=C("ipns"),awe=hn.code,O2="/ipns/",t6=O2.length,ZV=async(t,e,r,n)=>{let i=new QV.default(Date.now()+Number(n)),o=zi.ValidityType.EOL,[s,a]=n.toString().split("."),l=BigInt(s)*BigInt(1e5)+BigInt(a??"0");return await cwe(t,e,r,o,i,l)};var cwe=async(t,e,r,n,i,o)=>{r=BigInt(r);let s=U(i.toString());if(t.privateKey==null)throw(0,Fx.default)(new Error("Missing private key"),HV);let a=await Hn(t.privateKey),l=await uwe(a,e,n,s),u=jV(e,s,n,r,o),f=e6(u),h=await a.sign(f),p={value:e,signature:l,validityType:n,validity:s,sequence:r,ttl:o,signatureV2:h,data:u};if(t.publicKey!=null){let d=wr(t.toBytes());(d.code!==awe||!Me(t.publicKey,d.digest))&&(p.pubKey=t.publicKey)}return XV("ipns entry for %b created",e),p},lwe=t=>Rv.encode(t).slice(1),L2=t=>new ae(`/ipns/${lwe(t)}`),uwe=async(t,e,r,n)=>{try{let i=Jw(e,r,n);return await t.sign(i)}catch(i){throw XV.error("record signature creation failed",i),(0,Fx.default)(new Error("record signature creation failed"),KV)}};var Wo=C("ipfs:ipns:publisher"),JV=Rn().code,eq=60*60*1e3,sh=class{constructor(e,r){this._routing=e,this._datastore=r}async publishWithEOL(e,r,n){let i=await this._updateOrCreateRecord(e,r,n);return this._putRecordToRouting(i,e)}publish(e,r){return this.publishWithEOL(e,r,eq)}async _putRecordToRouting(e,r){if(!qo(r)){let i="peerId received is not valid";throw Wo.error(i),(0,jo.default)(new Error(i),"ERR_INVALID_PEER_ID")}if(r.publicKey==null)throw(0,jo.default)(new Error("Public key was missing"),"ERR_MISSING_PUBLIC_KEY");let n=ou(r);return await this._publishEntry(n,e),e}async _publishEntry(e,r){try{let n=await this._routing.put(e,r);return Wo(`ipns record for ${F(e,"base32")} was stored in the routing`),n}catch(n){let i=`ipns record for ${F(e,"base32")} could not be stored in the routing - ${n.stack}`;throw Wo.error(i),Wo.error(n),(0,jo.default)(new Error(i),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(e,r={}){if(!qo(e)){let i="peerId received is not valid";throw Wo.error(i),(0,jo.default)(new Error(i),"ERR_INVALID_PEER_ID")}let n=r.checkRouting!==!1;try{let i=await this._datastore.get(L2(e.toBytes()));return this._unmarshalData(i)}catch(i){if(i.code!==JV){let o=`unexpected error getting the ipns record ${e.toString()} from datastore`;throw Wo.error(o),(0,jo.default)(new Error(o),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!n)throw(0,jo.default)(i,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{let o=ou(e),s=await this._routing.get(o);return this._unmarshalData(s)}catch(o){throw Wo.error(o),o}}}_unmarshalData(e){try{return kc(e)}catch(r){throw(0,jo.default)(r,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(e,r,n){if(!qo(e)){let l="peerId received is not valid";throw Wo.error(l),(0,jo.default)(new Error(l),"ERR_INVALID_PEER_ID")}let i={checkRouting:!0},o;try{o=await this._getPublished(e,i)}catch(l){if(l.code!==JV){let u=`unexpected error when determining the last published IPNS record for ${e.toString()} ${l.stack}`;throw Wo.error(u),(0,jo.default)(new Error(u),"ERR_DETERMINING_PUBLISHED_RECORD")}}let s=0n;o&&o.sequence!==void 0&&(s=Me(o.value,r)?o.sequence:o.sequence+BigInt(1));let a;try{a=await ZV(e,r,s,n)}catch(l){let u=`ipns record for ${r} could not be created`;throw Wo.error(l),(0,jo.default)(new Error(u),"ERR_CREATING_IPNS_RECORD")}try{let l=Mx(a);return await this._datastore.put(L2(e.toBytes()),l),Wo(`ipns record for ${F(r,"base32")} was stored in the datastore`),l}catch{let u=`ipns record for ${r} could not be stored in the datastore`;throw Wo.error(u),(0,jo.default)(new Error(u),"ERR_STORING_IN_DATASTORE")}}};sh.defaultRecordLifetime=eq;c();var ah=E(V(),1);var r6=C("ipfs:ipns:republisher"),tq=60*1e3,rq=60*tq,fwe=4*rq,hwe=24*rq,n6=class{constructor(e,r,n,i,o={pass:""}){this._publisher=e,this._datastore=r,this._peerId=n,this._keychain=i,this._options=o,this._republishHandle=null}async start(){if(this._republishHandle)throw(0,ah.default)(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");let e={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:i=>{e._timeoutId=setTimeout(async()=>{e._timeoutId=null;try{e._inflightTask=e._task(),await e._inflightTask,e._task&&e.runPeriodically(i)}catch(o){r6.error(o)}},i())},cancel:async()=>{e._timeoutId!=null&&clearTimeout(e._timeoutId),e._task=null,await e._inflightTask}},{pass:r}=this._options,n=!0;e._task=()=>this._republishEntries(this._peerId,r),e.runPeriodically(()=>n?(n=!1,this._options.initialBroadcastInterval||tq):this._options.broadcastInterval||fwe),this._republishHandle=e}async stop(){let e=this._republishHandle;if(!e)throw(0,ah.default)(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await e.cancel()}async _republishEntries(e,r){try{await this._republishEntry(e)}catch{let i="cannot republish entry for the node's private key";r6.error(i);return}if(r)try{let n=await this._keychain.listKeys();for(let i of n){if(i.name==="self")continue;let o=await this._keychain.exportKey(i.name,r),s=await Nc(o,r),a=await on(s.public.bytes,s.bytes);await this._republishEntry(a)}}catch(n){r6.error(n)}}async _republishEntry(e){try{let r=await this._getPreviousValue(e);await this._publisher.publishWithEOL(e,r,hwe)}catch(r){if(r.code==="ERR_NO_ENTRY_FOUND")return;throw r}}async _getPreviousValue(e){if(!qo(e))throw(0,ah.default)(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{let r=await this._datastore.get(L2(e.toBytes()));if(!(r instanceof Uint8Array))throw(0,ah.default)(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return kc(r).value}catch(n){throw r6.error(n),(0,ah.default)(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(r){throw r&&r.notFound?(0,ah.default)(new Error(`no previous entry for record with id: ${e.toString()}`),"ERR_NO_ENTRY_FOUND"):r}}};c();var Zp=E(V(),1);Re();Ae();Pr();c();var Ls=E(V(),1);Re();Mr();var B2=C("ipns:validator"),dwe=async(t,e)=>{let{value:r,validityType:n,validity:i}=e,o,s;e.signatureV2!=null&&e.data!=null?(s=e.signatureV2,o=e6(e.data),pwe(e)):(s=e.signature??new Uint8Array(0),o=Jw(r,n,i));let a;try{a=await t.verify(o,s)}catch{a=!1}if(!a)throw B2.error("record signature verification failed"),(0,Ls.default)(new Error("record signature verification failed"),oh);if(i!=null&&n===zi.ValidityType.EOL){let l;try{l=D2(F(i))}catch{throw B2.error("unrecognized validity format (not an rfc3339 format)"),(0,Ls.default)(new Error("unrecognized validity format (not an rfc3339 format)"),VV)}if(l.getTime()<Date.now())throw B2.error("record has expired"),(0,Ls.default)(new Error("record has expired"),FV)}else if(n!=null)throw B2.error("unrecognized validity type"),(0,Ls.default)(new Error("unrecognized validity type"),k2);B2("ipns entry for %b is valid",r)},pwe=t=>{if(t.data==null)throw(0,Ls.default)(new Error("Record data is missing"),qV);let e=YV(t.data);if(!Me(e.Value,t.value))throw(0,Ls.default)(new Error('Field "value" did not match between protobuf and CBOR'),oh);if(!Me(e.Validity,t.validity))throw(0,Ls.default)(new Error('Field "validity" did not match between protobuf and CBOR'),oh);if(e.ValidityType!==t.validityType)throw(0,Ls.default)(new Error('Field "validityType" did not match between protobuf and CBOR'),oh);if(e.Sequence!==t.sequence)throw(0,Ls.default)(new Error('Field "sequence" did not match between protobuf and CBOR'),oh);if(e.TTL!==t.ttl)throw(0,Ls.default)(new Error('Field "ttl" did not match between protobuf and CBOR'),oh)},Xp=async(t,e)=>{let r=Ux(t),n=kc(e),i=await WV(r,n);await dwe(i,n)};var Vx=C("ipfs:ipns:resolver"),mwe=Rn().code,nq=32,i6=class{constructor(e){this._routing=e}async resolve(e,r={}){if(typeof e!="string")throw(0,Zp.default)(new Error("invalid name"),"ERR_INVALID_NAME");let n=r.recursive&&r.recursive.toString()==="true",i=e.split("/");if(i.length!==3||i[0]!=="")throw(0,Zp.default)(new Error("invalid name"),"ERR_INVALID_NAME");let o=i[2],s=1/0;n&&(s=nq);let a=await this.resolver(o,s);return Vx(`${e} was locally resolved correctly`),a}async resolver(e,r){if(r===0){let o=`could not resolve name (recursion limit of ${nq} exceeded)`;throw Vx.error(o),(0,Zp.default)(new Error(o),"ERR_RESOLVE_RECURSION_LIMIT")}let n=await this._resolveName(e),i=n.split("/");return i[1]==="ipfs"||!r?n:this.resolver(i[2],r-1)}async _resolveName(e){let r=he(e),n=ou(r),i;try{i=await this._routing.get(n)}catch(o){throw Vx.error("could not get record from routing",o),o.code===mwe?(0,Zp.default)(new Error(`record requested for ${e} was not found in the network`),"ERR_NO_RECORD_FOUND"):(0,Zp.default)(new Error(`unexpected error getting the ipns record ${r.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}return this._validateRecord(r,i)}async _validateRecord(e,r){await Xp(Pe([U("/ipns/"),e.toBytes()]),r);let n=kc(r);return F(n.value)}};c();var iq=E(xp(),1),o6=class{constructor(e){this.lru=(0,iq.default)(e)}get(e){let r=this.lru.get(e);if(r){if(r.expire&&r.expire<Date.now()){this.lru.remove(e);return}return r.value}}set(e,r,n){this.lru.set(e,{value:r,expire:Date.now()+n})}has(e){return!!this.get(e)}remove(e){this.lru.remove(e)}clear(){this.lru.clear()}};Re();var M2=C("ipfs:ipns"),oq=60*1e3,U2=class{constructor(e,r,n,i,o){this.publisher=new sh(e,r),this.republisher=new n6(this.publisher,r,n,i,o),this.resolver=new i6(e),this.cache=new o6(1e3),this.routing=e}async publish(e,r,n=sh.defaultRecordLifetime){try{await this.publisher.publishWithEOL(e,r,n),M2(`IPNS value ${F(r,"base32")} was published correctly`);let i=e.toString(),o=parseFloat(n),s=o<oq?o:oq;return this.cache.set(i,r,s),M2(`IPNS value ${F(r,"base32")} was cached correctly`),{name:i,value:r}}catch(i){throw M2.error(i),i}}async resolve(e,r={}){if(typeof e!="string")throw(0,sq.default)(new Error("name received is not valid"),"ERR_INVALID_NAME");if(!r.nocache&&!r.recursive){let n=e.split("/")[2],i=this.cache.get(n);if(i)return i}try{let n=await this.resolver.resolve(e,r);return M2(`IPNS record from ${e} was resolved correctly`),n}catch(n){throw M2.error(n),n}}async initializeKeyspace(e,r){return this.publish(e,r,sh.defaultRecordLifetime)}};c();c();c();c();var cq=E(Bs(),1),s6=(t,e)=>async function*(){yield*(await(0,cq.default)(t)).sort(e)}();var qx=E(Ti(),1),ch=E(Hi(),1),zx=E(Jp(),1),$i=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:i}of e)await this.put(n,i,r),yield{key:n,value:i}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,i){e.push({key:n,value:i})},delete(n){r.push(n)},commit:async n=>{await(0,qx.default)(this.putMany(e,n)),e=[],await(0,qx.default)(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null&&(n=(0,ch.default)(n,i=>i.key.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,ch.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>s6(i,o),n)),e.offset!=null){let i=0;n=(0,ch.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,zx.default)(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null&&(n=(0,ch.default)(n,i=>i.toString().startsWith(e.prefix))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,ch.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>s6(i,o),n)),e.offset!=null){let i=0;n=(0,ch.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,zx.default)(n,e.limit)),n}};var wq=E(Oi(),1),$x=E(yq(),1),Gx=E(Ti(),1),bwe=(0,wq.default)("datastore:core:tiered"),F2=class extends $i{constructor(e){super(),this.stores=e.slice()}async open(){try{await Promise.all(this.stores.map(e=>e.open()))}catch{throw mw()}}async put(e,r){try{await Promise.all(this.stores.map(n=>n.put(e,r)))}catch{throw yw()}}async get(e,r){for(let n of this.stores)try{let i=await n.get(e,r);if(i)return i}catch(i){bwe(i)}throw Rn()}async has(e,r){for(let n of this.stores)if(await n.has(e,r))return!0;return!1}async delete(e,r){try{await Promise.all(this.stores.map(n=>n.delete(e,r)))}catch{throw gw()}}async*putMany(e,r={}){let n,i=this.stores.map(o=>{let s=(0,$x.default)();return(0,Gx.default)(o.putMany(s,r)).catch(a=>{n=a}),s});try{for await(let o of e){if(n)throw n;i.forEach(s=>s.push(o)),yield o}}finally{i.forEach(o=>o.end())}}async*deleteMany(e,r={}){let n,i=this.stores.map(o=>{let s=(0,$x.default)();return(0,Gx.default)(o.deleteMany(s,r)).catch(a=>{n=a}),s});try{for await(let o of e){if(n)throw n;i.forEach(s=>s.push(o)),yield o}}finally{i.forEach(o=>o.end())}}async close(){await Promise.all(this.stores.map(e=>e.close()))}batch(){let e=this.stores.map(r=>r.batch());return{put:(r,n)=>{e.forEach(i=>i.put(r,n))},delete:r=>{e.forEach(n=>n.delete(r))},commit:async r=>{for(let n of e)await n.commit(r)}}}query(e,r){return this.stores[this.stores.length-1].query(e,r)}queryKeys(e,r){return this.stores[this.stores.length-1].queryKeys(e,r)}};var z2=E(a6(),1);c();c();Re();var c6=(t,e)=>{let r=e.map((n,i)=>({entry:zi.decode(n),index:i}));return r.sort((n,i)=>{if(n.entry.signatureV2!=null&&i.entry.signatureV2==null)return-1;if(n.entry.signatureV2==null&&i.entry.signatureV2!=null)return 1;let o=n.entry.sequence??0n,s=i.entry.sequence??0n;if(o>s)return-1;if(o<s)return 1;let a=n.entry.validity??new Uint8Array(0),l=i.entry.validity??new Uint8Array(0),u=D2(F(a)),f=D2(F(l));return u.getTime()>f.getTime()?-1:u.getTime()<f.getTime()?1:0}),r[0].index};en();c();c();c();c();c();var Eq="SHARDING",bq="_README";c();var K2=class extends $i{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(e,r){this.data[e.toString()]=r}async get(e){if(!await this.has(e))throw Rn();return this.data[e.toString()]}async has(e){return this.data[e.toString()]!==void 0}async delete(e){delete this.data[e.toString()]}async*_all(){yield*Object.entries(this.data).map(([e,r])=>({key:new ae(e),value:r}))}async*_allKeys(){yield*Object.entries(this.data).map(([e])=>new ae(e))}};c();var Rwe=E(ei(),1),Twe=E(xq(),1);c();var aHe=new ae(Eq),cHe=new ae(bq);c();var Cwe=E(Hi(),1),Pwe=E(Jp(),1),Nwe=E(Dc(),1);c();var r0=$l;c();var Cq=E(V(),1);Re();Ae();var u6="/record/";function Xx(t){return F(t,"base32")}function V2(t){(typeof t=="string"||t instanceof String)&&(t=U(t.toString()));let e=F(t,"base64url");return`${u6}${e}`}function Pq(t){if(t.substring(0,u6.length)!==u6)throw(0,Cq.default)(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");let e=t.substring(u6.length);return U(e,"base64url")}Mr();var uo=E(V(),1);var pi=C("datastore-pubsub:publisher"),f6=class extends $i{constructor(e,r,n,i,o,s){if(super(),!i)throw(0,uo.default)(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof i!="function")throw(0,uo.default)(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof o!="function")throw(0,uo.default)(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(s&&typeof s!="function")throw(0,uo.default)(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=e,this._datastore=r,this._peerId=n,this._validator=i,this._selector=o,this._handleSubscriptionKeyFn=s,this._onMessage=this._onMessage.bind(this),this._pubsub.addEventListener("message",this._onMessage)}async put(e,r){if(!(e instanceof Uint8Array)){let i="datastore key does not have a valid format";throw pi.error(i),(0,uo.default)(new Error(i),"ERR_INVALID_DATASTORE_KEY")}if(!(r instanceof Uint8Array)){let i="received value is not a Uint8Array";throw pi.error(i),(0,uo.default)(new Error(i),"ERR_INVALID_VALUE_RECEIVED")}let n=V2(e);pi(`publish value for topic ${n}`),await this._pubsub.publish(n,r)}async get(e){if(!(e instanceof Uint8Array)){let i="datastore key does not have a valid format";throw pi.error(i),(0,uo.default)(new Error(i),"ERR_INVALID_DATASTORE_KEY")}let r=V2(e),n=await this._pubsub.getTopics();if(n&&Array.isArray(n)&&n.indexOf(r)>-1)return this._getLocal(e);try{await this._pubsub.subscribe(r)}catch{let o=`cannot subscribe topic ${r}`;throw pi.error(o),(0,uo.default)(new Error(o),"ERR_SUBSCRIBING_TOPIC")}return pi(`subscribed values for key ${r}`),this._getLocal(e)}unsubscribe(e){let r=V2(e);return this._pubsub.unsubscribe(r)}async _getLocal(e){let r=new ae("/"+Xx(e),!1),n;try{n=await this._datastore.get(r)}catch(i){if(i.code!=="ERR_NOT_FOUND"){let s=`unexpected error getting the ipns record for ${r.toString()}`;throw pi.error(s),(0,uo.default)(new Error(s),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let o=`local record requested was not found for ${r.toString()}`;throw pi.error(o),(0,uo.default)(new Error(o),"ERR_NOT_FOUND")}if(!(n instanceof Uint8Array)){let i="found record that we couldn't convert to a value";throw pi.error(i),(0,uo.default)(new Error(i),"ERR_INVALID_RECORD_RECEIVED")}return n}async _onMessage(e){let r=e.detail,{data:n,from:i,topic:o}=r,s;try{s=Pq(o)}catch(a){pi.error(a);return}if(pi(`message received for topic ${o}`),this._peerId.equals(i)){pi("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let a;try{a=await this._handleSubscriptionKeyFn(s)}catch{pi.error("message discarded by the subscriptionKeyFn");return}s=a}try{await this._storeIfSubscriptionIsBetter(s,n)}catch(a){pi.error(a)}}async _storeIfSubscriptionIsBetter(e,r){let n=!1;try{n=await this._isBetter(e,r)}catch(i){if(i.code!=="ERR_NOT_VALID_RECORD")throw i}n&&await this._storeRecord(e,r)}async _validateRecord(e,r){return this._validator(e,r)}async _selectRecord(e,r){return await this._selector(e,r)===0}async _isBetter(e,r){try{await this._validateRecord(e,r)}catch{let s="record received through pubsub is not valid";throw pi.error(s),(0,uo.default)(new Error(s),"ERR_NOT_VALID_RECORD")}let n=new ae(e),i;try{i=await this._getLocal(n.uint8Array())}catch{return!0}return Me(i,r)?!1:this._selectRecord(e,[i,r])}async _storeRecord(e,r){let n=new ae("/"+Xx(e),!1);await this._datastore.put(n,r),pi(`record for ${V2(e)} was stored in the datastore`)}};Ae();Re();var Zx=E(V(),1);var h6=C("ipfs:ipns:pubsub"),lh=class{constructor(e,r,n){this._subscriptions={},this._handleSubscriptionKey=this._handleSubscriptionKey.bind(this),this._pubsubDs=new f6(e,r,n,Xp,c6,this._handleSubscriptionKey)}async put(e,r){try{await this._pubsubDs.put(e,r)}catch(n){throw h6.error(n),n}}async get(e){let r,n;try{r=await this._pubsubDs.get(e)}catch(o){n=o}let i=e.slice(0,t6);if(F(i)===O2){let o=Oe.encode(e).substring(1),s=Oe.encode(e.slice(t6)).substring(1);this._subscriptions[o]=s,h6(`subscribed to pubsub topic ${o}, id ${s}`)}if(n)throw n;return r}_handleSubscriptionKey(e){e instanceof Uint8Array&&(e=F(e,"base58btc"));let r=this._subscriptions[e];if(!r)throw(0,Zx.default)(new Error(`key ${e} does not correspond to a subscription`),"ERR_INVALID_KEY");try{return ou(he(r))}catch(n){throw h6.error(n),n}}getSubscriptions(){return Object.values(this._subscriptions).filter(Boolean).map(r=>`${O2}${r}`)}async cancel(e){if(typeof e!="string")throw(0,Zx.default)(new Error("invalid subscription name"),"ERR_INVALID_SUBSCRIPTION_NAME");e.startsWith(O2)&&(e=e.substring(t6));let r=Object.keys(this._subscriptions).find(i=>this._subscriptions[i]===e);if(!r)return{canceled:!1};let n=U(r);return this._pubsubDs.unsubscribe(n),delete this._subscriptions[r],h6(`unsubscribed pubsub ${r}: ${e}`),{canceled:!0}}};c();c();c();var q2;(function(t){t.codec=()=>et({1:{name:"key",codec:ve},2:{name:"value",codec:ve},5:{name:"timeReceived",codec:pn}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(q2||(q2={}));c();function Nq(t){let e=t.getUTCFullYear(),r=String(t.getUTCMonth()+1).padStart(2,"0"),n=String(t.getUTCDate()).padStart(2,"0"),i=String(t.getUTCHours()).padStart(2,"0"),o=String(t.getUTCMinutes()).padStart(2,"0"),s=String(t.getUTCSeconds()).padStart(2,"0"),a=t.getUTCMilliseconds(),l=String(a*1e3*1e3).padStart(9,"0");return`${e}-${r}-${n}T${i}:${o}:${s}.${l}Z`}function kq(t){let e=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),r=String(t).trim().match(e);if(r==null)throw new Error("Invalid format");let n=parseInt(r[1],10),i=parseInt(r[2],10)-1,o=parseInt(r[3],10),s=parseInt(r[4],10),a=parseInt(r[5],10),l=parseInt(r[6],10),u=parseInt(r[7].slice(0,-6),10);return new Date(Date.UTC(n,i,o,s,a,l,u))}var Kr=class{constructor(e,r,n){if(!(e instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(r instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=e,this.value=r,this.timeReceived=n}serialize(){return q2.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:Nq(this.timeReceived)}}static deserialize(e){let r=q2.decode(e);return new Kr(r.key,r.value,new Date(r.timeReceived))}static fromDeserialized(e){let r=kq(e.timeReceived);if(e.key==null)throw new Error("key missing from deserialized object");if(e.value==null)throw new Error("value missing from deserialized object");return new Kr(e.key,e.value,r)}};var n0=E(V(),1);Re();var Jx=C("ipfs:ipns:offline-datastore"),i0=class{constructor(e){this._datastore=e,this.stores=[]}async put(e,r){if(!(e instanceof Uint8Array))throw(0,n0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(r instanceof Uint8Array))throw(0,n0.default)(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let n;try{n=this._routingKey(e)}catch(o){throw Jx.error(o),(0,n0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let i=new Kr(e,r,new Date);await this._datastore.put(n,i.serialize())}async get(e){if(!(e instanceof Uint8Array))throw(0,n0.default)(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let r;try{r=this._routingKey(e)}catch(o){throw Jx.error(o),(0,n0.default)(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}let n=await this._datastore.get(r),i;try{i=Kr.deserialize(n)}catch(o){throw Jx.error(o),o}return i.value}_routingKey(e){return new ae("/dht/record/"+F(e,"base32"),!1)}};c();var Dq=E(Ti(),1);var Dwe=C("ipfs:ipns:dht-datastore"),d6=class{constructor(e){this._dht=e}async put(e,r){try{await(0,Dq.default)(this._dht.put(e,r))}catch(n){throw Dwe.error(n),n}}async get(e){for await(let r of this._dht.get(e))if(r.name==="VALUE")return r.value;throw Rn()}};function Oq({libp2p:t,repo:e,peerId:r,options:n}){let i=[],o;if((0,z2.default)(n,"EXPERIMENTAL.ipnsPubsub",!1)&&(o=new lh(t.pubsub,e.datastore,r),i.push(o)),(0,z2.default)(n,"offline",!1)!==!0&&["dht","dhtclient","dhtserver"].includes((0,z2.default)(n,"config.Routing.Type","none"))&&i.push(new d6(t.dht)),(0,z2.default)(n,"offline",!1)||i.length===0){let s=new i0(e.datastore);i.push(s)}return new F2(i)}var Owe=C("ipfs:components:ipns"),p6=class{constructor(e={pass:""}){this.options=e,this.offline=null,this.online=null}getIPNS(){let e=this.online||this.offline;if(e)return e;throw new yc}get routing(){return this.getIPNS().routing}startOffline({repo:e,peerId:r,keychain:n}){if(this.offline!=null)throw new vs;Owe("initializing IPNS keyspace (offline)");let i=new i0(e.datastore),o=new U2(i,e.datastore,r,n,this.options);this.offline=o}async startOnline({libp2p:e,repo:r,peerId:n,keychain:i}){if(this.online!=null)throw new vs;let o=Oq({libp2p:e,repo:r,peerId:n,options:this.options}),s=new U2(o,r.datastore,n,i,this.options);await s.republisher.start(),this.online=s}async stop(){let e=this.online;e&&(await e.republisher.stop(),this.online=null)}publish(e,r,n){return this.getIPNS().publish(e,r,n)}resolve(e,r){return this.getIPNS().resolve(e,r)}initializeKeyspace(e,r){return this.getIPNS().initializeKeyspace(e,r)}};c();c();var tR=E(V(),1);Ae();Re();c();var Lq=E(Xm(),1);var Bq=E(Ti(),1);async function Mq({ipns:t,repo:e,codecs:r},n,i){if(Lq.default.ipnsPath(n))return t.resolve(n);let{cid:o,path:s}=_c(n);await(0,Bq.default)(Vl(o,s||"",r,e,i))}var eR=C("ipfs:name:publish");function Uq({ipns:t,repo:e,codecs:r,peerId:n,isOnline:i,keychain:o}){let s=async l=>{let u;if(l==="self"&&n.privateKey!=null)u=await Hn(n.privateKey);else try{let f=await o.exportKey(l,"temp");u=await Nc(f,"temp")}catch(f){throw eR.error(f),(0,tR.default)(f,"ERR_CANNOT_GET_KEY")}return on(u.public.bytes,u.bytes)};async function a(l,u={}){let f=u.resolve!==!1,h=u.lifetime||"24h",p=u.key||"self";if(!i())throw(0,tR.default)(new Error(nw),"OFFLINE_ERROR");try{l=oU(l)}catch(w){throw eR.error(w),w}let d=0;try{d=Fl(h)||0,d=parseFloat(d.toFixed(6))}catch(w){throw eR.error(w),w}let m=await Promise.all([s(p),f?Mq({ipns:t,repo:e,codecs:r},l):Promise.resolve()]),g=U(l),y=await t.publish(m[0],g,d);return{name:y.name,value:F(y.value)}}return B(a)}c();var m6=E(V(),1);te();On();M4();var qq=E(Kq(),1);Re();var Bwe=Ye.bind({ignoreUndefined:!0}),Mwe=C("ipfs:name:resolve"),Vq=(t,e)=>e.length>0?t+"/"+e.join("/"):t;function zq({dns:t,ipns:e,isOnline:r,options:{offline:n}}){async function*i(o,s={}){if(s=Bwe({nocache:!1,recursive:!0},s),n&&s&&s.nocache)throw(0,m6.default)(new Error("cannot specify both offline and nocache"),"ERR_NOCACHE_AND_OFFLINE");if(!r()&&!n)throw(0,m6.default)(new Error(nw),"OFFLINE_ERROR");let a=o.toString();a.startsWith("/ipns/")||(a=`/ipns/${a}`);let[l,u,...f]=a.slice(1).split("/");try{if(u.substring(0,1)==="1"){let p=he(u),d=wr(p.toBytes());u=T.createV1(114,d).toString(fp)}else{let p=T.parse(u);p.version===1&&(u=p.toString(fp))}}catch(p){if((0,qq.default)(u)){yield Vq(await t(u,s),f);return}throw Mwe.error(p),(0,m6.default)(new Error("Invalid IPNS name"),"ERR_IPNS_INVALID_NAME")}let h=await e.resolve(`/${l}/${u}`,s);yield Vq(h instanceof Uint8Array?F(h):h,f)}return B(i)}c();c();c();var rR=E(V(),1);function o0(t,e){if(!t||!(e&&e.ipnsPubsub))throw(0,rR.default)(new Error("IPNS pubsub subsystem is not enabled"),"ERR_IPNS_PUBSUB_NOT_ENABLED");if(t.routing instanceof lh)return t.routing;let r=(t.routing.stores||[]).find(n=>n instanceof lh);if(!r)throw(0,rR.default)(new Error("IPNS pubsub datastore not found"),"ERR_PUBSUB_DATASTORE_NOT_FOUND");return r}function Hq({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i,o={}){return o0(t,r).cancel(i,o)}return B(n)}c();function $q({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i={}){try{return{enabled:Boolean(o0(t,r))}}catch{return{enabled:!1}}}return B(n)}c();function Gq({ipns:t,options:e}){let r=e.EXPERIMENTAL;async function n(i={}){return o0(t,r).getSubscriptions(i)}return B(n)}var g6=class{constructor({ipns:e,options:r}){this.cancel=Hq({ipns:e,options:r}),this.state=$q({ipns:e,options:r}),this.subs=Gq({ipns:e,options:r})}};var y6=class{constructor({dns:e,ipns:r,repo:n,codecs:i,peerId:o,isOnline:s,keychain:a,options:l}){this.publish=Uq({ipns:r,repo:n,codecs:i,peerId:o,isOnline:s,keychain:a}),this.resolve=zq({dns:e,ipns:r,isOnline:s,options:l}),this.pubsub=new g6({ipns:r,options:l})}};c();te();var Wq=E(Vo(),1),jq=E(Ui(),1),Uwe=Rn().code,nR={default:"<dst>",edges:"<src> -> <dst>"};function Yq({repo:t,codecs:e,resolve:r,preload:n}){async function*i(o,s={}){if(s.maxDepth===0)return;if(s.edges&&s.format&&s.format!==nR.default)throw new Error("Cannot set edges to true and also specify format");if(s.format=s.edges?nR.edges:s.format,typeof s.maxDepth!="number"&&(s.maxDepth=s.recursive?1/0:1),s.timeout){let f=[new Wq.TimeoutController(s.timeout).signal];s.signal&&f.push(s.signal),s.signal=(0,jq.anySignal)(f)}let l=(Array.isArray(o)?o:[o]).map(u=>Fwe(n,u,s));for(let u of l)try{yield*Kwe(r,t,e,u,s)}catch(f){yield{ref:"",err:f.message}}}return i}function Fwe(t,e,r){let{cid:n,path:i}=_c(e);return r.preload!==!1&&t(n),`/ipfs/${n}${i||""}`}async function*Kwe(t,e,r,n,i){let o=await t(n,i),{cid:s}=_c(o),a=i.maxDepth!=null?i.maxDepth:1/0,l=i.unique||!1;for await(let u of qwe(e,r,s,a,l,i))!u.parent||u.isDuplicate||(yield{ref:Vwe(u.parent.cid,u.node.cid,u.node.name,i.format)})}function Vwe(t,e,r="",n=nR.default){let i=n.replace(/<src>/g,t.toString());return i=i.replace(/<dst>/g,e.toString()),i=i.replace(/<linkname>/g,r),i}async function*qwe(t,e,r,n,i,o){let s=new Set;async function*a(l,u){let f=u+1;if(!(f>n))try{for await(let h of zwe(t,e,l.cid,o))yield{parent:l,node:h,isDuplicate:i&&s.has(h.cid.toString())},i&&s.add(h.cid.toString()),yield*a(h,f)}catch(h){throw h.code===Uwe&&(h.message=`Could not find object with CID: ${l.cid}`),h}}yield*a({cid:r},0)}async function*zwe(t,e,r,n){let i=await t.blocks.get(r,n),s=(await e.getCodec(r.code)).decode(i),a=r.code===ht,l=[];for(let[u,f]of iR(s,l)){if(a){let h=u.match(/^Links\/(\d+)\/Hash$/);if(h){let p=Number(h[1]);if(p<s.Links.length){yield{name:s.Links[p].Name,cid:f};continue}}}yield{name:u,cid:f}}}var iR=function*(t,e){if(t!=null&&!(t instanceof Uint8Array)){for(let[r,n]of Object.entries(t)){let i=[...e,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[o,s]of n.entries()){let a=[...i,o],l=T.asCID(s);l?yield[a.join("/"),l]:typeof s=="object"&&(yield*iR(s,a))}else{let o=T.asCID(n);o?yield[i.join("/"),o]:yield*iR(n,i)}}return[]}};c();function Qq({repo:t}){async function*e(r={}){for await(let n of t.blocks.queryKeys({},{signal:r.signal}))yield{ref:n.toString()}}return B(e)}c();c();function Xq({network:t}){async function e(r={}){let{bitswap:n}=await t.use(r),i=n.getWantlist();return Array.from(i).map(o=>o[1].cid)}return B(e)}c();function Zq({network:t}){async function e(r,n={}){let{bitswap:i}=await t.use(n),o=i.wantlistForPeer(r);return Array.from(o).map(s=>s[1].cid)}return B(e)}c();function Jq({network:t}){async function e(r,n={}){let{bitswap:i}=await t.use(n);return Array.isArray(r)||(r=[r]),i.unwant(r)}return B(e)}c();function w6({network:t}){async function e(r={}){let n=(await t.use(r)).bitswap,i=n.stat().snapshot;return{provideBufLen:parseInt(i.providesBufferLength.toString()),blocksReceived:BigInt(i.blocksReceived.toString()),wantlist:Array.from(n.getWantlist()).map(o=>o[1].cid),peers:n.peers(),dupBlksReceived:BigInt(i.dupBlksReceived.toString()),dupDataReceived:BigInt(i.dupDataReceived.toString()),dataReceived:BigInt(i.dataReceived.toString()),blocksSent:BigInt(i.blocksSent.toString()),dataSent:BigInt(i.dataSent.toString())}}return B(e)}var E6=class{constructor({network:e}){this.wantlist=Xq({network:e}),this.wantlistForPeer=Zq({network:e}),this.unwant=Jq({network:e}),this.stat=w6({network:e})}};c();c();c();c();c();c();c();c();c();c();var ez="[a-fA-F\\d:]",su=t=>t&&t.includeBoundaries?`(?:(?<=\\s|^)(?=${ez})|(?<=${ez})(?=\\s|$))`:"",Ms="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",mn="[a-fA-F\\d]{1,4}",b6=`
(?:
(?:${mn}:){7}(?:${mn}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${mn}:){6}(?:${Ms}|:${mn}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${mn}:){5}(?::${Ms}|(?::${mn}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${mn}:){4}(?:(?::${mn}){0,1}:${Ms}|(?::${mn}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${mn}:){3}(?:(?::${mn}){0,2}:${Ms}|(?::${mn}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${mn}:){2}(?:(?::${mn}){0,3}:${Ms}|(?::${mn}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${mn}:){1}(?:(?::${mn}){0,4}:${Ms}|(?::${mn}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${mn}){0,5}:${Ms}|(?::${mn}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),Hwe=new RegExp(`(?:^${Ms}$)|(?:^${b6}$)`),$we=new RegExp(`^${Ms}$`),Gwe=new RegExp(`^${b6}$`),oR=t=>t&&t.exact?Hwe:new RegExp(`(?:${su(t)}${Ms}${su(t)})|(?:${su(t)}${b6}${su(t)})`,"g");oR.v4=t=>t&&t.exact?$we:new RegExp(`${su(t)}${Ms}${su(t)}`,"g");oR.v6=t=>t&&t.exact?Gwe:new RegExp(`${su(t)}${b6}${su(t)}`,"g");var _6=oR;function v6(t){return _6({exact:!0}).test(t)}function tz(t){return _6.v6({exact:!0}).test(t)}function rz(t){return _6.v4({exact:!0}).test(t)}Re();var nz=rz,Wwe=tz,sR=function(t){let e=0,r;if(nz(t))r=new Uint8Array(e+4),t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255});else if(Wwe(t)){let n=t.split(":",8),i;for(i=0;i<n.length;i++){let o=nz(n[i]),s;o&&(s=sR(n[i]),n[i]=F(s.slice(0,2),"base16")),s!=null&&++i<8&&n.splice(i,0,F(s.slice(2,4),"base16"))}if(n[0]==="")for(;n.length<8;)n.unshift("0");else if(n[n.length-1]==="")for(;n.length<8;)n.push("0");else if(n.length<8){for(i=0;i<n.length&&n[i]!=="";i++);let o=[i,1];for(i=9-n.length;i>0;i--)o.push("0");n.splice.apply(n,o)}for(r=new Uint8Array(e+16),i=0;i<n.length;i++){let o=parseInt(n[i],16);r[e++]=o>>8&255,r[e++]=o&255}}if(r==null)throw Error("Invalid ip address: "+t);return r},iz=function(t,e,r){e=~~e,r=r??t.length-e;let n=[],i="",o=new DataView(t.buffer);if(r===4){for(let s=0;s<r;s++)n.push(t[e+s]);i=n.join(".")}else if(r===16){for(let s=0;s<r;s+=2)n.push(o.getUint16(e+s).toString(16));i=n.join(":"),i=i.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),i=i.replace(/:{3,4}/,"::")}return i};c();var H2={},aR={},Ywe=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,-1,"ip6zone"],[53,-1,"dns",!0],[54,-1,"dns4",!0],[55,-1,"dns6",!0],[56,-1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,-1,"unix",!1,!0],[421,-1,"ipfs"],[421,-1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,-1,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,-1,"memory"]];Ywe.forEach(t=>{let e=Qwe(...t);aR[e.code]=e,H2[e.name]=e});function Qwe(t,e,r,n,i){return{code:t,size:e,name:r,resolvable:Boolean(n),path:Boolean(i)}}function An(t){if(typeof t=="number"){if(aR[t]!=null)return aR[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(H2[t]!=null)return H2[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}te();si();en();On();var uh=E(ai(),1);Re();Ae();Pr();function az(t,e){switch(An(t).code){case 4:case 41:return Xwe(e);case 6:case 273:case 33:case 132:return lz(e).toString();case 53:case 54:case 55:case 56:case 400:case 777:return Jwe(e);case 421:return t6e(e);case 444:return sz(e);case 445:return sz(e);default:return F(e,"base16")}}function cz(t,e){switch(An(t).code){case 4:return oz(e);case 41:return oz(e);case 6:case 273:case 33:case 132:return cR(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 777:return Zwe(e);case 421:return e6e(e);case 444:return r6e(e);case 445:return n6e(e);default:return U(e,"base16")}}function oz(t){if(!v6(t))throw new Error("invalid ip address");return sR(t)}function Xwe(t){let e=iz(t,0,t.length);if(e==null||!v6(e))throw new Error("invalid ip address");return e}function cR(t){let e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function lz(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function Zwe(t){let e=U(t),r=Uint8Array.from(uh.default.encode(e.length));return Pe([r,e],r.length+e.length)}function Jwe(t){let e=uh.default.decode(t);if(t=t.slice(uh.default.decode.bytes),t.length!==e)throw new Error("inconsistent lengths");return F(t)}function e6e(t){let e;t[0]==="Q"||t[0]==="1"?e=wr(Oe.decode(`z${t}`)).bytes:e=T.parse(t).multihash.bytes;let r=Uint8Array.from(uh.default.encode(e.length));return Pe([r,e],r.length+e.length)}function t6e(t){let e=uh.default.decode(t),r=t.slice(uh.default.decode.bytes);if(r.length!==e)throw new Error("inconsistent lengths");return F(r,"base58btc")}function r6e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);let r=xt.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=cR(n);return Pe([r,i],r.length+i.length)}function n6e(t){let e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);let r=xt.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");let i=cR(n);return Pe([r,i],r.length+i.length)}function sz(t){let e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=F(e,"base32"),i=lz(r);return`${n}:${i}`}var s0=E(ai(),1);Pr();Re();function i6e(t){let e=[],r=t.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){let i=r[n],o=An(i);if(o.size===0){e.push([i]);continue}if(n++,n>=r.length)throw fz("invalid address: "+t);if(o.path===!0){e.push([i,hR(r.slice(n).join("/"))]);break}e.push([i,r[n]])}return e}function o6e(t){let e=[];return t.map(r=>{let n=R6(r);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),hR(e.join("/"))}function s6e(t){return t.map(e=>{Array.isArray(e)||(e=[e]);let r=R6(e);return e.length>1?[r.code,cz(r.code,e[1])]:[r.code]})}function lR(t){return t.map(e=>{let r=R6(e);return e[1]!=null?[r.code,az(r.code,e[1])]:[r.code]})}function uR(t){return x6(Pe(t.map(e=>{let r=R6(e),n=Uint8Array.from(s0.default.encode(r.code));return e.length>1&&e[1]!=null&&(n=Pe([n,e[1]])),n})))}function fR(t,e){return t.size>0?t.size/8:t.size===0?0:s0.default.decode(e)+s0.default.decode.bytes}function $2(t){let e=[],r=0;for(;r<t.length;){let n=s0.default.decode(t,r),i=s0.default.decode.bytes,o=An(n),s=fR(o,t.slice(r+i));if(s===0){e.push([n]),r+=i;continue}let a=t.slice(r+i,r+i+s);if(r+=s+i,r>t.length)throw fz("Invalid address Uint8Array: "+F(t,"base16"));e.push([n,a])}return e}function S6(t){let e=$2(t),r=lR(e);return o6e(r)}function a6e(t){t=hR(t);let e=i6e(t),r=s6e(e);return uR(r)}function uz(t){return a6e(t)}function x6(t){let e=c6e(t);if(e!=null)throw e;return Uint8Array.from(t)}function c6e(t){try{$2(t)}catch(e){return e}}function hR(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function fz(t){return new Error("Error parsing address: "+t)}function R6(t){return An(t[0])}var dR=E(ai(),1);te();en();var dz=E(V(),1);Re();Mr();var u6e=Symbol.for("nodejs.util.inspect.custom"),pz=new Map,hz=Symbol.for("@multiformats/js-multiaddr/multiaddr"),W=class{constructor(e){if(e==null&&(e=""),Object.defineProperty(this,hz,{value:!0}),e instanceof Uint8Array)this.bytes=x6(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);this.bytes=uz(e)}else if(W.isMultiaddr(e))this.bytes=x6(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return S6(this.bytes)}toJSON(){return this.toString()}toOptions(){let e=this.toString().split("/");return{family:e[1]==="ip4"?4:6,host:e[2],transport:e[3],port:parseInt(e[4])}}protos(){return this.protoCodes().map(e=>Object.assign({},An(e)))}protoCodes(){let e=[],r=this.bytes,n=0;for(;n<r.length;){let i=dR.default.decode(r,n),o=dR.default.decode.bytes,s=An(i);n+=fR(s,r.slice(n+o))+o,e.push(i)}return e}protoNames(){return this.protos().map(e=>e.name)}tuples(){return $2(this.bytes)}stringTuples(){let e=$2(this.bytes);return lR(e)}encapsulate(e){return e=new W(e),new W(this.toString()+e.toString())}decapsulate(e){let r=e.toString(),n=this.toString(),i=n.lastIndexOf(r);if(i<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new W(n.slice(0,i))}decapsulateCode(e){let r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new W(uR(r.slice(0,n)));return this}getPeerId(){try{let r=this.stringTuples().filter(n=>n[0]===H2.ipfs.code).pop();if(r?.[1]!=null){let n=r[1];return n[0]==="Q"||n[0]==="1"?F(Oe.decode(`z${n}`),"base58btc"):F(T.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let e=null;try{e=this.stringTuples().filter(r=>An(r[0]).path===!0)[0][1],e==null&&(e=null)}catch{e=null}return e}equals(e){return Me(this.bytes,e.bytes)}async resolve(){let e=this.protos().find(i=>i.resolvable);if(e==null)return[this];let r=pz.get(e.name);if(r==null)throw(0,dz.default)(new Error(`no available resolver for ${e.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await r(this)).map(i=>new W(i))}nodeAddress(){let e=this.protoCodes(),r=this.protoNames(),n=this.toString().split("/").slice(1);if(n.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(e[0]!==4&&e[0]!==41&&e[0]!==54&&e[0]!==55)throw new Error(`no protocol with name: "'${r[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(n[2]!=="tcp"&&n[2]!=="udp")throw new Error(`no protocol with name: "'${r[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:e[0]===41||e[0]===55?6:4,address:n[1],port:parseInt(n[3])}}isThinWaistAddress(e){let r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}static fromNodeAddress(e,r){if(e==null)throw new Error("requires node address object");if(r==null)throw new Error("requires transport protocol");let n;switch(e.family){case 4:n="ip4";break;case 6:n="ip6";break;default:throw Error("Invalid addr family, should be 4 or 6.")}return new W("/"+[n,e.address,r,e.port].join("/"))}static isName(e){return W.isMultiaddr(e)?e.protos().some(r=>r.resolvable):!1}static isMultiaddr(e){return Boolean(e?.[hz])}[u6e](){return"<Multiaddr "+F(this.bytes,"base16")+" - "+S6(this.bytes)+">"}inspect(){return"<Multiaddr "+F(this.bytes,"base16")+" - "+S6(this.bytes)+">"}};W.resolvers=pz;var f6e=qe("dns4"),h6e=qe("dns6"),d6e=qe("dnsaddr"),lu=mi(qe("dns"),d6e,f6e,h6e),T6=mi(qe("ip4"),qe("ip6")),W2=mi(ft(T6,qe("tcp")),ft(lu,qe("tcp"))),gz=ft(T6,qe("udp")),p6e=ft(gz,qe("utp")),m6e=ft(gz,qe("quic")),hh=mi(ft(W2,qe("ws")),ft(lu,qe("ws"))),cu=mi(ft(W2,qe("wss")),ft(lu,qe("wss"))),pR=mi(ft(W2,qe("http")),ft(T6,qe("http")),ft(lu,qe("http"))),mR=mi(ft(W2,qe("https")),ft(T6,qe("https")),ft(lu,qe("https"))),A6=mi(ft(hh,qe("p2p-webrtc-star"),qe("p2p")),ft(cu,qe("p2p-webrtc-star"),qe("p2p")),ft(hh,qe("p2p-webrtc-star")),ft(cu,qe("p2p-webrtc-star"))),QGe=mi(ft(hh,qe("p2p-websocket-star"),qe("p2p")),ft(cu,qe("p2p-websocket-star"),qe("p2p")),ft(hh,qe("p2p-websocket-star")),ft(cu,qe("p2p-websocket-star"))),yz=mi(ft(pR,qe("p2p-webrtc-direct"),qe("p2p")),ft(mR,qe("p2p-webrtc-direct"),qe("p2p")),ft(pR,qe("p2p-webrtc-direct")),ft(mR,qe("p2p-webrtc-direct"))),G2=mi(hh,cu,pR,mR,A6,yz,W2,p6e,m6e,lu),XGe=mi(ft(G2,qe("p2p-stardust"),qe("p2p")),ft(G2,qe("p2p-stardust"))),au=mi(ft(G2,qe("p2p")),A6,yz,qe("p2p")),mz=mi(ft(au,qe("p2p-circuit"),au),ft(au,qe("p2p-circuit")),ft(qe("p2p-circuit"),au),ft(G2,qe("p2p-circuit")),ft(qe("p2p-circuit"),G2),qe("p2p-circuit")),wz=()=>mi(ft(mz,wz),mz),fh=wz(),gR=mi(ft(fh,au,fh),ft(au,fh),ft(fh,au),fh,au),Ez=gR;function bz(t){function e(r){let n;try{n=new W(r)}catch{return!1}let i=t(n.protoNames());return i===null?!1:i===!0||i===!1?i:i.length===0}return e}function ft(...t){function e(r){if(r.length<t.length)return null;let n=r;return t.some(i=>(n=typeof i=="function"?i().partialMatch(r):i.partialMatch(r),Array.isArray(n)&&(r=n),n===null)),n}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:bz(e),partialMatch:e}}function mi(...t){function e(n){let i=null;return t.some(o=>{let s=typeof o=="function"?o().partialMatch(n):o.partialMatch(n);return s!=null?(i=s,!0):!1}),i}return{toString:function(){return"{ "+t.join(" ")+" }"},input:t,matches:bz(e),partialMatch:e}}function qe(t){let e=t;function r(i){let o;try{o=new W(i)}catch{return!1}let s=o.protoNames();return s.length===1&&s[0]===e}function n(i){return i.length===0?null:i[0]===e?i.slice(1):null}return{toString:function(){return e},matches:r,partialMatch:n}}function I6(t){try{return Ez.matches(t)}catch{return!1}}function _z({repo:t}){async function e(r,n={}){if(!I6(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await t.config.getAll(n),o=i.Bootstrap||[];return o.push(r.toString()),i.Bootstrap=Array.from(new Set(o)).sort((s,a)=>s.localeCompare(a)),await t.config.replace(i),{Peers:[r]}}return B(e)}c();function vz({repo:t}){async function e(r={}){let n=await t.config.getAll(r),i=n.Bootstrap||[];return n.Bootstrap=[],await t.config.replace(n),{Peers:i.map(o=>new W(o))}}return B(e)}c();function Sz({repo:t}){async function e(r={}){return{Peers:(await t.config.get("Bootstrap",r)||[]).map(i=>new W(i))}}return B(e)}c();c();var Oc=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:5,HighWater:20},DisableNatPortMap:!0},Routing:{Type:"dhtclient"}});function xz({repo:t}){async function e(r={}){let n=await t.config.getAll(r);return n.Bootstrap=Oc().Bootstrap,await t.config.replace(n),{Peers:Oc().Bootstrap.map(i=>new W(i))}}return B(e)}c();function Rz({repo:t}){async function e(r,n={}){if(!I6(r))throw new Error(`${r} is not a valid Multiaddr`);let i=await t.config.getAll(n);return i.Bootstrap=(i.Bootstrap||[]).filter(o=>o.toString()!==r.toString()),await t.config.replace(i),{Peers:[r]}}return B(e)}var C6=class{constructor({repo:e}){this.add=_z({repo:e}),this.list=Sz({repo:e}),this.rm=Rz({repo:e}),this.clear=vz({repo:e}),this.reset=xz({repo:e})}};c();c();function Tz({preload:t,repo:e}){async function r(n,i={}){return i.preload!==!1&&t(n),e.blocks.get(n,i)}return B(r)}c();te();function Az({codecs:t,hashers:e,repo:r,preload:n}){async function i(o,s={}){let a=s.pin?await r.gcLock.readLock():null;try{let l=s.version!=null?s.version:0,u=s.format||(l===0?"dag-pb":"raw"),h=await(await e.getHasher(s.mhtype||"sha2-256")).digest(o),p=await t.getCodec(u),d=T.create(l,p.code,h);return await r.blocks.put(d,o,{signal:s.signal}),s.preload!==!1&&n(d),s.pin===!0&&await r.pins.pinRecursively(d,{signal:s.signal}),d}finally{a&&a()}}return B(i)}c();var zz=E(V(),1),Hz=E(D6(),1),$z=E(ei(),1),Gz=E(Hi(),1);c();c();c();var O6=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},c0=class{constructor(e){this.hwm=e??16,this.head=new O6(this.hwm),this.tail=this.head}push(e){if(!this.head.push(e)){let r=this.head;this.head=r.next=new O6(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;return this.tail.next=null,this.tail=r,this.tail.shift()}return e}isEmpty(){return this.head.isEmpty()}};function Us(t){return R6e(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function R6e(t,e){e=e??{};let r=e.onEnd,n=new c0,i,o,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,y)=>{o=w=>{o=null,n.push(w);try{g(t(n))}catch(b){y(b)}return i}}):t(n),l=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new c0,o!=null?o({error:g}):(n.push({error:g}),i)),f=g=>s?i:l({done:!1,value:g}),h=g=>s?i:(s=!0,g!=null?u(g):l({done:!0})),p=()=>(n=new c0,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:p,throw:d,push:f,end:h},r==null)return i;let m=i;return i={[Symbol.asyncIterator](){return this},next(){return m.next()},throw(g){return m.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return m.return(),r!=null&&(r(),r=void 0),{done:!0}},push:f,end(g){return m.end(g),r!=null&&(r(g),r=void 0),i}},i}var Vz=E(Dc(),1),T6e=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},qz=t=>t!=null&&(typeof t[Symbol.asyncIterator]=="function"||typeof t[Symbol.iterator]=="function"||typeof t.next=="function"),ER=t=>t!=null&&typeof t.sink=="function"&&qz(t.source),A6e=t=>e=>{let r=t.sink(e);if(r.then!=null){let n=Us();return r.then(()=>{n.end()},o=>{n.end(o)}),(0,Vz.default)(n,async function*(){yield*t.source,n.end()}())}return t.source};function Se(t,...e){if(ER(t)){let n=t;t=()=>n.source}else if(qz(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&ER(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)ER(r[n])&&(r[n]=A6e(r[n]));return T6e(...r)}c();te();function L6(t){return t instanceof Uint8Array?T.decode(t):T.parse(t.toString())}var I6e=8;function Wz({repo:t}){async function*e(r,n={}){Array.isArray(r)||(r=[r]);let i=await t.gcLock.writeLock();try{yield*Se(r,o=>(0,$z.default)(o,s=>async()=>{s=L6(s);let a={cid:s};try{if(!await t.blocks.has(s))throw(0,zz.default)(new Error("block not found"),"ERR_BLOCK_NOT_FOUND");await t.blocks.delete(s)}catch(l){n.force||(l.message=`cannot remove ${s}: ${l.message}`,a.error=l)}return a}),o=>(0,Hz.default)(o,{concurrency:I6e}),o=>(0,Gz.default)(o,()=>!n.quiet))}finally{i()}}return B(e)}c();function jz({repo:t,preload:e}){async function r(n,i={}){n=L6(n),i.preload!==!1&&e(n);let o=await t.blocks.get(n);return{cid:n,size:o.length}}return B(r)}var B6=class{constructor({codecs:e,hashers:r,preload:n,repo:i}){this.get=Tz({preload:n,repo:i}),this.put=Az({codecs:e,hashers:r,preload:n,repo:i}),this.rm=Wz({repo:i}),this.stat=jz({preload:n,repo:i})}};c();c();var lH=E(Fi(),1);c();c();var eH=E(V(),1);Ae();var tH=E(l0(),1),rH=E(Zz(),1),nH=E(u0(),1),iH=E(Bs(),1),oH=E(ei(),1);c();function Yo(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function Lc(t){return t.constructor&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function j2(t){return typeof t=="object"&&(t.path||t.content)}var Bc=t=>t&&typeof t.getReader=="function";async function*M6(t){yield t}async function U6(t){if(Yo(t))return M6(bR(t));if(typeof t=="string"||t instanceof String)return M6(bR(t.toString()));if(Lc(t))return(0,rH.default)(t);if(Bc(t)&&(t=(0,tH.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=(0,nH.default)(t),{value:r,done:n}=await e.peek();if(n)return M6(new Uint8Array(0));if(e.push(r),Number.isInteger(r))return M6(Uint8Array.from(await(0,iH.default)(e)));if(Yo(r)||typeof r=="string"||r instanceof String)return(0,oH.default)(e,bR)}throw(0,eH.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}function bR(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer?new Uint8Array(t):Array.isArray(t)?Uint8Array.from(t):U(t.toString())}c();var K6=E(V(),1),sH=E(l0(),1),aH=E(u0(),1);async function*cH(t,e){if(t==null)throw(0,K6.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if(typeof t=="string"||t instanceof String){yield F6(t.toString(),e);return}if(Yo(t)||Lc(t)){yield F6(t,e);return}if(Bc(t)&&(t=(0,sH.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let r=(0,aH.default)(t),{value:n,done:i}=await r.peek();if(i){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||Yo(n)||typeof n=="string"||n instanceof String){yield F6(r,e);return}throw(0,K6.default)(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(j2(t)){yield F6(t,e);return}throw(0,K6.default)(new Error('Unexpected input: cannot convert "'+typeof t+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function F6(t,e){let{path:r,mode:n,mtime:i,content:o}=t,s={path:r||"",mode:hc(n),mtime:Dl(i)};return o?s.content=await e(o):r||(s.content=await e(t)),s}function V6(t){return cH(t,U6)}function uH({addAll:t}){async function e(r,n={}){let i=await(0,lH.default)(t(V6(r),n));if(i==null)throw Error("Failed to add a file, if you see this please report a bug");return i}return e}c();c();var p$=E(z6(),1);c();zr();c();B4();ap();var _R=E(mH(),1);function L6e(t){let e=new Array(4);for(let r=0;r<4;r++)e[r]=t&255,t=t>>8;return new Uint8Array(e)}var gje=sp({name:"murmur3-32",code:35,encode:t=>L6e(_R.default.x86.hash32(t))}),dh=sp({name:"murmur3-128",code:34,encode:t=>Wd.fromHex(_R.default.x64.hash128(t))});async function B6e(t){return(await dh.encode(t)).slice(0,8).reverse()}var M6e={chunker:"fixed",strategy:"balanced",rawLeaves:!1,onlyHash:!1,reduceSingleLeafToSelf:!0,hasher:Be,leafType:"file",cidVersion:0,progress:()=>()=>{},shardSplitThreshold:1e3,fileImportConcurrency:50,blockWriteConcurrency:10,minChunkSize:262144,maxChunkSize:262144,avgChunkSize:262144,window:16,polynomial:0x3df305dfb2a804,maxChildrenPerNode:174,layerRepeat:4,wrapWithDirectory:!1,recursive:!1,hidden:!1,timeout:void 0,hamtHashFn:B6e,hamtHashCode:34,hamtBucketBits:8},gH=(t={})=>Ye.bind({ignoreUndefined:!0})(M6e,t);c();c();c();te();zr();var U6e=async(t,e,r)=>{r.codec||(r.codec=Tt),r.hasher||(r.hasher=Be),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===Tt&&r.hasher!==Be&&(r.cidVersion=1);let n=await r.hasher.digest(t),i=T.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await e.put(i,t,{signal:r.signal}),i},Fs=U6e;var F6e=async(t,e,r)=>{let n=new Qe({type:"directory",mtime:t.mtime,mode:t.mode}),i=je(Ln({Data:n.marshal()})),o=await Fs(i,e,r),s=t.path;return{cid:o,path:s,unixfs:n,size:i.length}},yH=F6e;c();var TH=E(V(),1);var AH=E(z6(),1);Fo();c();var wH=E(Bs(),1);async function K6e(t,e){return e(await(0,wH.default)(t))}var EH=K6e;c();var bH=E(q6(),1);function V6e(t,e,r){return _H(t,e,r)}async function _H(t,e,r){let n=[];for await(let i of(0,bH.default)(t,r.maxChildrenPerNode))n.push(await e(i));return n.length>1?_H(n,e,r):n[0]}var vH=V6e;c();var SH=E(q6(),1);async function q6e(t,e,r){let n=new vR(r.layerRepeat),i=0,o=1,s=n;for await(let a of(0,SH.default)(t,r.maxChildrenPerNode))s.isFull()&&(s!==n&&n.addChild(await s.reduce(e)),i&&i%r.layerRepeat===0&&o++,s=new $6(o,r.layerRepeat,i),i++),s.append(a);return s&&s!==n&&n.addChild(await s.reduce(e)),n.reduce(e)}var xH=q6e,$6=class{constructor(e,r,n=0){this.maxDepth=e,this.layerRepeat=r,this.currentDepth=1,this.iteration=n,this.root=this.node=this.parent={children:[],depth:this.currentDepth,maxDepth:e,maxChildren:(this.maxDepth-this.currentDepth)*this.layerRepeat}}isFull(){if(!this.root.data)return!1;if(this.currentDepth<this.maxDepth&&this.node.maxChildren)return this._addNextNodeToParent(this.node),!1;let e=this._findParent(this.node,this.currentDepth);return e?(this._addNextNodeToParent(e),!1):!0}_addNextNodeToParent(e){this.parent=e;let r={children:[],depth:e.depth+1,parent:e,maxDepth:this.maxDepth,maxChildren:Math.floor(e.children.length/this.layerRepeat)*this.layerRepeat};e.children.push(r),this.currentDepth=r.depth,this.node=r}append(e){this.node.data=e}reduce(e){return this._reduce(this.root,e)}async _reduce(e,r){let n=[];return e.children.length&&(n=await Promise.all(e.children.filter(i=>i.data).map(i=>this._reduce(i,r)))),r((e.data||[]).concat(n))}_findParent(e,r){let n=e.parent;if(!(!n||n.depth===0))return n.children.length===n.maxChildren||!n.maxChildren?this._findParent(n,r):n}},vR=class extends $6{constructor(e){super(0,e),this.root.depth=0,this.currentDepth=1}addChild(e){this.root.children.push(e)}reduce(e){return e((this.root.data||[]).concat(this.root.children))}};c();Fo();async function*z6e(t,e,r){for await(let n of t.content)yield async()=>{r.progress(n.length,t.path);let i,o={codec:Tt,cidVersion:r.cidVersion,hasher:r.hasher,onlyHash:r.onlyHash};return r.rawLeaves?(o.codec=Bi,o.cidVersion=1):(i=new Qe({type:r.leafType,data:n}),n=je({Data:i.marshal(),Links:[]})),{cid:await Fs(n,e,o),unixfs:i,size:n.length}}}var RH=z6e;var H6e={flat:EH,balanced:vH,trickle:xH};async function*$6e(t,e,r){let n=-1,i,o;typeof r.bufferImporter=="function"?o=r.bufferImporter:o=RH;for await(let s of(0,AH.default)(o(t,e,r),r.blockWriteConcurrency)){if(n++,n===0){i=s;continue}else n===1&&i&&(yield i,i=null);yield s}i&&(i.single=!0,yield i)}var G6e=(t,e,r)=>{async function n(i){if(i.length===1&&i[0].single&&r.reduceSingleLeafToSelf){let f=i[0];if(t.mtime!==void 0||t.mode!==void 0){let h=await e.get(f.cid);f.unixfs=new Qe({type:"file",mtime:t.mtime,mode:t.mode,data:h}),h=je(Ln({Data:f.unixfs.marshal()})),f.cid=await Fs(h,e,{...r,codec:Tt,hasher:r.hasher,cidVersion:r.cidVersion}),f.size=h.length}return{cid:f.cid,path:t.path,unixfs:f.unixfs,size:f.size}}let o=new Qe({type:"file",mtime:t.mtime,mode:t.mode}),s=i.filter(f=>f.cid.code===Un&&f.size||f.unixfs&&!f.unixfs.data&&f.unixfs.fileSize()?!0:Boolean(f.unixfs&&f.unixfs.data&&f.unixfs.data.length)).map(f=>f.cid.code===Un?(o.addBlockSize(f.size),{Name:"",Tsize:f.size,Hash:f.cid}):(!f.unixfs||!f.unixfs.data?o.addBlockSize(f.unixfs&&f.unixfs.fileSize()||0):o.addBlockSize(f.unixfs.data.length),{Name:"",Tsize:f.size,Hash:f.cid})),a={Data:o.marshal(),Links:s},l=je(Ln(a));return{cid:await Fs(l,e,r),path:t.path,unixfs:o,size:l.length+a.Links.reduce((f,h)=>f+h.Tsize,0)}}return n};function W6e(t,e,r){let n=H6e[r.strategy];if(!n)throw(0,TH.default)(new Error(`Unknown importer build strategy name: ${r.strategy}`),"ERR_BAD_STRATEGY");return n($6e(t,e,r),G6e(t,e,r),r)}var IH=W6e;var PR=E(V(),1);c();var HH=E(SR(),1),$H=E(zH(),1),IR=E(V(),1);async function*J6e(t,e){let r,n,i;if(e.minChunkSize&&e.maxChunkSize&&e.avgChunkSize)i=e.avgChunkSize,r=e.minChunkSize,n=e.maxChunkSize;else if(e.avgChunkSize)i=e.avgChunkSize,r=i/3,n=i+i/2;else throw(0,IR.default)(new Error("please specify an average chunk size"),"ERR_INVALID_AVG_CHUNK_SIZE");if(r<16)throw(0,IR.default)(new Error("rabin min must be greater than 16"),"ERR_INVALID_MIN_CHUNK_SIZE");n<r&&(n=r),i<r&&(i=r);let o=Math.floor(Math.log2(i));for await(let s of e5e(t,{min:r,max:n,bits:o,window:e.window,polynomial:e.polynomial}))yield s}var GH=J6e;async function*e5e(t,e){let r=await(0,$H.create)(e.bits,e.min,e.max,e.window),n=new HH.default;for await(let i of t){n.append(i);let o=r.fingerprint(i);for(let s=0;s<o.length;s++){let a=o[s],l=n.slice(0,a);n.consume(a),yield l}}n.length&&(yield n.slice(0))}c();var G6=E(SR(),1);async function*t5e(t,e){let r=new G6.default,n=0,i=!1,o=e.maxChunkSize;for await(let s of t)for(r.append(s),n+=s.length;n>=o;)if(yield r.slice(0,o),i=!0,o===r.length)r=new G6.default,n=0;else{let a=new G6.default;a.append(r.shallowSlice(o)),r=a,n-=o}(!i||n)&&(yield r.slice(0,n))}var WH=t5e;c();var CR=E(V(),1);Ae();async function*r5e(t){for await(let e of t){if(e.length===void 0)throw(0,CR.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield U(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,CR.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}}var jH=r5e;function n5e(t){return Symbol.iterator in t}function i5e(t){return Symbol.asyncIterator in t}function o5e(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(n5e(t))return async function*(){yield*t}();if(i5e(t))return t}catch{throw(0,PR.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,PR.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}async function*s5e(t,e,r){for await(let n of t)if(n.path&&(n.path.substring(0,2)==="./"&&(r.wrapWithDirectory=!0),n.path=n.path.split("/").filter(i=>i&&i!==".").join("/")),n.content){let i;typeof r.chunker=="function"?i=r.chunker:r.chunker==="rabin"?i=GH:i=WH;let o;typeof r.chunkValidator=="function"?o=r.chunkValidator:o=jH;let s={path:n.path,mtime:n.mtime,mode:n.mode,content:i(o(o5e(n.content),r),r)};yield()=>IH(s,e,r)}else if(n.path){let i={path:n.path,mtime:n.mtime,mode:n.mode};yield()=>yH(i,e,r)}else throw new Error("Import candidate must have content or path or both")}var YH=s5e;c();c();c();var NR=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},uu=NR;var kR=class extends uu{constructor(e,r){super(e,r),this._children={}}async put(e,r){this.cid=void 0,this.size=void 0,this._children[e]=r}get(e){return Promise.resolve(this._children[e])}childCount(){return Object.keys(this._children).length}directChildrenCount(){return this.childCount()}onlyChild(){return this._children[Object.keys(this._children)[0]]}async*eachChildSeries(){let e=Object.keys(this._children);for(let r=0;r<e.length;r++){let n=e[r];yield{key:n,child:this._children[n]}}}async*flush(e){let r=Object.keys(this._children),n=[];for(let u=0;u<r.length;u++){let f=this._children[r[u]];if(f instanceof uu)for await(let h of f.flush(e))f=h,yield f;f.size!=null&&f.cid&&n.push({Name:r[u],Tsize:f.size,Hash:f.cid})}let i=new Qe({type:"directory",mtime:this.mtime,mode:this.mode}),o={Data:i.marshal(),Links:n},s=je(Ln(o)),a=await Fs(s,e,this.options),l=s.length+o.Links.reduce((u,f)=>u+(f.Tsize==null?0:f.Tsize),0);this.cid=a,this.size=l,yield{cid:a,unixfs:i,path:this.path,size:l}}},J2=kR;c();c();var W6=E(tg(),1),OR=class extends uu{constructor(e,r){super(e,r),this._bucket=(0,W6.createHAMT)({hashFn:r.hamtHashFn,bits:r.hamtBucketBits})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){for await(let r of c$(this._bucket,e,this,this.options))yield{...r,path:this.path}}},a$=OR;async function*c$(t,e,r,n){let i=t._children,o=[],s=0;for(let d=0;d<i.length;d++){let m=i.get(d);if(!m)continue;let g=d.toString(16).toUpperCase().padStart(2,"0");if(m instanceof W6.Bucket){let y;for await(let w of await c$(m,e,null,n))y=w;if(!y)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:g,Tsize:y.size,Hash:y.cid}),s+=y.size}else if(typeof m.value.flush=="function"){let y=m.value,w;for await(let v of y.flush(e))w=v,yield w;let b=g+m.key;o.push({Name:b,Tsize:w.size,Hash:w.cid}),s+=w.size}else{let y=m.value;if(!y.cid)continue;let w=g+m.key,b=y.size;o.push({Name:w,Tsize:b,Hash:y.cid}),s+=b}}let a=Uint8Array.from(i.bitField().reverse()),l=new Qe({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:n.hamtHashCode,mtime:r&&r.mtime,mode:r&&r.mode}),u={Data:l.marshal(),Links:o},f=je(Ln(u)),h=await Fs(f,e,n),p=f.length+s;yield{cid:h,unixfs:l,size:p}}async function l$(t,e,r,n){let i=e;e instanceof J2&&e.directChildrenCount()>=r&&(i=await x5e(e,n));let o=i.parent;if(o){if(i!==e){if(t&&(t.parent=i),!i.parentKey)throw new Error("No parent key found");await o.put(i.parentKey,i)}return l$(i,o,r,n)}return i}async function x5e(t,e){let r=new a$({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:n,child:i}of t.eachChildSeries())await r.put(n,i);return r}var u$=l$;c();var R5e=(t="")=>(t.trim().match(/([^\\/]|\\\/)+/g)||[]).filter(Boolean),f$=R5e;async function T5e(t,e,r){let n=f$(t.path||""),i=n.length-1,o=e,s="";for(let a=0;a<n.length;a++){let l=n[a];s+=`${s?"/":""}${l}`;let u=a===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,u)await o.put(l,t),e=await u$(null,o,r.shardSplitThreshold,r);else{let f=await o.get(l);(!f||!(f instanceof uu))&&(f=new J2({root:!1,dir:!0,parent:o,parentKey:l,path:s,dirty:!0,flat:!0,mtime:f&&f.unixfs&&f.unixfs.mtime,mode:f&&f.unixfs&&f.unixfs.mode},r)),await o.put(l,f),o=f}}return e}async function*h$(t,e){if(!(t instanceof uu)){t&&t.unixfs&&t.unixfs.isDirectory()&&(yield t);return}yield*t.flush(e)}async function*A5e(t,e,r){let n=new J2({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r);for await(let i of t)!i||(n=await T5e(i,n,r),(!i.unixfs||!i.unixfs.isDirectory())&&(yield i));if(r.wrapWithDirectory)yield*h$(n,e);else for await(let i of n.eachChildSeries())!i||(yield*h$(i.child,e))}var d$=A5e;async function*f0(t,e,r={}){let n=gH(r),i;typeof r.dagBuilder=="function"?i=r.dagBuilder:i=YH;let o;typeof r.treeBuilder=="function"?o=r.treeBuilder:o=d$;let s;Symbol.asyncIterator in t||Symbol.iterator in t?s=t:s=[t];for await(let a of o((0,p$.default)(i(s,e,n),n.fileImportConcurrency),e,n))yield{cid:a.cid,path:a.path,unixfs:a.unixfs,size:a.size}}c();c();var rg=E(V(),1),m$=E(l0(),1),g$=E(u0(),1),BR=E(ei(),1);async function*j6(t,e){if(typeof t=="string"||t instanceof String||Yo(t)||Lc(t)||t._readableState)throw(0,rg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Bc(t)&&(t=(0,m$.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let r=(0,g$.default)(t),{value:n,done:i}=await r.peek();if(i){yield*[];return}if(r.push(n),Number.isInteger(n))throw(0,rg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState){yield*(0,BR.default)(r,o=>LR({content:o},e));return}if(Yo(n)){yield LR({content:r},e);return}if(j2(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Bc(n)||Lc(n)){yield*(0,BR.default)(r,o=>LR(o,e));return}}throw j2(t)?(0,rg.default)(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):(0,rg.default)(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}async function LR(t,e){let{path:r,mode:n,mtime:i,content:o}=t,s={path:r||"",mode:hc(n),mtime:Dl(i)};return o?s.content=await e(o):r||(s.content=await e(t)),s}function y$(t){return j6(t,U6)}c();var w$=t=>{if(t)if(t.startsWith("size-")){let e=t.split("-")[1],r=parseInt(e);if(isNaN(r))throw new Error("Chunker parameter size must be an integer");return{chunker:"fixed",maxChunkSize:r}}else{if(t.startsWith("rabin"))return{chunker:"rabin",...I5e(t)};throw new Error(`Unrecognized chunker option: ${t}`)}else return{chunker:"fixed"}},I5e=t=>{let e={},r=t.split("-");switch(r.length){case 1:e.avgChunkSize=262144;break;case 2:e.avgChunkSize=Y6(r[1],"avg");break;case 4:e.minChunkSize=Y6(r[1],"min"),e.avgChunkSize=Y6(r[2],"avg"),e.maxChunkSize=Y6(r[3],"max");break;default:throw new Error('Incorrect chunker format (expected "rabin" "rabin-[avg]" or "rabin-[min]-[avg]-[max]"')}return e},Y6=(t,e)=>{let r=parseInt(t);if(isNaN(r))throw new Error(`Chunker parameter ${e} must be an integer`);return r};var C5e=Ye.bind({ignoreUndefined:!0});function E$({repo:t,preload:e,hashers:r,options:n}){let i=n&&n.sharding;async function*o(s,a={}){let l=C5e({shardSplitThreshold:i?1e3:1/0,strategy:"balanced"},a,{...w$(a.chunker)});l.hashAlg&&l.hashAlg!=="sha2-256"&&l.cidVersion!==1&&(l.cidVersion=1),l.trickle&&(l.strategy="trickle"),l.strategy==="trickle"&&(l.leafType="raw",l.reduceSingleLeafToSelf=!1),l.cidVersion>0&&l.rawLeaves===void 0&&(l.rawLeaves=!0),l.hashAlg!==void 0&&l.rawLeaves===void 0&&(l.rawLeaves=!0),delete l.trickle;let u={};if(l.progress){let d=l.progress;l.progress=(m,g)=>{u[g]||(u[g]=0),u[g]+=m,d(u[g],g)}}let f;l.hashAlg!=null&&(f=await r.getHasher(l.hashAlg));let h=Se(y$(s),d=>f0(d,t.blocks,{...l,hasher:f,pin:!1}),P5e(l),N5e(e,l),k5e(t,l)),p=await t.gcLock.readLock();try{for await(let d of h){let m=d.path??d.cid.toString();delete u[m],yield{...d,path:m}}}finally{p()}}return B(o)}function P5e(t){async function*e(r){for await(let n of r){let i=n.cid;t.cidVersion===1&&(i=i.toV1());let o=n.path?n.path:i.toString();t.wrapWithDirectory&&!n.path&&(o=""),yield{path:o,cid:i,size:n.size,mode:n.unixfs&&n.unixfs.mode,mtime:n.unixfs&&n.unixfs.mtime}}}return e}function N5e(t,e){async function*r(n){for await(let i of n)(!i.path||e.wrapWithDirectory?i.path==="":!i.path.includes("/"))&&!e.onlyHash&&e.preload!==!1&&t(i.cid),yield i}return r}function k5e(t,e){async function*r(n){for await(let i of n){let o=!(i.path&&i.path.includes("/"));(e.pin==null?!0:e.pin)&&o&&!e.onlyHash&&await t.pins.pinRecursively(i.cid),yield i}}return r}c();c();var J6=E(V(),1);te();c();var O$=E(V(),1);Fo();gc();c();var Z6=E(V(),1);c();var Q6=E(tg(),1);var D5e=async function(t){return(await dh.encode(t)).slice(0,8).reverse()},O5e=(t,e,r)=>Promise.all(t.map(n=>{if(n.Name==null)throw new Error("Unexpected Link without a Name");if(n.Name.length===2){let i=parseInt(n.Name,16);return e._putObjectAt(i,new Q6.Bucket({hash:r._options.hash,bits:r._options.bits},e,i))}return r.put(n.Name.substring(2),!0)})),b$=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),L5e=t=>{let e=t.bucket,r=[];for(;e._parent;)r.push(e),e=e._parent;return r.push(e),r.reverse()},_$=async(t,e,r,n,i)=>{if(!n){let f=(0,Q6.createHAMT)({hashFn:D5e});n={rootBucket:f,hamtDepth:1,lastBucket:f}}await O5e(t.Links,n.lastBucket,n.rootBucket);let o=await n.rootBucket._findNewBucketAndPos(e),s=b$(o.pos),a=L5e(o);a.length>n.hamtDepth&&(n.lastBucket=a[n.hamtDepth],s=b$(n.lastBucket._posAtParent));let l=t.Links.find(f=>{if(f.Name==null)return!1;let h=f.Name.substring(0,2),p=f.Name.substring(2);return!(h!==s||p&&p!==e)});if(!l)return null;if(l.Name!=null&&l.Name.substring(2)===e)return l.Hash;n.hamtDepth++;let u=await r.get(l.Hash,i);return t=Rt(u),_$(t,e,r,n,i)},v$=_$;c();c();function B5e(t,e,r,n){let i=t.length,o=e+i;return r>=o||n<e?new Uint8Array(0):(n>=e&&n<o&&(t=t.slice(0,n-e)),r>=e&&r<o&&(t=t.slice(r-e)),t)}var ph=B5e;c();var X6=E(V(),1),M5e=(t,e,r)=>{if(e||(e=0),e<0)throw(0,X6.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(e>t)throw(0,X6.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!r&&r!==0&&(r=t-e),r<0)throw(0,X6.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return e+r>t&&(r=t-e),{offset:e,length:r}},h0=M5e;var MR=E(V(),1);Fo();async function*S$(t,e,r,n,i=0,o){if(e instanceof Uint8Array){let l=ph(e,i,r,n);return l.length&&(yield l),i+=l.length,i}if(e.Data==null)throw(0,MR.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let s;try{s=Qe.unmarshal(e.Data)}catch(l){throw(0,MR.default)(l,"ERR_NOT_UNIXFS")}if(s.data&&s.data.length){let l=ph(s.data,i,r,n);l.length&&(yield l),i+=s.data.length}let a=i;for(let l=0;l<e.Links.length;l++){let u=e.Links[l],f=i+s.blockSizes[l];if(r>=a&&r<f||n>a&&n<=f||r<a&&n>f){let h=await t.get(u.Hash,{signal:o.signal}),p;switch(u.Hash.code){case ht:p=await Rt(h);break;case Un:p=h;break;case Lf:p=await Bf(h);break;default:throw Error(`Unsupported codec: ${u.Hash.code}`)}for await(let d of S$(t,p,r,n,i,o))i+=d.length,yield d}i=f,a=f+1}}var U5e=(t,e,r,n,i,o,s)=>{function a(l={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{offset:f,length:h}=h0(u,l.offset,l.length),p=f,d=f+h;return S$(s,e,p,d,0,l)}return a},UR=U5e;c();var F5e=(t,e,r,n,i,o,s)=>{async function*a(l={}){let u=l.offset||0,f=l.length||e.Links.length,h=e.Links.slice(u,f);for(let p of h){let d=await i(p.Hash,p.Name||"",`${n}/${p.Name||""}`,[],o+1,s,l);d.entry&&(yield d.entry)}}return a},x$=F5e;c();var K5e=(t,e,r,n,i,o,s)=>{function a(l={}){return R$(e,n,i,o,s,l)}return a};async function*R$(t,e,r,n,i,o){let s=t.Links;for(let a of s){let l=a.Name!=null?a.Name.substring(2):null;if(l)yield(await r(a.Hash,l,`${e}/${l}`,[],n+1,i,o)).entry;else{let u=await i.get(a.Hash);t=Rt(u);for await(let f of R$(t,e,r,n,i,o))yield f}}}var T$=K5e;var V5e=(t,e)=>{let r=t.Links.find(n=>n.Name===e);return r&&r.Hash},q5e={raw:UR,file:UR,directory:x$,"hamt-sharded-directory":T$,metadata:(t,e,r,n,i,o,s)=>()=>[],symlink:(t,e,r,n,i,o,s)=>()=>[]},z5e=async(t,e,r,n,i,o,s,a)=>{let l=await s.get(t,a),u=Rt(l),f,h;if(e||(e=t.toString()),u.Data==null)throw(0,Z6.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{f=Qe.unmarshal(u.Data)}catch(p){throw(0,Z6.default)(p,"ERR_NOT_UNIXFS")}if(r||(r=e),n.length){let p;if(f&&f.type==="hamt-sharded-directory"?p=await v$(u,n[0],s):p=V5e(u,n[0]),!p)throw(0,Z6.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let d=n.shift(),m=`${r}/${d}`;h={cid:p,toResolve:n,name:d||"",path:m}}return{entry:{type:f.isDirectory()?"directory":"file",name:e,path:r,cid:t,content:q5e[f.type](t,u,f,r,i,o,s),unixfs:f,depth:o,node:u,size:f.fileSize()},next:h}},A$=z5e;c();var I$=E(V(),1);var H5e=t=>{async function*e(r={}){let{offset:n,length:i}=h0(t.length,r.offset,r.length);yield ph(t,0,n,n+i)}return e},$5e=async(t,e,r,n,i,o,s,a)=>{if(n.length)throw(0,I$.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let l=await s.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:H5e(l),depth:o,size:l.length,node:l}}},C$=$5e;c();te();var P$=E(V(),1);var G5e=async(t,e,r,n,i,o,s,a)=>{let l=await s.get(t),u=Bf(l),f=u,h=r;for(;n.length;){let p=n[0];if(p in f){n.shift(),h=`${h}/${p}`;let d=T.asCID(f[p]);if(d)return{entry:{type:"object",name:e,path:r,cid:t,node:l,depth:o,size:l.length,content:async function*(){yield u}},next:{cid:d,name:p,path:h,toResolve:n}};f=f[p]}else throw(0,P$.default)(new Error(`No property named ${p} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:l,depth:o,size:l.length,content:async function*(){yield u}}}},N$=G5e;c();var k$=E(V(),1);On();var W5e=t=>{async function*e(r={}){let{offset:n,length:i}=h0(t.length,r.offset,r.length);yield ph(t,0,n,n+i)}return e},j5e=async(t,e,r,n,i,o,s,a)=>{if(n.length)throw(0,k$.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let l=await wr(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:W5e(l.digest),depth:o,size:l.digest.length,node:l.digest}}},D$=j5e;var Y5e={[ht]:A$,[Un]:C$,[Lf]:N$,[hn.code]:D$};function L$(t,e,r,n,i,o,s){let a=Y5e[t.code];if(!a)throw(0,O$.default)(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,n,L$,i,o,s)}var B$=L$;var M$=E(Fi(),1),Q5e=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean),X5e=t=>{if(t instanceof Uint8Array)return{cid:T.decode(t),toResolve:[]};let e=T.asCID(t);if(e)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=Q5e(t);return{cid:T.parse(r[0]),toResolve:r.slice(1)}}throw(0,J6.default)(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")};async function*FR(t,e,r={}){let{cid:n,toResolve:i}=X5e(t),o=n.toString(),s=o,a=i.length;for(;;){let l=await B$(n,o,s,i,a,e,r);if(!l.entry&&!l.next)throw(0,J6.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(l.entry&&(yield l.entry),!l.next)return;i=l.next.toResolve,n=l.next.cid,o=l.next.name,s=l.next.path}}async function ti(t,e,r={}){let n=await(0,M$.default)(FR(t,e,r));if(!n)throw(0,J6.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return n}async function*e5(t,e,r={}){let n=await ti(t,e,r);if(!n)return;if(yield n,n.type==="directory")for await(let o of i(n,r))yield o;async function*i(o,s){for await(let a of o.content(s))yield a,!(a instanceof Uint8Array)&&a.type==="directory"&&(yield*i(a,s))}}te();function U$({repo:t,preload:e}){async function*r(n,i={}){if(n=Sp(n),i.preload!==!1){let s=n.split("/");e(T.parse(s[0]))}let o=await ti(n,t.blocks,i);if(o.type==="directory")throw new Error("this dag node is a directory");if(!o.content)throw new Error("this dag node has no content");yield*o.content(i)}return B(r)}c();var w0=E(V(),1);te();c();c();c();function Sr(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}c();Re();Ae();var VQe="0".charCodeAt(0),qQe=U("ustar\0","binary"),zQe=U("ustar ","binary"),HQe=U(" \0","binary");c();c();function ng(t){let e=async function*(){let r=yield,n=new Ve;for await(let i of t){if(r==null){n.append(i),r=yield n,n=new Ve;continue}for(n.append(i);n.length>=r;){let o=n.subarray(0,r);if(n.consume(r),r=yield o,r==null){n.length>0&&(r=yield n,n=new Ve);break}}}if(r!=null)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return e.next(),e}c();var z$=E(K$(),1),H$=E(KR(),1);c();Ae();var t8e="0000000000000000000",r8e="7777777777777777777",n8e="0".charCodeAt(0),i8e=U("ustar\0","binary"),o8e=U("00","binary"),s8e=parseInt("7777",8),a8e=257,c8e=263,l8e=function(t){switch(t){case"file":return 0;case"link":return 1;case"symlink":return 2;case"character-device":return 3;case"block-device":return 4;case"directory":return 5;case"fifo":return 6;case"contiguous-file":return 7;case"pax-header":return 72;default:return 0}},u8e=function(t){let e=256;for(let r=0;r<148;r++)e+=t[r];for(let r=156;r<512;r++)e+=t[r];return e},fu=function(t,e){let r=t.toString(8);return r.length>e?U(r8e.slice(0,e)+" "):U(t8e.slice(0,e-r.length)+r+" ")},VR=function(t){let e=U(t).byteLength,r=Math.floor(Math.log(e)/Math.log(10))+1;return e+r>=Math.pow(10,r)&&r++,`${e+r}${t}`};function q$(t){let e="";t.name!=null&&(e+=VR(" path="+t.name+`
`)),t.linkname!=null&&(e+=VR(" linkpath="+t.linkname+`
`));let r=t.pax;if(r!=null)for(let n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e+=VR(" "+n+"="+r[n]+`
`));return U(e)}function t5(t){let e=new Uint8Array(512),r=t.name,n="";if(t.typeflag===5&&r[r.length-1]!=="/"&&(r+="/"),U(r).byteLength!==r.length)return null;for(;U(r).byteLength>100;){let i=r.indexOf("/");if(i===-1)return null;n+=n!==""?"/"+r.slice(0,i):r.slice(0,i),r=r.slice(i+1)}return U(r).byteLength>100||U(n).byteLength>155||t.linkname!=null&&U(t.linkname).byteLength>100?null:(e.set(U(r),0),e.set(fu(t.mode&s8e,6),100),e.set(fu(t.uid,6),108),e.set(fu(t.gid,6),116),e.set(fu(t.size,11),124),e.set(fu(t.mtime.getTime()/1e3|0,11),136),e[156]=n8e+l8e(t.type),t.linkname!=null&&e.set(U(t.linkname),157),e.set(i8e,a8e),e.set(o8e,c8e),t.uname!=null&&e.set(U(t.uname),265),t.gname!=null&&e.set(U(t.gname),297),e.set(fu(t.devmajor??0,6),329),e.set(fu(t.devminor??0,6),337),n!=null&&e.set(U(n),345),e.set(fu(u8e(e),6),148),e)}Ae();Re();var{S_IFMT:h8e,S_IFBLK:d8e,S_IFCHR:p8e,S_IFDIR:m8e,S_IFIFO:g8e,S_IFLNK:y8e}=z$.default,w8e=parseInt("755",8),E8e=parseInt("644",8),$$=new Uint8Array(1024);function b8e(t=0){switch(t&h8e){case d8e:return"block-device";case p8e:return"character-device";case m8e:return"directory";case g8e:return"fifo";case y8e:return"symlink";default:return"file"}}function zR(t){return t&=511,t!==0?$$.slice(0,512-t):new Uint8Array(0)}function qR(t){if(t.pax==null){let e=t5(t);if(e!=null)return e}return _8e(t)}function _8e(t){let e=q$(t),r={name:"PaxHeader",mode:t.mode,uid:t.uid,gid:t.gid,size:e.length,mtime:t.mtime,type:"pax-header",linkname:t.linkname,uname:t.uname,gname:t.gname,devmajor:t.devmajor,devminor:t.devminor};return new Ve(t5(r)??new Uint8Array(0),e,zR(e.length),t5({...r,size:t.size,type:t.type})??new Uint8Array(0)).slice()}function r5(){return async function*(t){for await(let{header:e,body:r}of t){let n={...e,size:e.type==="symlink"?0:e.size??0,type:e.type??b8e(e.mode),mode:e.mode??(e.type==="directory"?w8e:E8e),uid:e.uid??0,gid:e.gid??0,mtime:e.mtime??new Date};if(typeof r=="string"&&(r=U(r)),r instanceof Uint8Array||Gl(r)){n.size=r.length,yield qR(n),yield Gl(r)?r.slice():r,yield zR(n.size);continue}if(n.type==="symlink"&&n.linkname==null){if(r==null)throw new Error("type was symlink but no linkname or body specified");n.linkname=F(await(0,H$.default)(r)),yield qR(n);continue}if(yield qR(n),n.type!=="file"&&n.type!=="contiguous-file")continue;let i=0;for await(let o of r??[])i+=o.length,yield Gl(o)?o.slice():o;if(i!==n.size)throw new Error(`size mismatch, wrote ${i} of ${n.size} bytes`);yield zR(n.size)}yield $$}}c();function g0(t){let e=t.length;for(;--e>=0;)t[e]=0}var v8e=0,PG=1,S8e=2,x8e=3,R8e=258,cT=29,wg=256,ug=wg+1+cT,m0=30,lT=19,NG=2*ug+1,mh=15,HR=16,T8e=7,uT=256,kG=16,DG=17,OG=18,iT=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),c5=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),A8e=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),LG=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),I8e=512,Uc=new Array((ug+2)*2);g0(Uc);var ag=new Array(m0*2);g0(ag);var fg=new Array(I8e);g0(fg);var hg=new Array(R8e-x8e+1);g0(hg);var fT=new Array(cT);g0(fT);var h5=new Array(m0);g0(h5);function $R(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}var BG,MG,UG;function GR(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}var FG=t=>t<256?fg[t]:fg[256+(t>>>7)],dg=(t,e)=>{t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255},Gi=(t,e,r)=>{t.bi_valid>HR-r?(t.bi_buf|=e<<t.bi_valid&65535,dg(t,t.bi_buf),t.bi_buf=e>>HR-t.bi_valid,t.bi_valid+=r-HR):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Pa=(t,e,r)=>{Gi(t,r[e*2],r[e*2+1])},KG=(t,e)=>{let r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1},C8e=t=>{t.bi_valid===16?(dg(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)},P8e=(t,e)=>{let r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,u,f,h,p,d,m,g=0;for(p=0;p<=mh;p++)t.bl_count[p]=0;for(r[t.heap[t.heap_max]*2+1]=0,u=t.heap_max+1;u<NG;u++)f=t.heap[u],p=r[r[f*2+1]*2+1]+1,p>l&&(p=l,g++),r[f*2+1]=p,!(f>n)&&(t.bl_count[p]++,d=0,f>=a&&(d=s[f-a]),m=r[f*2],t.opt_len+=m*(p+d),o&&(t.static_len+=m*(i[f*2+1]+d)));if(g!==0){do{for(p=l-1;t.bl_count[p]===0;)p--;t.bl_count[p]--,t.bl_count[p+1]+=2,t.bl_count[l]--,g-=2}while(g>0);for(p=l;p!==0;p--)for(f=t.bl_count[p];f!==0;)h=t.heap[--u],!(h>n)&&(r[h*2+1]!==p&&(t.opt_len+=(p-r[h*2+1])*r[h*2],r[h*2+1]=p),f--)}},VG=(t,e,r)=>{let n=new Array(mh+1),i=0,o,s;for(o=1;o<=mh;o++)n[o]=i=i+r[o-1]<<1;for(s=0;s<=e;s++){let a=t[s*2+1];a!==0&&(t[s*2]=KG(n[a]++,a))}},N8e=()=>{let t,e,r,n,i,o=new Array(mh+1);for(r=0,n=0;n<cT-1;n++)for(fT[n]=r,t=0;t<1<<iT[n];t++)hg[r++]=n;for(hg[r-1]=n,i=0,n=0;n<16;n++)for(h5[n]=i,t=0;t<1<<c5[n];t++)fg[i++]=n;for(i>>=7;n<m0;n++)for(h5[n]=i<<7,t=0;t<1<<c5[n]-7;t++)fg[256+i++]=n;for(e=0;e<=mh;e++)o[e]=0;for(t=0;t<=143;)Uc[t*2+1]=8,t++,o[8]++;for(;t<=255;)Uc[t*2+1]=9,t++,o[9]++;for(;t<=279;)Uc[t*2+1]=7,t++,o[7]++;for(;t<=287;)Uc[t*2+1]=8,t++,o[8]++;for(VG(Uc,ug+1,o),t=0;t<m0;t++)ag[t*2+1]=5,ag[t*2]=KG(t,5);BG=new $R(Uc,iT,wg+1,ug,mh),MG=new $R(ag,c5,0,m0,mh),UG=new $R(new Array(0),A8e,0,lT,T8e)},qG=t=>{let e;for(e=0;e<ug;e++)t.dyn_ltree[e*2]=0;for(e=0;e<m0;e++)t.dyn_dtree[e*2]=0;for(e=0;e<lT;e++)t.bl_tree[e*2]=0;t.dyn_ltree[uT*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},zG=t=>{t.bi_valid>8?dg(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},k8e=(t,e,r,n)=>{zG(t),n&&(dg(t,r),dg(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},G$=(t,e,r,n)=>{let i=e*2,o=r*2;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},WR=(t,e,r)=>{let n=t.heap[r],i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&G$(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!G$(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},W$=(t,e,r)=>{let n,i,o=0,s,a;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+o*2]<<8|t.pending_buf[t.d_buf+o*2+1],i=t.pending_buf[t.l_buf+o],o++,n===0?Pa(t,i,e):(s=hg[i],Pa(t,s+wg+1,e),a=iT[s],a!==0&&(i-=fT[s],Gi(t,i,a)),n--,s=FG(n),Pa(t,s,r),a=c5[s],a!==0&&(n-=h5[s],Gi(t,n,a)));while(o<t.last_lit);Pa(t,uT,e)},oT=(t,e)=>{let r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems,s,a,l=-1,u;for(t.heap_len=0,t.heap_max=NG,s=0;s<o;s++)r[s*2]!==0?(t.heap[++t.heap_len]=l=s,t.depth[s]=0):r[s*2+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=l<2?++l:0,r[u*2]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[u*2+1]);for(e.max_code=l,s=t.heap_len>>1;s>=1;s--)WR(t,r,s);u=o;do s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],WR(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,r[u*2]=r[s*2]+r[a*2],t.depth[u]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,r[s*2+1]=r[a*2+1]=u,t.heap[1]=u++,WR(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],P8e(t,e),VG(r,l,t.bl_count)},j$=(t,e,r)=>{let n,i=-1,o,s=e[0*2+1],a=0,l=7,u=4;for(s===0&&(l=138,u=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)o=s,s=e[(n+1)*2+1],!(++a<l&&o===s)&&(a<u?t.bl_tree[o*2]+=a:o!==0?(o!==i&&t.bl_tree[o*2]++,t.bl_tree[kG*2]++):a<=10?t.bl_tree[DG*2]++:t.bl_tree[OG*2]++,a=0,i=o,s===0?(l=138,u=3):o===s?(l=6,u=3):(l=7,u=4))},Y$=(t,e,r)=>{let n,i=-1,o,s=e[0*2+1],a=0,l=7,u=4;for(s===0&&(l=138,u=3),n=0;n<=r;n++)if(o=s,s=e[(n+1)*2+1],!(++a<l&&o===s)){if(a<u)do Pa(t,o,t.bl_tree);while(--a!==0);else o!==0?(o!==i&&(Pa(t,o,t.bl_tree),a--),Pa(t,kG,t.bl_tree),Gi(t,a-3,2)):a<=10?(Pa(t,DG,t.bl_tree),Gi(t,a-3,3)):(Pa(t,OG,t.bl_tree),Gi(t,a-11,7));a=0,i=o,s===0?(l=138,u=3):o===s?(l=6,u=3):(l=7,u=4)}},D8e=t=>{let e;for(j$(t,t.dyn_ltree,t.l_desc.max_code),j$(t,t.dyn_dtree,t.d_desc.max_code),oT(t,t.bl_desc),e=lT-1;e>=3&&t.bl_tree[LG[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e},O8e=(t,e,r,n)=>{let i;for(Gi(t,e-257,5),Gi(t,r-1,5),Gi(t,n-4,4),i=0;i<n;i++)Gi(t,t.bl_tree[LG[i]*2+1],3);Y$(t,t.dyn_ltree,e-1),Y$(t,t.dyn_dtree,r-1)},L8e=t=>{let e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return 0;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return 1;for(r=32;r<wg;r++)if(t.dyn_ltree[r*2]!==0)return 1;return 0},Q$=!1,B8e=t=>{Q$||(N8e(),Q$=!0),t.l_desc=new GR(t.dyn_ltree,BG),t.d_desc=new GR(t.dyn_dtree,MG),t.bl_desc=new GR(t.bl_tree,UG),t.bi_buf=0,t.bi_valid=0,qG(t)},HG=(t,e,r,n)=>{Gi(t,(v8e<<1)+(n?1:0),3),k8e(t,e,r,!0)},M8e=t=>{Gi(t,PG<<1,3),Pa(t,uT,Uc),C8e(t)},U8e=(t,e,r,n)=>{let i,o,s=0;t.level>0?(t.strm.data_type===2&&(t.strm.data_type=L8e(t)),oT(t,t.l_desc),oT(t,t.d_desc),s=D8e(t),i=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=i&&(i=o)):i=o=r+5,r+4<=i&&e!==-1?HG(t,e,r,n):t.strategy===4||o===i?(Gi(t,(PG<<1)+(n?1:0),3),W$(t,Uc,ag)):(Gi(t,(S8e<<1)+(n?1:0),3),O8e(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),W$(t,t.dyn_ltree,t.dyn_dtree)),qG(t),n&&zG(t)},F8e=(t,e,r)=>(t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(hg[r]+wg+1)*2]++,t.dyn_dtree[FG(e)*2]++),t.last_lit===t.lit_bufsize-1),K8e=B8e,V8e=HG,q8e=U8e,z8e=F8e,H8e=M8e,$8e={_tr_init:K8e,_tr_stored_block:V8e,_tr_flush_block:q8e,_tr_tally:z8e,_tr_align:H8e},G8e=(t,e,r,n)=>{let i=t&65535|0,o=t>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+e[n++]|0,o=o+i|0;while(--s);i%=65521,o%=65521}return i|o<<16|0},pg=G8e,W8e=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e},j8e=new Uint32Array(W8e()),Y8e=(t,e,r,n)=>{let i=j8e,o=n+r;t^=-1;for(let s=n;s<o;s++)t=t>>>8^i[(t^e[s])&255];return t^-1},$n=Y8e,yh={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_h={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:Q8e,_tr_stored_block:X8e,_tr_flush_block:Z8e,_tr_tally:gu,_tr_align:J8e}=$8e,{Z_NO_FLUSH:vh,Z_PARTIAL_FLUSH:eEe,Z_FULL_FLUSH:tEe,Z_FINISH:yu,Z_BLOCK:X$,Z_OK:Na,Z_STREAM_END:Z$,Z_STREAM_ERROR:Xo,Z_DATA_ERROR:rEe,Z_BUF_ERROR:jR,Z_DEFAULT_COMPRESSION:nEe,Z_FILTERED:iEe,Z_HUFFMAN_ONLY:n5,Z_RLE:oEe,Z_FIXED:sEe,Z_DEFAULT_STRATEGY:aEe,Z_UNKNOWN:cEe,Z_DEFLATED:m5}=_h,lEe=9,uEe=15,fEe=8,hEe=29,dEe=256,sT=dEe+1+hEe,pEe=30,mEe=19,gEe=2*sT+1,yEe=15,At=3,pu=258,Vs=pu+At+1,wEe=32,g5=42,aT=69,l5=73,u5=91,f5=103,gh=113,og=666,Cn=1,Eg=2,wh=3,y0=4,EEe=3,mu=(t,e)=>(t.msg=yh[e],e),J$=t=>(t<<1)-(t>4?9:0),du=t=>{let e=t.length;for(;--e>=0;)t[e]=0},bEe=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,wu=bEe,hu=t=>{let e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))},ri=(t,e)=>{Z8e(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,hu(t.strm)},zt=(t,e)=>{t.pending_buf[t.pending++]=e},ig=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255},_Ee=(t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),i===0?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),t.state.wrap===1?t.adler=pg(t.adler,e,i,r):t.state.wrap===2&&(t.adler=$n(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},$G=(t,e)=>{let r=t.max_chain_length,n=t.strstart,i,o,s=t.prev_length,a=t.nice_match,l=t.strstart>t.w_size-Vs?t.strstart-(t.w_size-Vs):0,u=t.window,f=t.w_mask,h=t.prev,p=t.strstart+pu,d=u[n+s-1],m=u[n+s];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(i=e,!(u[i+s]!==m||u[i+s-1]!==d||u[i]!==u[n]||u[++i]!==u[n+1])){n+=2,i++;do;while(u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&u[++n]===u[++i]&&n<p);if(o=pu-(p-n),n=p-pu,o>s){if(t.match_start=e,s=o,o>=a)break;d=u[n+s-1],m=u[n+s]}}while((e=h[e&f])>l&&--r!==0);return s<=t.lookahead?s:t.lookahead},Eh=t=>{let e=t.w_size,r,n,i,o,s;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-Vs)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do i=t.head[--r],t.head[r]=i>=e?i-e:0;while(--n);n=e,r=n;do i=t.prev[--r],t.prev[r]=i>=e?i-e:0;while(--n);o+=e}if(t.strm.avail_in===0)break;if(n=_Ee(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=At)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=wu(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=wu(t,t.ins_h,t.window[s+At-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<At)););}while(t.lookahead<Vs&&t.strm.avail_in!==0)},vEe=(t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Eh(t),t.lookahead===0&&e===vh)return Cn;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;let n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,ri(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-Vs&&(ri(t,!1),t.strm.avail_out===0))return Cn}return t.insert=0,e===yu?(ri(t,!0),t.strm.avail_out===0?wh:y0):(t.strstart>t.block_start&&(ri(t,!1),t.strm.avail_out===0),Cn)},YR=(t,e)=>{let r,n;for(;;){if(t.lookahead<Vs){if(Eh(t),t.lookahead<Vs&&e===vh)return Cn;if(t.lookahead===0)break}if(r=0,t.lookahead>=At&&(t.ins_h=wu(t,t.ins_h,t.window[t.strstart+At-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-Vs&&(t.match_length=$G(t,r)),t.match_length>=At)if(n=gu(t,t.strstart-t.match_start,t.match_length-At),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=At){t.match_length--;do t.strstart++,t.ins_h=wu(t,t.ins_h,t.window[t.strstart+At-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=wu(t,t.ins_h,t.window[t.strstart+1]);else n=gu(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(ri(t,!1),t.strm.avail_out===0))return Cn}return t.insert=t.strstart<At-1?t.strstart:At-1,e===yu?(ri(t,!0),t.strm.avail_out===0?wh:y0):t.last_lit&&(ri(t,!1),t.strm.avail_out===0)?Cn:Eg},d0=(t,e)=>{let r,n,i;for(;;){if(t.lookahead<Vs){if(Eh(t),t.lookahead<Vs&&e===vh)return Cn;if(t.lookahead===0)break}if(r=0,t.lookahead>=At&&(t.ins_h=wu(t,t.ins_h,t.window[t.strstart+At-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=At-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-Vs&&(t.match_length=$G(t,r),t.match_length<=5&&(t.strategy===iEe||t.match_length===At&&t.strstart-t.match_start>4096)&&(t.match_length=At-1)),t.prev_length>=At&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-At,n=gu(t,t.strstart-1-t.prev_match,t.prev_length-At),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=i&&(t.ins_h=wu(t,t.ins_h,t.window[t.strstart+At-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=At-1,t.strstart++,n&&(ri(t,!1),t.strm.avail_out===0))return Cn}else if(t.match_available){if(n=gu(t,0,t.window[t.strstart-1]),n&&ri(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return Cn}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=gu(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<At-1?t.strstart:At-1,e===yu?(ri(t,!0),t.strm.avail_out===0?wh:y0):t.last_lit&&(ri(t,!1),t.strm.avail_out===0)?Cn:Eg},SEe=(t,e)=>{let r,n,i,o,s=t.window;for(;;){if(t.lookahead<=pu){if(Eh(t),t.lookahead<=pu&&e===vh)return Cn;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=At&&t.strstart>0&&(i=t.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=t.strstart+pu;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);t.match_length=pu-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=At?(r=gu(t,1,t.match_length-At),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=gu(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(ri(t,!1),t.strm.avail_out===0))return Cn}return t.insert=0,e===yu?(ri(t,!0),t.strm.avail_out===0?wh:y0):t.last_lit&&(ri(t,!1),t.strm.avail_out===0)?Cn:Eg},xEe=(t,e)=>{let r;for(;;){if(t.lookahead===0&&(Eh(t),t.lookahead===0)){if(e===vh)return Cn;break}if(t.match_length=0,r=gu(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(ri(t,!1),t.strm.avail_out===0))return Cn}return t.insert=0,e===yu?(ri(t,!0),t.strm.avail_out===0?wh:y0):t.last_lit&&(ri(t,!1),t.strm.avail_out===0)?Cn:Eg};function Ca(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}var sg=[new Ca(0,0,0,0,vEe),new Ca(4,4,8,4,YR),new Ca(4,5,16,8,YR),new Ca(4,6,32,32,YR),new Ca(4,4,16,16,d0),new Ca(8,16,32,32,d0),new Ca(8,16,128,128,d0),new Ca(8,32,128,256,d0),new Ca(32,128,258,1024,d0),new Ca(32,258,258,4096,d0)],REe=t=>{t.window_size=2*t.w_size,du(t.head),t.max_lazy_match=sg[t.level].max_lazy,t.good_match=sg[t.level].good_length,t.nice_match=sg[t.level].nice_length,t.max_chain_length=sg[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=At-1,t.match_available=0,t.ins_h=0};function TEe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=m5,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(gEe*2),this.dyn_dtree=new Uint16Array((2*pEe+1)*2),this.bl_tree=new Uint16Array((2*mEe+1)*2),du(this.dyn_ltree),du(this.dyn_dtree),du(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(yEe+1),this.heap=new Uint16Array(2*sT+1),du(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*sT+1),du(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var GG=t=>{if(!t||!t.state)return mu(t,Xo);t.total_in=t.total_out=0,t.data_type=cEe;let e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?g5:gh,t.adler=e.wrap===2?0:1,e.last_flush=vh,Q8e(e),Na},WG=t=>{let e=GG(t);return e===Na&&REe(t.state),e},AEe=(t,e)=>!t||!t.state||t.state.wrap!==2?Xo:(t.state.gzhead=e,Na),jG=(t,e,r,n,i,o)=>{if(!t)return Xo;let s=1;if(e===nEe&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>lEe||r!==m5||n<8||n>15||e<0||e>9||o<0||o>sEe)return mu(t,Xo);n===8&&(n=9);let a=new TEe;return t.state=a,a.strm=t,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+At-1)/At),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=e,a.strategy=o,a.method=r,WG(t)},IEe=(t,e)=>jG(t,e,m5,uEe,fEe,aEe),CEe=(t,e)=>{let r,n;if(!t||!t.state||e>X$||e<0)return t?mu(t,Xo):Xo;let i=t.state;if(!t.output||!t.input&&t.avail_in!==0||i.status===og&&e!==yu)return mu(t,t.avail_out===0?jR:Xo);i.strm=t;let o=i.last_flush;if(i.last_flush=e,i.status===g5)if(i.wrap===2)t.adler=0,zt(i,31),zt(i,139),zt(i,8),i.gzhead?(zt(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),zt(i,i.gzhead.time&255),zt(i,i.gzhead.time>>8&255),zt(i,i.gzhead.time>>16&255),zt(i,i.gzhead.time>>24&255),zt(i,i.level===9?2:i.strategy>=n5||i.level<2?4:0),zt(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(zt(i,i.gzhead.extra.length&255),zt(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=$n(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=aT):(zt(i,0),zt(i,0),zt(i,0),zt(i,0),zt(i,0),zt(i,i.level===9?2:i.strategy>=n5||i.level<2?4:0),zt(i,EEe),i.status=gh);else{let s=m5+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=n5||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,s|=a<<6,i.strstart!==0&&(s|=wEe),s+=31-s%31,i.status=gh,ig(i,s),i.strstart!==0&&(ig(i,t.adler>>>16),ig(i,t.adler&65535)),t.adler=1}if(i.status===aT)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),hu(t),r=i.pending,i.pending===i.pending_buf_size));)zt(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=l5)}else i.status=l5;if(i.status===l5)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),hu(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,zt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.gzindex=0,i.status=u5)}else i.status=u5;if(i.status===u5)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),hu(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,zt(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>r&&(t.adler=$n(t.adler,i.pending_buf,i.pending-r,r)),n===0&&(i.status=f5)}else i.status=f5;if(i.status===f5&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&hu(t),i.pending+2<=i.pending_buf_size&&(zt(i,t.adler&255),zt(i,t.adler>>8&255),t.adler=0,i.status=gh)):i.status=gh),i.pending!==0){if(hu(t),t.avail_out===0)return i.last_flush=-1,Na}else if(t.avail_in===0&&J$(e)<=J$(o)&&e!==yu)return mu(t,jR);if(i.status===og&&t.avail_in!==0)return mu(t,jR);if(t.avail_in!==0||i.lookahead!==0||e!==vh&&i.status!==og){let s=i.strategy===n5?xEe(i,e):i.strategy===oEe?SEe(i,e):sg[i.level].func(i,e);if((s===wh||s===y0)&&(i.status=og),s===Cn||s===wh)return t.avail_out===0&&(i.last_flush=-1),Na;if(s===Eg&&(e===eEe?J8e(i):e!==X$&&(X8e(i,0,0,!1),e===tEe&&(du(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),hu(t),t.avail_out===0))return i.last_flush=-1,Na}return e!==yu?Na:i.wrap<=0?Z$:(i.wrap===2?(zt(i,t.adler&255),zt(i,t.adler>>8&255),zt(i,t.adler>>16&255),zt(i,t.adler>>24&255),zt(i,t.total_in&255),zt(i,t.total_in>>8&255),zt(i,t.total_in>>16&255),zt(i,t.total_in>>24&255)):(ig(i,t.adler>>>16),ig(i,t.adler&65535)),hu(t),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Na:Z$)},PEe=t=>{if(!t||!t.state)return Xo;let e=t.state.status;return e!==g5&&e!==aT&&e!==l5&&e!==u5&&e!==f5&&e!==gh&&e!==og?mu(t,Xo):(t.state=null,e===gh?mu(t,rEe):Na)},NEe=(t,e)=>{let r=e.length;if(!t||!t.state)return Xo;let n=t.state,i=n.wrap;if(i===2||i===1&&n.status!==g5||n.lookahead)return Xo;if(i===1&&(t.adler=pg(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){i===0&&(du(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(e.subarray(r-n.w_size,r),0),e=l,r=n.w_size}let o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,Eh(n);n.lookahead>=At;){let l=n.strstart,u=n.lookahead-(At-1);do n.ins_h=wu(n,n.ins_h,n.window[l+At-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--u);n.strstart=l,n.lookahead=At-1,Eh(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=At-1,n.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,n.wrap=i,Na},kEe=IEe,DEe=jG,OEe=WG,LEe=GG,BEe=AEe,MEe=CEe,UEe=PEe,FEe=NEe,KEe="pako deflate (from Nodeca project)",cg={deflateInit:kEe,deflateInit2:DEe,deflateReset:OEe,deflateResetKeep:LEe,deflateSetHeader:BEe,deflate:MEe,deflateEnd:UEe,deflateSetDictionary:FEe,deflateInfo:KEe},VEe=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),qEe=function(t){let e=Array.prototype.slice.call(arguments,1);for(;e.length;){let r=e.shift();if(!!r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let n in r)VEe(r,n)&&(t[n]=r[n])}}return t},zEe=t=>{let e=0;for(let n=0,i=t.length;n<i;n++)e+=t[n].length;let r=new Uint8Array(e);for(let n=0,i=0,o=t.length;n<o;n++){let s=t[n];r.set(s,i),i+=s.length}return r},y5={assign:qEe,flattenChunks:zEe},YG=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{YG=!1}var mg=new Uint8Array(256);for(let t=0;t<256;t++)mg[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;mg[254]=mg[254]=1;var HEe=t=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(t);let e,r,n,i,o,s=t.length,a=0;for(i=0;i<s;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),o=0,i=0;o<a;i++)r=t.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=t.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|r&63):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|r&63):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|r&63);return e},$Ee=(t,e)=>{if(e<65534&&t.subarray&&YG)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r},GEe=(t,e)=>{let r=e||t.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(t.subarray(0,e));let n,i,o=new Array(r*2);for(i=0,n=0;n<r;){let s=t[n++];if(s<128){o[i++]=s;continue}let a=mg[s];if(a>4){o[i++]=65533,n+=a-1;continue}for(s&=a===2?31:a===3?15:7;a>1&&n<r;)s=s<<6|t[n++]&63,a--;if(a>1){o[i++]=65533;continue}s<65536?o[i++]=s:(s-=65536,o[i++]=55296|s>>10&1023,o[i++]=56320|s&1023)}return $Ee(o,i)},WEe=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;for(;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+mg[t[r]]>e?r:e},gg={string2buf:HEe,buf2string:GEe,utf8border:WEe};function jEe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var QG=jEe,XG=Object.prototype.toString,{Z_NO_FLUSH:YEe,Z_SYNC_FLUSH:QEe,Z_FULL_FLUSH:XEe,Z_FINISH:ZEe,Z_OK:d5,Z_STREAM_END:JEe,Z_DEFAULT_COMPRESSION:ebe,Z_DEFAULT_STRATEGY:tbe,Z_DEFLATED:rbe}=_h;function bg(t){this.options=y5.assign({level:ebe,method:rbe,chunkSize:16384,windowBits:15,memLevel:8,strategy:tbe},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new QG,this.strm.avail_out=0;let r=cg.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==d5)throw new Error(yh[r]);if(e.header&&cg.deflateSetHeader(this.strm,e.header),e.dictionary){let n;if(typeof e.dictionary=="string"?n=gg.string2buf(e.dictionary):XG.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=cg.deflateSetDictionary(this.strm,n),r!==d5)throw new Error(yh[r]);this._dict_set=!0}}bg.prototype.push=function(t,e){let r=this.strm,n=this.options.chunkSize,i,o;if(this.ended)return!1;for(e===~~e?o=e:o=e===!0?ZEe:YEe,typeof t=="string"?r.input=gg.string2buf(t):XG.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===QEe||o===XEe)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=cg.deflate(r,o),i===JEe)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=cg.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===d5;if(r.avail_out===0){this.onData(r.output);continue}if(o>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};bg.prototype.onData=function(t){this.chunks.push(t)};bg.prototype.onEnd=function(t){t===d5&&(this.result=y5.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function hT(t,e){let r=new bg(e);if(r.push(t,!0),r.err)throw r.msg||yh[r.err];return r.result}function nbe(t,e){return e=e||{},e.raw=!0,hT(t,e)}function ibe(t,e){return e=e||{},e.gzip=!0,hT(t,e)}var obe=bg,sbe=hT,abe=nbe,cbe=ibe,lbe=_h,ube={Deflate:obe,deflate:sbe,deflateRaw:abe,gzip:cbe,constants:lbe},i5=30,fbe=12,hbe=function(e,r){let n,i,o,s,a,l,u,f,h,p,d,m,g,y,w,b,v,S,R,I,A,L,q,G,j=e.state;n=e.next_in,q=e.input,i=n+(e.avail_in-5),o=e.next_out,G=e.output,s=o-(r-e.avail_out),a=o+(e.avail_out-257),l=j.dmax,u=j.wsize,f=j.whave,h=j.wnext,p=j.window,d=j.hold,m=j.bits,g=j.lencode,y=j.distcode,w=(1<<j.lenbits)-1,b=(1<<j.distbits)-1;e:do{m<15&&(d+=q[n++]<<m,m+=8,d+=q[n++]<<m,m+=8),v=g[d&w];t:for(;;){if(S=v>>>24,d>>>=S,m-=S,S=v>>>16&255,S===0)G[o++]=v&65535;else if(S&16){R=v&65535,S&=15,S&&(m<S&&(d+=q[n++]<<m,m+=8),R+=d&(1<<S)-1,d>>>=S,m-=S),m<15&&(d+=q[n++]<<m,m+=8,d+=q[n++]<<m,m+=8),v=y[d&b];r:for(;;){if(S=v>>>24,d>>>=S,m-=S,S=v>>>16&255,S&16){if(I=v&65535,S&=15,m<S&&(d+=q[n++]<<m,m+=8,m<S&&(d+=q[n++]<<m,m+=8)),I+=d&(1<<S)-1,I>l){e.msg="invalid distance too far back",j.mode=i5;break e}if(d>>>=S,m-=S,S=o-s,I>S){if(S=I-S,S>f&&j.sane){e.msg="invalid distance too far back",j.mode=i5;break e}if(A=0,L=p,h===0){if(A+=u-S,S<R){R-=S;do G[o++]=p[A++];while(--S);A=o-I,L=G}}else if(h<S){if(A+=u+h-S,S-=h,S<R){R-=S;do G[o++]=p[A++];while(--S);if(A=0,h<R){S=h,R-=S;do G[o++]=p[A++];while(--S);A=o-I,L=G}}}else if(A+=h-S,S<R){R-=S;do G[o++]=p[A++];while(--S);A=o-I,L=G}for(;R>2;)G[o++]=L[A++],G[o++]=L[A++],G[o++]=L[A++],R-=3;R&&(G[o++]=L[A++],R>1&&(G[o++]=L[A++]))}else{A=o-I;do G[o++]=G[A++],G[o++]=G[A++],G[o++]=G[A++],R-=3;while(R>2);R&&(G[o++]=G[A++],R>1&&(G[o++]=G[A++]))}}else if((S&64)===0){v=y[(v&65535)+(d&(1<<S)-1)];continue r}else{e.msg="invalid distance code",j.mode=i5;break e}break}}else if((S&64)===0){v=g[(v&65535)+(d&(1<<S)-1)];continue t}else if(S&32){j.mode=fbe;break e}else{e.msg="invalid literal/length code",j.mode=i5;break e}break}}while(n<i&&o<a);R=m>>3,n-=R,m-=R<<3,d&=(1<<m)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?5+(i-n):5-(n-i),e.avail_out=o<a?257+(a-o):257-(o-a),j.hold=d,j.bits=m},p0=15,eG=852,tG=592,rG=0,QR=1,nG=2,dbe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),pbe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mbe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),gbe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ybe=(t,e,r,n,i,o,s,a)=>{let l=a.bits,u=0,f=0,h=0,p=0,d=0,m=0,g=0,y=0,w=0,b=0,v,S,R,I,A,L=null,q=0,G,j=new Uint16Array(p0+1),se=new Uint16Array(p0+1),re=null,Ge=0,me,Ce,z;for(u=0;u<=p0;u++)j[u]=0;for(f=0;f<n;f++)j[e[r+f]]++;for(d=l,p=p0;p>=1&&j[p]===0;p--);if(d>p&&(d=p),p===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,a.bits=1,0;for(h=1;h<p&&j[h]===0;h++);for(d<h&&(d=h),y=1,u=1;u<=p0;u++)if(y<<=1,y-=j[u],y<0)return-1;if(y>0&&(t===rG||p!==1))return-1;for(se[1]=0,u=1;u<p0;u++)se[u+1]=se[u]+j[u];for(f=0;f<n;f++)e[r+f]!==0&&(s[se[e[r+f]]++]=f);if(t===rG?(L=re=s,G=19):t===QR?(L=dbe,q-=257,re=pbe,Ge-=257,G=256):(L=mbe,re=gbe,G=-1),b=0,f=0,u=h,A=o,m=d,g=0,R=-1,w=1<<d,I=w-1,t===QR&&w>eG||t===nG&&w>tG)return 1;for(;;){me=u-g,s[f]<G?(Ce=0,z=s[f]):s[f]>G?(Ce=re[Ge+s[f]],z=L[q+s[f]]):(Ce=32+64,z=0),v=1<<u-g,S=1<<m,h=S;do S-=v,i[A+(b>>g)+S]=me<<24|Ce<<16|z|0;while(S!==0);for(v=1<<u-1;b&v;)v>>=1;if(v!==0?(b&=v-1,b+=v):b=0,f++,--j[u]===0){if(u===p)break;u=e[r+s[f]]}if(u>d&&(b&I)!==R){for(g===0&&(g=d),A+=h,m=u-g,y=1<<m;m+g<p&&(y-=j[m+g],!(y<=0));)m++,y<<=1;if(w+=1<<m,t===QR&&w>eG||t===nG&&w>tG)return 1;R=b&I,i[R]=d<<24|m<<16|A-o|0}}return b!==0&&(i[A+b]=u-g<<24|64<<16|0),a.bits=d,0},lg=ybe,wbe=0,ZG=1,JG=2,{Z_FINISH:iG,Z_BLOCK:Ebe,Z_TREES:o5,Z_OK:bh,Z_STREAM_END:bbe,Z_NEED_DICT:_be,Z_STREAM_ERROR:Zo,Z_DATA_ERROR:eW,Z_MEM_ERROR:tW,Z_BUF_ERROR:vbe,Z_DEFLATED:oG}=_h,rW=1,sG=2,aG=3,cG=4,lG=5,uG=6,fG=7,hG=8,dG=9,pG=10,p5=11,Mc=12,XR=13,mG=14,ZR=15,gG=16,yG=17,wG=18,EG=19,s5=20,a5=21,bG=22,_G=23,vG=24,SG=25,xG=26,JR=27,RG=28,TG=29,kr=30,nW=31,Sbe=32,xbe=852,Rbe=592,Tbe=15,Abe=Tbe,AG=t=>(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24);function Ibe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var iW=t=>{if(!t||!t.state)return Zo;let e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=rW,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(xbe),e.distcode=e.distdyn=new Int32Array(Rbe),e.sane=1,e.back=-1,bh},oW=t=>{if(!t||!t.state)return Zo;let e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,iW(t)},sW=(t,e)=>{let r;if(!t||!t.state)return Zo;let n=t.state;return e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15)?Zo:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,oW(t))},aW=(t,e)=>{if(!t)return Zo;let r=new Ibe;t.state=r,r.window=null;let n=sW(t,e);return n!==bh&&(t.state=null),n},Cbe=t=>aW(t,Abe),IG=!0,eT,tT,Pbe=t=>{if(IG){eT=new Int32Array(512),tT=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(lg(ZG,t.lens,0,288,eT,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;lg(JG,t.lens,0,32,tT,0,t.work,{bits:5}),IG=!1}t.lencode=eT,t.lenbits=9,t.distcode=tT,t.distbits=5},cW=(t,e,r,n)=>{let i,o=t.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),n-=i,n?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0},Nbe=(t,e)=>{let r,n,i,o,s,a,l,u,f,h,p,d,m,g,y=0,w,b,v,S,R,I,A,L,q=new Uint8Array(4),G,j,se=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Zo;r=t.state,r.mode===Mc&&(r.mode=XR),s=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,u=r.hold,f=r.bits,h=a,p=l,L=bh;e:for(;;)switch(r.mode){case rW:if(r.wrap===0){r.mode=XR;break}for(;f<16;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(r.wrap&2&&u===35615){r.check=0,q[0]=u&255,q[1]=u>>>8&255,r.check=$n(r.check,q,2,0),u=0,f=0,r.mode=sG;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){t.msg="incorrect header check",r.mode=kr;break}if((u&15)!==oG){t.msg="unknown compression method",r.mode=kr;break}if(u>>>=4,f-=4,A=(u&15)+8,r.wbits===0)r.wbits=A;else if(A>r.wbits){t.msg="invalid window size",r.mode=kr;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=u&512?pG:Mc,u=0,f=0;break;case sG:for(;f<16;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==oG){t.msg="unknown compression method",r.mode=kr;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=kr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(q[0]=u&255,q[1]=u>>>8&255,r.check=$n(r.check,q,2,0)),u=0,f=0,r.mode=aG;case aG:for(;f<32;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&(q[0]=u&255,q[1]=u>>>8&255,q[2]=u>>>16&255,q[3]=u>>>24&255,r.check=$n(r.check,q,4,0)),u=0,f=0,r.mode=cG;case cG:for(;f<16;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(q[0]=u&255,q[1]=u>>>8&255,r.check=$n(r.check,q,2,0)),u=0,f=0,r.mode=lG;case lG:if(r.flags&1024){for(;f<16;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(q[0]=u&255,q[1]=u>>>8&255,r.check=$n(r.check,q,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=uG;case uG:if(r.flags&1024&&(d=r.length,d>a&&(d=a),d&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+d),A)),r.flags&512&&(r.check=$n(r.check,n,d,o)),a-=d,o+=d,r.length-=d),r.length))break e;r.length=0,r.mode=fG;case fG:if(r.flags&2048){if(a===0)break e;d=0;do A=n[o+d++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&d<a);if(r.flags&512&&(r.check=$n(r.check,n,d,o)),a-=d,o+=d,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=hG;case hG:if(r.flags&4096){if(a===0)break e;d=0;do A=n[o+d++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&d<a);if(r.flags&512&&(r.check=$n(r.check,n,d,o)),a-=d,o+=d,A)break e}else r.head&&(r.head.comment=null);r.mode=dG;case dG:if(r.flags&512){for(;f<16;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(u!==(r.check&65535)){t.msg="header crc mismatch",r.mode=kr;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Mc;break;case pG:for(;f<32;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}t.adler=r.check=AG(u),u=0,f=0,r.mode=p5;case p5:if(r.havedict===0)return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=f,_be;t.adler=r.check=1,r.mode=Mc;case Mc:if(e===Ebe||e===o5)break e;case XR:if(r.last){u>>>=f&7,f-=f&7,r.mode=JR;break}for(;f<3;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}switch(r.last=u&1,u>>>=1,f-=1,u&3){case 0:r.mode=mG;break;case 1:if(Pbe(r),r.mode=s5,e===o5){u>>>=2,f-=2;break e}break;case 2:r.mode=yG;break;case 3:t.msg="invalid block type",r.mode=kr}u>>>=2,f-=2;break;case mG:for(u>>>=f&7,f-=f&7;f<32;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){t.msg="invalid stored block lengths",r.mode=kr;break}if(r.length=u&65535,u=0,f=0,r.mode=ZR,e===o5)break e;case ZR:r.mode=gG;case gG:if(d=r.length,d){if(d>a&&(d=a),d>l&&(d=l),d===0)break e;i.set(n.subarray(o,o+d),s),a-=d,o+=d,l-=d,s+=d,r.length-=d;break}r.mode=Mc;break;case yG:for(;f<14;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=kr;break}r.have=0,r.mode=wG;case wG:for(;r.have<r.ncode;){for(;f<3;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.lens[se[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[se[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,G={bits:r.lenbits},L=lg(wbe,r.lens,0,19,r.lencode,0,r.work,G),r.lenbits=G.bits,L){t.msg="invalid code lengths set",r.mode=kr;break}r.have=0,r.mode=EG;case EG:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],w=y>>>24,b=y>>>16&255,v=y&65535,!(w<=f);){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(v<16)u>>>=w,f-=w,r.lens[r.have++]=v;else{if(v===16){for(j=w+2;f<j;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(u>>>=w,f-=w,r.have===0){t.msg="invalid bit length repeat",r.mode=kr;break}A=r.lens[r.have-1],d=3+(u&3),u>>>=2,f-=2}else if(v===17){for(j=w+3;f<j;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}u>>>=w,f-=w,A=0,d=3+(u&7),u>>>=3,f-=3}else{for(j=w+7;f<j;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}u>>>=w,f-=w,A=0,d=11+(u&127),u>>>=7,f-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=kr;break}for(;d--;)r.lens[r.have++]=A}}if(r.mode===kr)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=kr;break}if(r.lenbits=9,G={bits:r.lenbits},L=lg(ZG,r.lens,0,r.nlen,r.lencode,0,r.work,G),r.lenbits=G.bits,L){t.msg="invalid literal/lengths set",r.mode=kr;break}if(r.distbits=6,r.distcode=r.distdyn,G={bits:r.distbits},L=lg(JG,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,G),r.distbits=G.bits,L){t.msg="invalid distances set",r.mode=kr;break}if(r.mode=s5,e===o5)break e;case s5:r.mode=a5;case a5:if(a>=6&&l>=258){t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=f,hbe(t,p),s=t.next_out,i=t.output,l=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,u=r.hold,f=r.bits,r.mode===Mc&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],w=y>>>24,b=y>>>16&255,v=y&65535,!(w<=f);){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(b&&(b&240)===0){for(S=w,R=b,I=v;y=r.lencode[I+((u&(1<<S+R)-1)>>S)],w=y>>>24,b=y>>>16&255,v=y&65535,!(S+w<=f);){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}u>>>=S,f-=S,r.back+=S}if(u>>>=w,f-=w,r.back+=w,r.length=v,b===0){r.mode=xG;break}if(b&32){r.back=-1,r.mode=Mc;break}if(b&64){t.msg="invalid literal/length code",r.mode=kr;break}r.extra=b&15,r.mode=bG;case bG:if(r.extra){for(j=r.extra;f<j;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=_G;case _G:for(;y=r.distcode[u&(1<<r.distbits)-1],w=y>>>24,b=y>>>16&255,v=y&65535,!(w<=f);){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if((b&240)===0){for(S=w,R=b,I=v;y=r.distcode[I+((u&(1<<S+R)-1)>>S)],w=y>>>24,b=y>>>16&255,v=y&65535,!(S+w<=f);){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}u>>>=S,f-=S,r.back+=S}if(u>>>=w,f-=w,r.back+=w,b&64){t.msg="invalid distance code",r.mode=kr;break}r.offset=v,r.extra=b&15,r.mode=vG;case vG:if(r.extra){for(j=r.extra;f<j;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=kr;break}r.mode=SG;case SG:if(l===0)break e;if(d=p-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=kr;break}d>r.wnext?(d-=r.wnext,m=r.wsize-d):m=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=i,m=s-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do i[s++]=g[m++];while(--d);r.length===0&&(r.mode=a5);break;case xG:if(l===0)break e;i[s++]=r.length,l--,r.mode=a5;break;case JR:if(r.wrap){for(;f<32;){if(a===0)break e;a--,u|=n[o++]<<f,f+=8}if(p-=l,t.total_out+=p,r.total+=p,p&&(t.adler=r.check=r.flags?$n(r.check,i,p,s-p):pg(r.check,i,p,s-p)),p=l,(r.flags?u:AG(u))!==r.check){t.msg="incorrect data check",r.mode=kr;break}u=0,f=0}r.mode=RG;case RG:if(r.wrap&&r.flags){for(;f<32;){if(a===0)break e;a--,u+=n[o++]<<f,f+=8}if(u!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=kr;break}u=0,f=0}r.mode=TG;case TG:L=bbe;break e;case kr:L=eW;break e;case nW:return tW;case Sbe:default:return Zo}return t.next_out=s,t.avail_out=l,t.next_in=o,t.avail_in=a,r.hold=u,r.bits=f,(r.wsize||p!==t.avail_out&&r.mode<kr&&(r.mode<JR||e!==iG))&&cW(t,t.output,t.next_out,p-t.avail_out),h-=t.avail_in,p-=t.avail_out,t.total_in+=h,t.total_out+=p,r.total+=p,r.wrap&&p&&(t.adler=r.check=r.flags?$n(r.check,i,p,t.next_out-p):pg(r.check,i,p,t.next_out-p)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Mc?128:0)+(r.mode===s5||r.mode===ZR?256:0),(h===0&&p===0||e===iG)&&L===bh&&(L=vbe),L},kbe=t=>{if(!t||!t.state)return Zo;let e=t.state;return e.window&&(e.window=null),t.state=null,bh},Dbe=(t,e)=>{if(!t||!t.state)return Zo;let r=t.state;return(r.wrap&2)===0?Zo:(r.head=e,e.done=!1,bh)},Obe=(t,e)=>{let r=e.length,n,i,o;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==p5)?Zo:n.mode===p5&&(i=1,i=pg(i,e,r,0),i!==n.check)?eW:(o=cW(t,e,r,r),o?(n.mode=nW,tW):(n.havedict=1,bh))},Lbe=oW,Bbe=sW,Mbe=iW,Ube=Cbe,Fbe=aW,Kbe=Nbe,Vbe=kbe,qbe=Dbe,zbe=Obe,Hbe="pako inflate (from Nodeca project)",Fc={inflateReset:Lbe,inflateReset2:Bbe,inflateResetKeep:Mbe,inflateInit:Ube,inflateInit2:Fbe,inflate:Kbe,inflateEnd:Vbe,inflateGetHeader:qbe,inflateSetDictionary:zbe,inflateInfo:Hbe};function $be(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Gbe=$be,lW=Object.prototype.toString,{Z_NO_FLUSH:Wbe,Z_FINISH:jbe,Z_OK:yg,Z_STREAM_END:rT,Z_NEED_DICT:nT,Z_STREAM_ERROR:Ybe,Z_DATA_ERROR:CG,Z_MEM_ERROR:Qbe}=_h;function _g(t){this.options=y5.assign({chunkSize:1024*64,windowBits:15,to:""},t||{});let e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15)===0&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new QG,this.strm.avail_out=0;let r=Fc.inflateInit2(this.strm,e.windowBits);if(r!==yg)throw new Error(yh[r]);if(this.header=new Gbe,Fc.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=gg.string2buf(e.dictionary):lW.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Fc.inflateSetDictionary(this.strm,e.dictionary),r!==yg)))throw new Error(yh[r])}_g.prototype.push=function(t,e){let r=this.strm,n=this.options.chunkSize,i=this.options.dictionary,o,s,a;if(this.ended)return!1;for(e===~~e?s=e:s=e===!0?jbe:Wbe,lW.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Fc.inflate(r,s),o===nT&&i&&(o=Fc.inflateSetDictionary(r,i),o===yg?o=Fc.inflate(r,s):o===CG&&(o=nT));r.avail_in>0&&o===rT&&r.state.wrap>0&&t[r.next_in]!==0;)Fc.inflateReset(r),o=Fc.inflate(r,s);switch(o){case Ybe:case CG:case nT:case Qbe:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(r.avail_out===0||o===rT))if(this.options.to==="string"){let l=gg.utf8border(r.output,r.next_out),u=r.next_out-l,f=gg.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(o===yg&&a===0)){if(o===rT)return o=Fc.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};_g.prototype.onData=function(t){this.chunks.push(t)};_g.prototype.onEnd=function(t){t===yg&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=y5.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function dT(t,e){let r=new _g(e);if(r.push(t),r.err)throw r.msg||yh[r.err];return r.result}function Xbe(t,e){return e=e||{},e.raw=!0,dT(t,e)}var Zbe=_g,Jbe=dT,e_e=Xbe,t_e=dT,r_e=_h,n_e={Inflate:Zbe,inflate:Jbe,inflateRaw:e_e,ungzip:t_e,constants:r_e},{Deflate:i_e,deflate:o_e,deflateRaw:s_e,gzip:a_e}=ube,{Inflate:c_e,inflate:l_e,inflateRaw:u_e,ungzip:f_e}=n_e,h_e=i_e,d_e=o_e,p_e=s_e,m_e=a_e,g_e=c_e,y_e=l_e,w_e=u_e,E_e=f_e,b_e=_h,pT={Deflate:h_e,deflate:d_e,deflateRaw:p_e,gzip:m_e,Inflate:g_e,inflate:y_e,inflateRaw:w_e,ungzip:E_e,constants:b_e};var mT=E(ei(),1),gT=E(KR(),1),uW=6;function fW({repo:t,preload:e}){async function*r(n,i={}){if(i.compressionLevel!=null&&(i.compressionLevel<-1||i.compressionLevel>9))throw(0,w0.default)(new Error("Compression level must be between -1 and 9"),"ERR_INVALID_PARAMS");if(i.preload!==!1){let a;try{a=Sp(n).split("/")}catch(l){throw(0,w0.default)(l,"ERR_INVALID_PATH")}e(T.parse(a[0]))}let o=T.asCID(n)||n,s=await ti(o,t.blocks,i);if(s.type==="file"||s.type==="raw"){let a=[];!i.compress||i.archive===!0?a.push([{header:{name:s.path,mode:s.type==="file"&&s.unixfs.mode,mtime:s.type==="file"&&s.unixfs.mtime?new Date(s.unixfs.mtime.secs*1e3):void 0,size:s.size,type:"file"},body:s.content()}],r5(),l=>(0,mT.default)(l,u=>u.slice())):a.push(s.content),i.compress&&a.push(async function*(l){let u=await(0,gT.default)(l);yield pT.gzip(u,{level:i.compressionLevel||uW})}),yield*Se(...a);return}if(s.type==="directory"){let a=[e5(o,t.blocks,i),async function*(l){for await(let u of l){let f={header:{name:u.path,size:u.size}};if(u.type==="file")f.header.type="file",f.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,f.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0,f.body=u.content();else if(u.type==="raw")f.header.type="file",f.body=u.content();else if(u.type==="directory")f.header.type="directory",f.header.mode=u.unixfs.mode!=null?u.unixfs.mode:void 0,f.header.mtime=u.unixfs.mtime?new Date(u.unixfs.mtime.secs*1e3):void 0;else throw(0,w0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS");yield f}},r5(),l=>(0,mT.default)(l,u=>u.slice())];if(i.compress){if(!i.archive)throw(0,w0.default)(new Error("file is not regular"),"ERR_INVALID_PATH");i.compress&&a.push(async function*(l){let u=await(0,gT.default)(l);yield pT.gzip(u,{level:i.compressionLevel||uW})})}yield*Se(...a);return}throw(0,w0.default)(new Error("Not a UnixFS node"),"ERR_NOT_UNIXFS")}return B(r)}c();var hW=E(V(),1);te();function dW({repo:t,preload:e}){async function*r(n,i={}){let o=Sp(n),s=o.split("/");i.preload!==!1&&e(T.parse(s[0]));let a=T.asCID(o)||o,l=await ti(a,t.blocks,i);if(l.type==="file"){yield fS(l);return}if(l.type==="directory"){for await(let u of l.content())yield fS(u);return}throw(0,hW.default)(new Error(`Unknown UnixFS type ${l.type}`),"ERR_UNKNOWN_UNIXFS_TYPE")}return B(r)}var w5=class{constructor({preload:e,repo:r,hashers:n,options:i}){let o=E$({preload:e,repo:r,options:i,hashers:n});this.addAll=o,this.add=uH({addAll:o}),this.cat=U$({repo:r,preload:e}),this.get=fW({repo:r,preload:e}),this.ls=dW({repo:r,preload:e})}};c();c();var Sh="",pW="",mW="";function gW({repo:t}){async function e(r={}){let n=await t.version.get();return{version:Sh,commit:pW,repo:`${n}`,"ipfs-core":Sh,"interface-ipfs-core":mW}}return B(e)}c();Re();var E5=E(V(),1);var __e=C("ipfs:components:id");function yW({peerId:t,network:e}){async function r(n={}){let i=e.try();if(!i){if(n.peerId)throw new wc;if(t.publicKey==null)throw(0,E5.default)(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");return{id:t,publicKey:F(t.publicKey,"base64pad"),addresses:[],agentVersion:`js-ipfs/${Sh}`,protocolVersion:"9000",protocols:[]}}let{libp2p:o}=i,s=n.peerId?n.peerId:t,a=await v_e(s,o,n),l=F(a.metadata.get("AgentVersion")||new Uint8Array),u=F(a.metadata.get("ProtocolVersion")||new Uint8Array),f=a.id.toString(),h=a.publicKey?F(a.publicKey,"base64pad"):"";return{id:s,publicKey:h,addresses:(a.addresses||[]).map(p=>{let d=p.toString();return d.endsWith(`/p2p/${f}`)?d:`${d}/p2p/${f}`}).sort().map(p=>new W(p)),agentVersion:l,protocolVersion:u,protocols:(a.protocols||[]).sort()}}return B(r)}async function v_e(t,e,r){let n=await e.peerStore.get(t);n||(n=await S_e(t,e,r));let i=t.publicKey?t.publicKey:await e.peerStore.keyBook.get(t);if(i==null)try{i=await e.getPublicKey(t,r)}catch(o){__e.error("Could not load public key for",t.toString(),o)}return{...n,publicKey:i,metadata:n.metadata||new Map,addresses:n.addresses.map(o=>o.multiaddr)}}async function S_e(t,e,r){if(e.dht==null)throw(0,E5.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");for await(let i of e.dht.findPeer(t,r))if(i.name==="FINAL_PEER")break;let n=await e.peerStore.get(t);if(!n)throw(0,E5.default)(new Error("Could not find peer"),"ERR_NOT_FOUND");return n}c();c();c();var Hr=x_e;function x_e(t,e,r){var n,i;if(Array.isArray(e)&&(n=e.slice(0)),typeof e=="string"&&(n=e.split(".")),typeof e=="symbol"&&(n=[e]),!Array.isArray(n))throw new Error("props arg must be an array, a string or a symbol");if(i=n.pop(),!i)return!1;wW(i);for(var o;o=n.shift();)if(wW(o),typeof t[o]>"u"&&(t[o]={}),t=t[o],!t||typeof t!="object")return!1;return t[i]=r,!0}function wW(t){if(t=="__proto__"||t=="constructor"||t=="prototype")throw new Error("setting of prototype values not supported")}var E0={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:t=>(Hr(t,"Discovery.MDNS.Enabled",!1),Hr(t,"Discovery.webRTCStar.Enabled",!1),t.Swarm={...t.Swarm||{},DisableNatPortMap:!0},t)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:t=>(Hr(t,"Discovery.MDNS.Enabled",!0),Hr(t,"Discovery.webRTCStar.Enabled",!0),Hr(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:t=>{let e=Oc();return Hr(t,"Addresses.API",e.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),Hr(t,"Addresses.Gateway",e.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),Hr(t,"Addresses.Swarm",e.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),Hr(t,"Addresses.Delegates",[]),Hr(t,"Bootstrap",[]),Hr(t,"Discovery.MDNS.Enabled",!1),Hr(t,"Discovery.webRTCStar.Enabled",!1),Hr(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!0}),t}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:t=>{let e=Oc();return Hr(t,"Addresses.API",e.Addresses.API),Hr(t,"Addresses.Gateway",e.Addresses.Gateway),Hr(t,"Addresses.Swarm",e.Addresses.Swarm),Hr(t,"Addresses.Delegates",e.Addresses.Delegates),Hr(t,"Bootstrap",e.Bootstrap),Hr(t,"Discovery.MDNS.Enabled",e.Discovery.MDNS.Enabled),Hr(t,"Discovery.webRTCStar.Enabled",e.Discovery.webRTCStar.Enabled),Hr(t,"Swarm",{...t.Swarm||{},DisableNatPortMap:!1}),t}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:t=>{let e=t.Swarm||{},r=e.ConnMgr||{};return r.LowWater=20,r.HighWater=40,e.ConnMgr=r,t.Swarm=e,t}},"default-power":{description:'Inverse of "lowpower" profile.',transform:t=>{let e=Oc();return t.Swarm=e.Swarm,t}}};var R_e=C("ipfs:core:config");function EW({repo:t}){return{getAll:B(e),get:B(r),set:B(n),replace:B(i),profiles:{apply:B(o),list:B(T_e)}};async function e(s={}){return t.config.getAll(s)}async function r(s,a){return s?t.config.get(s,a):Promise.reject(new Error("key argument is required"))}async function n(s,a,l){return t.config.set(s,a,l)}async function i(s,a){return t.config.replace(s,a)}async function o(s,a={dryRun:!1}){let{dryRun:l}=a,u=E0[s];if(!u)throw new Error(`No profile with name '${s}' exists`);try{let f=await t.config.getAll(a),h=JSON.parse(JSON.stringify(f));return h=u.transform(h),l||await t.config.replace(h,a),delete f.Identity.PrivKey,delete h.Identity.PrivKey,{original:f,updated:h}}catch(f){throw R_e(f),new Error(`Could not apply profile '${s}' to config: ${f.message}`)}}}async function T_e(t){return Object.keys(E0).map(e=>({name:e,description:E0[e].description}))}c();c();te();c();ap();var b5=({enumerable:t=!0,configurable:e=!1}={})=>({enumerable:t,configurable:e,writable:!1}),yT=function*(t,e){if(t!=null&&!(t instanceof Uint8Array))for(let[r,n]of Object.entries(t)){let i=[...e,r];if(n!=null&&typeof n=="object")if(Array.isArray(n))for(let[o,s]of n.entries()){let a=[...i,o],l=T.asCID(s);l?yield[a.join("/"),l]:typeof s=="object"&&(yield*yT(s,a))}else{let o=T.asCID(n);o?yield[i.join("/"),o]:yield*yT(n,i)}}},wT=function*(t,e){if(t!=null)for(let[r,n]of Object.entries(t)){let i=[...e,r];if(yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!T.asCID(n))if(Array.isArray(n))for(let[o,s]of n.entries()){let a=[...i,o];yield a.join("/"),typeof s=="object"&&!T.asCID(s)&&(yield*wT(s,a))}else yield*wT(n,i)}},A_e=(t,e)=>{let r=t;for(let[n,i]of e.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let o=T.asCID(r);if(o)return{value:o,remaining:e.slice(n+1).join("/")}}return{value:r}},ET=class{constructor({cid:e,bytes:r,value:n}){if(!e||!r||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:b5(),bytes:b5(),value:b5(),asBlock:b5()})}links(){return yT(this.value,[])}tree(){return wT(this.value,[])}get(e="/"){return A_e(this.value,e.split("/").filter(Boolean))}};var b0=({bytes:t,cid:e,value:r,codec:n})=>{let i=r!==void 0?r:n&&n.decode(t);if(i===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new ET({cid:e,bytes:t,value:i})};c();te();c();var bT=E(ai(),1);function _T(t){let e=l9({version:1,roots:t}),r=bT.default.encode(e.length),n=new Uint8Array(r.length+e.length);return n.set(r,0),n.set(e,r.length),n}function bW(t){return{async setRoots(e){let r=_T(e);await t.write(r)},async writeBlock(e){let{cid:r,bytes:n}=e;await t.write(new Uint8Array(bT.default.encode(r.bytes.length+n.length))),await t.write(r.bytes),n.length&&await t.write(n)},async close(){await t.end()}}}c();function _5(){}function _W(){let t=[],e=null,r=_5,n=!1,i=null,o=_5,s=()=>(e||(e=new Promise(u=>{r=()=>{e=null,r=_5,u()}})),e),a={write(u){t.push(u);let f=s();return o(),f},async end(){n=!0;let u=s();o(),await u}},l={async next(){let u=t.shift();return u?(t.length===0&&r(),{done:!1,value:u}):n?(r(),{done:!0,value:void 0}):(i||(i=new Promise(f=>{o=()=>(i=null,o=_5,f(l.next()))})),i)}};return{writer:a,iterator:l}}c();var bu=E(ai(),1);te();On();c();var Eu={Null:t=>t===null,Int:t=>Number.isInteger(t),Float:t=>typeof t=="number"&&Number.isFinite(t),String:t=>typeof t=="string",Bool:t=>typeof t=="boolean",Bytes:t=>t instanceof Uint8Array,Link:t=>!Eu.Null(t)&&typeof t=="object"&&t.asCID===t,List:t=>Array.isArray(t),Map:t=>!Eu.Null(t)&&typeof t=="object"&&t.asCID!==t&&!Eu.List(t)&&!Eu.Bytes(t)},_0={Int:Eu.Int,"CarHeader > version":t=>_0.Int(t),"CarHeader > roots (anon) > valueType (anon)":Eu.Link,"CarHeader > roots (anon)":t=>Eu.List(t)&&Array.prototype.every.call(t,_0["CarHeader > roots (anon) > valueType (anon)"]),"CarHeader > roots":t=>_0["CarHeader > roots (anon)"](t),CarHeader:t=>{let e=t&&Object.keys(t);return Eu.Map(t)&&["version"].every(r=>e.includes(r))&&Object.entries(t).every(([r,n])=>_0["CarHeader > "+r]&&_0["CarHeader > "+r](n))}},vW=_0.CarHeader;var vT={SHA2_256:18,LENGTH:32,DAG_PB:112},SW=16+8+8+8;async function v5(t){let e=await t.upTo(8);if(!e.length)throw new Error("Unexpected end of data");let r=bu.default.decode(e);return t.seek(bu.default.decode.bytes),r}async function I_e(t){let e=await t.exactly(SW),r=new DataView(e.buffer,e.byteOffset,e.byteLength),n=0,i={version:2,characteristics:[r.getBigUint64(n,!0),r.getBigUint64(n+=8,!0)],dataOffset:Number(r.getBigUint64(n+=8,!0)),dataSize:Number(r.getBigUint64(n+=8,!0)),indexOffset:Number(r.getBigUint64(n+=8,!0))};return t.seek(SW),i}async function S5(t,e){let r=await v5(t);if(r===0)throw new Error("Invalid CAR header (zero length)");let n=await t.exactly(r);t.seek(r);let i=Bf(n);if(!vW(i))throw new Error("Invalid CAR header format");if(i.version!==1&&i.version!==2||e!==void 0&&i.version!==e)throw new Error(`Invalid CAR version: ${i.version}${e!==void 0?` (expected ${e})`:""}`);let o=Array.isArray(i.roots);if(i.version===1&&!o||i.version===2&&o)throw new Error("Invalid CAR header format");if(i.version===1)return i;let s=await I_e(t);t.seek(s.dataOffset-t.pos);let a=await S5(t,1);return Object.assign(a,s)}async function C_e(t){let e=await t.upTo(8);bu.default.decode(e);let r=bu.default.decode.bytes,n=bu.default.decode(e.subarray(bu.default.decode.bytes)),i=bu.default.decode.bytes,o=r+i+n,s=await t.exactly(o);return t.seek(o),s}async function P_e(t){let e=await t.exactly(2);if(e[0]===vT.SHA2_256&&e[1]===vT.LENGTH){let s=await t.exactly(34);t.seek(34);let a=wr(s);return T.create(0,vT.DAG_PB,a)}let r=await v5(t);if(r!==1)throw new Error(`Unexpected CID version (${r})`);let n=await v5(t),i=await C_e(t),o=wr(i);return T.create(r,n,o)}async function xW(t){let e=t.pos,r=await v5(t);if(r===0)throw new Error("Invalid CAR section (zero length)");r+=t.pos-e;let n=await P_e(t),i=r-Number(t.pos-e);return{cid:n,length:r,blockLength:i}}async function N_e(t){let{cid:e,blockLength:r}=await xW(t),n=await t.exactly(r);return t.seek(r),{bytes:n,cid:e}}async function k_e(t){let e=t.pos,{cid:r,length:n,blockLength:i}=await xW(t),o={cid:r,length:n,blockLength:i,offset:e,blockOffset:t.pos};return t.seek(o.blockLength),o}function RW(t){let e=(async()=>{let r=await S5(t);if(r.version===2){let n=t.pos-r.dataOffset;t=O_e(t,r.dataSize-n)}return r})();return{header:()=>e,async*blocks(){for(await e;(await t.upTo(8)).length>0;)yield await N_e(t)},async*blocksIndex(){for(await e;(await t.upTo(8)).length>0;)yield await k_e(t)}}}function x5(t){let e=0;return{async upTo(r){return t.subarray(e,e+Math.min(r,t.length-e))},async exactly(r){if(r>t.length-e)throw new Error("Unexpected end of data");return t.subarray(e,e+r)},seek(r){e+=r},get pos(){return e}}}function D_e(t){let e=0,r=0,n=0,i=new Uint8Array(0),o=async s=>{r=i.length-n;let a=[i.subarray(n)];for(;r<s;){let u=await t();if(u==null)break;r<0?u.length>r&&a.push(u.subarray(-r)):a.push(u),r+=u.length}i=new Uint8Array(a.reduce((u,f)=>u+f.length,0));let l=0;for(let u of a)i.set(u,l),l+=u.length;n=0};return{async upTo(s){return i.length-n<s&&await o(s),i.subarray(n,n+Math.min(i.length-n,s))},async exactly(s){if(i.length-n<s&&await o(s),i.length-n<s)throw new Error("Unexpected end of data");return i.subarray(n,n+s)},seek(s){e+=s,n+=s},get pos(){return e}}}function TW(t){let e=t[Symbol.asyncIterator]();async function r(){let n=await e.next();return n.done?null:n.value}return D_e(r)}function O_e(t,e){let r=0;return{async upTo(n){let i=await t.upTo(n);return i.length+r>e&&(i=i.subarray(0,e-r)),i},async exactly(n){let i=await t.exactly(n);if(i.length+r>e)throw new Error("Unexpected end of data");return i},seek(n){r+=n,t.seek(n)},get pos(){return t.pos}}}var xh=class{constructor(e,r){this._encoder=r,this._mutex=r.setRoots(e),this._ended=!1}async put(e){if(!(e.bytes instanceof Uint8Array)||!e.cid)throw new TypeError("Can only write {cid, bytes} objects");if(this._ended)throw new Error("Already closed");let r=T.asCID(e.cid);if(!r)throw new TypeError("Can only write {cid, bytes} objects");return this._mutex=this._mutex.then(()=>this._encoder.writeBlock({cid:r,bytes:e.bytes})),this._mutex}async close(){if(this._ended)throw new Error("Already closed");return await this._mutex,this._ended=!0,this._encoder.close()}static create(e){e=L_e(e);let{encoder:r,iterator:n}=AW(),i=new xh(e,r),o=new R5(n);return{writer:i,out:o}}static createAppender(){let{encoder:e,iterator:r}=AW();e.setRoots=()=>Promise.resolve();let n=new xh([],e),i=new R5(r);return{writer:n,out:i}}static async updateRootsInBytes(e,r){let n=x5(e);await S5(n);let i=_T(r);if(Number(n.pos)!==i.length)throw new Error(`updateRoots() can only overwrite a header of the same length (old header is ${n.pos} bytes, new header is ${i.length} bytes)`);return e.set(i,0),e}},R5=class{constructor(e){this._iterator=e}[Symbol.asyncIterator](){if(this._iterating)throw new Error("Multiple iterator not supported");return this._iterating=!0,this._iterator}};function AW(){let t=_W(),{writer:e,iterator:r}=t;return{encoder:bW(e),iterator:r}}function L_e(t){if(t===void 0)return[];if(!Array.isArray(t)){let r=T.asCID(t);if(!r)throw new TypeError("roots must be a single CID or an array of CIDs");return[r]}let e=[];for(let r of t){let n=T.asCID(r);if(!n)throw new TypeError("roots must be a single CID or an array of CIDs");e.push(n)}return e}Fo();D9();c();en();var ST=async({cid:t,load:e,seen:r})=>{r=r||new Set;let n=t.toString(Oe);if(r.has(n))return;let i=await e(t);if(r.add(n),i!==null)for(let[,o]of i.links())await ST({cid:o,load:e,seen:r})};var IW=C("ipfs:components:dag:import"),B_e=[Un,k9];function CW({repo:t,preload:e,codecs:r}){async function*n(i,o={}){o.preload!==!1&&e(i);let s=T.asCID(i);if(!s)throw new Error(`Unexpected error converting CID type: ${i}`);IW(`Exporting ${s} as car`);let{writer:a,out:l}=await xh.create([s]),u=null;(async()=>{try{let f=M_e(t,a,{signal:o.signal,timeout:o.timeout},r);await ST({cid:s,load:f})}catch(f){u=f}finally{a.close()}})();for await(let f of l){if(u)break;yield f}if(u)throw u}return B(n)}function M_e(t,e,r,n){return async i=>{let o=await n.getCodec(i.code);if(!o)throw new Error(`Can't decode links in block with codec 0x${i.code.toString(16)} to form complete DAG`);let s=await t.blocks.get(i,r);return IW(`Adding block ${i} to car`),await e.put({cid:i,bytes:s}),B_e.includes(i.code)?null:b0({bytes:s,cid:i,codec:o})}}c();var NW=E(Kc(),1),kW=E(Fi(),1);var DW=E(V(),1);function OW({codecs:t,repo:e,preload:r}){return B(async function(o,s={}){if(s.preload!==!1&&r(o),s.path){let h=s.localResolve?await(0,NW.default)(Vl(o,s.path,t,e,s)):await(0,kW.default)(Vl(o,s.path,t,e,s));if(!h)throw(0,DW.default)(new Error("Not found"),"ERR_NOT_FOUND");return h}let a=await t.getCodec(o.code),l=await e.blocks.get(o,s);return{value:a.decode(l),remainderPath:""}})}c();c();var T5=class{constructor(e,r,n){this._version=e,this._roots=r,this._iterable=n,this._decoded=!1}get version(){return this._version}async getRoots(){return this._roots}},Rh=class extends T5{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");return this._decoded=!0,this._iterable[Symbol.asyncIterator]()}static async fromBytes(e){let{version:r,roots:n,iterator:i}=await LW(e);return new Rh(r,n,i)}static async fromIterable(e){let{version:r,roots:n,iterator:i}=await BW(e);return new Rh(r,n,i)}},vg=class extends T5{[Symbol.asyncIterator](){if(this._decoded)throw new Error("Cannot decode more than once");if(!this._iterable)throw new Error("Block iterable not found");this._decoded=!0;let e=this._iterable[Symbol.asyncIterator]();return{async next(){let r=await e.next();return r.done?r:{done:!1,value:r.value.cid}}}}static async fromBytes(e){let{version:r,roots:n,iterator:i}=await LW(e);return new vg(r,n,i)}static async fromIterable(e){let{version:r,roots:n,iterator:i}=await BW(e);return new vg(r,n,i)}};async function LW(t){if(!(t instanceof Uint8Array))throw new TypeError("fromBytes() requires a Uint8Array");return MW(x5(t))}async function BW(t){if(!t||typeof t[Symbol.asyncIterator]!="function")throw new TypeError("fromIterable() requires an async iterable");return MW(TW(t))}async function MW(t){let e=RW(t),{version:r,roots:n}=await e.header();return{version:r,roots:n,iterator:e.blocks()}}var UW=E(u0(),1),FW=E(Ti(),1),KW=E(ei(),1);var VW=C("ipfs:components:dag:import");function qW({repo:t}){async function*e(r,n={}){let i=await t.gcLock.readLock();try{let o={signal:n.signal,timeout:n.timeout},s=(0,UW.default)(r),{value:a,done:l}=await s.peek();if(l)return;a&&s.push(a);let u;a instanceof Uint8Array?u=[s]:u=s;for await(let f of u){let h=await F_e(t,o,f);if(n.pinRoots!==!1)for(let p of h){let d="";try{await t.blocks.has(p)?(VW(`Pinning root ${p}`),await t.pins.pinRecursively(p)):d="blockstore: block not found"}catch(m){d=m.message}yield{root:{cid:p,pinErrorMsg:d}}}}}finally{i()}}return B(e)}async function F_e(t,e,r){let n=await Rh.fromIterable(r),i=await n.getRoots();return await(0,FW.default)(t.blocks.putMany((0,KW.default)(n,({cid:o,bytes:s})=>(VW(`Import block ${o}`),{key:o,value:s})),{signal:e.signal})),i}c();te();function zW({repo:t,codecs:e,hashers:r,preload:n}){async function i(o,s={}){let a=s.pin?await t.gcLock.readLock():null;try{let l=await e.getCodec(s.storeCodec||"dag-cbor");if(!l)throw new Error(`Unknown storeCodec ${s.storeCodec}, please configure additional BlockCodecs for this IPFS instance`);if(s.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");let m=await e.getCodec(s.inputCodec);if(!m)throw new Error(`Unknown inputCodec ${s.inputCodec}, please configure additional BlockCodecs for this IPFS instance`);o=m.decode(o)}let u=s.version!=null?s.version:1,f=await r.getHasher(s.hashAlg||"sha2-256");if(!f)throw new Error(`Unknown hash algorithm ${s.hashAlg}, please configure additional MultihashHashers for this IPFS instance`);let h=l.encode(o),p=await f.digest(h),d=T.create(u,l.code,p);return await t.blocks.put(d,h,{signal:s.signal}),s.pin&&await t.pins.pinRecursively(d),s.preload!==!1&&n(d),d}finally{a&&a()}}return B(i)}c();function HW({repo:t,codecs:e,preload:r}){async function n(i,o={}){let{cid:s}=_c(i);return o.preload!==!1&&r(s),Kl(t,e,i,o)}return B(n)}var A5=class{constructor({repo:e,codecs:r,hashers:n,preload:i}){this.export=CW({repo:e,preload:i,codecs:r}),this.get=OW({codecs:r,repo:e,preload:i}),this.import=qW({repo:e}),this.resolve=HW({repo:e,codecs:r,preload:i}),this.put=zW({repo:e,codecs:r,hashers:n,preload:i})}};c();c();var I5=(t,e)=>e,K_e=(t,e,r,n)=>{if(n!=null&&n.assumeHttp===!1)return`tcp://${t}:${e}`;let i="tcp",o=`:${e}`;return r[r.length-1].protocol==="tcp"&&(i=e==="443"?"https":"http",o=e==="443"||e==="80"?"":o),`${i}://${t}${o}`},V_e={ip4:I5,ip6:(t,e,r,n)=>n.length===1&&n[0].protocol==="ip6"?e:`[${e}]`,tcp:(t,e,r,n,i)=>n.some(o=>["http","https","ws","wss"].includes(o.protocol))?`${t}:${e}`:K_e(t,e,n,i),udp:(t,e)=>`udp://${t}:${e}`,dnsaddr:I5,dns4:I5,dns6:I5,ipfs:(t,e)=>`${t}/ipfs/${e}`,p2p:(t,e)=>`${t}/p2p/${e}`,http:t=>`http://${t}`,https:t=>`https://${t}`,ws:t=>`ws://${t}`,wss:t=>`wss://${t}`,"p2p-websocket-star":t=>`${t}/p2p-websocket-star`,"p2p-webrtc-star":t=>`${t}/p2p-webrtc-star`,"p2p-webrtc-direct":t=>`${t}/p2p-webrtc-direct`};function v0(t,e){let r=new W(t),n=t.toString().split("/").slice(1);return r.tuples().map(i=>({protocol:n.shift()??"",content:i[1]!=null?n.shift()??"":""})).reduce((i,o,s,a)=>{let l=V_e[o.protocol];if(l==null)throw new Error(`Unsupported protocol ${o.protocol}`);return l(i,o.content,s,a,e)},"")}c();function xT(t){if(!Array.isArray(t))throw new TypeError(`Expected an array, got ${typeof t}`);t=[...t];for(let e=t.length-1;e>0;e--){let r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}return t}c();var $W=E(Ip(),1);var q_e=C("ipfs:preload"),z_e=As.default?As.default:As,H_e=new z_e({concurrency:4});function GW(t,e={}){return q_e(t),H_e.add(async()=>{let n=(await $W.default.post(t,{signal:e.signal})).body.getReader();try{for(;;){let{done:i}=await n.read();if(i)return}}finally{n.releaseLock()}})}var WW=E(xp(),1),Sg=C("ipfs:preload");function jW(t={}){if(t.enabled=Boolean(t.enabled),t.addresses=t.addresses||[],t.cache=t.cache||1e3,!t.enabled||!t.addresses.length)return Sg("preload disabled"),Object.assign(()=>{},{start:()=>{},stop:()=>{}});let e=!0,r=[],n=t.addresses.map(s=>v0(s)),i=(0,WW.default)(t.cache),o=async s=>{try{if(e)throw new Error(`preload ${s} but preloader is not started`);let a=s.toString();if(i.has(a))return;i.set(a,!0);let l=xT(n),u=!1,f=Date.now();for(let h of l){if(e)throw new Error(`preload aborted for ${a}`);let p;try{p=new AbortController,r=r.concat(p),await GW(`${h}/api/v0/refs?r=true&arg=${encodeURIComponent(a)}`,{signal:p.signal}),u=!0}catch(d){d.type!=="aborted"&&Sg.error(d)}finally{r=r.filter(d=>d!==p)}if(u)break}Sg(`${u?"":"un"}successfully preloaded ${a} in ${Date.now()-f}ms`)}catch(a){Sg.error(a)}};return o.start=()=>{e=!1},o.stop=()=>{e=!0,Sg(`aborting ${r.length} pending preload request(s)`),r.forEach(s=>s.abort()),r=[]},o}c();var C5=C("ipfs:mfs-preload");function YW({preload:t,files:e,options:r={}}){if(r.interval=r.interval||30*1e3,!r.enabled){C5("MFS preload disabled");let s=async()=>{};return{start:s,stop:s}}let n="",i,o=async()=>{try{let s=await e.stat("/"),a=s.cid.toString();n!==a&&(C5(`preloading updated MFS root ${n} -> ${s.cid}`),await t(s.cid),n=a)}catch(s){C5.error("failed to preload MFS root",s)}finally{i=setTimeout(o,r.interval)}};return{async start(){let s=await e.stat("/");n=s.cid.toString(),C5(`monitoring MFS root ${s.cid}`),i=setTimeout(o,r.interval)},stop(){clearTimeout(i)}}}c();c();c();c();var rj=E(ql(),1);c();c();function RT(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var Th=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Vc,xg=class{constructor(){Vc.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&Th(this,Vc,"f")[this.size-1].priority>=r.priority){Th(this,Vc,"f").push(n);return}let i=RT(Th(this,Vc,"f"),n,(o,s)=>s.priority-o.priority);Th(this,Vc,"f").splice(i,0,n)}dequeue(){let e=Th(this,Vc,"f").shift();return e?.run}filter(e){return Th(this,Vc,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return Th(this,Vc,"f").length}};Vc=new WeakMap;var Jt=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ye=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Gn,Tg,Ag,vu,O5,Ig,P5,qs,Rg,fo,N5,ho,Cg,_u,S0,x0,Ah,k5,QW,XW,tj,ZW,JW,ej,D5,TT,AT,L5,B5=()=>{},$_e=new hi,IT=class extends Error{},R0=class extends rj.default{constructor(e){var r,n,i,o;if(super(),Gn.add(this),Tg.set(this,void 0),Ag.set(this,void 0),vu.set(this,0),O5.set(this,void 0),Ig.set(this,void 0),P5.set(this,0),qs.set(this,void 0),Rg.set(this,void 0),fo.set(this,void 0),N5.set(this,void 0),ho.set(this,0),Cg.set(this,void 0),_u.set(this,void 0),S0.set(this,B5),x0.set(this,B5),Ah.set(this,void 0),k5.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:xg,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);Jt(this,Tg,e.carryoverConcurrencyCount,"f"),Jt(this,Ag,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),Jt(this,O5,e.intervalCap,"f"),Jt(this,Ig,e.interval,"f"),Jt(this,fo,new e.queueClass,"f"),Jt(this,N5,e.queueClass,"f"),this.concurrency=e.concurrency,Jt(this,Ah,e.timeout,"f"),Jt(this,k5,e.throwOnTimeout===!0,"f"),Jt(this,_u,e.autoStart===!1,"f")}get concurrency(){return ye(this,Cg,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);Jt(this,Cg,e,"f"),ye(this,Gn,"m",L5).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;Jt(this,ho,(a=ye(this,ho,"f"),a++,a),"f"),Jt(this,vu,(l=ye(this,vu,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new IT("The task was aborted."));return}let f=await(ye(this,Ah,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?ye(this,Ah,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?ye(this,k5,"f"):r.throwOnTimeout)&&i($_e)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}ye(this,Gn,"m",tj).call(this)};ye(this,fo,"f").enqueue(o,r),ye(this,Gn,"m",D5).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return ye(this,_u,"f")?(Jt(this,_u,!1,"f"),ye(this,Gn,"m",L5).call(this),this):this}pause(){Jt(this,_u,!0,"f")}clear(){Jt(this,fo,new(ye(this,N5,"f")),"f")}async onEmpty(){if(ye(this,fo,"f").size!==0)return new Promise(e=>{let r=ye(this,S0,"f");Jt(this,S0,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(ye(this,fo,"f").size<e))return new Promise(r=>{let n=()=>{ye(this,fo,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(ye(this,ho,"f")===0&&ye(this,fo,"f").size===0))return new Promise(e=>{let r=ye(this,x0,"f");Jt(this,x0,()=>{r(),e()},"f")})}get size(){return ye(this,fo,"f").size}sizeBy(e){return ye(this,fo,"f").filter(e).length}get pending(){return ye(this,ho,"f")}get isPaused(){return ye(this,_u,"f")}get timeout(){return ye(this,Ah,"f")}set timeout(e){Jt(this,Ah,e,"f")}};Tg=new WeakMap,Ag=new WeakMap,vu=new WeakMap,O5=new WeakMap,Ig=new WeakMap,P5=new WeakMap,qs=new WeakMap,Rg=new WeakMap,fo=new WeakMap,N5=new WeakMap,ho=new WeakMap,Cg=new WeakMap,_u=new WeakMap,S0=new WeakMap,x0=new WeakMap,Ah=new WeakMap,k5=new WeakMap,Gn=new WeakSet,QW=function(){return ye(this,Ag,"f")||ye(this,vu,"f")<ye(this,O5,"f")},XW=function(){return ye(this,ho,"f")<ye(this,Cg,"f")},tj=function(){var e;Jt(this,ho,(e=ye(this,ho,"f"),e--,e),"f"),ye(this,Gn,"m",D5).call(this),this.emit("next")},ZW=function(){ye(this,S0,"f").call(this),Jt(this,S0,B5,"f"),ye(this,ho,"f")===0&&(ye(this,x0,"f").call(this),Jt(this,x0,B5,"f"),this.emit("idle"))},JW=function(){ye(this,Gn,"m",AT).call(this),ye(this,Gn,"m",TT).call(this),Jt(this,Rg,void 0,"f")},ej=function(){let e=Date.now();if(ye(this,qs,"f")===void 0){let r=ye(this,P5,"f")-e;if(r<0)Jt(this,vu,ye(this,Tg,"f")?ye(this,ho,"f"):0,"f");else return ye(this,Rg,"f")===void 0&&Jt(this,Rg,setTimeout(()=>{ye(this,Gn,"m",JW).call(this)},r),"f"),!0}return!1},D5=function(){if(ye(this,fo,"f").size===0)return ye(this,qs,"f")&&clearInterval(ye(this,qs,"f")),Jt(this,qs,void 0,"f"),ye(this,Gn,"m",ZW).call(this),!1;if(!ye(this,_u,"f")){let e=!ye(this,Gn,"m",ej).call(this);if(ye(this,Gn,"a",QW)&&ye(this,Gn,"a",XW)){let r=ye(this,fo,"f").dequeue();return r?(this.emit("active"),r(),e&&ye(this,Gn,"m",TT).call(this),!0):!1}}return!1},TT=function(){ye(this,Ag,"f")||ye(this,qs,"f")!==void 0||(Jt(this,qs,setInterval(()=>{ye(this,Gn,"m",AT).call(this)},ye(this,Ig,"f")),"f"),Jt(this,P5,Date.now()+ye(this,Ig,"f"),"f"))},AT=function(){ye(this,vu,"f")===0&&ye(this,ho,"f")===0&&ye(this,qs,"f")&&(clearInterval(ye(this,qs,"f")),Jt(this,qs,void 0,"f")),Jt(this,vu,ye(this,Tg,"f")?ye(this,ho,"f"):0,"f"),ye(this,Gn,"m",L5).call(this)},L5=function(){for(;ye(this,Gn,"m",D5).call(this););};c();vp();c();var CT="lock:worker:request-read",PT="lock:worker:release-read",NT="lock:master:grant-read",kT="lock:worker:request-write",DT="lock:worker:release-write",OT="lock:master:grant-write";c();var Su={},T0=t=>{t.addEventListener("message",e=>{T0.dispatchEvent("message",t,e)}),t.port!=null&&t.port.addEventListener("message",e=>{T0.dispatchEvent("message",t,e)})};T0.addEventListener=(t,e)=>{Su[t]==null&&(Su[t]=[]),Su[t].push(e)};T0.removeEventListener=(t,e)=>{Su[t]!=null&&(Su[t]=Su[t].filter(r=>r===e))};T0.dispatchEvent=function(t,e,r){Su[t]!=null&&Su[t].forEach(n=>n(e,r))};var LT=T0;var nj=(t,e,r,n,i)=>(o,s)=>{if(s.data.type!==r)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};t.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(l=>{let u=f=>{if(f==null||f.data==null)return;let h={type:f.data.type,name:f.data.name,identifier:f.data.identifier};h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),l())};o.addEventListener("message",u)}))}}))},ij=(t,e,r,n)=>async()=>{let i=Vf();return globalThis.postMessage({type:e,identifier:i,name:t}),await new Promise(o=>{let s=a=>{if(a==null||a.data==null)return;let l={type:a.data.type,identifier:a.data.identifier};l.type===r&&l.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:t})}))};globalThis.addEventListener("message",s)})},G_e={singleProcess:!1},oj=t=>{if(t=Object.assign({},G_e,t),Boolean(globalThis.document)||t.singleProcess){let r=new EventTarget;return LT.addEventListener("message",nj(r,"requestReadLock",CT,PT,NT)),LT.addEventListener("message",nj(r,"requestWriteLock",kT,DT,OT)),r}return{isWorker:!0,readLock:r=>ij(r,CT,NT,PT),writeLock:r=>ij(r,kT,OT,DT)}};var Ih={},xu;async function BT(t,e){let r,n=new Promise(i=>{r=i});return t.add(async()=>await rn((async()=>await new Promise(i=>{r(()=>{i()})}))(),e.timeout)),await n}var W_e=(t,e)=>{if(xu.isWorker===!0)return{readLock:xu.readLock(t,e),writeLock:xu.writeLock(t,e)};let r=new R0({concurrency:1}),n;return{async readLock(){if(n!=null)return await BT(n,e);n=new R0({concurrency:e.concurrency,autoStart:!1});let i=n,o=BT(n,e);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await BT(r,e)}}},j_e={name:"lock",concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};function MT(t){let e=Object.assign({},j_e,t);return xu==null&&(xu=oj(e),xu.isWorker!==!0&&(xu.addEventListener("requestReadLock",r=>{Ih[r.data.name]!=null&&Ih[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),xu.addEventListener("requestWriteLock",async r=>{Ih[r.data.name]!=null&&Ih[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Ih[e.name]==null&&(Ih[e.name]=W_e(e.name,e)),Ih[e.name]}var M5;function Pg(t=!1){if(M5)return M5;let e=MT({singleProcess:t});return M5={readLock:r=>async(...n)=>{let i=await e.readLock();try{return await r.apply(null,n)}finally{i()}},writeLock:r=>async(...n)=>{let i=await e.writeLock();try{return await r.apply(null,n)}finally{i()}}},M5}var WT=E(Xm(),1);c();c();c();te();zr();var UT=E(V(),1);var sj=C("ipfs:mfs:utils:with-mfs-root");async function A0(t,e){if(e&&e.signal&&e.signal.aborted)throw(0,UT.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.open();let r;try{let n=await t.repo.datastore.get(e2);r=T.decode(n)}catch(n){if(n.code!=="ERR_NOT_FOUND")throw n;sj("Creating new MFS root");let i=je({Data:new Qe({type:"directory"}).marshal(),Links:[]}),o=await Be.digest(i);if(r=T.createV0(o),await t.repo.blocks.put(r,i),e&&e.signal&&e.signal.aborted)throw(0,UT.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});await t.repo.datastore.put(e2,r.bytes)}return sj(`Loaded MFS root /ipfs/${r}`),r}c();function I0(t=""){return(t.trim().match(/([^\\^/]|\\\/)+/g)||[]).filter(Boolean)}var KT=E(V(),1);te();var FT="ipfs",$r=async(t,e,r)=>{let n=await A0(t,r),i={entryType:"file"},o="";if(T.asCID(e)?o=`/ipfs/${e}`:o=e.toString(),o=o.trim(),o=o.replace(/(\/\/+)/g,"/"),o.endsWith("/")&&o.length>1&&(o=o.substring(0,o.length-1)),!o)throw(0,KT.default)(new Error("paths must not be empty"),"ERR_NO_PATH");if(o.substring(0,1)!=="/")throw(0,KT.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");o.substring(o.length-1)==="/"&&(o=o.substring(0,o.length-1));let s=I0(o);if(s[0]===FT){let l;s.length===2?l=`/${s.join("/")}`:l=`/${s.slice(0,s.length-1).join("/")}`,i={type:"ipfs",depth:s.length-2,entryType:"file",mfsPath:`/${s.join("/")}`,mfsDirectory:l,parts:s,path:`/${s.join("/")}`,name:s[s.length-1]}}else{let l=`/${FT}/${n}${s.length?"/"+s.join("/"):""}`,u=`/${FT}/${n}/${s.slice(0,s.length-1).join("/")}`;i={type:"mfs",depth:s.length,entryType:"file",mfsDirectory:u,mfsPath:l,parts:s,path:`/${s.join("/")}`,name:s[s.length-1]}}let a=i.type==="mfs"?i.mfsPath:i.path;try{let l=await ti(a,t.repo.blocks,r);i.cid=l.cid,i.mfsPath=`/ipfs/${l.path}`,i.entryType=l.type,i.content=l.content,(i.entryType==="file"||i.entryType==="directory")&&(l.type==="file"||l.type==="directory")&&(i.unixfs=l.unixfs)}catch(l){if(l.code!=="ERR_NOT_FOUND")throw l}return i.exists=Boolean(i.cid),i};var cj=E(V(),1);var Y_e=Ye.bind({ignoreUndefined:!0}),Q_e=C("ipfs:mfs:stat"),X_e={withLocal:!1};function Ru(t){async function e(r,n={}){n=Y_e(X_e,n),Q_e(`Fetching stats for ${r}`);let{type:i,cid:o,mfsPath:s}=await $r(t,r,n),a=i==="ipfs"&&o?o:s,l;try{l=await ti(a,t.repo.blocks)}catch(u){throw u.code==="ERR_NOT_FOUND"?(0,cj.default)(new Error(`${r} does not exist`),"ERR_NOT_FOUND"):u}if(!aj[l.type])throw new Error(`Cannot stat codec ${l.cid.code}`);return aj[l.type](l)}return B(e)}var aj={raw:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1}),file:t=>{let e={cid:t.cid,type:"file",size:t.unixfs.fileSize(),cumulativeSize:je(t.node).length+(t.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:t.unixfs.blockSizes.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},directory:t=>{let e={cid:t.cid,type:"directory",size:0,cumulativeSize:je(t.node).length+(t.node.Links||[]).reduce((r,n)=>r+(n.Tsize||0),0),blocks:t.node.Links.length,local:void 0,sizeLocal:void 0,withLocality:!1,mode:t.unixfs.mode};return t.unixfs.mtime&&(e.mtime=t.unixfs.mtime),e},object:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,type:"file",blocks:0,local:void 0,sizeLocal:void 0,withLocality:!1}),identity:t=>({cid:t.cid,size:t.node.length,cumulativeSize:t.node.length,blocks:0,type:"file",local:void 0,sizeLocal:void 0,withLocality:!1})};c();var O0=E(V(),1);c();var Z_e=C("ipfs:mfs:utils:to-trail");async function ka(t,e){Z_e(`Creating trail for path ${e}`);let r=[];for await(let n of FR(e,t.repo.blocks))r.push({name:n.name,cid:n.cid,size:n.size,type:n.type});return r}c();te();c();c();te();zr();var U5=async(t,e,r)=>{r.codec||(r.codec=Tt),r.hasher||(r.hasher=Be),r.cidVersion===void 0&&(r.cidVersion=1),r.codec===Tt&&r.hasher!==Be&&(r.cidVersion=1);let n=await r.hasher.digest(t),i=T.create(r.cidVersion,r.codec.code,n);return r.onlyHash||await e.put(i,t,{signal:r.signal}),i};var q5=E(tg(),1);c();var F5=dh.code,K5=8;async function V5(t){return(await dh.encode(t)).slice(0,8).reverse()}var VT=class{constructor(e,r){this.options=r||{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime,this.cid=void 0,this.size=void 0}async put(e,r){}get(e){return Promise.resolve(this)}async*eachChildSeries(){}async*flush(e){}},C0=class extends VT{constructor(e,r){super(e,r),this._bucket=(0,q5.createHAMT)({hashFn:V5,bits:K5})}async put(e,r){await this._bucket.put(e,r)}get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}async*flush(e){yield*lj(this._bucket,e,this,this.options)}};async function*lj(t,e,r,n){let i=t._children,o=[],s=0;for(let d=0;d<i.length;d++){let m=i.get(d);if(!m)continue;let g=d.toString(16).toUpperCase().padStart(2,"0");if(m instanceof q5.Bucket){let y;for await(let w of await lj(m,e,null,n))y=w;if(!y)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:g,Tsize:y.size,Hash:y.cid}),s+=y.size}else if(typeof m.value.flush=="function"){let y=m.value,w;for await(let v of y.flush(e))w=v,yield w;let b=g+m.key;o.push({Name:b,Tsize:w.size,Hash:w.cid}),s+=w.size}else{let y=m.value;if(!y.cid)continue;let w=g+m.key,b=y.size;o.push({Name:w,Tsize:b,Hash:y.cid}),s+=b}}let a=Uint8Array.from(i.bitField().reverse()),u={Data:new Qe({type:"hamt-sharded-directory",data:a,fanout:t.tableSize(),hashType:F5,mtime:r&&r.mtime,mode:r&&r.mode}).marshal(),Links:o},f=je(Ln(u)),h=await U5(f,e,n),p=f.length+s;yield{cid:h,node:u,size:p}}c();var P0=E(tg(),1);var uj=E(Fi(),1);te();var Ng=C("ipfs:mfs:core:utils:hamt-utils"),N0=async(t,e,r,n)=>{if(!n.parent.Data)throw new Error("Could not update HAMT directory because parent had no data");let i=Uint8Array.from(r._children.bitField().reverse()),o=Qe.unmarshal(n.parent.Data),s=new Qe({type:"hamt-sharded-directory",data:i,fanout:r.tableSize(),hashType:F5,mode:o.mode,mtime:o.mtime}),a=await t.hashers.getHasher(n.hashAlg),l={Data:s.marshal(),Links:e.sort((p,d)=>(p.Name||"").localeCompare(d.Name||""))},u=je(l),f=await a.digest(u),h=T.create(n.cidVersion,ht,f);return n.flush&&await t.repo.blocks.put(h,u),{node:l,cid:h,size:e.reduce((p,d)=>p+(d.Tsize||0),u.length)}},qT=async(t,e,r,n,i)=>{let o=new P0.Bucket({hash:r._options.hash,bits:r._options.bits},n,i);return n._putObjectAt(i,o),await kg(t,e,o,r),o},zT=async t=>{let e=(0,P0.createHAMT)({hashFn:V5,bits:K5});return await Promise.all(t.map(async r=>{let n=r.Name||"";if(n.length===2){let i=parseInt(n,16),o=new P0.Bucket({hash:e._options.hash,bits:e._options.bits},e,i);return e._putObjectAt(i,o),Promise.resolve()}return e.put(n.substring(2),{size:r.Tsize,cid:r.Hash})})),e},kg=async(t,e,r,n)=>{await Promise.all(e.map(async i=>{let o=i.Name||"";if(o.length===2){Ng("Populating sub bucket",o);let s=parseInt(o,16),a=await t.repo.blocks.get(i.Hash),l=Rt(a),u=new P0.Bucket({hash:n._options.hash,bits:n._options.bits},r,s);return r._putObjectAt(s,u),await kg(t,l.Links,u,n),Promise.resolve()}return n.put(o.substring(2),{size:i.Tsize,cid:i.Hash})}))},Ch=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),fj=async(t,e,r)=>{let n=await zT(r.Links),i=await n._findNewBucketAndPos(e),o=[{bucket:i.bucket,prefix:Ch(i.pos)}],s=i.bucket;for(;s!==n;)o.push({bucket:s,prefix:Ch(s._posAtParent)}),s=s._parent;o.reverse(),o[0].node=r;for(let a=0;a<o.length;a++){let l=o[a];if(!l.node)throw new Error("Could not generate HAMT path");let u=l.node.Links.filter(d=>(d.Name||"").substring(0,2)===l.prefix).pop();if(!u){Ng(`Link ${l.prefix}${e} will be added`);continue}if(u.Name===`${l.prefix}${e}`){Ng(`Link ${l.prefix}${e} will be replaced`);continue}Ng(`Found subshard ${l.prefix}`);let f=await t.repo.blocks.get(u.Hash),h=Rt(f);if(!o[a+1]){Ng(`Loaded new subshard ${l.prefix}`),await qT(t,h.Links,n,l.bucket,parseInt(l.prefix,16));let d=await n._findNewBucketAndPos(e);o.push({bucket:d.bucket,prefix:Ch(d.pos),node:h});continue}let p=o[a+1];await kg(t,h.Links,p.bucket,n),p.node=h}return await n.put(e,!0),o.reverse(),{rootBucket:n,path:o}},hj=async(t,e,r={})=>{let n=new C0({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:r.mtime,mode:r.mode},r);for(let o=0;o<e.length;o++)await n._bucket.put(e[o].name,{size:e[o].size,cid:e[o].cid});let i=await(0,uj.default)(n.flush(t.repo.blocks));if(!i)throw new Error("Flushing shard yielded no result");return i};var Da=E(V(),1),dj=E(Fi(),1),Oa=C("ipfs:mfs:core:utils:add-link");async function Jo(t,e){let r=e.parent;if(e.parentCid){let i=T.asCID(e.parentCid);if(i===null)throw(0,Da.default)(new Error("Invalid CID passed to addLink"),"EINVALIDPARENTCID");if(i.code!==ht)throw(0,Da.default)(new Error("Unsupported codec. Only DAG-PB is supported"),"EINVALIDPARENTCID");Oa(`Loading parent node ${i}`);let o=await t.repo.blocks.get(i);r=Rt(o)}if(!r)throw(0,Da.default)(new Error("No parent node or CID passed to addLink"),"EINVALIDPARENT");if(!e.cid)throw(0,Da.default)(new Error("No child cid passed to addLink"),"EINVALIDCHILDCID");if(!e.name)throw(0,Da.default)(new Error("No child name passed to addLink"),"EINVALIDCHILDNAME");if(!e.size&&e.size!==0)throw(0,Da.default)(new Error("No child size passed to addLink"),"EINVALIDCHILDSIZE");if(!r.Data)throw(0,Da.default)(new Error("Parent node with no data passed to addLink"),"ERR_INVALID_PARENT");let n=Qe.unmarshal(r.Data);return n.type==="hamt-sharded-directory"?(Oa("Adding link to sharded directory"),t7e(t,{...e,parent:r})):r.Links.length>=e.shardSplitThreshold?(Oa("Converting directory to sharded directory"),J_e(t,{...e,parent:r,mtime:n.mtime,mode:n.mode})):(Oa(`Adding ${e.name} (${e.cid}) to regular directory`),e7e(t,{...e,parent:r}))}var J_e=async(t,e)=>{let r=await hj(t,e.parent.Links.map(n=>({name:n.Name||"",size:n.Tsize||0,cid:n.Hash})).concat({name:e.name,size:e.size,cid:e.cid}),e);return Oa(`Converted directory to sharded directory ${r.cid}`),r},e7e=async(t,e)=>{let r=e.parent.Links.filter(u=>u.Name!==e.name);if(r.push({Name:e.name,Tsize:e.size,Hash:e.cid}),!e.parent.Data)throw(0,Da.default)(new Error("Parent node with no data passed to addToDirectory"),"ERR_INVALID_PARENT");let n=Qe.unmarshal(e.parent.Data),i;if(n.mtime){let u=Date.now(),f=Math.floor(u/1e3);n.mtime={secs:f,nsecs:(u-f*1e3)*1e3},i=n.marshal()}else i=e.parent.Data;e.parent=Ln({Data:i,Links:r});let o=await t.hashers.getHasher(e.hashAlg),s=je(e.parent),a=await o.digest(s),l=T.create(e.cidVersion,ht,a);return e.flush&&await t.repo.blocks.put(l,s),{node:e.parent,cid:l,size:s.length}},t7e=async(t,e)=>{let{shard:r,path:n}=await r7e(t,e),i=await(0,dj.default)(r.flush(t.repo.blocks));if(!i)throw new Error("No result from flushing shard");let o=await t.repo.blocks.get(i.cid),s=Rt(o),a=e.parent.Links.filter(u=>(u.Name||"").substring(0,2)!==n[0].prefix),l=s.Links.find(u=>(u.Name||"").substring(0,2)===n[0].prefix);if(!l)throw new Error(`No link found with prefix ${n[0].prefix}`);return a.push(l),N0(t,a,n[0].bucket,e)},r7e=async(t,e)=>{let r={name:e.name,cid:e.cid,size:e.size};if(!e.parent.Data)throw(0,Da.default)(new Error("Parent node with no data passed to addFileToShardedDirectory"),"ERR_INVALID_PARENT");let n=await zT(e.parent.Links),i=Qe.unmarshal(e.parent.Data),o=new C0({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mode:i.mode},e);o._bucket=n,i.mtime&&(o.mtime={secs:Math.round(Date.now()/1e3)});let s=await n._findNewBucketAndPos(r.name),a=n7e(s);a[0].node=e.parent;let l=0;for(;l<a.length;){let u=a[l];l++;let f=u.node;if(!f)throw new Error("Segment had no node");let h=f.Links.find(g=>(g.Name||"").substring(0,2)===u.prefix);if(!h){Oa(`Link ${u.prefix}${r.name} will be added`),l=a.length;break}if(h.Name===`${u.prefix}${r.name}`){Oa(`Link ${u.prefix}${r.name} will be replaced`),l=a.length;break}if((h.Name||"").length>2){Oa(`Link ${h.Name} ${h.Hash} will be replaced with a subshard`),l=a.length;break}Oa(`Found subshard ${u.prefix}`);let p=await t.repo.blocks.get(h.Hash),d=Rt(p);if(!a[l]){Oa(`Loaded new subshard ${u.prefix}`),await qT(t,d.Links,n,u.bucket,parseInt(u.prefix,16));let g=await n._findNewBucketAndPos(r.name);a.push({bucket:g.bucket,prefix:Ch(g.pos),node:d});break}let m=a[l];await kg(t,d.Links,m.bucket,n),m.node=d}return await o._bucket.put(r.name,{size:r.size,cid:r.cid}),{shard:o,path:a}},n7e=t=>{let e=[{bucket:t.bucket,prefix:Ch(t.pos)}],r=t.bucket._parent,n=t.bucket._posAtParent;for(;r;)e.push({bucket:r,prefix:Ch(n)}),n=r._posAtParent,r=r._parent;return e.reverse(),e};c();var pj=C("ipfs:mfs:utils:update-tree"),i7e={shardSplitThreshold:1e3};async function po(t,e,r){r=Object.assign({},i7e,r),pj("Trail",e),e=e.slice().reverse();let n=0,i;for await(let s of t.repo.blocks.getMany(e.map(a=>a.cid))){let a=Rt(s),l=e[n].cid,u=e[n].name;if(n++,!i){i={cid:l,name:u,size:s.length};continue}let f=await Jo(t,{parent:a,name:i.name,cid:i.cid,size:i.size,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold,hashAlg:r.hashAlg,cidVersion:r.cidVersion});i={cid:f.cid,name:u,size:f.size}}let{cid:o}=i;return pj(`Final CID ${o}`),o}c();var mj=E(V(),1),o7e=C("ipfs:mfs:utils:update-mfs-root");async function mo(t,e,r){if(r&&r.signal&&r.signal.aborted)throw(0,mj.default)(new Error("Request aborted"),"ERR_ABORTED",{name:"Aborted"});return o7e(`New MFS root will be ${e}`),await t.repo.datastore.put(e2,e.bytes),e}te();var xj=E(Fi(),1);c();c();var Ph=E(V(),1);c();te();async function gj(t,e,r){let n=new Qe({type:e,mode:r.mode,mtime:r.mtime}),i=await t.hashers.getHasher(r.hashAlg),o={Data:n.marshal(),Links:[]},s=je(o),a=await i.digest(s),l=T.create(r.cidVersion,ht,a);return r.flush&&await t.repo.blocks.put(l,s),{cid:l,node:o}}var s7e=Ye.bind({ignoreUndefined:!0}),yj=C("ipfs:mfs:mkdir"),a7e={parents:!1,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3,flush:!0};function Nh(t){async function e(r,n={}){let i=s7e(a7e,n);if(!r)throw new Error("no path given to Mkdir");if(r=r.trim(),r==="/"){if(i.parents)return;throw(0,Ph.default)(new Error("cannot create directory '/': Already exists"),"ERR_INVALID_PATH")}if(r.substring(0,1)!=="/")throw(0,Ph.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");yj(`Creating ${r}`);let o=I0(r);if(o[0]==="ipfs")throw(0,Ph.default)(new Error("path cannot have the prefix 'ipfs'"),"ERR_INVALID_PATH");let s=await A0(t,i),a,l=[],u=await gj(t,"directory",i);for(let h=0;h<=o.length;h++){let p=o.slice(0,h),d=`/ipfs/${s}/${p.join("/")}`;try{if(a=await ti(d,t.repo.blocks),a.type!=="file"&&a.type!=="directory")throw(0,Ph.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(h===o.length){if(i.parents)return;throw(0,Ph.default)(new Error("file already exists"),"ERR_ALREADY_EXISTS")}l.push({name:a.name,cid:a.cid})}catch(m){if(m.code==="ERR_NOT_FOUND"){if(h<o.length&&!i.parents)throw(0,Ph.default)(new Error(`Intermediate directory path ${d} does not exist, use the -p flag to create it`),"ERR_NOT_FOUND");await c7e(t,p[p.length-1],u,l[l.length-1],l,i)}else throw m}}let f=await po(t,l,i);await mo(t,f,i)}return B(e)}var c7e=async(t,e,r,n,i,o)=>{yj(`Adding empty dir called ${e} to ${n.cid}`);let s=await Jo(t,{parent:n.node,parentCid:n.cid,size:0,cid:r.cid,name:e,hashAlg:o.hashAlg,cidVersion:o.cidVersion,flush:o.flush,shardSplitThreshold:o.shardSplitThreshold});i[i.length-1].cid=s.cid,i.push({name:e,cid:r.cid})};var Tu=E(V(),1);var l7e=Ye.bind({ignoreUndefined:!0}),z5=C("ipfs:mfs:cp"),u7e={parents:!1,flush:!0,hashAlg:"sha2-256",cidVersion:0,shardSplitThreshold:1e3};function k0(t){async function e(r,n,i={}){let o=l7e(u7e,i);Array.isArray(r)||(r=[r]);let s=await Promise.all(r.map(p=>$r(t,p,o))),a=await $r(t,n,o);if(!s.length||!a)throw(0,Tu.default)(new Error("Please supply at least one source"),"ERR_INVALID_PARAMS");let l=s.find(p=>!p.exists);if(l)throw(0,Tu.default)(new Error(`${l.path} does not exist`),"ERR_INVALID_PARAMS");let u=wj(a);if(a.exists){if(z5("Destination exists"),s.length===1&&!u)throw(0,Tu.default)(new Error("directory already has entry by that name"),"ERR_ALREADY_EXISTS")}else if(z5("Destination does not exist"),s.length>1){if(!o.parents)throw(0,Tu.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Nh(t)(a.path,o),a=await $r(t,a.path,o)}else if(a.parts.length>1){let p=`/${a.parts.slice(0,-1).join("/")}`;try{await Ru(t)(p,o)}catch(d){if(d.code!=="ERR_NOT_FOUND")throw d;if(!o.parents)throw(0,Tu.default)(new Error("destination did not exist, pass -p to create intermediate directories"),"ERR_INVALID_PARAMS");await Nh(t)(p,o),a=await $r(t,a.path,o)}}let f=wj(a)?a.mfsPath:a.mfsDirectory,h=await ka(t,f);if(s.length===1){let p=s.pop();if(!p)throw(0,Tu.default)(new Error("could not find source"),"ERR_INVALID_PARAMS");let d=u?p.name:a.name;return z5(`Only one source, copying to destination ${u?"directory":"file"} ${d}`),f7e(t,p,d,h,o)}return z5("Multiple sources, wrapping in a directory"),h7e(t,s,a,h,o)}return B(e)}var wj=t=>t.unixfs&&t.unixfs.type&&t.unixfs.type.includes("directory"),f7e=async(t,e,r,n,i)=>{let o=n.pop();if(!o)throw(0,Tu.default)(new Error("destination had no parent"),"ERR_INVALID_PARAMS");o=await Ej(t,e,r,o,i),n.push(o);let s=await po(t,n,i);await mo(t,s,i)},h7e=async(t,e,r,n,i)=>{for(let s=0;s<e.length;s++){let a=e[s];r=await Ej(t,a,a.name,r,i)}n[n.length-1]=r;let o=await po(t,n,i);await mo(t,o,i)},Ej=async(t,e,r,n,i)=>{let o=await t.repo.blocks.get(e.cid),{node:s,cid:a,size:l}=await Jo(t,{parentCid:n.cid,size:o.length,cid:e.cid,name:r,hashAlg:i.hashAlg,cidVersion:i.cidVersion,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold});return n.node=s,n.cid=a,n.size=l,n};c();var Dg=E(V(),1);c();te();var Au=E(V(),1),Iu=C("ipfs:mfs:core:utils:remove-link");async function bj(t,e){let r=e.parent;if(e.parentCid){let i=T.asCID(e.parentCid);if(i===null)throw(0,Au.default)(new Error("Invalid CID passed to removeLink"),"EINVALIDPARENTCID");Iu(`Loading parent node ${i}`);let o=await t.repo.blocks.get(i);r=Rt(o)}if(!r)throw(0,Au.default)(new Error("No parent node or CID passed to removeLink"),"EINVALIDPARENT");if(!e.name)throw(0,Au.default)(new Error("No child name passed to removeLink"),"EINVALIDCHILDNAME");if(!r.Data)throw(0,Au.default)(new Error("Parent node had no data"),"ERR_INVALID_NODE");return Qe.unmarshal(r.Data).type==="hamt-sharded-directory"?(Iu(`Removing ${e.name} from sharded directory`),p7e(t,{...e,parent:r})):(Iu(`Removing link ${e.name} regular directory`),d7e(t,{...e,parent:r}))}var d7e=async(t,e)=>{e.parent.Links=e.parent.Links.filter(s=>s.Name!==e.name);let r=await je(e.parent),i=await(await t.hashers.getHasher(e.hashAlg)).digest(r),o=T.create(e.cidVersion,ht,i);return await t.repo.blocks.put(o,r),Iu(`Updated regular directory ${o}`),{node:e.parent,cid:o}},p7e=async(t,e)=>{let{rootBucket:r,path:n}=await fj(t,e.name,e.parent);await r.del(e.name);let{node:i}=await _j(t,n,e.name,e);return N0(t,i.Links,r,e)},_j=async(t,e,r,n)=>{let i=e.pop();if(!i)throw(0,Au.default)(new Error("Could not find parent"),"EINVALIDPARENT");let{bucket:o,prefix:s,node:a}=i;if(!a)throw(0,Au.default)(new Error("Could not find parent"),"EINVALIDPARENT");let l=a.Links.find(d=>(d.Name||"").substring(0,2)===s);if(!l)throw(0,Au.default)(new Error(`No link found with prefix ${s} for file ${r}`),"ERR_NOT_FOUND");if(l.Name===`${s}${r}`){Iu(`Removing existing link ${l.Name}`);let d=a.Links.filter(m=>m.Name!==l.Name);return await o.del(r),N0(t,d,o,n)}Iu(`Descending into sub-shard ${l.Name} for ${s}${r}`);let u=await _j(t,e,r,n),f=u.cid,h=u.size,p=s;if(u.node.Links.length===1){Iu(`Removing subshard for ${s}`);let d=u.node.Links[0];p=`${s}${(d.Name||"").substring(2)}`,f=d.Hash,h=d.Tsize||0}return Iu(`Updating shard ${s} with name ${p}`),m7e(t,o,a,s,p,h,f,n)},m7e=(t,e,r,n,i,o,s,a)=>{let l=r.Links.filter(u=>u.Name!==n);return l.push({Name:i,Tsize:o,Hash:s}),N0(t,l,e,a)};var g7e=Ye.bind({ignoreUndefined:!0}),y7e={recursive:!1,cidVersion:0,hashAlg:"sha2-256",flush:!0,shardSplitThreshold:1e3};function D0(t){async function e(r,n={}){let i=g7e(y7e,n);Array.isArray(r)||(r=[r]);let o=await Promise.all(r.map(s=>$r(t,s,i)));if(!o.length)throw(0,Dg.default)(new Error("Please supply at least one path to remove"),"ERR_INVALID_PARAMS");o.forEach(s=>{if(s.path==="/")throw(0,Dg.default)(new Error("Cannot delete root"),"ERR_INVALID_PARAMS")});for(let s of o)await w7e(t,s.path,i)}return B(e)}var w7e=async(t,e,r)=>{let n=await $r(t,e,r),i=await ka(t,n.mfsPath),o=i[i.length-1];i.pop();let s=i[i.length-1];if(!s)throw(0,Dg.default)(new Error(`${e} does not exist`),"ERR_NOT_FOUND");if(o.type==="directory"&&!r.recursive)throw(0,Dg.default)(new Error(`${e} is a directory, use -r to remove directories`),"ERR_WAS_DIR");let{cid:a}=await bj(t,{parentCid:s.cid,name:o.name,hashAlg:r.hashAlg,cidVersion:r.cidVersion,flush:r.flush,shardSplitThreshold:r.shardSplitThreshold});s.cid=a;let l=await po(t,i,r);await mo(t,l,r)};var E7e=Ye.bind({ignoreUndefined:!0}),b7e=C("ipfs:mfs:touch"),vj={flush:!0,shardSplitThreshold:1e3,hashAlg:"sha2-256",cidVersion:0,recursive:!1};function _7e(t,e,r){let n=0;return(t.includes("x")||t.includes("X")&&(r||e&1||e&8||e&64))&&(n+=1),t.includes("w")&&(n+=2),t.includes("r")&&(n+=4),n}function v7e(t,e){let r=0;return t.includes("u")&&(r+=e<<6),t.includes("g")&&(r+=e<<3),t.includes("o")&&(r+=e),r}function S7e(t,e,r){return e.includes("t")&&(r+=parseInt("1000",8)),e.includes("s")&&(t.includes("u")&&(r+=parseInt("4000",8)),t.includes("g")&&(r+=parseInt("2000",8))),r}function x7e(t,e,r){e||(e=0);let n=t.match(/^(u?g?o?a?)(-?\+?=?)?(r?w?x?X?s?t?)$/);if(!n)throw new Error(`Invalid file mode: ${t}`);let[,i,o,s]=n;(i==="a"||!i)&&(i="ugo");let a=_7e(s,e,r);return a=v7e(i,a),a=S7e(i,s,a),o==="="?(i.includes("u")&&(e=e&parseInt("7077",8),e=e|a),i.includes("g")&&(e=e&parseInt("7707",8),e=e|a),i.includes("o")&&(e=e&parseInt("7770",8),e=e|a),e):o==="+"?a|e:o==="-"?a^e:e}function Sj(t,e){if(t instanceof String||typeof t=="string"){let r=`${t}`;r.match(/^\d+$/g)?t=parseInt(r,8):t=0+r.split(",").reduce((n,i)=>x7e(i,n,e.isDirectory()),e.mode||0)}return t}function Rj(t){async function e(r,n,i={}){let o=E7e(vj,i);b7e(`Fetching stats for ${r}`);let{cid:s,mfsDirectory:a,name:l}=await $r(t,r,o);if(s.code!==ht)throw(0,O0.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");if(o.recursive){let L=await Se(async function*(){for await(let q of e5(s,t.repo.blocks)){if(q.type!=="file"&&q.type!=="directory")throw(0,O0.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");q.unixfs.mode=Sj(n,q.unixfs);let G=Ln({Data:q.unixfs.marshal(),Links:q.node.Links});yield{path:q.path,content:G}}},q=>f0(q,t.repo.blocks,{...o,pin:!1,dagBuilder:async function*(G,j,se){for await(let re of G)yield async function(){let Ge=re.content,me=je(Ge),Ce=await U5(me,j,se);if(!Ge.Data)throw(0,O0.default)(new Error(`${Ce} had no data`),"ERR_INVALID_NODE");let z=Qe.unmarshal(Ge.Data);return{cid:Ce,size:me.length,path:re.path,unixfs:z}}}}),q=>(0,xj.default)(q));if(!L)throw(0,O0.default)(new Error(`Could not chmod ${r}`),"ERR_COULD_NOT_CHMOD");await D0(t)(r,o),await k0(t)(`/ipfs/${L.cid}`,r,o);return}let u=await t.repo.blocks.get(s),f=Rt(u);if(!f.Data)throw(0,O0.default)(new Error(`${s} had no data`),"ERR_INVALID_NODE");let h=Qe.unmarshal(f.Data);h.mode=Sj(n,h);let p=je({Data:h.marshal(),Links:f.Links}),d=o.hashAlg||vj.hashAlg,g=await(await t.hashers.getHasher(d)).digest(p),y=T.create(o.cidVersion,ht,g);o.flush&&await t.repo.blocks.put(y,p);let w=await ka(t,a),b=w[w.length-1],v=T.decode(b.cid.bytes),S=await t.repo.blocks.get(v),R=Rt(S),I=await Jo(t,{parent:R,name:l,cid:y,size:p.length,flush:o.flush,hashAlg:d,cidVersion:s.version,shardSplitThreshold:1/0});b.cid=I.cid;let A=await po(t,w,o);await mo(t,A,o)}return B(e)}c();var R7e=Ye.bind({ignoreUndefined:!0}),T7e={};function Tj(t){async function e(r,n={}){n=R7e(T7e,n);let{cid:i}=await Ru(t)(r,n);return i}return B(e)}c();var A7e=Ye.bind({ignoreUndefined:!0}),I7e={parents:!1,flush:!0,cidVersion:0,hashAlg:"sha2-256",shardSplitThreshold:1e3};function Aj(t){async function e(r,n,i={}){let o=A7e(I7e,i);await k0(t)(r,n,o),await D0(t)(r,{...o,recursive:!0})}return B(e)}c();var HT=E(V(),1);te();var C7e=Ye.bind({ignoreUndefined:!0}),P7e=C("ipfs:mfs:touch"),Ij={flush:!0,shardSplitThreshold:1e3,cidVersion:0,hashAlg:"sha2-256"};function Cj(t){async function e(r,n={}){let i=C7e(Ij,n);i.mtime=i.mtime||new Date,P7e(`Touching ${r} mtime: ${i.mtime}`);let{cid:o,mfsDirectory:s,name:a,exists:l}=await $r(t,r,i),u=n.hashAlg||Ij.hashAlg,f=await t.hashers.getHasher(u),h,p,d=i.cidVersion;if(l){if(o.code!==ht)throw(0,HT.default)(new Error(`${r} was not a UnixFS node`),"ERR_NOT_UNIXFS");d=o.version;let R=await t.repo.blocks.get(o),I=Rt(R);if(!I.Data)throw(0,HT.default)(new Error(`${r} had no data`),"ERR_INVALID_NODE");let A=Qe.unmarshal(I.Data);A.mtime=i.mtime,h=je({Data:A.marshal(),Links:I.Links});let L=await f.digest(h);p=T.create(i.cidVersion,ht,L),i.flush&&await t.repo.blocks.put(p,h)}else{let R=new Qe({type:"file",mtime:i.mtime});h=je({Data:R.marshal(),Links:[]});let I=await f.digest(h);p=T.create(i.cidVersion,ht,I),i.flush&&await t.repo.blocks.put(p,h)}let m=await ka(t,s),g=m[m.length-1],y=g.cid,w=await t.repo.blocks.get(y),b=Rt(w),v=await Jo(t,{parent:b,name:a,cid:p,size:h.length,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:d});g.cid=v.cid;let S=await po(t,m,i);await mo(t,S,i)}return B(e)}c();var $T=E(V(),1);var N7e=Ye.bind({ignoreUndefined:!0}),k7e={offset:0,length:1/0};function Pj(t){function e(r,n={}){return n=N7e(k7e,n),{[Symbol.asyncIterator]:async function*(){let o=await $r(t,r,n),s=await ti(o.mfsPath,t.repo.blocks);if(s.type!=="file")throw(0,$T.default)(new Error(`${r} was not a file`),"ERR_NOT_FILE");if(!s.content)throw(0,$T.default)(new Error(`Could not load content stream from ${r}`),"ERR_NO_CONTENT");for await(let a of s.content({offset:n.offset,length:n.length}))yield a}}}return B(e)}c();c();var GT=E(V(),1);Ae();var Og=C("ipfs:mfs:utils:to-async-iterator");function Nj(t){if(!t)throw(0,GT.default)(new Error("paths must start with a leading slash"),"ERR_INVALID_PATH");if((typeof t=="string"||t instanceof String)&&(Og("Content was a string"),t=U(t.toString())),t.length)return Og("Content was array-like"),{[Symbol.asyncIterator]:function*(){yield t}};if(t[Symbol.asyncIterator])return Og("Content was an async iterator"),t;if(t[Symbol.iterator])return Og("Content was an iterator"),t;if(globalThis.Blob&&t instanceof globalThis.Blob){Og("Content was an HTML5 Blob");let e=0,r={next:()=>e>t.size?{done:!0}:new Promise((n,i)=>{let o=t.slice(e,t2);e+=t2;let s=new globalThis.FileReader,a=l=>{if(s.removeEventListener("loadend",a,!1),l.error)return i(l.error);n({done:!1,value:new Uint8Array(s.result)})};s.addEventListener("loadend",a),s.readAsArrayBuffer(o)})};return{[Symbol.asyncIterator]:()=>r}}throw(0,GT.default)(new Error(`Don't know how to convert ${t} into an async iterator`),"ERR_INVALID_PARAMS")}var Ba=E(V(),1);var Dj=E(Fi(),1);var D7e=Ye.bind({ignoreUndefined:!0}),La=C("ipfs:mfs:write"),O7e={offset:0,length:1/0,create:!1,truncate:!1,rawLeaves:!1,reduceSingleLeafToSelf:!1,cidVersion:0,hashAlg:"sha2-256",parents:!1,progress:(t,e)=>{},strategy:"trickle",flush:!0,leafType:"raw",shardSplitThreshold:1e3};function Oj(t){async function e(r,n,i={}){let o=D7e(O7e,i),s,a,l;if(La("Reading source, destination and parent"),await Pg().readLock(async()=>{s=await Nj(n),a=await $r(t,r,o),l=await $r(t,a.mfsDirectory,o)})(),La("Read source, destination and parent"),!o.parents&&!l.exists)throw(0,Ba.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(s==null)throw(0,Ba.default)(new Error("could not create source"),"ERR_NO_SOURCE");if(a==null)throw(0,Ba.default)(new Error("could not create destination"),"ERR_NO_DESTINATION");if(!o.create&&!a.exists)throw(0,Ba.default)(new Error("file does not exist"),"ERR_NO_EXIST");if(a.entryType!=="file")throw(0,Ba.default)(new Error("not a file"),"ERR_NOT_A_FILE");return L7e(t,r,s,a,o)}return B(e)}var L7e=async(t,e,r,n,i)=>{let o=await B7e(t,r,n,i);await Pg().writeLock(async()=>{let s=I0(e),a=s.pop();if(a==null)throw(0,Ba.default)(new Error("source does not exist"),"ERR_NO_EXIST");let l=!1;try{await Ru(t)(`/${s.join("/")}`,i),l=!0}catch(y){if(y.code!=="ERR_NOT_FOUND")throw y}l||await Nh(t)(`/${s.join("/")}`,i);let u=await $r(t,e,i),f=await ka(t,u.mfsDirectory),h=f[f.length-1];if(!h)throw(0,Ba.default)(new Error("directory does not exist"),"ERR_NO_EXIST");if(!h.type||!h.type.includes("directory"))throw(0,Ba.default)(new Error(`cannot write to ${h.name}: Not a directory`),"ERR_NOT_A_DIRECTORY");let p=await t.repo.blocks.get(h.cid),d=Rt(p),m=await Jo(t,{parent:d,name:a,cid:o.cid,size:o.size,flush:i.flush,shardSplitThreshold:i.shardSplitThreshold,hashAlg:i.hashAlg,cidVersion:i.cidVersion});h.cid=m.cid;let g=await po(t,f,i);await mo(t,g,i)})()},B7e=async(t,e,r,n)=>{r.exists?La(`Overwriting file ${r.cid} offset ${n.offset} length ${n.length}`):La(`Writing file offset ${n.offset} length ${n.length}`);let i=[];if(n.offset>0)if(r.unixfs){if(La(`Writing first ${n.offset} bytes of original file`),i.push(()=>r.content({offset:0,length:n.offset})),r.unixfs.fileSize()<n.offset){let f=n.offset-r.unixfs.fileSize();La(`Writing zeros for extra ${f} bytes`),i.push(kj(f))}}else La(`Writing zeros for first ${n.offset} bytes`),i.push(kj(n.offset));i.push(Lj(e,n.length));let o=U7e(M7e(i),f=>{if(r.unixfs&&!n.truncate){let h=r.unixfs.fileSize();if(h>f)return La(`Writing last ${h-f} of ${h} bytes from original file starting at offset ${f}`),r.content({offset:f});La("Not writing last bytes from original file")}return{[Symbol.asyncIterator]:async function*(){}}}),s;n.mode!==void 0&&n.mode!==null?s=hc(n.mode):r&&r.unixfs&&(s=r.unixfs.mode);let a;n.mtime!=null?a=Dl(n.mtime):r&&r.unixfs&&(a=r.unixfs.mtime);let l=await t.hashers.getHasher(n.hashAlg),u=await(0,Dj.default)(f0([{content:o,mode:s,mtime:a}],t.repo.blocks,{progress:n.progress,hasher:l,cidVersion:n.cidVersion,strategy:n.strategy,rawLeaves:n.rawLeaves,reduceSingleLeafToSelf:n.reduceSingleLeafToSelf,leafType:n.leafType}));if(!u)throw(0,Ba.default)(new Error(`cannot write to ${parent.name}`),"ERR_COULD_NOT_WRITE");return La(`Wrote ${u.cid}`),{cid:u.cid,size:u.size}},Lj=(t,e)=>async function*(){let n=0;for await(let i of t){if(n+=i.length,n>e){yield i.slice(0,e-n);return}yield i}},kj=(t,e=t2)=>{let r=new Uint8Array(e);async function*n(){for(;;)yield r.slice()}return Lj(n(),t)},M7e=async function*(t){for(let e=0;e<t.length;e++)yield*t[e]()},U7e=async function*(t,e){let r=0;for await(let n of t)r+=n.length,yield n;for await(let n of e(r))r+=n.length,yield n};c();var Mj=E(ei(),1),Bj=t=>{let e={cid:t.cid,name:t.name,type:t.type==="directory"?"directory":"file",size:t.size};return(t.type==="file"||t.type==="directory")&&(e.mode=t.unixfs.mode,e.mtime=t.unixfs.mtime),e};function Uj(t){async function*e(r,n={}){let i=await $r(t,r,n),o=await ti(i.mfsPath,t.repo.blocks);if(o.type==="directory"){yield*(0,Mj.default)(o.content(n),Bj);return}yield Bj(o)}return B(e)}var F7e={stat:Ru},K7e={chmod:Rj,cp:k0,flush:Tj,mkdir:Nh,mv:Aj,rm:D0,touch:Cj},Fj={write:Oj,read:Pj,ls:Uj},Kj=({options:t,mfs:e,operations:r,lock:n})=>{Object.keys(r).forEach(i=>{e[i]=n(r[i](t))})},V7e={repoOwner:!0,repo:null};function q7e(t){let{repoOwner:e}=Object.assign({},V7e||{},t),r=Pg(e),n=s=>r.readLock(s),i=s=>r.writeLock(s),o={};return Kj({options:t,mfs:o,operations:F7e,lock:n}),Kj({options:t,mfs:o,operations:K7e,lock:i}),Object.keys(Fj).forEach(s=>{o[s]=Fj[s](t)}),o}function Vj({repo:t,preload:e,hashers:r,options:n}){let i=q7e({repo:t,repoOwner:n.repoOwner!==!1,hashers:r}),o=s=>(...l)=>{let u=l.filter(f=>WT.default.ipfsPath(f)||WT.default.cid(f));if(u.length){let f=l[l.length-1];f&&f.preload!==!1&&u.forEach(h=>e(h))}return s(...l)};return{...i,chmod:i.chmod,cp:o(i.cp),mkdir:i.mkdir,stat:o(i.stat),rm:i.rm,read:o(i.read),touch:i.touch,write:i.write,mv:o(i.mv),flush:i.flush,ls:o(async function*(...s){for await(let a of i.ls(...s))yield{...a,size:a.size||0}})}}c();c();function qj({keychain:t}){return B((r,n)=>t.exportKey(r,n))}c();var zj="Ed25519",Hj=2048;function $j({keychain:t}){return B((r,n={type:zj,size:Hj})=>t.createKey(r,n.type||zj,n.size||Hj))}c();function Gj({keychain:t}){return B((r,n,i)=>t.importKey(r,n,i))}c();function Wj({keychain:t}){return B(r=>t.findKeyByName(r))}c();function jj({keychain:t}){return B(()=>t.listKeys())}c();function Yj({keychain:t}){return B(async(r,n)=>{let i=await t.renameKey(r,n);return{was:r,now:i.name,id:i.id,overwrite:!1}})}c();function Qj({keychain:t}){return B(r=>t.removeKey(r))}var H5=class{constructor({keychain:e}){this.gen=$j({keychain:e}),this.list=jj({keychain:e}),this.rm=Qj({keychain:e}),this.rename=Yj({keychain:e}),this.export=qj({keychain:e}),this.import=Gj({keychain:e}),this.info=Wj({keychain:e})}};c();c();c();function Wi({repo:t,preload:e}){async function r(n,i={}){i.preload!==!1&&e(n);let o=await t.blocks.get(n,i);return Rt(o)}return B(r)}function Xj({repo:t,preload:e}){let r=Wi({repo:t,preload:e});async function n(i,o={}){return(await r(i,o)).Data||new Uint8Array(0)}return B(n)}c();Fo();te();function jT(t,e=[]){for(let r in t){let n=t[r];if(r==="/"&&Object.keys(t).length===1)try{e.push({Name:"",Tsize:0,Hash:T.parse(n)});continue}catch{}let i=T.asCID(n);if(i){e.push({Name:"",Tsize:0,Hash:i});continue}Array.isArray(n)&&jT(n,e),n&&typeof n=="object"&&jT(n,e)}return e}function Zj({repo:t,codecs:e}){async function r(n,i={}){let o=await e.getCodec(n.code),s=await t.blocks.get(n,i),a=o.decode(s);switch(n.code){case Un:return[];case ht:return a.Links;case Lf:case g9:return jT(a);default:throw new Error(`Cannot resolve links from codec ${n.code}`)}}return B(r)}c();zr();te();function Jj({repo:t,preload:e}){async function r(n={}){let i;if(n.template)if(n.template==="unixfs-dir")i=new Qe({type:"directory"}).marshal();else throw new Error("unknown template");let o=je({Data:i,Links:[]}),s=await Be.digest(o),a=T.createV0(s);return await t.blocks.put(a,o,{signal:n.signal}),n.preload!==!1&&e(a),a}return B(r)}c();te();zr();function Ma({repo:t,preload:e}){async function r(n,i={}){let o=await t.gcLock.readLock();try{let s=je(n),a=await Be.digest(s),l=T.createV1(ht,a);return await t.blocks.put(l,s,{signal:i.signal}),i.preload!==!1&&e(l),i.pin&&await t.pins.pinRecursively(l,{signal:i.signal}),l}finally{o()}}return B(r)}c();function eY({repo:t,preload:e}){let r=Wi({repo:t,preload:e});async function n(i,o={}){let s=await r(i,o),l=je(s).length,u=s.Links.reduce((f,h)=>f+(h.Tsize||0),0);return{Hash:i,NumLinks:s.Links.length,BlockSize:l,LinksSize:l-(s.Data||[]).length,DataSize:(s.Data||[]).length,CumulativeSize:l+u}}return B(n)}c();c();function tY({repo:t,preload:e}){let r=Wi({repo:t,preload:e}),n=Ma({repo:t,preload:e});async function i(o,s,a={}){let l=await r(o,a);return n({...l,Links:l.Links.concat([s])},a)}return B(i)}c();Pr();function rY({repo:t,preload:e}){let r=Wi({repo:t,preload:e}),n=Ma({repo:t,preload:e});async function i(o,s,a={}){let l=await r(o,a),u=Pe([l.Data||[],s]);return n({...l,Data:u},a)}return B(i)}c();function nY({repo:t,preload:e}){let r=Wi({repo:t,preload:e}),n=Ma({repo:t,preload:e});async function i(o,s,a={}){let l=await r(o,a),u=(typeof s=="string"?s:s.Name)||"";return l.Links=l.Links.filter(f=>f.Name!==u),n(l,a)}return B(i)}c();function iY({repo:t,preload:e}){let r=Wi({repo:t,preload:e}),n=Ma({repo:t,preload:e});async function i(o,s,a={}){let l=await r(o,a);return n({...l,Data:s},a)}return B(i)}var $5=class{constructor({repo:e,preload:r}){this.addLink=tY({repo:e,preload:r}),this.appendData=rY({repo:e,preload:r}),this.rmLink=nY({repo:e,preload:r}),this.setData=iY({repo:e,preload:r})}};var G5=class{constructor({repo:e,codecs:r,preload:n}){this.data=Xj({repo:e,preload:n}),this.get=Wi({repo:e,preload:n}),this.links=Zj({repo:e,codecs:r}),this.new=Jj({repo:e,preload:n}),this.put=Ma({repo:e,preload:n}),this.stat=eY({repo:e,preload:n}),this.patch=new $5({repo:e,preload:n})}};c();c();var z7e=C("ipfs:repo:gc");function oY({repo:t,hashers:e}){async function*r(n={}){let i=Date.now(),o;try{o=await A0({repo:t,hashers:e},n),await t.pins.pinRecursively(o),yield*t.gc()}finally{o&&await t.pins.unpin(o)}z7e(`Complete (${Date.now()-i}ms)`)}return B(r)}c();function W5({repo:t}){async function e(r={}){let n=await t.stat();return{numObjects:BigInt(n.numObjects.toString()),repoSize:BigInt(n.repoSize.toString()),repoPath:n.repoPath,version:`${n.version}`,storageMax:BigInt(n.storageMax.toString())}}return B(e)}c();c();function sY({repo:t}){async function e(r={}){try{await t._checkInitialized(r)}catch(n){if([/Key not found in database \[\/version\]/,/ENOENT/,/repo is not initialized yet/].some(o=>o.test(n.message)))return 12;throw n}return t.version.get()}return B(e)}var j5=class{constructor({repo:e,hashers:r}){this.gc=oY({repo:e,hashers:r}),this.stat=W5({repo:e}),this.version=sY({repo:e}),this.setApiAddr=n=>e.apiAddr.set(n)}};c();c();var cY=E(V(),1);function aY(t,e){let r;if(t.metrics?e.peer?r=t.metrics.forPeer(e.peer):e.proto?r=t.metrics.forProtocol(e.proto):r=t.metrics.getGlobal():r=void 0,!r)return{totalIn:BigInt(0),totalOut:BigInt(0),rateIn:0,rateOut:0};let n=r.getMovingAverages(),i=r.getSnapshot();return{totalIn:i.dataReceived,totalOut:i.dataSent,rateIn:n.dataReceived[6e4].movingAverage/60,rateOut:n.dataSent[6e4].movingAverage/60}}function lY({network:t}){return B(async function*(r={}){let{libp2p:n}=await t.use(r);if(!r.poll){yield aY(n,r);return}let i=r.interval||1e3,o=-1;try{if(o=typeof i=="string"?Fl(i)||-1:i,!o||o<0)throw new Error("invalid duration")}catch(a){throw(0,cY.default)(a,"ERR_INVALID_POLL_INTERVAL")}let s;try{for(;;)yield aY(n,r),await new Promise(a=>{s=setTimeout(a,o)})}finally{clearTimeout(s)}})}var Y5=class{constructor({repo:e,network:r}){this.repo=W5({repo:e}),this.bw=lY({network:r}),this.bitswap=w6({network:r})}};c();c();c();var LA=E(YT(),1),yX=E(Oi(),1),Vh=E(V(),1);c();c();c();te();var dY=E(Oi(),1),pY=E(Bg(),1);si();Fo();On();var W7e=(0,dY.default)("ipfs:repo:migrator:migration-8");function mY(t){return t.child?mY(t.child):t}function j7e(t){try{let e=xt.decode(`b${t.toString().toLowerCase().slice(1)}`),r=T.decode(e).multihash.bytes,n=xt.encode(r).slice(1).toUpperCase();return new ae(`/${n}`,!1)}catch{return t}}function Y7e(t){try{let e=xt.decode(`b${t.toString().toLowerCase().slice(1)}`),r=wr(e),n=xt.encode(T.createV1(Un,r).bytes).slice(1);return new ae(`/${n.toUpperCase()}`,!1)}catch{return t}}async function hY(t,e,r){let n=t.blocks;await n.open();let i=mY(n),o=await(0,pY.default)(i.queryKeys({filters:[s=>r(s).toString()!==s.toString()]}));try{let s=0;for await(let a of i.query({})){let l=r(a.key);l.toString()!==a.key.toString()&&(s+=1,W7e(`Migrating Block from ${a.key} to ${l}`,await i.has(a.key)),await i.delete(a.key),await i.put(l,a.value),e(s/o*100,`Migrated Block from ${a.key} to ${l}`))}}finally{await n.close()}}var gY={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(t,e=()=>{})=>hY(t,e,j7e),revert:(t,e=()=>{})=>hY(t,e,Y7e)};c();te();Of();c();te();c();var kh=E(pa(),1),yY=kh.default.Reader,Q7e=kh.default.Writer,vit=kh.default.util,Q5=kh.default.roots.default||(kh.default.roots.default={}),wY=Q5.ipfs=(()=>{let t={};return t.pin=function(){let e={};return e.Set=function(){function r(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}return r.prototype.version=0,r.prototype.fanout=0,r.prototype.seed=0,r.encode=function(i,o){return o||(o=Q7e.create()),i.version!=null&&Object.hasOwnProperty.call(i,"version")&&o.uint32(8).uint32(i.version),i.fanout!=null&&Object.hasOwnProperty.call(i,"fanout")&&o.uint32(16).uint32(i.fanout),i.seed!=null&&Object.hasOwnProperty.call(i,"seed")&&o.uint32(29).fixed32(i.seed),o},r.decode=function(i,o){i instanceof yY||(i=yY.create(i));for(var s=o===void 0?i.len:i.pos+o,a=new Q5.ipfs.pin.Set;i.pos<s;){var l=i.uint32();switch(l>>>3){case 1:a.version=i.uint32();break;case 2:a.fanout=i.uint32();break;case 3:a.seed=i.fixed32();break;default:i.skipType(l&7);break}}return a},r.fromObject=function(i){if(i instanceof Q5.ipfs.pin.Set)return i;var o=new Q5.ipfs.pin.Set;return i.version!=null&&(o.version=i.version>>>0),i.fanout!=null&&(o.fanout=i.fanout>>>0),i.seed!=null&&(o.seed=i.seed>>>0),o},r.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(s.version=0,s.fanout=0,s.seed=0),i.version!=null&&i.hasOwnProperty("version")&&(s.version=i.version),i.fanout!=null&&i.hasOwnProperty("fanout")&&(s.fanout=i.fanout),i.seed!=null&&i.hasOwnProperty("seed")&&(s.seed=i.seed),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,kh.default.util.toJSONOptions)},r}(),e}(),t})();var vY=E(bY(),1),J5=E(ai(),1);c();si();te();var Mg=new ae("/local/pins"),Z5=256,_Y=8192,XT=T.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),Dh={direct:"direct",recursive:"recursive"};function ZT(t){return new ae(`/${xt.encode(t.multihash.bytes).toUpperCase().substring(1)}`)}Pr();Re();Ae();zr();var JT=wY.pin.Set;function X7e(t){let e=t.Data;if(!e)throw new Error("No data present");let r=J5.default.decode(e),n=J5.default.decode.bytes;if(n<=0)throw new Error("Invalid Set header length");if(n+r>e.length)throw new Error("Impossibly large set header length");let i=e.slice(n,r+n),o=JT.toObject(JT.decode(i),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(o.version!==1)throw new Error(`Unsupported Set version: ${o.version}`);if(o.fanout>t.Links.length)throw new Error("Impossibly large fanout");return{header:o,data:e.slice(r+n)}}function Z7e(t,e){let r=new Uint8Array(4);new DataView(r.buffer).setUint32(0,t,!0);let i=U(e.toString()),o=Pe([r,i],r.byteLength+i.byteLength);return(0,vY.default)(F(o))}async function*SY(t,e){let r=X7e(e),n=0;for(let i of e.Links){if(n<r.header.fanout){let o=i.Hash;if(!XT.equals(o)){let s=await t.get(o),a=Rt(s);yield*SY(t,a)}}else yield i.Hash;n++}}async function*Ug(t,e,r){let n=e.Links.find(s=>s.Name===r);if(!n)throw new Error("No link found with name "+r);let i=await t.get(n.Hash),o=Rt(i);yield*SY(t,o)}function J7e(t,e){return r(e,0);async function r(n,i){let o=JT.encode({version:1,fanout:Z5,seed:i}).finish(),s=J5.default.encode(o.length),a=Pe([s,o]),l=[];for(let f=0;f<Z5;f++)l.push({Name:"",Tsize:1,Hash:XT});if(n.length<=_Y){let f=n.map(d=>({link:{Name:"",Tsize:1,Hash:d.key},data:d.data||new Uint8Array})).sort((d,m)=>Wf(d.link.Hash.bytes,m.link.Hash.bytes)),h=l.concat(f.map(d=>d.link));return{Data:Pe([a,...f.map(d=>d.data)]),Links:h}}else{let f=n.reduce((p,d)=>{let m=Z7e(i,d.key)%Z5;return p[m]=m in p?p[m].concat([d]):[d],p},[]),h=0;for(let p of f){let d=await r(p,i+1);await u(d,h),h++}return{Data:a,Links:l}}async function u(f,h){let p=je(f),d=await Be.digest(p),m=T.createV0(d);await t.put(m,p);let g=f.Links.reduce((y,w)=>y+(w.Tsize||0),0)+p.length;l[h]={Name:"",Tsize:g,Hash:m}}}}async function eA(t,e,r){let n=await J7e(t,r.map(l=>({key:l}))),i=je(n),o=await Be.digest(i),s=T.createV0(o);await t.put(s,i);let a=n.Links.reduce((l,u)=>l+u.Tsize,0)+i.length;return{Name:e,Tsize:a,Hash:s}}var e8=E(Bg(),1);zr();On();si();async function tve(t,e,r,n){if(!await e.has(Mg))return;let i=await e.get(Mg),o=T.decode(i),s=await t.get(o),a=Rt(s),l=0,u=await(0,e8.default)(Ug(t,a,Dh.recursive))+await(0,e8.default)(Ug(t,a,Dh.direct));for await(let f of Ug(t,a,Dh.recursive)){l++;let h={depth:1/0};f.version!==0&&(h.version=f.version),f.code!==ht&&(h.codec=f.code),await r.put(ZT(f),no(h)),n(l/u*100,`Migrated recursive pin ${f}`)}for await(let f of Ug(t,a,Dh.direct)){l++;let h={depth:0};f.version!==0&&(h.version=f.version),f.code!==ht&&(h.codec=f.code),await r.put(ZT(f),no(h)),n(l/u*100,`Migrated direct pin ${f}`)}await t.delete(o),await e.delete(Mg)}async function rve(t,e,r,n){let i=[],o=[],s=0,a=await(0,e8.default)(r.queryKeys({}));for await(let{key:p,value:d}of r.query({})){s++;let m=Mn(d),g=T.create(m.version||0,m.codec||ht,wr(xt.decode("b"+p.toString().toLowerCase().split("/").pop())));m.depth===0?(n(s/a*100,`Reverted direct pin ${g}`),o.push(g)):(n(s/a*100,`Reverted recursive pin ${g}`),i.push(g))}n(100,"Updating pin root");let l={Links:[await eA(t,Dh.direct,o),await eA(t,Dh.recursive,i)]},u=je(l),f=await Be.digest(u),h=T.createV0(f);await t.put(h,u),await e.put(Mg,h.bytes)}async function xY(t,e,r){let n=t.blocks,i=t.datastore,o=t.pins;await n.open(),await i.open(),await o.open();try{await r(n,i,o,e)}finally{await o.close(),await i.close(),await n.close()}}var RY={version:9,description:"Migrates pins to datastore",migrate:(t,e=()=>{})=>xY(t,e,tve),revert:(t,e=()=>{})=>xY(t,e,rve)};c();c();var TY=new ae("/config"),Fg=new ae("/version");function Kg(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}async function nve(t,e,r){let n=await e(t);if(n)return n;let i=Kg(r);return i?new Promise((o,s)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{o(Boolean(a.result))}}):!1}async function ive(t,e,r,n){if(await r(t))return e(t);let i=Kg(n);if(!i)throw Rn();return new Promise((o,s)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return o(a.result);s(Rn())}})}function t8(t){let e=t.get.bind(t),r=t.has.bind(t);return t.get=n=>ive(n,e,r,t),t.has=n=>nve(n,r,t),t}function tA(t){return{...t,root:t8(t.root),datastore:t8(t.datastore),pins:t8(t.pins),keys:t8(t.keys)}}Ae();Re();async function ove(t,e,r=()=>{}){let n=Kg(e);if(!n){r(`${t} did not need an upgrade`);return}r(`Upgrading ${t}`),await PY(n,(o,s)=>[{type:"del",key:o},{type:"put",key:U(o),value:s}])}async function sve(t,e,r=()=>{}){let n=Kg(e);if(!n){r(`${t} did not need a downgrade`);return}r(`Downgrading ${t}`),await PY(n,(o,s)=>[{type:"del",key:o},{type:"put",key:F(o),value:s}])}function IY(t){return t.child?IY(t.child):t}async function AY(t,e,r){let n=Object.entries(t).map(([s,a])=>({key:s,backend:IY(a)})).filter(({key:s,backend:a})=>a.constructor.name==="LevelDatastore").map(({key:s,backend:a})=>({name:s,store:a}));e(0,`Migrating ${n.length} dbs`);let i=0,o=s=>{e(Math.round(i/n.length*100),s)};for(let{name:s,store:a}of n){await a.open();try{await r(s,a,o)}finally{i++,await a.close()}}e(100,`Migrated ${n.length} dbs`)}var CY={version:10,description:"Migrates datastore-level keys to binary",migrate:(t,e=()=>{})=>AY(t,e,ove),revert:(t,e=()=>{})=>AY(t,e,sve)};function PY(t,e){function r(n,i){let o=t.store("readwrite"),s=o.transaction,a=0,l;s.onabort=()=>i(l||s.error||new Error("aborted by user")),s.oncomplete=()=>i();function u(){let f=n[a++],h=f.key,p;try{p=f.type==="del"?o.delete(h):o.put(f.value,h)}catch(d){l=d,s.abort();return}a<n.length&&(p.onsuccess=u)}u()}return new Promise((n,i)=>{let o=t.iterator(),s=l=>l;o._deserializeKey=o._deserializeValue=s,a();function a(){let l=(u,f,h)=>{if(u||f===void 0){let p=d=>{if(d){i(d);return}n()};o.end(p);return}r(e(f,h),a)};o.next(l)}})}c();var Cu=new ae("/local/filesroot");async function ave(t,e=()=>{}){if(e(100,"Migrating MFS root to repo datastore"),await t.root.open(),await t.datastore.open(),await t.root.has(Cu)){let r=await t.root.get(Cu);await t.datastore.put(Cu,r),await t.root.delete(Cu)}await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo datastore")}async function cve(t,e=()=>{}){if(e(100,"Migrating MFS root to repo root datastore"),await t.root.open(),await t.datastore.open(),await t.datastore.has(Cu)){let r=await t.datastore.get(Cu);await t.root.put(Cu,r),await t.datastore.delete(Cu)}await t.datastore.close(),await t.root.close(),e(100,"Stored MFS root in repo root datastore")}var NY={version:11,description:"Store mfs root in the datastore",migrate:ave,revert:cve};c();var cA=E(pa(),1);c();var Oh=E(pa(),1),kY=Oh.default.Reader,lve=Oh.default.Writer,uve=Oh.default.util,r8=Oh.default.roots.default||(Oh.default.roots.default={}),rA=r8.Protocols=(()=>{function t(e){if(this.protocols=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.protocols=uve.emptyArray,t.encode=function(r,n){if(n||(n=lve.create()),r.protocols!=null&&r.protocols.length)for(var i=0;i<r.protocols.length;++i)n.uint32(10).string(r.protocols[i]);return n},t.decode=function(r,n){r instanceof kY||(r=kY.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new r8.Protocols;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.protocols&&o.protocols.length||(o.protocols=[]),o.protocols.push(r.string());break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof r8.Protocols)return r;var n=new r8.Protocols;if(r.protocols){if(!Array.isArray(r.protocols))throw TypeError(".Protocols.protocols: array expected");n.protocols=[];for(var i=0;i<r.protocols.length;++i)n.protocols[i]=String(r.protocols[i])}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.protocols=[]),r.protocols&&r.protocols.length){i.protocols=[];for(var o=0;o<r.protocols.length;++o)i.protocols[o]=r.protocols[o]}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Oh.default.util.toJSONOptions)},t})();c();var qc=E(pa(),1),L0=qc.default.Reader,nA=qc.default.Writer,Dr=qc.default.util,Wn=qc.default.roots.default||(qc.default.roots.default={}),iA=Wn.Addresses=(()=>{function t(e){if(this.addrs=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.addrs=Dr.emptyArray,t.prototype.certifiedRecord=null,t.encode=function(r,n){if(n||(n=nA.create()),r.addrs!=null&&r.addrs.length)for(var i=0;i<r.addrs.length;++i)Wn.Addresses.Address.encode(r.addrs[i],n.uint32(10).fork()).ldelim();return r.certifiedRecord!=null&&Object.hasOwnProperty.call(r,"certifiedRecord")&&Wn.Addresses.CertifiedRecord.encode(r.certifiedRecord,n.uint32(18).fork()).ldelim(),n},t.decode=function(r,n){r instanceof L0||(r=L0.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Wn.Addresses;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.addrs&&o.addrs.length||(o.addrs=[]),o.addrs.push(Wn.Addresses.Address.decode(r,r.uint32()));break;case 2:o.certifiedRecord=Wn.Addresses.CertifiedRecord.decode(r,r.uint32());break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof Wn.Addresses)return r;var n=new Wn.Addresses;if(r.addrs){if(!Array.isArray(r.addrs))throw TypeError(".Addresses.addrs: array expected");n.addrs=[];for(var i=0;i<r.addrs.length;++i){if(typeof r.addrs[i]!="object")throw TypeError(".Addresses.addrs: object expected");n.addrs[i]=Wn.Addresses.Address.fromObject(r.addrs[i])}}if(r.certifiedRecord!=null){if(typeof r.certifiedRecord!="object")throw TypeError(".Addresses.certifiedRecord: object expected");n.certifiedRecord=Wn.Addresses.CertifiedRecord.fromObject(r.certifiedRecord)}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addrs=[]),n.defaults&&(i.certifiedRecord=null),r.addrs&&r.addrs.length){i.addrs=[];for(var o=0;o<r.addrs.length;++o)i.addrs[o]=Wn.Addresses.Address.toObject(r.addrs[o],n)}return r.certifiedRecord!=null&&r.hasOwnProperty("certifiedRecord")&&(i.certifiedRecord=Wn.Addresses.CertifiedRecord.toObject(r.certifiedRecord,n)),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,qc.default.util.toJSONOptions)},t.Address=function(){function e(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}e.prototype.multiaddr=Dr.newBuffer([]),e.prototype.isCertified=null;let r;return Object.defineProperty(e.prototype,"_isCertified",{get:Dr.oneOfGetter(r=["isCertified"]),set:Dr.oneOfSetter(r)}),e.encode=function(i,o){return o||(o=nA.create()),i.multiaddr!=null&&Object.hasOwnProperty.call(i,"multiaddr")&&o.uint32(10).bytes(i.multiaddr),i.isCertified!=null&&Object.hasOwnProperty.call(i,"isCertified")&&o.uint32(16).bool(i.isCertified),o},e.decode=function(i,o){i instanceof L0||(i=L0.create(i));for(var s=o===void 0?i.len:i.pos+o,a=new Wn.Addresses.Address;i.pos<s;){var l=i.uint32();switch(l>>>3){case 1:a.multiaddr=i.bytes();break;case 2:a.isCertified=i.bool();break;default:i.skipType(l&7);break}}return a},e.fromObject=function(i){if(i instanceof Wn.Addresses.Address)return i;var o=new Wn.Addresses.Address;return i.multiaddr!=null&&(typeof i.multiaddr=="string"?Dr.base64.decode(i.multiaddr,o.multiaddr=Dr.newBuffer(Dr.base64.length(i.multiaddr)),0):i.multiaddr.length&&(o.multiaddr=i.multiaddr)),i.isCertified!=null&&(o.isCertified=Boolean(i.isCertified)),o},e.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(o.bytes===String?s.multiaddr="":(s.multiaddr=[],o.bytes!==Array&&(s.multiaddr=Dr.newBuffer(s.multiaddr)))),i.multiaddr!=null&&i.hasOwnProperty("multiaddr")&&(s.multiaddr=o.bytes===String?Dr.base64.encode(i.multiaddr,0,i.multiaddr.length):o.bytes===Array?Array.prototype.slice.call(i.multiaddr):i.multiaddr),i.isCertified!=null&&i.hasOwnProperty("isCertified")&&(s.isCertified=i.isCertified,o.oneofs&&(s._isCertified="isCertified")),s},e.prototype.toJSON=function(){return this.constructor.toObject(this,qc.default.util.toJSONOptions)},e}(),t.CertifiedRecord=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.seq=Dr.Long?Dr.Long.fromBits(0,0,!0):0,e.prototype.raw=Dr.newBuffer([]),e.encode=function(n,i){return i||(i=nA.create()),n.seq!=null&&Object.hasOwnProperty.call(n,"seq")&&i.uint32(8).uint64(n.seq),n.raw!=null&&Object.hasOwnProperty.call(n,"raw")&&i.uint32(18).bytes(n.raw),i},e.decode=function(n,i){n instanceof L0||(n=L0.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new Wn.Addresses.CertifiedRecord;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.seq=n.uint64();break;case 2:s.raw=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Wn.Addresses.CertifiedRecord)return n;var i=new Wn.Addresses.CertifiedRecord;return n.seq!=null&&(Dr.Long?(i.seq=Dr.Long.fromValue(n.seq)).unsigned=!0:typeof n.seq=="string"?i.seq=parseInt(n.seq,10):typeof n.seq=="number"?i.seq=n.seq:typeof n.seq=="object"&&(i.seq=new Dr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0))),n.raw!=null&&(typeof n.raw=="string"?Dr.base64.decode(n.raw,i.raw=Dr.newBuffer(Dr.base64.length(n.raw)),0):n.raw.length&&(i.raw=n.raw)),i},e.toObject=function(n,i){i||(i={});var o={};if(i.defaults){if(Dr.Long){var s=new Dr.Long(0,0,!0);o.seq=i.longs===String?s.toString():i.longs===Number?s.toNumber():s}else o.seq=i.longs===String?"0":0;i.bytes===String?o.raw="":(o.raw=[],i.bytes!==Array&&(o.raw=Dr.newBuffer(o.raw)))}return n.seq!=null&&n.hasOwnProperty("seq")&&(typeof n.seq=="number"?o.seq=i.longs===String?String(n.seq):n.seq:o.seq=i.longs===String?Dr.Long.prototype.toString.call(n.seq):i.longs===Number?new Dr.LongBits(n.seq.low>>>0,n.seq.high>>>0).toNumber(!0):n.seq),n.raw!=null&&n.hasOwnProperty("raw")&&(o.raw=i.bytes===String?Dr.base64.encode(n.raw,0,n.raw.length):i.bytes===Array?Array.prototype.slice.call(n.raw):n.raw),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,qc.default.util.toJSONOptions)},e}(),t})();c();var zc=E(pa(),1),B0=zc.default.Reader,oA=zc.default.Writer,er=zc.default.util,gn=zc.default.roots.default||(zc.default.roots.default={}),sA=gn.Peer=(()=>{function t(r){if(this.addresses=[],this.protocols=[],this.metadata=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.addresses=er.emptyArray,t.prototype.protocols=er.emptyArray,t.prototype.metadata=er.emptyArray,t.prototype.pubKey=null,t.prototype.peerRecordEnvelope=null;let e;return Object.defineProperty(t.prototype,"_pubKey",{get:er.oneOfGetter(e=["pubKey"]),set:er.oneOfSetter(e)}),Object.defineProperty(t.prototype,"_peerRecordEnvelope",{get:er.oneOfGetter(e=["peerRecordEnvelope"]),set:er.oneOfSetter(e)}),t.encode=function(n,i){if(i||(i=oA.create()),n.addresses!=null&&n.addresses.length)for(var o=0;o<n.addresses.length;++o)gn.Address.encode(n.addresses[o],i.uint32(10).fork()).ldelim();if(n.protocols!=null&&n.protocols.length)for(var o=0;o<n.protocols.length;++o)i.uint32(18).string(n.protocols[o]);if(n.metadata!=null&&n.metadata.length)for(var o=0;o<n.metadata.length;++o)gn.Metadata.encode(n.metadata[o],i.uint32(26).fork()).ldelim();return n.pubKey!=null&&Object.hasOwnProperty.call(n,"pubKey")&&i.uint32(34).bytes(n.pubKey),n.peerRecordEnvelope!=null&&Object.hasOwnProperty.call(n,"peerRecordEnvelope")&&i.uint32(42).bytes(n.peerRecordEnvelope),i},t.decode=function(n,i){n instanceof B0||(n=B0.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new gn.Peer;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.addresses&&s.addresses.length||(s.addresses=[]),s.addresses.push(gn.Address.decode(n,n.uint32()));break;case 2:s.protocols&&s.protocols.length||(s.protocols=[]),s.protocols.push(n.string());break;case 3:s.metadata&&s.metadata.length||(s.metadata=[]),s.metadata.push(gn.Metadata.decode(n,n.uint32()));break;case 4:s.pubKey=n.bytes();break;case 5:s.peerRecordEnvelope=n.bytes();break;default:n.skipType(a&7);break}}return s},t.fromObject=function(n){if(n instanceof gn.Peer)return n;var i=new gn.Peer;if(n.addresses){if(!Array.isArray(n.addresses))throw TypeError(".Peer.addresses: array expected");i.addresses=[];for(var o=0;o<n.addresses.length;++o){if(typeof n.addresses[o]!="object")throw TypeError(".Peer.addresses: object expected");i.addresses[o]=gn.Address.fromObject(n.addresses[o])}}if(n.protocols){if(!Array.isArray(n.protocols))throw TypeError(".Peer.protocols: array expected");i.protocols=[];for(var o=0;o<n.protocols.length;++o)i.protocols[o]=String(n.protocols[o])}if(n.metadata){if(!Array.isArray(n.metadata))throw TypeError(".Peer.metadata: array expected");i.metadata=[];for(var o=0;o<n.metadata.length;++o){if(typeof n.metadata[o]!="object")throw TypeError(".Peer.metadata: object expected");i.metadata[o]=gn.Metadata.fromObject(n.metadata[o])}}return n.pubKey!=null&&(typeof n.pubKey=="string"?er.base64.decode(n.pubKey,i.pubKey=er.newBuffer(er.base64.length(n.pubKey)),0):n.pubKey.length&&(i.pubKey=n.pubKey)),n.peerRecordEnvelope!=null&&(typeof n.peerRecordEnvelope=="string"?er.base64.decode(n.peerRecordEnvelope,i.peerRecordEnvelope=er.newBuffer(er.base64.length(n.peerRecordEnvelope)),0):n.peerRecordEnvelope.length&&(i.peerRecordEnvelope=n.peerRecordEnvelope)),i},t.toObject=function(n,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.addresses=[],o.protocols=[],o.metadata=[]),n.addresses&&n.addresses.length){o.addresses=[];for(var s=0;s<n.addresses.length;++s)o.addresses[s]=gn.Address.toObject(n.addresses[s],i)}if(n.protocols&&n.protocols.length){o.protocols=[];for(var s=0;s<n.protocols.length;++s)o.protocols[s]=n.protocols[s]}if(n.metadata&&n.metadata.length){o.metadata=[];for(var s=0;s<n.metadata.length;++s)o.metadata[s]=gn.Metadata.toObject(n.metadata[s],i)}return n.pubKey!=null&&n.hasOwnProperty("pubKey")&&(o.pubKey=i.bytes===String?er.base64.encode(n.pubKey,0,n.pubKey.length):i.bytes===Array?Array.prototype.slice.call(n.pubKey):n.pubKey,i.oneofs&&(o._pubKey="pubKey")),n.peerRecordEnvelope!=null&&n.hasOwnProperty("peerRecordEnvelope")&&(o.peerRecordEnvelope=i.bytes===String?er.base64.encode(n.peerRecordEnvelope,0,n.peerRecordEnvelope.length):i.bytes===Array?Array.prototype.slice.call(n.peerRecordEnvelope):n.peerRecordEnvelope,i.oneofs&&(o._peerRecordEnvelope="peerRecordEnvelope")),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,zc.default.util.toJSONOptions)},t})(),Zit=gn.Address=(()=>{function t(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}t.prototype.multiaddr=er.newBuffer([]),t.prototype.isCertified=null;let e;return Object.defineProperty(t.prototype,"_isCertified",{get:er.oneOfGetter(e=["isCertified"]),set:er.oneOfSetter(e)}),t.encode=function(n,i){return i||(i=oA.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),n.isCertified!=null&&Object.hasOwnProperty.call(n,"isCertified")&&i.uint32(16).bool(n.isCertified),i},t.decode=function(n,i){n instanceof B0||(n=B0.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new gn.Address;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;case 2:s.isCertified=n.bool();break;default:n.skipType(a&7);break}}return s},t.fromObject=function(n){if(n instanceof gn.Address)return n;var i=new gn.Address;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?er.base64.decode(n.multiaddr,i.multiaddr=er.newBuffer(er.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),n.isCertified!=null&&(i.isCertified=Boolean(n.isCertified)),i},t.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=er.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?er.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),n.isCertified!=null&&n.hasOwnProperty("isCertified")&&(o.isCertified=n.isCertified,i.oneofs&&(o._isCertified="isCertified")),o},t.prototype.toJSON=function(){return this.constructor.toObject(this,zc.default.util.toJSONOptions)},t})(),Jit=gn.Metadata=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.key="",t.prototype.value=er.newBuffer([]),t.encode=function(r,n){return n||(n=oA.create()),r.key!=null&&Object.hasOwnProperty.call(r,"key")&&n.uint32(10).string(r.key),r.value!=null&&Object.hasOwnProperty.call(r,"value")&&n.uint32(18).bytes(r.value),n},t.decode=function(r,n){r instanceof B0||(r=B0.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new gn.Metadata;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.key=r.string();break;case 2:o.value=r.bytes();break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof gn.Metadata)return r;var n=new gn.Metadata;return r.key!=null&&(n.key=String(r.key)),r.value!=null&&(typeof r.value=="string"?er.base64.decode(r.value,n.value=er.newBuffer(er.base64.length(r.value)),0):r.value.length&&(n.value=r.value)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(i.key="",n.bytes===String?i.value="":(i.value=[],n.bytes!==Array&&(i.value=er.newBuffer(i.value)))),r.key!=null&&r.hasOwnProperty("key")&&(i.key=r.key),r.value!=null&&r.hasOwnProperty("value")&&(i.value=n.bytes===String?er.base64.encode(r.value,0,r.value.length):n.bytes===Array?Array.prototype.slice.call(r.value):r.value),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,zc.default.util.toJSONOptions)},t})();c();var Lh=E(pa(),1),DY=Lh.default.Reader,fve=Lh.default.Writer,Or=Lh.default.util,n8=Lh.default.roots.default||(Lh.default.roots.default={}),OY=n8.Envelope=(()=>{function t(e){if(e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.publicKey=Or.newBuffer([]),t.prototype.payloadType=Or.newBuffer([]),t.prototype.payload=Or.newBuffer([]),t.prototype.signature=Or.newBuffer([]),t.encode=function(r,n){return n||(n=fve.create()),r.publicKey!=null&&Object.hasOwnProperty.call(r,"publicKey")&&n.uint32(10).bytes(r.publicKey),r.payloadType!=null&&Object.hasOwnProperty.call(r,"payloadType")&&n.uint32(18).bytes(r.payloadType),r.payload!=null&&Object.hasOwnProperty.call(r,"payload")&&n.uint32(26).bytes(r.payload),r.signature!=null&&Object.hasOwnProperty.call(r,"signature")&&n.uint32(42).bytes(r.signature),n},t.decode=function(r,n){r instanceof DY||(r=DY.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new n8.Envelope;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.publicKey=r.bytes();break;case 2:o.payloadType=r.bytes();break;case 3:o.payload=r.bytes();break;case 5:o.signature=r.bytes();break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof n8.Envelope)return r;var n=new n8.Envelope;return r.publicKey!=null&&(typeof r.publicKey=="string"?Or.base64.decode(r.publicKey,n.publicKey=Or.newBuffer(Or.base64.length(r.publicKey)),0):r.publicKey.length&&(n.publicKey=r.publicKey)),r.payloadType!=null&&(typeof r.payloadType=="string"?Or.base64.decode(r.payloadType,n.payloadType=Or.newBuffer(Or.base64.length(r.payloadType)),0):r.payloadType.length&&(n.payloadType=r.payloadType)),r.payload!=null&&(typeof r.payload=="string"?Or.base64.decode(r.payload,n.payload=Or.newBuffer(Or.base64.length(r.payload)),0):r.payload.length&&(n.payload=r.payload)),r.signature!=null&&(typeof r.signature=="string"?Or.base64.decode(r.signature,n.signature=Or.newBuffer(Or.base64.length(r.signature)),0):r.signature.length&&(n.signature=r.signature)),n},t.toObject=function(r,n){n||(n={});var i={};return n.defaults&&(n.bytes===String?i.publicKey="":(i.publicKey=[],n.bytes!==Array&&(i.publicKey=Or.newBuffer(i.publicKey))),n.bytes===String?i.payloadType="":(i.payloadType=[],n.bytes!==Array&&(i.payloadType=Or.newBuffer(i.payloadType))),n.bytes===String?i.payload="":(i.payload=[],n.bytes!==Array&&(i.payload=Or.newBuffer(i.payload))),n.bytes===String?i.signature="":(i.signature=[],n.bytes!==Array&&(i.signature=Or.newBuffer(i.signature)))),r.publicKey!=null&&r.hasOwnProperty("publicKey")&&(i.publicKey=n.bytes===String?Or.base64.encode(r.publicKey,0,r.publicKey.length):n.bytes===Array?Array.prototype.slice.call(r.publicKey):r.publicKey),r.payloadType!=null&&r.hasOwnProperty("payloadType")&&(i.payloadType=n.bytes===String?Or.base64.encode(r.payloadType,0,r.payloadType.length):n.bytes===Array?Array.prototype.slice.call(r.payloadType):r.payloadType),r.payload!=null&&r.hasOwnProperty("payload")&&(i.payload=n.bytes===String?Or.base64.encode(r.payload,0,r.payload.length):n.bytes===Array?Array.prototype.slice.call(r.payload):r.payload),r.signature!=null&&r.hasOwnProperty("signature")&&(i.signature=n.bytes===String?Or.base64.encode(r.signature,0,r.signature.length):n.bytes===Array?Array.prototype.slice.call(r.signature):r.signature),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Lh.default.util.toJSONOptions)},t})();c();var Pu=E(pa(),1),i8=Pu.default.Reader,LY=Pu.default.Writer,Gr=Pu.default.util,zs=Pu.default.roots.default||(Pu.default.roots.default={}),BY=zs.PeerRecord=(()=>{function t(e){if(this.addresses=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.peerId=Gr.newBuffer([]),t.prototype.seq=Gr.Long?Gr.Long.fromBits(0,0,!0):0,t.prototype.addresses=Gr.emptyArray,t.encode=function(r,n){if(n||(n=LY.create()),r.peerId!=null&&Object.hasOwnProperty.call(r,"peerId")&&n.uint32(10).bytes(r.peerId),r.seq!=null&&Object.hasOwnProperty.call(r,"seq")&&n.uint32(16).uint64(r.seq),r.addresses!=null&&r.addresses.length)for(var i=0;i<r.addresses.length;++i)zs.PeerRecord.AddressInfo.encode(r.addresses[i],n.uint32(26).fork()).ldelim();return n},t.decode=function(r,n){r instanceof i8||(r=i8.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new zs.PeerRecord;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.peerId=r.bytes();break;case 2:o.seq=r.uint64();break;case 3:o.addresses&&o.addresses.length||(o.addresses=[]),o.addresses.push(zs.PeerRecord.AddressInfo.decode(r,r.uint32()));break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof zs.PeerRecord)return r;var n=new zs.PeerRecord;if(r.peerId!=null&&(typeof r.peerId=="string"?Gr.base64.decode(r.peerId,n.peerId=Gr.newBuffer(Gr.base64.length(r.peerId)),0):r.peerId.length&&(n.peerId=r.peerId)),r.seq!=null&&(Gr.Long?(n.seq=Gr.Long.fromValue(r.seq)).unsigned=!0:typeof r.seq=="string"?n.seq=parseInt(r.seq,10):typeof r.seq=="number"?n.seq=r.seq:typeof r.seq=="object"&&(n.seq=new Gr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0))),r.addresses){if(!Array.isArray(r.addresses))throw TypeError(".PeerRecord.addresses: array expected");n.addresses=[];for(var i=0;i<r.addresses.length;++i){if(typeof r.addresses[i]!="object")throw TypeError(".PeerRecord.addresses: object expected");n.addresses[i]=zs.PeerRecord.AddressInfo.fromObject(r.addresses[i])}}return n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.addresses=[]),n.defaults)if(n.bytes===String?i.peerId="":(i.peerId=[],n.bytes!==Array&&(i.peerId=Gr.newBuffer(i.peerId))),Gr.Long){var o=new Gr.Long(0,0,!0);i.seq=n.longs===String?o.toString():n.longs===Number?o.toNumber():o}else i.seq=n.longs===String?"0":0;if(r.peerId!=null&&r.hasOwnProperty("peerId")&&(i.peerId=n.bytes===String?Gr.base64.encode(r.peerId,0,r.peerId.length):n.bytes===Array?Array.prototype.slice.call(r.peerId):r.peerId),r.seq!=null&&r.hasOwnProperty("seq")&&(typeof r.seq=="number"?i.seq=n.longs===String?String(r.seq):r.seq:i.seq=n.longs===String?Gr.Long.prototype.toString.call(r.seq):n.longs===Number?new Gr.LongBits(r.seq.low>>>0,r.seq.high>>>0).toNumber(!0):r.seq),r.addresses&&r.addresses.length){i.addresses=[];for(var s=0;s<r.addresses.length;++s)i.addresses[s]=zs.PeerRecord.AddressInfo.toObject(r.addresses[s],n)}return i},t.prototype.toJSON=function(){return this.constructor.toObject(this,Pu.default.util.toJSONOptions)},t.AddressInfo=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.multiaddr=Gr.newBuffer([]),e.encode=function(n,i){return i||(i=LY.create()),n.multiaddr!=null&&Object.hasOwnProperty.call(n,"multiaddr")&&i.uint32(10).bytes(n.multiaddr),i},e.decode=function(n,i){n instanceof i8||(n=i8.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new zs.PeerRecord.AddressInfo;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.multiaddr=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof zs.PeerRecord.AddressInfo)return n;var i=new zs.PeerRecord.AddressInfo;return n.multiaddr!=null&&(typeof n.multiaddr=="string"?Gr.base64.decode(n.multiaddr,i.multiaddr=Gr.newBuffer(Gr.base64.length(n.multiaddr)),0):n.multiaddr.length&&(i.multiaddr=n.multiaddr)),i},e.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.multiaddr="":(o.multiaddr=[],i.bytes!==Array&&(o.multiaddr=Gr.newBuffer(o.multiaddr)))),n.multiaddr!=null&&n.hasOwnProperty("multiaddr")&&(o.multiaddr=i.bytes===String?Gr.base64.encode(n.multiaddr,0,n.multiaddr.length):i.bytes===Array?Array.prototype.slice.call(n.multiaddr):n.multiaddr),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,Pu.default.util.toJSONOptions)},e}(),t})();var aA=E(Y4(),1);cA.default.util.Long=void 0;cA.default.configure();async function hve(t,e=()=>{}){e(0,"Storing each peerstore key under a single datastore key"),await t.datastore.open();let r={},n=[];for await(let{key:i,value:o}of t.datastore.query({prefix:"/peers"})){n.push(i);let s=i.toString(),[a,l,u,f,h]=s.split("/");if(l==="peers"&&!!["protos","addrs","metadata","keys"].includes(u)&&!!f)if(r[f]=r[f]||{addresses:[],protocols:[],metadata:[]},u==="protos"){let p=rA.decode(o);r[f].protocols=p.protocols.sort()}else if(u==="addrs"){let p=iA.decode(o);r[f].addresses=p.addrs.sort((d,m)=>new aA.Multiaddr(d.multiaddr).toString().localeCompare(new aA.Multiaddr(m.multiaddr).toString())),p.certifiedRecord&&p.certifiedRecord.raw&&(r[f].peerRecordEnvelope=p.certifiedRecord.raw)}else u==="metadata"?r[f].metadata.push({key:h,value:o}):u==="keys"&&(r[f].pubKey=o)}e(33,"Read peer data from store");for(let i of n)await t.datastore.delete(i);e(66,"Removed existing peer data from store");for(let i of Object.keys(r)){let o=r[i];o.metadata=o.metadata.sort((a,l)=>a.key.localeCompare(l.key));let s=sA.encode(o).finish();await t.datastore.put(new ae(`/peers/${i}`),s)}await t.datastore.close(),e(100,"Stored each peerstore key under a single datastore key")}async function dve(t,e=()=>{}){e(0,"Storing each peerstore key under a multiple datastore keys"),await t.datastore.open();let r={},n=[];for await(let{key:i,value:o}of t.datastore.query({prefix:"/peers"})){n.push(i);let s=i.toString(),[a,l,u]=s.split("/");r[u]=sA.decode(o)}e(33,"Read peer data from store");for(let i of n)await t.datastore.delete(i);e(66,"Removed existing peer data from store");for(let[i,o]of Object.entries(r)){if(o.protocols&&o.protocols.length>0&&await t.datastore.put(new ae(`/peers/protos/${i}`),rA.encode({protocols:o.protocols}).finish()),o.addresses&&o.addresses.length>0){let s=o.peerRecordEnvelope,a;if(s){let l=OY.decode(s),u=BY.decode(l.payload);a={raw:s,seq:u.seq}}await t.datastore.put(new ae(`/peers/addrs/${i}`),iA.encode({addrs:o.addresses,certifiedRecord:a}).finish())}if(o.metadata&&o.metadata.length>0)for(let{key:s,value:a}of o.metadata)await t.datastore.put(new ae(`/peers/metadata/${i}/${s}`),a);o.pubKey&&await t.datastore.put(new ae(`/peers/keys/${i}`),o.pubKey)}await t.datastore.close(),e(100,"Stored each peerstore key under multiple datastore keys")}var MY={version:12,description:"Store each peerstore peer under a single datastore key",migrate:hve,revert:dve};var Bh={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0},o8=[Object.assign({version:1},Bh),Object.assign({version:2},Bh),Object.assign({version:3},Bh),Object.assign({version:4},Bh),Object.assign({version:5},Bh),Object.assign({version:6},Bh),Object.assign({version:7},Bh),gY,RY,CY,NY,MY];c();c();var UY=E(Oi(),1);var lA={};_t(lA,{InvalidValueError:()=>F0,MissingRepoOptionsError:()=>Ua,NonReversibleMigrationError:()=>M0,NotInitializedRepoError:()=>Nu,RequiredParameterError:()=>U0});c();var M0=class extends Error{constructor(e){super(e),this.name="NonReversibleMigrationError",this.code=M0.code,this.message=e}};M0.code="ERR_NON_REVERSIBLE_MIGRATION";var Nu=class extends Error{constructor(e){super(e),this.name="NotInitializedRepoError",this.code=Nu.code,this.message=e}};Nu.code="ERR_NOT_INITIALIZED_REPO";var U0=class extends Error{constructor(e){super(e),this.name="RequiredParameterError",this.code=U0.code,this.message=e}};U0.code="ERR_REQUIRED_PARAMETER";var F0=class extends Error{constructor(e){super(e),this.name="InvalidValueError",this.code=F0.code,this.message=e}};F0.code="ERR_INVALID_VALUE";var Ua=class extends Error{constructor(e){super(e),this.name="MissingRepoOptionsError",this.code=Ua.code,this.message=e}};Ua.code="ERR_MISSING_REPO_OPTIONS";var uA=(0,UY.default)("ipfs:repo:migrator:repo:init");async function FY(t){if(!t)throw new Ua("Please pass repo options when trying to open a repo");let e=t.root;try{await e.open();let r=await e.has(Fg),n=await e.has(TY);return!r||!n?(uA(`Version entry present: ${r}`),uA(`Config entry present: ${n}`),!1):!0}catch(r){return uA("While checking if repo is initialized error was thrown: "+r.message),!1}finally{if(e!==void 0)try{await e.close()}catch{}}}Ae();Re();async function fA(t){if(!await FY(t))throw new Nu("Repo is not initialized!");let e=t.root;await e.open();try{return parseInt(F(await e.get(Fg)))}finally{await e.close()}}async function Vg(t,e){if(!e)throw new Ua("Please pass repo options when trying to open a repo");let r=e.root;await r.open(),await r.put(Fg,U(String(t))),await r.close()}var KY=E(Oi(),1),Hs=(0,KY.default)("ipfs:repo:migrator");function mve(t){return t=t||o8,!Array.isArray(t)||t.length===0?0:t[t.length-1].version}async function VY(t,e,r,n,{ignoreLock:i=!1,onProgress:o,isDryRun:s=!1,migrations:a}){if(a=a||o8,!t)throw new es.RequiredParameterError("Path argument is required!");if(!r)throw new es.RequiredParameterError("repoOptions argument is required!");if(!n)throw new es.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(n)||n<=0)throw new es.InvalidValueError("Version has to be positive integer!");e=tA(e);let l=await fA(e);if(l===n){Hs("Nothing to migrate.");return}if(l>n)throw new es.InvalidValueError(`Current repo's version (${l}) is higher then toVersion (${n}), you probably wanted to revert it?`);zY(a,l,n);let u;!s&&!i&&(u=await r.repoLock.lock(t));try{for(let f of a){if(n!==void 0&&f.version>n)break;if(!(f.version<=l)){Hs(`Migrating version ${f.version}`);try{if(!s){let h=()=>{};o&&(h=(p,d)=>o(f.version,p.toFixed(2),d)),await f.migrate(e,h)}}catch(h){let p=f.version-1;throw Hs(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${p}`),await Vg(p,e),new Error(`During migration to version ${f.version} exception was raised: ${h.stack||h.message||h}`)}Hs(`Migrating to version ${f.version} finished`)}}s||await Vg(n||mve(a),e),Hs("Repo successfully migrated",n!==void 0?`to version ${n}!`:"to latest version!")}finally{!s&&!i&&u&&await u.close()}}async function qY(t,e,r,n,{ignoreLock:i=!1,onProgress:o,isDryRun:s=!1,migrations:a}){if(a=a||o8,!t)throw new es.RequiredParameterError("Path argument is required!");if(!r)throw new es.RequiredParameterError("repoOptions argument is required!");if(!n)throw new es.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(n)||n<=0)throw new es.InvalidValueError("Version has to be positive integer!");e=tA(e);let l=await fA(e);if(l===n){Hs("Nothing to revert.");return}if(l<n)throw new es.InvalidValueError(`Current repo's version (${l}) is lower then toVersion (${n}), you probably wanted to migrate it?`);zY(a,n,l,!0);let u;!s&&!i&&(u=await r.repoLock.lock(t)),Hs(`Reverting from version ${l} to ${n}`);try{let f=a.slice().reverse();for(let h of f){if(h.version<=n)break;if(!(h.version>l)){Hs(`Reverting migration version ${h.version}`);try{if(!s){let p=()=>{};o&&(p=(d,m)=>o(h.version,d.toFixed(2),m)),await h.revert(e,p)}}catch(p){let d=h.version;throw Hs(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${d}`),await Vg(d,e),p.message=`During reversion to version ${h.version} exception was raised: ${p.message}`,p}Hs(`Reverting to version ${h.version} finished`)}}s||await Vg(n,e),Hs(`All migrations successfully reverted to version ${n}!`)}finally{!s&&!i&&u&&await u.close()}}function zY(t,e,r,n=!1){let i=0;for(let o of t){if(o.version>r)break;if(o.version>e){if(n&&!o.revert)throw new es.NonReversibleMigrationError(`It is not possible to revert to version ${e} because migration version ${o.version} is not reversible. Cancelling reversion.`);i++}}if(i!==r-e)throw new es.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${e} to ${r}`)}var es=lA;var wX=E(GY(),1);c();var QY=E(Oi(),1);Re();Ae();c();c();var Mh=class extends Error{constructor(e){super(e),this.name="LockExistsError",this.code=Mh.code}};Mh.code="ERR_LOCK_EXISTS";var go=class extends Error{constructor(e){super(e),this.name="NotFoundError",this.code=go.code}};go.code="ERR_NOT_FOUND";var Uh=class extends Error{constructor(e){super(e),this.name="InvalidRepoVersionError",this.code=Uh.code}};Uh.code="ERR_INVALID_REPO_VERSION";var Fh="ERR_REPO_NOT_INITIALIZED",WY="ERR_REPO_ALREADY_OPEN",jY="ERR_REPO_ALREADY_CLOSED";async function a8(t,e,r){let n=await e(t);if(n)return n;let i=YY(r);return i?new Promise((o,s)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{o(Boolean(a.result))}}):!1}async function c8(t,e,r,n){if(await r(t))return e(t);let i=YY(n);if(!i)throw new go;return new Promise((o,s)=>{let a=i.store("readonly").get(t.toString());a.transaction.onabort=()=>{s(a.transaction.error)},a.transaction.oncomplete=()=>{if(a.result)return o(a.result);s(new go)}})}function YY(t){let e=t;for(;e.db||e.child;)if(e=e.db||e.child,e.type==="level-js"||e.constructor.name==="Level")return e}var vve=(0,QY.default)("ipfs:repo:version"),hA=new ae("version");function XY(t){return{async exists(){return a8(hA,t.has.bind(t),t)},async get(){let e=await c8(hA,t.get.bind(t),t.has.bind(t),t);return parseInt(F(e),10)},set(e){return t.put(hA,U(String(e)))},async check(e){let r=await this.get();return vve("comparing version: %s and %s",r,e),r===e||(r===6&&e===7||e===6&&r===7)}}}c();var h8=E(wA(),1),cQ=E(YT(),1),lQ=E(aQ(),1),d8=E(V(),1);Re();Ae();var Pve=h8.default.default?h8.default.default:h8.default,EA=new ae("config");function uQ(t){let e=new Pve({concurrency:1}),r={async getAll(o={}){let s=await c8(EA,t.get.bind(t),t.has.bind(t),t);return JSON.parse(F(s))},async get(o,s={}){if(o==null)throw new go(`Key ${o} does not exist in config`);let a=await this.getAll(s),l=(0,cQ.default)(a,o);if(l===void 0)throw new go(`Key ${o} does not exist in config`);return l},set(o,s,a={}){if(typeof o!="string"&&!(o instanceof String))throw(0,d8.default)(new Error("Invalid key type: "+typeof o),"ERR_INVALID_KEY");if(s===void 0||s instanceof Uint8Array)throw(0,d8.default)(new Error("Invalid value type: "+typeof s),"ERR_INVALID_VALUE");return e.add(()=>n({key:o,value:s},a.signal))},replace(o,s={}){if(!o||o instanceof Uint8Array)throw(0,d8.default)(new Error("Invalid value type: "+typeof o),"ERR_INVALID_VALUE");return e.add(()=>n({key:void 0,value:o},s.signal))},async exists(){return a8(EA,t.has.bind(t),t)}};return r;async function n(o,s){if(s&&s.aborted)return;let a=o.key,l=o.value;if(a){let u=await r.getAll();return typeof u=="object"&&u!==null&&(0,lQ.default)(u,a,l),i(u)}return i(l)}function i(o){let s=U(JSON.stringify(o,null,2));return t.put(EA,s)}}c();var dQ=E(hQ(),1);Re();Ae();var _A=new ae("datastore_spec");function pQ(t){return{exists(){return t.has(_A)},async get(){let e=await t.get(_A);return JSON.parse(F(e))},async set(e){return t.put(_A,U(JSON.stringify((0,dQ.default)(e,{deep:!0}))))}}}c();Ae();var vA=new ae("api");function mQ(t){return{async get(){let e=await t.get(vA);return e&&e.toString()},set(e){return t.put(vA,U(e.toString()))},delete(){return t.delete(vA)}}}c();var wQ=E(Hi(),1),EQ=E(yQ(),1),bQ=E(Ti(),1);te();var _Q=E(V(),1);gc();function vQ(t){return{open(){return t.open()},close(){return t.close()},query(e,r){return t.query(e,r)},queryKeys(e,r){return t.queryKeys(e,r)},async get(e,r){let n=Du(e);return n.isIdentity?Promise.resolve(n.digest):t.get(e,r)},async*getMany(e,r){for await(let n of e)yield this.get(n,r)},async put(e,r,n){let{isIdentity:i}=Du(e);i||await t.put(e,r,n)},async*putMany(e,r){let n=(0,EQ.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{await(0,bQ.default)(t.putMany(async function*(){for await(let{key:o,value:s}of e)Du(o).isIdentity||(yield{key:o,value:s}),n.push({key:o,value:s})}())),n.end()}catch(o){n.end(o)}}),yield*n},has(e,r){let{isIdentity:n}=Du(e);return n?Promise.resolve(!0):t.has(e,r)},delete(e,r){let{isIdentity:n}=Du(e);return n?Promise.resolve():t.delete(e,r)},deleteMany(e,r){return t.deleteMany((0,wQ.default)(e,n=>!Du(n).isIdentity),r)},batch(){let e=t.batch();return{put(r,n){let{isIdentity:i}=Du(r);i||e.put(r,n)},delete(r){let{isIdentity:n}=Du(r);n||e.delete(r)},commit:r=>e.commit(r)}}}}function Du(t){let e=T.asCID(t);if(e==null)throw(0,_Q.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return e.multihash.code!==hn.code?{isIdentity:!1}:{isIdentity:!0,digest:e.multihash.digest}}c();c();var SQ=E(Oi(),1),xQ=(0,SQ.default)("ipfs:repo:lock:memory"),RQ="repo.lock",qg={};async function Nve(t){let e=t+"/"+RQ;if(xQ("locking %s",e),qg[e]===!0)throw new Mh(`Lock already being held for file: ${e}`);return qg[e]=!0,{async close(){qg[e]&&delete qg[e]}}}async function kve(t){let e=t+"/"+RQ;return xQ(`checking lock: ${e}`),Boolean(qg[e])}var p8={lock:Nve,locked:kve};var TQ={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:p8};c();var xA={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};c();te();var CQ=E(V(),1),PQ=E(Oi(),1),TA=E(Kc(),1);Of();c();ap();Fo();var AQ=E(V(),1);si();On();function zg(t){let e=T.asCID(t);if(e==null)throw(0,AQ.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");let r=xt.encode(e.multihash.bytes);return new ae("/"+r.slice(1).toUpperCase(),!1)}function RA(t){return wr(xt.decode(`b${t.toString().toLowerCase().substring(1)}`))}c();var IQ=E(Oi(),1);var Dve=(0,IQ.default)("ipfs:repo:utils:walk-dag");async function*K0(t,e,r,n){try{let i=await e.get(t,n),o=await r(t.code),s=b0({bytes:i,cid:t,codec:o});for(let[,a]of s.links())yield a,yield*K0(a,e,r,n)}catch(i){throw Dve("Could not walk DAG for CID",t.toString(),i),i}}function Ove(t){let e=`Invalid type '${t}', must be one of {direct, indirect, recursive, all}`;return(0,CQ.default)(new Error(e),"ERR_INVALID_PIN_TYPE")}var m8=class{constructor({pinstore:e,blockstore:r,loadCodec:n}){this.pinstore=e,this.blockstore=r,this.loadCodec=n,this.log=(0,PQ.default)("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(e,r={}){await this.blockstore.get(e,r);let n={depth:0};return e.version!==0&&(n.version=e.version),e.code!==ht&&(n.codec=e.code),r.metadata&&(n.metadata=r.metadata),this.pinstore.put(zg(e),no(n))}unpin(e,r){return this.pinstore.delete(zg(e),r)}async pinRecursively(e,r={}){await this.fetchCompleteDag(e,r);let n={depth:1/0};e.version!==0&&(n.version=e.version),e.code!==ht&&(n.codec=e.code),r.metadata&&(n.metadata=r.metadata),await this.pinstore.put(zg(e),no(n))}async*directKeys(e){for await(let r of this.pinstore.query({filters:[n=>Mn(n.value).depth===0]})){let n=Mn(r.value),i=n.version||0,o=n.codec!=null?n.codec:ht,s=RA(r.key);yield{cid:T.create(i,o,s),metadata:n.metadata}}}async*recursiveKeys(e){for await(let r of this.pinstore.query({filters:[n=>Mn(n.value).depth===1/0]})){let n=Mn(r.value),i=n.version||0,o=n.codec!=null?n.codec:ht,s=RA(r.key);yield{cid:T.create(i,o,s),metadata:n.metadata}}}async*indirectKeys(e){for await(let{cid:r}of this.recursiveKeys())for await(let n of K0(r,this.blockstore,this.loadCodec,e)){let i=[vt.recursive];(await this.isPinnedWithType(n,i)).pinned||(yield n)}}async isPinnedWithType(e,r,n){Array.isArray(r)||(r=[r]);let i=r.includes(vt.all),o=r.includes(vt.direct),s=r.includes(vt.recursive),a=r.includes(vt.indirect);if(s||o||i){let f=await(0,TA.default)(this.pinstore.query({prefix:zg(e).toString(),filters:[h=>{if(i)return!0;let p=Mn(h.value);return r.includes(p.depth===0?vt.direct:vt.recursive)}],limit:1}));if(f){let h=Mn(f.value);return{cid:e,pinned:!0,reason:h.depth===0?vt.direct:vt.recursive,metadata:h.metadata}}}let l=this;async function*u(f,h){for await(let{cid:p}of h)for await(let d of K0(p,l.blockstore,l.loadCodec))if(d.equals(f)){yield p;return}}if(i||a){let f=await(0,TA.default)(u(e,this.recursiveKeys()));if(f)return{cid:e,pinned:!0,reason:vt.indirect,parent:f}}return{cid:e,pinned:!1}}async fetchCompleteDag(e,r){let n=new Set,i=async(o,s)=>{if(n.has(o.toString()))return;n.add(o.toString());let a=await this.blockstore.get(o,s),l=await this.loadCodec(o.code),u=b0({bytes:a,cid:o,codec:l});await Promise.all([...u.links()].map(([,f])=>i(f,s)))};await i(e,r)}static checkPinType(e){if(typeof e!="string"||!Object.keys(vt).includes(e))throw Ove(e);return!0}};c();var kQ=E(ei(),1),DQ=E(V(),1);function OQ(t,e){return{open(){return e.open()},close(){return e.close()},query(r,n){return e.query(r,n)},queryKeys(r,n){return e.queryKeys(r,n)},async get(r,n){return e.get(r,n)},async*getMany(r,n){yield*e.getMany(r,n)},async put(r,n,i){await e.put(r,n,i)},async*putMany(r,n){yield*e.putMany(r,n)},has(r,n){return e.has(r,n)},async delete(r,n){return await NQ(r,t),e.delete(r,n)},deleteMany(r,n){return e.deleteMany((0,kQ.default)(r,async i=>(await NQ(i,t),i)),n)},batch(){return e.batch()}}}async function NQ(t,e){let{pinned:r,reason:n}=await e.isPinnedWithType(t,vt.all);if(r)throw(0,DQ.default)(new Error(`pinned: ${n}`),"ERR_BLOCK_PINNED")}var EX=E(aX(),1);c();te();var fX=E(Oi(),1);var hX=E(z6(),1),dX=E(uX(),1),DA=E(Dc(),1),w8=E(ei(),1),pX=E(Hi(),1);si();var $g=(0,fX.default)("ipfs:repo:gc"),Wve=Rn().code,jve=256,Yve=new ae("/local/filesroot");function mX({gcLock:t,pins:e,blockstore:r,root:n,loadCodec:i}){async function*o(){let s=Date.now();$g("Creating set of marked blocks");let a=await t.writeLock();try{let l=await Qve({pins:e,blockstore:r,root:n,loadCodec:i}),u=r.queryKeys({});yield*Xve({blockstore:r},l,u),$g(`Complete (${Date.now()-s}ms)`)}finally{a()}}return o}async function Qve({pins:t,blockstore:e,loadCodec:r,root:n}){let i=async function*(){let a;try{a=await n.get(Yve)}catch(u){if(u.code===Wve){$g("No blocks in MFS");return}throw u}let l=T.decode(a);yield l,yield*K0(l,e,r)}(),o=(0,DA.default)((0,w8.default)(t.recursiveKeys(),({cid:a})=>a),t.indirectKeys(),(0,w8.default)(t.directKeys(),({cid:a})=>a),i),s=new Set;for await(let a of(0,DA.default)(o,i))s.add(xt.encode(a.multihash.bytes));return s}async function*Xve({blockstore:t},e,r){let n=0,i=0;yield*(0,dX.pipe)((0,hX.default)((0,w8.default)(r,async s=>async function(){n++;try{let l=xt.encode(s.multihash.bytes);if(e.has(l))return null;try{await t.delete(s),i++}catch(u){return{err:new Error(`Could not delete block with CID ${s}: ${u.message}`)}}return{cid:s}}catch(l){let u=`Could delete block with CID ${s}`;return $g(u,l),{err:new Error(u+`: ${l.message}`)}}}),jve),s=>(0,pX.default)(s,Boolean)),$g(`Marked set has ${e.size} unique blocks. Blockstore has ${n} blocks. Deleted ${i} blocks.`)}var ji=(0,yX.default)("ipfs:repo"),Zve=Number.MAX_SAFE_INTEGER,Jve="repoAutoMigrate",OA=class{constructor(e,r,n,i){if(typeof e!="string")throw new Error("missing repo path");if(typeof r!="function")throw new Error("missing codec loader");this.options=Ye(TQ,i),this.closed=!0,this.path=e,this.root=n.root,this.datastore=n.datastore,this.keys=n.keys;let o=n.blocks,s=n.pins;this.pins=new m8({pinstore:s,blockstore:o,loadCodec:r});let a=OQ(this.pins,o);this.blocks=vQ(a),this.version=XY(this.root),this.config=uQ(this.root),this.spec=pQ(this.root),this.apiAddr=mQ(this.root),this.gcLock=(0,EX.default)(e,{singleProcess:this.options.repoOwner!==!1}),this.gc=mX({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:r})}async init(e){ji("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(e9e(e)),await this.spec.set(t9e(e)),await this.version.set(12)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw(0,Vh.default)(new Error("repo is already open"),WY);ji("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),ji("acquired repo.lock"),!await this.version.check(12))if(await this._isAutoMigrationEnabled())await this._migrate(12,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new Uh("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");ji("creating datastore"),await this.datastore.open(),ji("creating blocks"),await this.blocks.open(),ji("creating keystore"),await this.keys.open(),ji("creating pins"),await this.pins.pinstore.open(),this.closed=!1,ji("all opened")}catch(e){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(r){ji("error removing lock",r)}throw e}}async _openRoot(){try{await this.root.open()}catch(e){if(e.message!=="Already open")throw e}}async _openLock(){let e=await this.options.repoLock.lock(this.path);if(typeof e.close!="function")throw(0,Vh.default)(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return e}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){ji("init check");let e;try{[e]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(r){throw r.code==="ERR_NOT_FOUND"?(0,Vh.default)(new Error("repo is not initialized yet"),Fh,{path:this.path}):r}if(!e)throw(0,Vh.default)(new Error("repo is not initialized yet"),Fh,{path:this.path})}async close(){if(this.closed)throw(0,Vh.default)(new Error("repo is already closed"),jY);ji("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(e){if(e.code!==Fh&&!e.message.startsWith("ENOENT"))throw e}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(e=>e&&e.close())),ji("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){let[e,r,n,i,o]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),gX(this.datastore),gX(this.keys)]),s=r.size+i+o;return{repoPath:this.path,storageMax:e,version:n,numObjects:r.count,repoSize:s}}throw(0,Vh.default)(new Error("repo is not initialized yet"),Fh,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let e;try{e=await this.config.get(Jve)}catch(r){if(r.code===go.code)e=!0;else throw r}return e}async _migrate(e,r){return await this.version.get()>e?(ji(`reverting to version ${e}`),qY(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(ji(`migrating to version ${e}`),VY(this.path,r,this.options,e,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{let e=await this.config.get("Datastore.StorageMax");return BigInt((0,wX.default)(e))}catch{return BigInt(Zve)}}async _blockStat(){let e=BigInt(0),r=BigInt(0);if(this.blocks)for await(let{key:n,value:i}of this.blocks.query({}))e+=BigInt(1),r+=BigInt(i.byteLength),r+=BigInt(n.bytes.byteLength);return{count:e,size:r}}};async function gX(t){let e=BigInt(0);for await(let r of t.query({}))e+=BigInt(r.value.byteLength),e+=BigInt(r.key.uint8Array().byteLength);return e}function bX(t,e,r,n){return new OA(t,e,r,n)}function e9e(t){return t.Datastore=Object.assign({},xA,(0,LA.default)(t,"datastore")),t}function t9e(t){let e={...xA.Spec,...(0,LA.default)(t,"Datastore.Spec")};return{type:e.type,mounts:e.mounts.map(r=>({mountpoint:r.mountpoint,type:r.child.type,path:r.child.path,shardFunc:r.child.shardFunc}))}}c();var uy=E(Hi(),1),XJ=E(ei(),1),FI=E(Jp(),1),KI=E(Gg(),1),ZJ=E(QJ(),1),qu=class extends $i{constructor(e,r){super(),this.path=e,this.opts=r,r&&r.db?(this.database=r.db,delete r.db):this.database=ZJ.default}_initDb(){return new Promise((e,r)=>{this.db=this.database(this.path,{...this.opts,valueEncoding:"binary",compression:!1},n=>{if(n)return r(n);e(this.db)})})}async open(){try{this.db?await this.db.open():this.db=await this._initDb()}catch(e){throw r0.dbOpenFailedError(e)}}async put(e,r){try{await this.db.put(e.toString(),r)}catch(n){throw r0.dbWriteFailedError(n)}}async get(e){let r;try{r=await this.db.get(e.toString())}catch(n){throw n.notFound?r0.notFoundError(n):r0.dbWriteFailedError(n)}return r}async has(e){try{await this.db.get(e.toString())}catch(r){if(r.notFound)return!1;throw r}return!0}async delete(e){try{await this.db.del(e.toString())}catch(r){throw r0.dbDeleteFailedError(r)}}close(){return this.db&&this.db.close()}batch(){let e=[];return{put:(r,n)=>{e.push({type:"put",key:r.toString(),value:n})},delete:r=>{e.push({type:"del",key:r.toString()})},commit:()=>this.db.batch(e)}}query(e){let r=this._query({values:!0,prefix:e.prefix});Array.isArray(e.filters)&&(r=e.filters.reduce((o,s)=>(0,uy.default)(o,s),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((o,s)=>(0,KI.default)(o,s),r));let{offset:n,limit:i}=e;if(n){let o=0;r=(0,uy.default)(r,()=>o++>=n)}return i&&(r=(0,FI.default)(r,i)),r}queryKeys(e){let r=(0,XJ.default)(this._query({values:!1,prefix:e.prefix}),({key:o})=>o);Array.isArray(e.filters)&&(r=e.filters.reduce((o,s)=>(0,uy.default)(o,s),r)),Array.isArray(e.orders)&&(r=e.orders.reduce((o,s)=>(0,KI.default)(o,s),r));let{offset:n,limit:i}=e;if(n){let o=0;r=(0,uy.default)(r,()=>o++>=n)}return i&&(r=(0,FI.default)(r,i)),r}_query(e){let r={keys:!0,keyAsBuffer:!0,values:e.values};if(e.prefix!=null){let n=e.prefix.toString();r.gte=n,r.lt=n+"\xFF"}return gRe(this.db.iterator(r))}};function gRe(t){return{[Symbol.asyncIterator](){return{next:()=>new Promise((e,r)=>{t.next((n,i,o)=>{if(n)return r(n);if(i==null)return t.end(s=>{if(s)return r(s);e({done:!0,value:void 0})});e({done:!1,value:{key:new ae(i,!1),value:o}})})}),return:()=>new Promise((e,r)=>{t.end(n=>{if(n)return r(n);e({done:!0,value:void 0})})})}}}}c();var HI=E(Ti(),1),$I=E(eee(),1);te();Fo();On();si();en();var nee=E(V(),1);c();var qI=E(Ti(),1),Zh=E(Hi(),1),zI=E(Jp(),1),ree=E(Bs(),1),tee=(t,e)=>async function*(){yield*(await(0,ree.default)(t)).sort(e)}(),Va=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(e,r,n){return Promise.reject(new Error(".put is not implemented"))}get(e,r){return Promise.reject(new Error(".get is not implemented"))}has(e,r){return Promise.reject(new Error(".has is not implemented"))}delete(e,r){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(e,r={}){for await(let{key:n,value:i}of e)await this.put(n,i,r),yield{key:n,value:i}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}async*deleteMany(e,r={}){for await(let n of e)await this.delete(n,r),yield n}batch(){let e=[],r=[];return{put(n,i){e.push({key:n,value:i})},delete(n){r.push(n)},commit:async n=>{await(0,qI.default)(this.putMany(e,n)),e=[],await(0,qI.default)(this.deleteMany(r,n)),r=[]}}}async*_all(e,r){throw new Error("._all is not implemented")}async*_allKeys(e,r){throw new Error("._allKeys is not implemented")}query(e,r){let n=this._all(e,r);if(e.prefix!=null&&(n=(0,Zh.default)(n,i=>i.key.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Zh.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>tee(i,o),n)),e.offset!=null){let i=0;n=(0,Zh.default)(n,()=>i++>=(e.offset||0))}return e.limit!=null&&(n=(0,zI.default)(n,e.limit)),n}queryKeys(e,r){let n=this._allKeys(e,r);if(e.prefix!=null&&(n=(0,Zh.default)(n,i=>i.toString().startsWith(e.prefix||""))),Array.isArray(e.filters)&&(n=e.filters.reduce((i,o)=>(0,Zh.default)(i,o),n)),Array.isArray(e.orders)&&(n=e.orders.reduce((i,o)=>tee(i,o),n)),e.offset!=null){let i=0;n=(0,Zh.default)(n,()=>i++>=e.offset)}return e.limit!=null&&(n=(0,zI.default)(n,e.limit)),n}};function n1(t){let e=T.asCID(t);if(!e)throw(0,nee.default)(new Error("Not a valid cid"),"ERR_INVALID_CID");return new ae("/"+xt.encode(e.multihash.bytes).slice(1).toUpperCase(),!1)}function zu(t){return T.createV1(Un,wr(xt.decode("b"+t.toString().slice(1).toLowerCase())))}function GI(t){let e=t.substring(0,1);if(e==="/")return GI(t.substring(1));let r;e.toLowerCase()==="b"?r=o=>xt.decode(o.toLowerCase()).subarray(2):e.toLowerCase()==="c"?r=o=>Tv.decode(o.toLowerCase()).subarray(2):e==="z"?r=o=>Oe.decode(o).subarray(2):e==="Q"?r=o=>Oe.decode("z"+o):r=o=>xt.decode("b"+o.toLowerCase()).subarray(2);let n;for(let o=1;o<t.length;o++)try{n=r(t.substring(0,o))}catch(s){if(s.message!=="Unexpected end of data")throw s}let i="/C";return n&&(i=`/${xt.encode(n).slice(1,-1).toUpperCase()||"C"}`),i}function yRe(t){return{...t,prefix:t.prefix?GI(t.prefix):void 0,filters:t.filters?t.filters.map(e=>r=>e({key:zu(r.key),value:r.value})):void 0,orders:t.orders?t.orders.map(e=>(r,n)=>e({key:zu(r.key),value:r.value},{key:zu(n.key),value:n.value})):void 0}}function wRe(t){return{...t,prefix:t.prefix?GI(t.prefix):void 0,filters:t.filters?t.filters.map(e=>r=>e(zu(r))):void 0,orders:t.orders?t.orders.map(e=>(r,n)=>e(zu(r),zu(n))):void 0}}var tE=class extends Va{constructor(e){super(),this.child=e}open(){return this.child.open()}close(){return this.child.close()}async*query(e,r){for await(let{key:n,value:i}of this.child.query(yRe(e),r))yield{key:zu(n),value:i}}async*queryKeys(e,r){for await(let n of this.child.queryKeys(wRe(e),r))yield zu(n)}async get(e,r){return this.child.get(n1(e),r)}async*getMany(e,r){for await(let n of e)yield this.get(n,r)}async put(e,r,n){await this.child.put(n1(e),r,n)}async*putMany(e,r){let n=(0,$I.default)();(globalThis.process&&globalThis.process.nextTick?globalThis.process.nextTick:globalThis.setImmediate||globalThis.setTimeout)(async()=>{try{let o=this.child;await(0,HI.default)(this.child.putMany(async function*(){for await(let s of e){let a=n1(s.key);await o.has(a,r)||(yield{key:a,value:s.value}),n.push(s)}}())),n.end()}catch(o){n.end(o)}}),yield*n}has(e,r){return this.child.has(n1(e),r)}delete(e,r){return this.child.delete(n1(e),r)}deleteMany(e,r){let n=(0,$I.default)();return(0,HI.default)(this.child.deleteMany(async function*(){for await(let i of e)yield n1(i),n.push(i);n.end()}(),r)).catch(i=>{n.end(i)}),n}};function iee(t,e,r){let n=r.path||"ipfs";return bX(n,i=>e.getCodec(i),{root:new qu(n,{prefix:"",version:2}),blocks:new tE(new qu(`${n}/blocks`,{prefix:"",version:2})),datastore:new qu(`${n}/datastore`,{prefix:"",version:2}),keys:new qu(`${n}/keys`,{prefix:"",version:2}),pins:new qu(`${n}/pins`,{prefix:"",version:2})},{autoMigrate:r.autoMigrate,onMigrationProgress:r.onMigrationProgress||t,repoLock:p8})}Ae();Re();c();var Qt=E(a6(),1);var Bfe=E(V(),1);c();c();c();c();var see=E(V(),1);Pr();Ae();var rE=E(ai(),1);Mr();c();var oee={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};c();var fy;(function(t){t.codec=()=>et({1:{name:"publicKey",codec:ve},2:{name:"payloadType",codec:ve},3:{name:"payload",codec:ve},5:{name:"signature",codec:ve}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(fy||(fy={}));var ERe,ln=class{constructor(e){let{peerId:r,payloadType:n,payload:i,signature:o}=e;this.peerId=r,this.payloadType=n,this.payload=i,this.signature=o}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=fy.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload,signature:this.signature})),this.marshaled}equals(e){return Me(this.marshal(),e.marshal())}async validate(e){let r=aee(e,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return await qi(this.peerId.publicKey).verify(r,this.signature)}};ERe=ln;ln.createFromProtobuf=async t=>{let e=fy.decode(t),r=await on(e.publicKey);return new ln({peerId:r,payloadType:e.payloadType,payload:e.payload,signature:e.signature})};ln.seal=async(t,e)=>{let r=t.domain,n=t.codec,i=t.marshal(),o=aee(r,n,i);if(e.privateKey==null)throw new Error("Missing private key");let a=await(await Hn(e.privateKey)).sign(o);return new ln({peerId:e,payloadType:n,payload:i,signature:a})};ln.openAndCertify=async(t,e)=>{let r=await ln.createFromProtobuf(t);if(!await r.validate(e))throw(0,see.default)(new Error("envelope signature is not valid for the given domain"),oee.ERR_SIGNATURE_NOT_VALID);return r};var aee=(t,e,r)=>{let n=U(t),i=rE.default.encode(n.byteLength),o=rE.default.encode(e.length),s=rE.default.encode(r.length);return Pe([new Uint8Array(i),n,new Uint8Array(o),e,new Uint8Array(s),r])};c();c();function cee(t,e){let r=(n,i)=>n.toString().localeCompare(i.toString());return t.length===e.length&&e.sort(r)&&t.sort(r).every((n,i)=>e[i].equals(n))}c();var hy;(function(t){let e;(function(r){r.codec=()=>et({1:{name:"multiaddr",codec:ve}}),r.encode=n=>Je(n,r.codec()),r.decode=n=>Ze(n,r.codec())})(e=t.AddressInfo||(t.AddressInfo={})),t.codec=()=>et({1:{name:"peerId",codec:ve},2:{name:"seq",codec:jl},3:{name:"addresses",codec:t.AddressInfo.codec(),repeats:!0}}),t.encode=r=>Je(r,t.codec()),t.decode=r=>Ze(r,t.codec())})(hy||(hy={}));c();var lee="libp2p-peer-record",uee=Uint8Array.from([3,1]);var wn=class{constructor(e){this.domain=wn.DOMAIN,this.codec=wn.CODEC;let{peerId:r,multiaddrs:n,seqNumber:i}=e;this.peerId=r,this.multiaddrs=n??[],this.seqNumber=i??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=hy.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(e=>({multiaddr:e.bytes}))})),this.marshaled}equals(e){return!(!(e instanceof wn)||!this.peerId.equals(e.peerId)||this.seqNumber!==e.seqNumber||!cee(this.multiaddrs,e.multiaddrs))}};wn.createFromProtobuf=t=>{let e=hy.decode(t),r=Rr(e.peerId),n=(e.addresses??[]).map(o=>new W(o.multiaddr)),i=e.seq;return new wn({peerId:r,multiaddrs:n,seqNumber:i})};wn.DOMAIN=lee;wn.CODEC=uee;c();c();var nE=Symbol.for("@libp2p/topology");function fee(t){return t!=null&&Boolean(t[nE])}var hee=()=>{},WI=class{constructor(e){this.min=e.min??0,this.max=e.max??1/0,this.peers=new Set,this.onConnect=e.onConnect??hee,this.onDisconnect=e.onDisconnect??hee}get[Symbol.toStringTag](){return nE.toString()}get[nE](){return!0}async setRegistrar(e){this.registrar=e}disconnect(e){this.onDisconnect(e)}};function i1(t){return new WI(t)}c();c();var Jh=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Qc,Ue=class extends EventTarget{constructor(){super(...arguments),Qc.set(this,new Map)}listenerCount(e){let r=Jh(this,Qc,"f").get(e);return r==null?0:r.length}addEventListener(e,r,n){super.addEventListener(e,r,n);let i=Jh(this,Qc,"f").get(e);i==null&&(i=[],Jh(this,Qc,"f").set(e,i)),i.push({callback:r,once:(n!==!0&&n!==!1&&n?.once)??!1})}removeEventListener(e,r,n){super.removeEventListener(e,r,n);let i=Jh(this,Qc,"f").get(e);i!=null&&(i=i.filter(({callback:o})=>o!==r),Jh(this,Qc,"f").set(e,i))}dispatchEvent(e){let r=super.dispatchEvent(e),n=Jh(this,Qc,"f").get(e.type);return n==null||(n=n.filter(({once:i})=>!i),Jh(this,Qc,"f").set(e.type,n)),r}};Qc=new WeakMap;var jI=class extends Event{constructor(e,r){super(e,r),this.detail=r?.detail}},ee=globalThis.CustomEvent??jI;c();c();c();var YI=E(ai(),1),o1=(t,e,r)=>{let n=YI.default.encode(t,e,r);return o1.bytes=YI.default.encode.bytes,e??Uint8Array.from(n)};o1.bytes=0;var dee=8,bRe=10*1024;function Cr(t){t=t??{};let e=Math.max(t.poolSize??bRe,t.minPoolSize??dee),r=t.lengthEncoder??o1;return async function*(i){let o=new Uint8Array(e),s=0;for await(let a of i){r(a.length,o,s);let l=o.slice(s,s+r.bytes);s+=r.bytes,o.length-s<dee&&(o=new Uint8Array(e),s=0),yield Pe([l,a.slice()],l.length+a.length)}}}Cr.single=(t,e)=>{e=e??{};let r=e.lengthEncoder??o1;return new Ve(r(t.length),t.slice())};c();c();var QI=E(ai(),1),dy=t=>{let e=QI.default.decode(t);return dy.bytes=QI.default.decode.bytes,e};dy.bytes=0;var iE=E(V(),1),_Re=8,vRe=1024*1024*4,SRe=new Ve,Hu={LENGTH:"readLength",DATA:"readData"},xRe={[Hu.LENGTH]:(t,e,r,n)=>{let i=n?.lengthDecoder??dy,o=n?.maxLengthLength??_Re,s=n?.maxDataLength??vRe;e.append(t);let a;try{a=i(e.slice())}catch(l){if(e.length>o)throw(0,iE.default)(new Error("message length too long"),"ERR_MSG_LENGTH_TOO_LONG");if(l instanceof RangeError)return{mode:Hu.LENGTH,buffer:e,chunk:void 0,state:void 0,data:void 0};throw l}if(a>s)throw(0,iE.default)(new Error("message data too long"),"ERR_MSG_DATA_TOO_LONG");return t=e.subarray(i.bytes),e=new Ve,n?.onLength!=null&&n.onLength(a),a<=0?{mode:Hu.LENGTH,chunk:t,buffer:e,data:SRe}:{mode:Hu.DATA,chunk:t,buffer:e,state:{dataLength:a},data:void 0}},[Hu.DATA]:(t,e,r,n)=>{if(e.append(t),r==null)throw new Error("state is required");if(e.length<r.dataLength)return{mode:Hu.DATA,buffer:e,state:r,chunk:void 0,data:void 0};let{dataLength:i}=r,o=e.subarray(0,i),s=e.length>i?e.subarray(i):void 0;return e=new Ve,{mode:Hu.LENGTH,chunk:s,buffer:e,state:void 0,data:o}}};function gr(t){return async function*(r){let n=new Ve,i=Hu.LENGTH,o;for await(let s of r){let a=new Ve(s);for(;a!=null;){let l=xRe[i](a,n,o,t);if(i=l.mode,a=l.chunk,n=l.buffer,o=l.state,l.data!=null){let u=l.data.slice();t?.onData!=null&&t.onData(u),yield u}}}if(n.length>0)throw(0,iE.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}gr.fromReader=(t,e)=>{let r=1,n=async function*(){for(;;)try{let{done:o,value:s}=await t.next(r);if(o===!0)return;s!=null&&(yield s)}catch(o){if(o.code==="ERR_UNDER_READ")return{done:!0,value:null};throw o}finally{r=1}}();return gr({...e??{},onLength:o=>{r=o}})(n)};c();c();function pee(t){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}var mee=(t,e,r)=>(e=e??pee(4),new DataView(e.buffer,e.byteOffset,e.byteLength).setInt32(r??0,t,!1),e);mee.bytes=4;c();var gee=t=>{if(t.length<4)throw RangeError("Could not decode int32BE");return new DataView(t.buffer,t.byteOffset,t.byteLength).getInt32(0,!1)};gee.bytes=4;c();c();var $u=class extends Error{constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};c();function yee(t){if(t!=null){if(typeof t[Symbol.iterator]=="function")return t[Symbol.iterator]();if(typeof t[Symbol.asyncIterator]=="function")return t[Symbol.asyncIterator]();if(typeof t.next=="function")return t}throw new Error("argument is not an iterator or iterable")}function Pn(t,e,r){let n=r??{},i=yee(t);async function*o(){let s,a=()=>{s?.()};for(e.addEventListener("abort",a);;){let l;try{if(e.aborted){let{abortMessage:f,abortCode:h}=n;throw new $u(f,h)}let u=new Promise((f,h)=>{s=()=>{let{abortMessage:p,abortCode:d}=n;h(new $u(p,d))}});l=await Promise.race([u,i.next()]),s=null}catch(u){e.removeEventListener("abort",a);let f=u.type==="aborted"&&e.aborted;if(f&&n.onAbort!=null&&await n.onAbort(t),typeof i.return=="function")try{let h=i.return();h instanceof Promise&&h.catch(p=>{n.onReturnError!=null&&n.onReturnError(p)})}catch(h){n.onReturnError!=null&&n.onReturnError(h)}if(f&&n.returnOnAbort===!0)return;throw u}if(l.done===!0)break;yield l.value}e.removeEventListener("abort",a)}return o()}function RRe(t,e,r){return n=>t(Pn(n,e,r))}function ns(t,e,r){return{sink:RRe(t.sink,e,{...r,onAbort:void 0}),source:Pn(t.source,e,r)}}var TRe=C("libp2p-pubsub:peer-streams"),oE=class extends Ue{constructor(e){super(),this.id=e.id,this.protocol=e.protocol,this._inboundAbortController=new AbortController,this.closed=!1}get isReadable(){return Boolean(this.inboundStream)}get isWritable(){return Boolean(this.outboundStream)}write(e){if(this.outboundStream==null){let r=this.id.toString();throw new Error("No writable connection to "+r)}this.outboundStream.push(e)}attachInboundStream(e){return this._rawInboundStream=e,this.inboundStream=Pn(Se(this._rawInboundStream,gr()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.dispatchEvent(new ee("stream:inbound")),this.inboundStream}async attachOutboundStream(e){let r=this.outboundStream;return this.outboundStream!=null&&await this.outboundStream.end(),this._rawOutboundStream=e,this.outboundStream=Us({onEnd:n=>{this._rawOutboundStream!=null&&this._rawOutboundStream.reset!=null&&this._rawOutboundStream.reset(),this._rawOutboundStream=void 0,this.outboundStream=void 0,n!=null&&this.dispatchEvent(new ee("close"))}}),Se(this.outboundStream,Cr(),this._rawOutboundStream).catch(n=>{TRe.error(n)}),r==null&&this.dispatchEvent(new ee("stream:outbound")),this.outboundStream}close(){this.closed||(this.closed=!0,this.outboundStream!=null&&this.outboundStream.end(),this.inboundStream!=null&&this._inboundAbortController.abort(),this._rawOutboundStream=void 0,this.outboundStream=void 0,this._rawInboundStream=void 0,this.inboundStream=void 0,this.dispatchEvent(new ee("close")))}};Re();c();c();c();function za(t=[],e){return{subscriptions:[],messages:t,control:e?{graft:e.graft||[],prune:e.prune||[],ihave:e.ihave||[],iwant:e.iwant||[]}:void 0}}c();function Gu(t){if(t.length<=1)return t;let e=()=>Math.floor(Math.random()*Math.floor(t.length));for(let r=0;r<t.length;r++){let n=e(),i=t[r];t[r]=t[n],t[n]=i}return t}c();c();var XI="/floodsub/1.0.0",py="/meshsub/1.0.0",my="/meshsub/1.1.0";var wee="ERR_TOPIC_VALIDATOR_REJECT",Eee="ERR_TOPIC_VALIDATOR_IGNORE";function ZI(t){return t===py||t===my}c();Ae();Re();function Ha(t){return F(t,"base64")}function bee(t){return U(t,"base64")}c();c();var ed="StrictSign",s1="StrictNoSign";c();var _ee;(function(t){t.StrictSign="StrictSign",t.StrictNoSign="StrictNoSign"})(_ee||(_ee={}));var Xc;(function(t){t[t.Signing=0]="Signing",t[t.Author=1]="Author",t[t.Anonymous=2]="Anonymous"})(Xc||(Xc={}));var $a;(function(t){t.Accept="accept",t.Ignore="ignore",t.Reject="reject"})($a||($a={}));var gi;(function(t){t.Error="error",t.Ignore="ignore",t.Reject="reject",t.Blacklisted="blacklisted"})(gi||(gi={}));var oi;(function(t){t.InvalidSignature="invalid_signature",t.InvalidSeqno="invalid_seqno",t.InvalidPeerId="invalid_peerid",t.SignaturePresent="signature_present",t.SeqnoPresent="seqno_present",t.FromPresent="from_present",t.TransformFailed="transform_failed"})(oi||(oi={}));var yo;(function(t){t.duplicate="duplicate",t.invalid="invalid",t.valid="valid"})(yo||(yo={}));function JI(t){switch(t){case $a.Ignore:return gi.Ignore;case $a.Reject:return gi.Reject}}async function eC(t,e){switch(t){case ed:{if(!e)throw Error("Must provide PeerId");if(e.privateKey==null)throw Error("Cannot sign message, no private key present");if(e.publicKey==null)throw Error("Cannot sign message, no public key present");let r=await Hn(e.privateKey);return{type:Xc.Signing,author:e,key:e.publicKey,privateKey:r}}case s1:return{type:Xc.Anonymous};default:throw new Error(`Unknown signature policy "${t}"`)}}var sE=class{constructor(e,r){this.gossip=e,this.msgs=new Map,this.history=[];for(let n=0;n<r;n++)this.history[n]=[]}get size(){return this.msgs.size}put(e,r){if(this.msgs.has(e))return!1;this.msgs.set(e,{message:r,validated:!1,originatingPeers:new Set,iwantCounts:new Map});let n=bee(e);return this.history[0].push({msgId:n,topic:r.topic}),!0}observeDuplicate(e,r){let n=this.msgs.get(e);n&&!n.validated&&n.originatingPeers.add(r)}get(e){return this.msgs.get(Ha(e))?.message}getWithIWantCount(e,r){let n=this.msgs.get(e);if(!n)return null;let i=(n.iwantCounts.get(r)??0)+1;return n.iwantCounts.set(r,i),{msg:n.message,count:i}}getGossipIDs(e){let r=[];for(let n=0;n<this.gossip;n++)this.history[n].forEach(i=>{i.topic===e&&r.push(i.msgId)});return r}validate(e){let r=this.msgs.get(e);if(!r)return null;let{message:n,originatingPeers:i}=r;return r.validated=!0,r.originatingPeers=new Set,{message:n,originatingPeers:i}}shift(){this.history[this.history.length-1].forEach(r=>{let n=Ha(r.msgId);this.msgs.delete(n)}),this.history.pop(),this.history.unshift([])}remove(e){let r=this.msgs.get(e);return r?(this.msgs.delete(e),r):null}};c();var Wu;(function(t){let e;(function(u){u.codec=()=>et({1:{name:"subscribe",codec:h2,optional:!0},2:{name:"topic",codec:pn,optional:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(e=t.SubOpts||(t.SubOpts={}));let r;(function(u){u.codec=()=>et({1:{name:"from",codec:ve,optional:!0},2:{name:"data",codec:ve,optional:!0},3:{name:"seqno",codec:ve,optional:!0},4:{name:"topic",codec:pn},5:{name:"signature",codec:ve,optional:!0},6:{name:"key",codec:ve,optional:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(r=t.Message||(t.Message={}));let n;(function(u){u.codec=()=>et({1:{name:"ihave",codec:t.ControlIHave.codec(),repeats:!0},2:{name:"iwant",codec:t.ControlIWant.codec(),repeats:!0},3:{name:"graft",codec:t.ControlGraft.codec(),repeats:!0},4:{name:"prune",codec:t.ControlPrune.codec(),repeats:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(n=t.ControlMessage||(t.ControlMessage={}));let i;(function(u){u.codec=()=>et({1:{name:"topicID",codec:pn,optional:!0},2:{name:"messageIDs",codec:ve,repeats:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(i=t.ControlIHave||(t.ControlIHave={}));let o;(function(u){u.codec=()=>et({1:{name:"messageIDs",codec:ve,repeats:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(o=t.ControlIWant||(t.ControlIWant={}));let s;(function(u){u.codec=()=>et({1:{name:"topicID",codec:pn,optional:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(s=t.ControlGraft||(t.ControlGraft={}));let a;(function(u){u.codec=()=>et({1:{name:"topicID",codec:pn,optional:!0},2:{name:"peers",codec:t.PeerInfo.codec(),repeats:!0},3:{name:"backoff",codec:jl,optional:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(a=t.ControlPrune||(t.ControlPrune={}));let l;(function(u){u.codec=()=>et({1:{name:"peerID",codec:ve,optional:!0},2:{name:"signedPeerRecord",codec:ve,optional:!0}}),u.encode=f=>Je(f,u.codec()),u.decode=f=>Ze(f,u.codec())})(l=t.PeerInfo||(t.PeerInfo={})),t.codec=()=>et({1:{name:"subscriptions",codec:t.SubOpts.codec(),repeats:!0},2:{name:"messages",codec:t.Message.codec(),repeats:!0},3:{name:"control",codec:t.ControlMessage.codec(),optional:!0}}),t.encode=u=>Je(u,t.codec()),t.decode=u=>Ze(u,t.codec())})(Wu||(Wu={}));c();c();c();var fr="ERR_INVALID_PEER_SCORE_PARAMS";var hr=E(V(),1),IRe={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},CRe={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function vee(t={}){return{...IRe,...t,topics:t.topics?Object.entries(t.topics).reduce((e,[r,n])=>(e[r]=PRe(n),e),{}):{}}}function PRe(t={}){return{...CRe,...t}}function See(t){for(let[e,r]of Object.entries(t.topics))try{NRe(r)}catch(n){throw(0,hr.default)(new Error(`invalid score parameters for topic ${e}: ${n.message}`),fr)}if(t.topicScoreCap<0)throw(0,hr.default)(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),fr);if(t.appSpecificScore===null||t.appSpecificScore===void 0)throw(0,hr.default)(new Error("missing application specific score function"),fr);if(t.IPColocationFactorWeight>0)throw(0,hr.default)(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),fr);if(t.IPColocationFactorWeight!==0&&t.IPColocationFactorThreshold<1)throw(0,hr.default)(new Error("invalid IPColocationFactorThreshold; must be at least 1"),fr);if(t.behaviourPenaltyWeight>0)throw(0,hr.default)(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),fr);if(t.behaviourPenaltyWeight!==0&&(t.behaviourPenaltyDecay<=0||t.behaviourPenaltyDecay>=1))throw(0,hr.default)(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),fr);if(t.decayInterval<1e3)throw(0,hr.default)(new Error("invalid DecayInterval; must be at least 1s"),fr);if(t.decayToZero<=0||t.decayToZero>=1)throw(0,hr.default)(new Error("invalid DecayToZero; must be between 0 and 1"),fr)}function NRe(t){if(t.topicWeight<0)throw(0,hr.default)(new Error("invalid topic weight; must be >= 0"),fr);if(t.timeInMeshQuantum===0)throw(0,hr.default)(new Error("invalid TimeInMeshQuantum; must be non zero"),fr);if(t.timeInMeshWeight<0)throw(0,hr.default)(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),fr);if(t.timeInMeshWeight!==0&&t.timeInMeshQuantum<=0)throw(0,hr.default)(new Error("invalid TimeInMeshQuantum; must be positive"),fr);if(t.timeInMeshWeight!==0&&t.timeInMeshCap<=0)throw(0,hr.default)(new Error("invalid TimeInMeshCap; must be positive"),fr);if(t.firstMessageDeliveriesWeight<0)throw(0,hr.default)(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),fr);if(t.firstMessageDeliveriesWeight!==0&&(t.firstMessageDeliveriesDecay<=0||t.firstMessageDeliveriesDecay>=1))throw(0,hr.default)(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),fr);if(t.firstMessageDeliveriesWeight!==0&&t.firstMessageDeliveriesCap<=0)throw(0,hr.default)(new Error("invalid FirstMessageDeliveriesCap; must be positive"),fr);if(t.meshMessageDeliveriesWeight>0)throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),fr);if(t.meshMessageDeliveriesWeight!==0&&(t.meshMessageDeliveriesDecay<=0||t.meshMessageDeliveriesDecay>=1))throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),fr);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesCap<=0)throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesCap; must be positive"),fr);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesThreshold<=0)throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),fr);if(t.meshMessageDeliveriesWindow<0)throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),fr);if(t.meshMessageDeliveriesWeight!==0&&t.meshMessageDeliveriesActivation<1e3)throw(0,hr.default)(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),fr);if(t.meshFailurePenaltyWeight>0)throw(0,hr.default)(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),fr);if(t.meshFailurePenaltyWeight!==0&&(t.meshFailurePenaltyDecay<=0||t.meshFailurePenaltyDecay>=1))throw(0,hr.default)(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),fr);if(t.invalidMessageDeliveriesWeight>0)throw(0,hr.default)(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),fr);if(t.invalidMessageDeliveriesDecay<=0||t.invalidMessageDeliveriesDecay>=1)throw(0,hr.default)(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),fr)}c();var kRe=E(V(),1),DRe={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function xee(t={}){return{...DRe,...t}}c();c();function Ree(t,e,r,n){let i=0;if(Object.entries(e.topics).forEach(([s,a])=>{let l=r.topics[s];if(l===void 0)return;let u=0;if(a.inMesh){let d=a.meshTime/l.timeInMeshQuantum;d>l.timeInMeshCap&&(d=l.timeInMeshCap),u+=d*l.timeInMeshWeight}let f=a.firstMessageDeliveries;if(f>l.firstMessageDeliveriesCap&&(f=l.firstMessageDeliveriesCap),u+=f*l.firstMessageDeliveriesWeight,a.meshMessageDeliveriesActive&&a.meshMessageDeliveries<l.meshMessageDeliveriesThreshold){let d=l.meshMessageDeliveriesThreshold-a.meshMessageDeliveries;u+=d*d*l.meshMessageDeliveriesWeight}u+=a.meshFailurePenalty*l.meshFailurePenaltyWeight,u+=a.invalidMessageDeliveries*a.invalidMessageDeliveries*l.invalidMessageDeliveriesWeight,i+=u*l.topicWeight}),r.topicScoreCap>0&&i>r.topicScoreCap&&(i=r.topicScoreCap),i+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(s=>{if(r.IPColocationFactorWhitelist.has(s))return;let a=n.get(s),l=a?a.size:0;if(l>r.IPColocationFactorThreshold){let u=l-r.IPColocationFactorThreshold;i+=u*u*r.IPColocationFactorWeight}}),e.behaviourPenalty>r.behaviourPenaltyThreshold){let s=e.behaviourPenalty-r.behaviourPenaltyThreshold;i+=s*s*r.behaviourPenaltyWeight}return i}c();var Iee=E(Aee(),1),Ii;(function(t){t[t.unknown=0]="unknown",t[t.valid=1]="valid",t[t.invalid=2]="invalid",t[t.ignored=3]="ignored"})(Ii||(Ii={}));var aE=class{constructor(){this.records=new Map,this.queue=new Iee.default}ensureRecord(e){let r=this.records.get(e);if(r)return r;r={status:Ii.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(e,r);let n={msgId:e,expire:Date.now()+12e4};return this.queue.push(n),r}gc(){let e=Date.now(),r=this.queue.peekFront();for(;r&&r.expire<e;)this.records.delete(r.msgId),this.queue.shift(),r=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}};c();var Yi=E(V(),1);c();function Zc(t){return t!=null&&typeof t.start=="function"&&typeof t.stop=="function"}function yi(t){return t!=null&&typeof t.init=="function"}var ze=class{constructor(e={}){this.started=!1,e.peerId!=null&&this.setPeerId(e.peerId),e.addressManager!=null&&this.setAddressManager(e.addressManager),e.peerStore!=null&&this.setPeerStore(e.peerStore),e.upgrader!=null&&this.setUpgrader(e.upgrader),e.metrics!=null&&this.setMetrics(e.metrics),e.registrar!=null&&this.setRegistrar(e.registrar),e.connectionManager!=null&&this.setConnectionManager(e.connectionManager),e.transportManager!=null&&this.setTransportManager(e.transportManager),e.connectionGater!=null&&this.setConnectionGater(e.connectionGater),e.contentRouting!=null&&this.setContentRouting(e.contentRouting),e.peerRouting!=null&&this.setPeerRouting(e.peerRouting),e.datastore!=null&&this.setDatastore(e.datastore),e.connectionProtector!=null&&this.setConnectionProtector(e.connectionProtector),e.dht!=null&&this.setDHT(e.dht),e.pubsub!=null&&this.setPubSub(e.pubsub)}isStarted(){return this.started}async beforeStart(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{e.beforeStart!=null&&await e.beforeStart()}))}async start(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{await e.start()})),this.started=!0}async afterStart(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{e.afterStart!=null&&await e.afterStart()}))}async beforeStop(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{e.beforeStop!=null&&await e.beforeStop()}))}async stop(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{await e.stop()})),this.started=!1}async afterStop(){await Promise.all(Object.values(this).filter(e=>Zc(e)).map(async e=>{e.afterStop!=null&&await e.afterStop()}))}setPeerId(e){return this.peerId=e,e}getPeerId(){if(this.peerId==null)throw(0,Yi.default)(new Error("peerId not set"),"ERR_SERVICE_MISSING");return this.peerId}setMetrics(e){return this.metrics=e,yi(e)&&e.init(this),e}getMetrics(){return this.metrics}setAddressManager(e){return this.addressManager=e,yi(e)&&e.init(this),e}getAddressManager(){if(this.addressManager==null)throw(0,Yi.default)(new Error("addressManager not set"),"ERR_SERVICE_MISSING");return this.addressManager}setPeerStore(e){return this.peerStore=e,yi(e)&&e.init(this),e}getPeerStore(){if(this.peerStore==null)throw(0,Yi.default)(new Error("peerStore not set"),"ERR_SERVICE_MISSING");return this.peerStore}setUpgrader(e){return this.upgrader=e,yi(e)&&e.init(this),e}getUpgrader(){if(this.upgrader==null)throw(0,Yi.default)(new Error("upgrader not set"),"ERR_SERVICE_MISSING");return this.upgrader}setRegistrar(e){return this.registrar=e,yi(e)&&e.init(this),e}getRegistrar(){if(this.registrar==null)throw(0,Yi.default)(new Error("registrar not set"),"ERR_SERVICE_MISSING");return this.registrar}setConnectionManager(e){return this.connectionManager=e,yi(e)&&e.init(this),e}getConnectionManager(){if(this.connectionManager==null)throw(0,Yi.default)(new Error("connectionManager not set"),"ERR_SERVICE_MISSING");return this.connectionManager}setTransportManager(e){return this.transportManager=e,yi(e)&&e.init(this),e}getTransportManager(){if(this.transportManager==null)throw(0,Yi.default)(new Error("transportManager not set"),"ERR_SERVICE_MISSING");return this.transportManager}setConnectionGater(e){return this.connectionGater=e,yi(e)&&e.init(this),e}getConnectionGater(){if(this.connectionGater==null)throw(0,Yi.default)(new Error("connectionGater not set"),"ERR_SERVICE_MISSING");return this.connectionGater}setContentRouting(e){return this.contentRouting=e,yi(e)&&e.init(this),e}getContentRouting(){if(this.contentRouting==null)throw(0,Yi.default)(new Error("contentRouting not set"),"ERR_SERVICE_MISSING");return this.contentRouting}setPeerRouting(e){return this.peerRouting=e,yi(e)&&e.init(this),e}getPeerRouting(){if(this.peerRouting==null)throw(0,Yi.default)(new Error("peerRouting not set"),"ERR_SERVICE_MISSING");return this.peerRouting}setDatastore(e){return this.datastore=e,yi(e)&&e.init(this),e}getDatastore(){if(this.datastore==null)throw(0,Yi.default)(new Error("datastore not set"),"ERR_SERVICE_MISSING");return this.datastore}setConnectionProtector(e){return this.connectionProtector=e,yi(e)&&e.init(this),e}getConnectionProtector(){return this.connectionProtector}setDHT(e){return this.dht=e,yi(e)&&e.init(this),e}getDHT(){if(this.dht==null)throw(0,Yi.default)(new Error("dht not set"),"ERR_SERVICE_MISSING");return this.dht}setPubSub(e){return this.pubsub=e,yi(e)&&e.init(this),e}getPubSub(){if(this.pubsub==null)throw(0,Yi.default)(new Error("pubsub not set"),"ERR_SERVICE_MISSING");return this.pubsub}};var a1=C("libp2p:gossipsub:score"),cE=class{constructor(e,r,n){this.params=e,this.metrics=r,this.peerStats=new Map,this.peerIPs=new Map,this.scoreCache=new Map,this.deliveryRecords=new aE,this.components=new ze,See(e),this.scoreCacheValidityMs=n.scoreCacheValidityMs,this.computeScore=n.computeScore??Ree}init(e){this.components=e}get size(){return this.peerStats.size}start(){if(this._backgroundInterval){a1("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),a1("started")}stop(){if(!this._backgroundInterval){a1("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),a1("stopped")}background(){this.refreshScores(),this.updateIPs(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([e,r])=>[e,r]))}refreshScores(){let e=Date.now(),r=this.params.decayToZero;this.peerStats.forEach((n,i)=>{if(!n.connected){e>n.expire&&(this.removeIPs(i,n.ips),this.peerStats.delete(i),this.scoreCache.delete(i));return}Object.entries(n.topics).forEach(([o,s])=>{let a=this.params.topics[o];a!==void 0&&(s.firstMessageDeliveries*=a.firstMessageDeliveriesDecay,s.firstMessageDeliveries<r&&(s.firstMessageDeliveries=0),s.meshMessageDeliveries*=a.meshMessageDeliveriesDecay,s.meshMessageDeliveries<r&&(s.meshMessageDeliveries=0),s.meshFailurePenalty*=a.meshFailurePenaltyDecay,s.meshFailurePenalty<r&&(s.meshFailurePenalty=0),s.invalidMessageDeliveries*=a.invalidMessageDeliveriesDecay,s.invalidMessageDeliveries<r&&(s.invalidMessageDeliveries=0),s.inMesh&&(s.meshTime=e-s.graftTime,s.meshTime>a.meshMessageDeliveriesActivation&&(s.meshMessageDeliveriesActive=!0)))}),n.behaviourPenalty*=this.params.behaviourPenaltyDecay,n.behaviourPenalty<r&&(n.behaviourPenalty=0)})}score(e){this.metrics?.scoreFnCalls.inc();let r=this.peerStats.get(e);if(!r)return 0;let n=Date.now(),i=this.scoreCache.get(e);if(i&&i.cacheUntil>n)return i.score;this.metrics?.scoreFnRuns.inc();let o=this.computeScore(e,r,this.params,this.peerIPs),s=n+this.scoreCacheValidityMs;return i?(this.metrics?.scoreCachedDelta.observe(Math.abs(o-i.score)),i.score=o,i.cacheUntil=s):this.scoreCache.set(e,{score:o,cacheUntil:s}),o}addPenalty(e,r,n){let i=this.peerStats.get(e);i&&(i.behaviourPenalty+=r,this.metrics?.onScorePenalty(n))}addPeer(e){let r={connected:!0,expire:0,topics:{},ips:[],behaviourPenalty:0};this.peerStats.set(e,r);let n=this.getIPs(e);this.setIPs(e,n,r.ips),r.ips=n}removePeer(e){let r=this.peerStats.get(e);if(!!r){if(this.score(e)>0){this.removeIPs(e,r.ips),this.peerStats.delete(e);return}Object.entries(r.topics).forEach(([n,i])=>{i.firstMessageDeliveries=0;let o=this.params.topics[n].meshMessageDeliveriesThreshold;if(i.inMesh&&i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<o){let s=o-i.meshMessageDeliveries;i.meshFailurePenalty+=s*s}i.inMesh=!1,i.meshMessageDeliveriesActive=!1}),r.connected=!1,r.expire=Date.now()+this.params.retainScore}}graft(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.inMesh=!0,i.graftTime=Date.now(),i.meshTime=0,i.meshMessageDeliveriesActive=!1)}}prune(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let o=this.params.topics[r].meshMessageDeliveriesThreshold;if(i.meshMessageDeliveriesActive&&i.meshMessageDeliveries<o){let s=o-i.meshMessageDeliveries;i.meshFailurePenalty+=s*s}i.meshMessageDeliveriesActive=!1,i.inMesh=!1}}}validateMessage(e){this.deliveryRecords.ensureRecord(e)}deliverMessage(e,r,n){this.markFirstMessageDelivery(e,n);let i=this.deliveryRecords.ensureRecord(r),o=Date.now();if(i.status!==Ii.unknown){a1("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",e,o-i.firstSeen,Ii[i.status]);return}i.status=Ii.valid,i.validated=o,i.peers.forEach(s=>{s!==e.toString()&&this.markDuplicateMessageDelivery(s,n)})}rejectInvalidMessage(e,r){this.markInvalidMessageDelivery(e,r)}rejectMessage(e,r,n,i){switch(i){case gi.Error:this.markInvalidMessageDelivery(e,n);return;case gi.Blacklisted:return}let o=this.deliveryRecords.ensureRecord(r);if(o.status!==Ii.unknown){a1("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",e,Date.now()-o.firstSeen,Ii[o.status]);return}if(i===gi.Ignore){o.status=Ii.ignored,o.peers.clear();return}o.status=Ii.invalid,this.markInvalidMessageDelivery(e,n),o.peers.forEach(s=>{this.markInvalidMessageDelivery(s,n)}),o.peers.clear()}duplicateMessage(e,r,n){let i=this.deliveryRecords.ensureRecord(r);if(!i.peers.has(e))switch(i.status){case Ii.unknown:i.peers.add(e);break;case Ii.valid:i.peers.add(e),this.markDuplicateMessageDelivery(e,n,i.validated);break;case Ii.invalid:this.markInvalidMessageDelivery(e,n);break;case Ii.ignored:break}}markInvalidMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);i&&(i.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(e,r){let n=this.peerStats.get(e);if(n){let i=this.getPtopicStats(n,r);if(i){let o=this.params.topics[r].firstMessageDeliveriesCap;i.firstMessageDeliveries=Math.min(o,i.firstMessageDeliveries+1),i.inMesh&&(o=this.params.topics[r].meshMessageDeliveriesCap,i.meshMessageDeliveries=Math.min(o,i.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(e,r,n){let i=this.peerStats.get(e);if(i){let o=n!==void 0?Date.now():0,s=this.getPtopicStats(i,r);if(s&&s.inMesh){let a=this.params.topics[r];if(n!==void 0){let u=o-n,f=u>a.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(r,u,f),f)return}let l=a.meshMessageDeliveriesCap;s.meshMessageDeliveries=Math.min(l,s.meshMessageDeliveries+1)}}}getIPs(e){return this.components.getConnectionManager().getConnections(he(e)).map(r=>r.remoteAddr.toOptions().host)}setIPs(e,r,n){e:for(let i of r){for(let s of n)if(i===s)continue e;let o=this.peerIPs.get(i);o||(o=new Set,this.peerIPs.set(i,o)),o.add(e)}e:for(let i of n){for(let s of r)if(i===s)continue e;let o=this.peerIPs.get(i);!o||(o.delete(e),o.size||this.peerIPs.delete(i))}}removeIPs(e,r){r.forEach(n=>{let i=this.peerIPs.get(n);!i||(i.delete(e),i.size||this.peerIPs.delete(n))})}updateIPs(){this.peerStats.forEach((e,r)=>{let n=this.getIPs(r);this.setIPs(r,n,e.ips),e.ips=n})}getPtopicStats(e,r){let n=e.topics[r];return n!==void 0?n:this.params.topics[r]!==void 0?(n={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},e.topics[r]=n,n):null}};c();var lE=class{constructor(e,r){this.gossipsubIWantFollowupMs=e,this.metrics=r,this.promises=new Map,this.requestMsByMsg=new Map,this.requestMsByMsgExpire=10*e}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(e,r){let n=Math.floor(Math.random()*r.length),i=r[n],o=Ha(i),s=this.promises.get(o);s||(s=new Map,this.promises.set(o,s));let a=Date.now();s.has(e)||(s.set(e,a+this.gossipsubIWantFollowupMs),this.metrics&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(o)||this.requestMsByMsg.set(o,a)))}getBrokenPromises(){let e=Date.now(),r=new Map,n=0;return this.promises.forEach((i,o)=>{i.forEach((s,a)=>{s<e&&(r.set(a,(r.get(a)??0)+1),i.delete(a),n++)}),i.size||this.promises.delete(o)}),this.metrics?.iwantPromiseBroken.inc(n),r}deliverMessage(e){this.trackMessage(e);let r=this.promises.get(e);r&&(this.promises.delete(e),this.metrics&&(this.metrics.iwantPromiseResolved.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(r.size)))}rejectMessage(e,r){switch(this.trackMessage(e),r){case gi.Error:return}this.promises.delete(e)}clear(){this.promises.clear()}prune(){let e=Date.now()-this.requestMsByMsgExpire;for(let[r,n]of this.requestMsByMsg.entries())if(n<e)this.requestMsByMsg.delete(r);else break}trackMessage(e){if(this.metrics){let r=this.requestMsByMsg.get(e);r!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-r)/1e3),this.requestMsByMsg.delete(e))}}};c();var c1=class{constructor(e){this.entries=new Map,this.validityMs=e.validityMs}get size(){return this.entries.size}put(e,r){this.entries.set(e,{value:r,validUntilMs:Date.now()+this.validityMs})}prune(){let e=Date.now();for(let[r,n]of this.entries.entries())if(n.validUntilMs<e)this.entries.delete(r);else break}has(e){return this.entries.has(e)}get(e){let r=this.entries.get(e);return r&&r.validUntilMs>=Date.now()?r.value:void 0}clear(){this.entries.clear()}};c();var Cee;(function(t){t.forward="forward",t.publish="publish"})(Cee||(Cee={}));var Jc;(function(t){t.Fanout="fanout",t.Random="random",t.Subscribed="subscribed",t.Outbound="outbound",t.NotEnough="not_enough",t.Opportunistic="opportunistic"})(Jc||(Jc={}));var td;(function(t){t.Dc="disconnected",t.BadScore="bad_score",t.Prune="prune",t.Unsub="unsubscribed",t.Excess="excess"})(td||(td={}));var u1;(function(t){t.GraftBackoff="graft_backoff",t.BrokenPromise="broken_promise",t.MessageDeficit="message_deficit",t.IPColocation="IP_colocation"})(u1||(u1={}));var f1;(function(t){t.LowScore="low_score",t.MaxIhave="max_ihave",t.MaxIasked="max_iasked"})(f1||(f1={}));var l1;(function(t){t.graylist="graylist",t.publish="publish",t.gossip="gossip",t.mesh="mesh"})(l1||(l1={}));function Pee(t,e,r){return{protocolsEnabled:t.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:t.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:t.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:t.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEvents:t.gauge({name:"gossipsub_mesh_peer_inclusion_events_total",help:"Number of times we include peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),meshPeerChurnEvents:t.gauge({name:"gossipsub_peer_churn_events_total",help:"Number of times we remove peers in a topic mesh for different reasons",labelNames:["topic","reason"]}),peersPerProtocol:t.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:t.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:t.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),asyncValidationResult:t.gauge({name:"gossipsub_async_validation_result_total",help:"Message validation result for each topic",labelNames:["topic","acceptance"]}),asyncValidationMcacheHit:t.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),rpcRecvBytes:t.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:t.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:t.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:t.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:t.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:t.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:t.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:t.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:t.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcRecvNotAccepted:t.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:t.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:t.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:t.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:t.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:t.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:t.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:t.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:t.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:t.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:t.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeers:t.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),msgPublishPeersByGroup:t.gauge({name:"gossipsub_msg_publish_peers_by_group",help:"Total count of peers (by group) that we publish a msg to",labelNames:["topic","peerGroup"]}),msgPublishBytes:t.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgForwardCount:t.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:t.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:t.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedStatus:t.gauge({name:"gossipsub_msg_received_status_total",help:"Tracks distribution of recv msgs by duplicate, invalid, valid",labelNames:["topic","status"]}),msgReceivedInvalid:t.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["topic","error"]}),duplicateMsgDeliveryDelay:t.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*r.maxMeshMessageDeliveriesWindowSec,.5*r.maxMeshMessageDeliveriesWindowSec,1*r.maxMeshMessageDeliveriesWindowSec,2*r.maxMeshMessageDeliveriesWindowSec,4*r.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:t.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),scoreFnCalls:t.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:t.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:t.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:t.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:t.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores",labelNames:["topic","p"]}),scoreWeights:t.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:t.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:t.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:t.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*r.behaviourPenaltyThreshold,.5*r.behaviourPenaltyThreshold,1*r.behaviourPenaltyThreshold,2*r.behaviourPenaltyThreshold,4*r.behaviourPenaltyThreshold]}),ihaveRcvIgnored:t.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:t.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:t.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:t.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:t.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:t.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:t.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedPeers:t.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:t.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantPromiseDeliveryTime:t.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*r.gossipPromiseExpireSec,1*r.gossipPromiseExpireSec,2*r.gossipPromiseExpireSec,4*r.gossipPromiseExpireSec]}),cacheSize:t.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:t.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),topicStrToLabel:e,toTopic(n){return this.topicStrToLabel.get(n)??n},onJoin(n){this.topicSubscriptionStatus.set({topicStr:n},1),this.meshPeerCounts.set({topicStr:n},0)},onLeave(n){this.topicSubscriptionStatus.set({topicStr:n},0),this.meshPeerCounts.set({topicStr:n},0)},onAddToMesh(n,i,o){let s=this.toTopic(n);this.meshPeerInclusionEvents.inc({topic:s,reason:i},o)},onRemoveFromMesh(n,i,o){let s=this.toTopic(n);this.meshPeerChurnEvents.inc({topic:s,reason:i},o)},onReportValidationMcacheHit(n){this.asyncValidationMcacheHit.inc({hit:n?"hit":"miss"})},onReportValidation(n,i){let o=this.toTopic(n);this.asyncValidationResult.inc({topic:o,acceptance:i})},onScorePenalty(n){this.scoringPenalties.inc({penalty:n},1)},onIhaveRcv(n,i,o){let s=this.toTopic(n);this.ihaveRcvMsgids.inc({topic:s},i),this.ihaveRcvNotSeenMsgids.inc({topic:s},o)},onIwantRcv(n,i){for(let[o,s]of n){let a=this.toTopic(o);this.iwantRcvMsgids.inc({topic:a},s)}this.iwantRcvDonthaveMsgids.inc(i)},onForwardMsg(n,i){let o=this.toTopic(n);this.msgForwardCount.inc({topic:o},1),this.msgForwardPeers.inc({topic:o},i)},onPublishMsg(n,i,o,s){let a=this.toTopic(n);this.msgPublishCount.inc({topic:a},1),this.msgPublishBytes.inc({topic:a},o*s),this.msgPublishPeers.inc({topic:a},o),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"direct"},i.direct),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"floodsub"},i.floodsub),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"mesh"},i.mesh),this.msgPublishPeersByGroup.inc({topic:a,peerGroup:"fanout"},i.fanout)},onMsgRecvPreValidation(n){let i=this.toTopic(n);this.msgReceivedPreValidation.inc({topic:i},1)},onMsgRecvResult(n,i){let o=this.toTopic(n);this.msgReceivedStatus.inc({topic:o,status:i})},onMsgRecvInvalid(n,i){let o=this.toTopic(n),s=i.reason===gi.Error?i.error:i.reason;this.msgReceivedInvalid.inc({topic:o,error:s},1)},onDuplicateMsgDelivery(n,i,o){if(this.duplicateMsgDeliveryDelay.observe(i/1e3),o){let s=this.toTopic(n);this.duplicateMsgLateDelivery.inc({topic:s},1)}},onRpcRecv(n,i){this.rpcRecvBytes.inc(i),this.rpcRecvCount.inc(1),this.rpcRecvSubscription.inc(n.subscriptions.length),this.rpcRecvMessage.inc(n.messages.length),n.control&&(this.rpcRecvControl.inc(1),this.rpcRecvIHave.inc(n.control.ihave.length),this.rpcRecvIWant.inc(n.control.iwant.length),this.rpcRecvGraft.inc(n.control.graft.length),this.rpcRecvPrune.inc(n.control.prune.length))},onRpcSent(n,i){if(this.rpcSentBytes.inc(i),this.rpcSentCount.inc(1),this.rpcSentSubscription.inc(n.subscriptions.length),this.rpcSentMessage.inc(n.messages.length),n.control){let o=n.control.ihave.length,s=n.control.iwant.length,a=n.control.graft.length,l=n.control.prune.length;o>0&&this.rpcSentIHave.inc(o),s>0&&this.rpcSentIWant.inc(s),a>0&&this.rpcSentGraft.inc(a),l>0&&this.rpcSentPrune.inc(l),(o>0||s>0||a>0||l>0)&&this.rpcSentControl.inc(1)}},registerScores(n,i){let o=0,s=0,a=0,l=0;for(let u of n)u>=i.graylistThreshold&&o++,u>=i.publishThreshold&&s++,u>=i.gossipThreshold&&a++,u>=0&&l++;this.peersByScoreThreshold.set({threshold:l1.graylist},o),this.peersByScoreThreshold.set({threshold:l1.publish},s),this.peersByScoreThreshold.set({threshold:l1.gossip},a),this.peersByScoreThreshold.set({threshold:l1.mesh},l),this.score.set(n)},registerScoreWeights(n){for(let[i,o]of n.byTopic)this.scoreWeights.set({topic:i,p:"p1"},o.p1w),this.scoreWeights.set({topic:i,p:"p2"},o.p2w),this.scoreWeights.set({topic:i,p:"p3"},o.p3w),this.scoreWeights.set({topic:i,p:"p3b"},o.p3bw),this.scoreWeights.set({topic:i,p:"p4"},o.p4w);this.scoreWeights.set({p:"p5"},n.p5w),this.scoreWeights.set({p:"p6"},n.p6w),this.scoreWeights.set({p:"p7"},n.p7w)},registerScorePerMesh(n,i){let o=new Map;n.forEach((s,a)=>{let l=this.topicStrToLabel.get(a)??"unknown",u=o.get(l);u||(u=new Set,o.set(l,u)),s.forEach(f=>u?.add(f))});for(let[s,a]of o){let l=[];a.forEach(u=>{l.push(i.get(u)??0)}),this.scorePerMesh.set({topic:s},l)}}}}c();var RC=E(xC(),1);Pr();Ae();Mr();var Ate=U("libp2p-pubsub:");async function Ite(t,e,r){switch(t.type){case Xc.Signing:{let n={from:t.author.toBytes(),data:r,seqno:(0,RC.randomBytes)(8),topic:e,signature:void 0,key:void 0},i=Pe([Ate,Wu.Message.encode(n)]);return n.signature=await t.privateKey.sign(i),n.key=t.key,n}case Xc.Author:return{from:t.author.toBytes(),data:r,seqno:(0,RC.randomBytes)(8),topic:e,signature:void 0,key:void 0};case Xc.Anonymous:return{from:void 0,data:r,seqno:void 0,topic:e,signature:void 0,key:void 0}}}async function Cte(t,e){switch(t){case s1:return e.signature!=null?{valid:!1,error:oi.SignaturePresent}:e.seqno!=null?{valid:!1,error:oi.SeqnoPresent}:e.key!=null?{valid:!1,error:oi.FromPresent}:{valid:!0,fromPeerId:null};case ed:{if(e.seqno==null)return{valid:!1,error:oi.InvalidSeqno};if(e.seqno.length!==8)return{valid:!1,error:oi.InvalidSeqno};if(e.signature==null)return{valid:!1,error:oi.InvalidSignature};if(e.from==null)return{valid:!1,error:oi.InvalidPeerId};let r;try{r=Rr(e.from)}catch{return{valid:!1,error:oi.InvalidPeerId}}let n;if(e.key){if(n=qi(e.key),r.publicKey!==void 0&&!Me(n.bytes,r.publicKey))return{valid:!1,error:oi.InvalidPeerId}}else{if(r.publicKey==null)return{valid:!1,error:oi.InvalidPeerId};n=qi(r.publicKey)}let i={from:e.from,data:e.data,seqno:e.seqno,topic:e.topic,signature:void 0,key:void 0},o=Pe([Ate,Wu.Message.encode(i)]);return await n.verify(o,e.signature)?{valid:!0,fromPeerId:r}:{valid:!1,error:oi.InvalidSignature}}}}c();zr();c();var _Ae=E(xC(),1);Ae();Re();zr();c();var vAe=E(V(),1);var Pte=(t,e)=>{let r=U(e.toString(16).padStart(16,"0"),"base16"),n=new Uint8Array(t.length+r.length);return n.set(t,0),n.set(r,t.length),n};function Nte(t){if(t.sequenceNumber==null)throw Error("missing seqno field");return Pte(t.from.toBytes(),t.sequenceNumber)}async function kte(t){return await Be.encode(t.data)}c();function SAe(t,e,r,n,i){let o=0,s=new Map;if(Object.entries(e.topics).forEach(([p,d])=>{let m=i.get(p)??"unknown",g=r.topics[p];if(g===void 0)return;let y=s.get(m);y||(y={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},s.set(m,y));let w=0,b=0,v=0,S=0,R=0;d.inMesh&&(w+=Math.max(d.meshTime/g.timeInMeshQuantum,g.timeInMeshCap)*g.timeInMeshWeight);let I=d.firstMessageDeliveries;if(I>g.firstMessageDeliveriesCap&&(I=g.firstMessageDeliveriesCap),b+=I*g.firstMessageDeliveriesWeight,d.meshMessageDeliveriesActive&&d.meshMessageDeliveries<g.meshMessageDeliveriesThreshold){let q=g.meshMessageDeliveriesThreshold-d.meshMessageDeliveries;v+=q*q*g.meshMessageDeliveriesWeight}S+=d.meshFailurePenalty*g.meshFailurePenaltyWeight,R+=d.invalidMessageDeliveries*d.invalidMessageDeliveries*g.invalidMessageDeliveriesWeight,o+=(w+b+v+S+R)*g.topicWeight,y.p1w+=w,y.p2w+=b,y.p3w+=v,y.p3bw+=S,y.p4w+=R}),r.topicScoreCap>0&&o>r.topicScoreCap){o=r.topicScoreCap;let p=r.topicScoreCap/o;for(let d of s.values())d.p1w*=p,d.p2w*=p,d.p3w*=p,d.p3bw*=p,d.p4w*=p}let a=0,l=0,u=0;return a+=r.appSpecificScore(t)*r.appSpecificWeight,e.ips.forEach(p=>{if(r.IPColocationFactorWhitelist.has(p))return;let d=n.get(p),m=d?d.size:0;if(m>r.IPColocationFactorThreshold){let g=m-r.IPColocationFactorThreshold;l+=g*g*r.IPColocationFactorWeight}}),u+=e.behaviourPenalty*e.behaviourPenalty*r.behaviourPenaltyWeight,o+=a+l+u,{byTopic:s,p5w:a,p6w:l,p7w:u,score:o}}function Dte(t,e,r,n,i){let o={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(let s of t){let a=e.get(s);if(a){let l=SAe(s,a,r,n,i);for(let[u,f]of l.byTopic){let h=o.byTopic.get(u);h||(h={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},o.byTopic.set(u,h)),h.p1w.push(f.p1w),h.p2w.push(f.p2w),h.p3w.push(f.p3w),h.p3bw.push(f.p3bw),h.p4w.push(f.p4w)}o.p5w.push(l.p5w),o.p6w.push(l.p6w),o.p7w.push(l.p7w),o.score.push(l.score)}else o.p5w.push(0),o.p6w.push(0),o.p7w.push(0),o.score.push(0)}return o}var wo;(function(t){t[t.started=0]="started",t[t.stopped=1]="stopped"})(wo||(wo={}));var vy=class extends Ue{constructor(e={}){super(),this.multicodecs=[my,py],this.peers=new Map,this.direct=new Set,this.floodsubPeers=new Set,this.acceptFromWhitelist=new Map,this.topics=new Map,this.subscriptions=new Set,this.mesh=new Map,this.fanout=new Map,this.fanoutLastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.topicValidators=new Map,this.heartbeatTicks=0,this.components=new ze,this.directPeerInitial=null,this.status={code:wo.stopped},this.heartbeatTimer=null,this.runHeartbeat=()=>{let n=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(i=>{this.log("Error running heartbeat",i)}).finally(()=>{if(n?.(),this.status.code===wo.started){clearTimeout(this.status.heartbeatTimeout);let i=(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;i<this.opts.heartbeatInterval*.25&&(i+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,i)}})};let r={gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:6,Dlo:4,Dhi:12,Dscore:4,Dout:2,Dlazy:6,heartbeatInterval:1e3,fanoutTTL:6e4,mcacheLength:5,mcacheGossip:3,seenTTL:12e4,gossipsubIWantFollowupMs:3e3,prunePeers:16,pruneBackoff:6e4,graftFloodThreshold:1e4,opportunisticGraftPeers:2,opportunisticGraftTicks:60,directConnectTicks:300,...e,scoreParams:vee(e.scoreParams),scoreThresholds:xee(e.scoreThresholds)};if(this.globalSignaturePolicy=r.globalSignaturePolicy??ed,r.fallbackToFloodsub&&this.multicodecs.push(XI),this.log=C(r.debugName??"libp2p:gossipsub"),this.opts=r,this.direct=new Set(r.directPeers.map(n=>n.id.toString())),this.seenCache=new c1({validityMs:r.seenTTL}),this.publishedMessageIds=new c1({validityMs:r.seenTTL}),this.mcache=e.messageCache||new sE(r.mcacheGossip,r.mcacheLength),e.msgIdFn)this.msgIdFn=e.msgIdFn;else switch(this.globalSignaturePolicy){case ed:this.msgIdFn=Nte;break;case s1:this.msgIdFn=kte;break}if(e.fastMsgIdFn&&(this.fastMsgIdFn=e.fastMsgIdFn,this.fastMsgIdCache=new c1({validityMs:r.seenTTL})),e.dataTransform&&(this.dataTransform=e.dataTransform),e.metricsRegister){if(!e.metricsTopicStrToLabel)throw Error("Must set metricsTopicStrToLabel with metrics");let n=Math.max(...Object.values(r.scoreParams.topics).map(o=>o.meshMessageDeliveriesWindow),1e3),i=Pee(e.metricsRegister,e.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:r.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:n/1e3});i.mcacheSize.addCollect(()=>this.onScrapeMetrics(i));for(let o of this.multicodecs)i.protocolsEnabled.set({protocol:o},1);this.metrics=i}else this.metrics=null;this.gossipTracer=new lE(this.opts.gossipsubIWantFollowupMs,this.metrics),this.score=new cE(this.opts.scoreParams,this.metrics,{scoreCacheValidityMs:r.heartbeatInterval})}getPeers(){return[...this.peers.keys()].map(e=>he(e))}isStarted(){return this.status.code===wo.started}async init(e){this.components=e,this.score.init(e)}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await eC(this.globalSignaturePolicy,this.components.getPeerId()),await Promise.all(this.opts.directPeers.map(async i=>{await this.components.getPeerStore().addressBook.add(i.id,i.addrs)})),await this.components.getRegistrar().handle(this.multicodecs,this.onIncomingStream.bind(this));let e=i1({onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this)}),r=await this.components.getRegistrar().register(this.multicodecs,e),n=setTimeout(this.runHeartbeat,100);this.status={code:wo.started,registrarTopologyId:r,heartbeatTimeout:n,hearbeatStartMs:Date.now()+100},this.log("started"),this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async i=>await this.connect(i)))}).catch(i=>{this.log(i)})},1e3)}async stop(){if(this.log("stopping"),this.status.code!==wo.started)return;let{registrarTopologyId:e}=this.status;this.status={code:wo.stopped},this.components.getRegistrar().unregister(e);for(let r of this.peers.values())r.close();this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache&&this.fastMsgIdCache.clear(),this.directPeerInitial&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({protocol:e,stream:r,connection:n}){if(!this.isStarted())return;let i=n.remotePeer,s=this.addPeer(i,e,n.stat.direction).attachInboundStream(r);this.pipePeerReadStream(i,s).catch(a=>this.log(a))}onPeerConnected(e,r){!this.isStarted()||(this.log("topology peer connected %p %s",e,r.stat.direction),Promise.resolve().then(async()=>{try{let{stream:n,protocol:i}=await r.newStream(this.multicodecs);await this.addPeer(e,i,r.stat.direction).attachOutboundStream(n)}catch(n){this.log(n)}this.subscriptions.size>0&&this.sendSubscriptions(e.toString(),Array.from(this.subscriptions),!0)}))}onPeerDisconnected(e){this.log("connection ended %p",e),this.removePeer(e)}addPeer(e,r,n){let i=e.toString(),o=this.peers.get(i);return o===void 0&&(this.log("new peer %p",e),o=new oE({id:e,protocol:r}),this.peers.set(i,o),o.addEventListener("close",()=>this.removePeer(e))),this.score.addPeer(i),r===XI&&this.floodsubPeers.add(i),this.metrics?.peersPerProtocol.inc({protocol:r},1),this.outbound.get(i)||this.outbound.set(i,n==="outbound"),o}removePeer(e){let r=e.toString(),n=this.peers.get(r);if(n!=null){this.metrics?.peersPerProtocol.inc({protocol:n.protocol},-1),this.log("delete peer %p",e),this.peers.delete(r),n.close();for(let i of this.topics.values())i.delete(r)}for(let[i,o]of this.mesh)o.delete(r)===!0&&this.metrics?.onRemoveFromMesh(i,td.Dc,1);for(let i of this.fanout.values())i.delete(r);return this.floodsubPeers.delete(r),this.gossip.delete(r),this.control.delete(r),this.outbound.delete(r),this.score.removePeer(r),this.acceptFromWhitelist.delete(r),n}get started(){return this.status.code===wo.started}getMeshPeers(e){let r=this.mesh.get(e);return r?Array.from(r):[]}getSubscribers(e){let r=this.topics.get(e);return(r?Array.from(r):[]).map(n=>he(n))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(e,r){try{await Se(r,async n=>{for await(let i of n)try{let o=i instanceof Uint8Array?i:i.slice(),s=Wu.decode(o);this.metrics?.onRpcRecv(s,o.length),this.opts.awaitRpcHandler?await this.handleReceivedRpc(e,s):this.handleReceivedRpc(e,s).catch(a=>this.log(a))}catch(o){this.log(o)}})}catch(n){this.log.error(n),this.onPeerDisconnected(e)}}async handleReceivedRpc(e,r){if(!this.acceptFrom(e.toString())){this.log("received message from unacceptable peer %p",e),this.metrics?.rpcRecvNotAccepted.inc();return}this.log("rpc from %p",e),r.subscriptions.length>0&&(r.subscriptions.forEach(n=>{this.handleReceivedSubscription(e,n)}),this.dispatchEvent(new ee("subscription-change",{detail:{peerId:e,subscriptions:r.subscriptions.filter(n=>n.topic!==null).map(n=>({topic:n.topic??"",subscribe:Boolean(n.subscribe)}))}})));for(let n of r.messages){let i=this.handleReceivedMessage(e,n).catch(o=>this.log(o));this.opts.awaitRpcMessageHandler&&await i}r.control&&await this.handleControlMessage(e.toString(),r.control)}handleReceivedSubscription(e,r){if(r.topic==null)return;this.log("subscription update from %p topic %s",e,r.topic);let n=this.topics.get(r.topic);n==null&&(n=new Set,this.topics.set(r.topic,n)),r.subscribe?n.add(e.toString()):n.delete(e.toString())}async handleReceivedMessage(e,r){this.metrics?.onMsgRecvPreValidation(r.topic);let n=await this.validateReceivedMessage(e,r);switch(this.metrics?.onMsgRecvResult(r.topic,n.code),n.code){case yo.duplicate:this.score.duplicateMessage(e.toString(),n.msgId,r.topic),this.mcache.observeDuplicate(n.msgId,e.toString());return;case yo.invalid:n.msgId?(this.score.rejectMessage(e.toString(),n.msgId,r.topic,n.reason),this.gossipTracer.rejectMessage(n.msgId,n.reason)):this.score.rejectInvalidMessage(e.toString(),r.topic),this.metrics?.onMsgRecvInvalid(r.topic,n);return;case yo.valid:this.score.validateMessage(n.msgIdStr),this.gossipTracer.deliverMessage(n.msgIdStr),this.mcache.put(n.msgIdStr,r),this.subscriptions.has(r.topic)&&(!this.components.getPeerId().equals(e)||this.opts.emitSelf)&&(super.dispatchEvent(new ee("gossipsub:message",{detail:{propagationSource:e,msgId:n.msgIdStr,msg:n.msg}})),super.dispatchEvent(new ee("message",{detail:n.msg}))),this.opts.asyncValidation||this.forwardMessage(n.msgIdStr,r,e.toString())}}async validateReceivedMessage(e,r){let n=this.fastMsgIdFn?.(r),i=n&&this.fastMsgIdCache?.get(n);if(i)return{code:yo.duplicate,msgId:i};let o=await Cte(this.globalSignaturePolicy,r);if(!o.valid)return{code:yo.invalid,reason:gi.Error,error:o.error};let s;try{let f=r.data??new Uint8Array(0);s=this.dataTransform?this.dataTransform.inboundTransform(r.topic,f):f}catch(f){return this.log("Invalid message, transform failed",f),{code:yo.invalid,reason:gi.Error,error:oi.TransformFailed}}if(r.from==null)return this.log("Invalid message, transform failed"),{code:yo.invalid,reason:gi.Error,error:oi.TransformFailed};let a={from:Rr(r.from),data:s,sequenceNumber:r.seqno==null?void 0:BigInt(`0x${F(r.seqno,"base16")}`),topic:r.topic},l=i??Ha(await this.msgIdFn(a));if(n&&this.fastMsgIdCache?.put(n,l),this.seenCache.has(l))return{code:yo.duplicate,msgId:l};this.seenCache.put(l);let u=this.topicValidators.get(r.topic);if(u!=null){let f;try{f=await u(a.topic,a,e)}catch(h){let p=h.code;p===Eee&&(f=$a.Ignore),p===wee?f=$a.Reject:f=$a.Ignore}if(f!==$a.Accept)return{code:yo.invalid,reason:JI(f),msgId:l}}return{code:yo.valid,msgIdStr:l,msg:a}}getScore(e){return this.score.score(e)}sendSubscriptions(e,r,n){this.sendRpc(e,{subscriptions:r.map(i=>({topic:i,subscribe:n})),messages:[]})}async handleControlMessage(e,r){if(r===void 0)return;let n=this.handleIHave(e,r.ihave),i=this.handleIWant(e,r.iwant),o=await this.handleGraft(e,r.graft);await this.handlePrune(e,r.prune),!(!n.length&&!i.length&&!o.length)&&this.sendRpc(e,za(i,{iwant:n,prune:o}))}acceptFrom(e){if(this.direct.has(e))return!0;let r=Date.now(),n=this.acceptFromWhitelist.get(e);if(n&&n.messagesAccepted<128&&n.acceptUntil>=r)return n.messagesAccepted+=1,!0;let i=this.score.score(e);return i>=0?this.acceptFromWhitelist.set(e,{messagesAccepted:0,acceptUntil:r+1e3}):this.acceptFromWhitelist.delete(e),i>=this.opts.scoreThresholds.graylistThreshold}handleIHave(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",e,n),this.metrics?.ihaveRcvIgnored.inc({reason:f1.LowScore}),[];let i=(this.peerhave.get(e)??0)+1;if(this.peerhave.set(e,i),i>10)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",e,i),this.metrics?.ihaveRcvIgnored.inc({reason:f1.MaxIhave}),[];let o=this.iasked.get(e)??0;if(o>=5e3)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",e,o),this.metrics?.ihaveRcvIgnored.inc({reason:f1.MaxIasked}),[];let s=new Map;if(r.forEach(({topicID:u,messageIDs:f})=>{if(!u||!this.mesh.has(u))return;let h=0;f.forEach(p=>{let d=Ha(p);this.seenCache.has(d)||(s.set(d,p),h++)}),this.metrics?.onIhaveRcv(u,f.length,h)}),!s.size)return[];let a=s.size;a+o>5e3&&(a=5e3-o),this.log("IHAVE: Asking for %d out of %d messages from %s",a,s.size,e);let l=Array.from(s.values());return Gu(l),l=l.slice(0,a),this.iasked.set(e,o+a),this.gossipTracer.addPromise(e,l),[{messageIDs:l}]}handleIWant(e,r){if(!r.length)return[];let n=this.score.score(e);if(n<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",e,n),[];let i=new Map,o=new Map,s=0;return r.forEach(({messageIDs:a})=>{a.forEach(l=>{let u=Ha(l),f=this.mcache.getWithIWantCount(u,e);if(f==null){s++;return}if(o.set(f.msg.topic,1+(o.get(f.msg.topic)??0)),f.count>3){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",e,l);return}i.set(u,f.msg)})}),this.metrics?.onIwantRcv(o,s),i.size?(this.log("IWANT: Sending %d messages to %s",i.size,e),Array.from(i.values())):(this.log("IWANT: Could not provide any wanted messages to %s",e),[])}async handleGraft(e,r){let n=[],i=this.score.score(e),o=Date.now(),s=this.opts.doPX;return r.forEach(({topicID:a})=>{if(!a)return;let l=this.mesh.get(a);if(!l){s=!1;return}if(l.has(e))return;if(this.direct.has(e)){this.log("GRAFT: ignoring request from direct peer %s",e),n.push(a),s=!1;return}let u=this.backoff.get(a)?.get(e);if(typeof u=="number"&&o<u){this.log("GRAFT: ignoring backed off peer %s",e),this.score.addPenalty(e,1,u1.GraftBackoff),s=!1;let f=u+this.opts.graftFloodThreshold-this.opts.pruneBackoff;o<f&&this.score.addPenalty(e,1,u1.GraftBackoff),this.addBackoff(e,a),n.push(a);return}if(i<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",e,i,a),n.push(a),s=!1,this.addBackoff(e,a);return}if(l.size>=this.opts.Dhi&&!this.outbound.get(e)){n.push(a),this.addBackoff(e,a);return}this.log("GRAFT: Add mesh link from %s in %s",e,a),this.score.graft(e,a),l.add(e),this.metrics?.onAddToMesh(a,Jc.Subscribed,1)}),n.length?await Promise.all(n.map(a=>this.makePrune(e,a,s))):[]}async handlePrune(e,r){let n=this.score.score(e);for(let{topicID:i,backoff:o,peers:s}of r){if(i==null)continue;let a=this.mesh.get(i);if(!a)return;if(this.log("PRUNE: Remove mesh link to %s in %s",e,i),this.score.prune(e,i),a.has(e)&&(a.delete(e),this.metrics?.onRemoveFromMesh(i,td.Unsub,1)),typeof o=="number"&&o>0?this.doAddBackoff(e,i,o*1e3):this.addBackoff(e,i),s.length){if(n<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",e,n,i);continue}await this.pxConnect(s)}}}addBackoff(e,r){this.doAddBackoff(e,r,this.opts.pruneBackoff)}doAddBackoff(e,r,n){let i=this.backoff.get(r);i||(i=new Map,this.backoff.set(r,i));let o=Date.now()+n;(i.get(e)??0)<o&&i.set(e,o)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((e,r)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",r,e),this.score.addPenalty(r,e,u1.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%15!==0)return;let e=Date.now();this.backoff.forEach((r,n)=>{r.forEach((i,o)=>{i<e&&r.delete(o)}),r.size===0&&this.backoff.delete(n)})}async directConnect(){let e=[];this.direct.forEach(r=>{let n=this.peers.get(r);(!n||!n.isWritable)&&e.push(r)}),await Promise.all(e.map(async r=>await this.connect(r)))}async pxConnect(e){e.length>this.opts.prunePeers&&(Gu(e),e=e.slice(0,this.opts.prunePeers));let r=[];await Promise.all(e.map(async n=>{if(!n.peerID)return;let i=Rr(n.peerID).toString();if(!this.peers.has(i)){if(!n.signedPeerRecord){r.push(i);return}try{let o=await ln.openAndCertify(n.signedPeerRecord,"libp2p-peer-record"),s=o.peerId;if(!o.peerId.equals(i)){this.log("bogus peer record obtained through px: peer ID %p doesn't match expected peer %p",s,i);return}if(!await this.components.getPeerStore().addressBook.consumePeerRecord(o)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}r.push(i)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),r.length&&await Promise.all(r.map(async n=>await this.connect(n)))}async connect(e){this.log("Initiating connection with %s",e),await(await this.components.getConnectionManager().openConnection(he(e))).newStream(this.multicodecs)}subscribe(e){if(this.status.code!==wo.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(e)){this.subscriptions.add(e);for(let r of this.peers.keys())this.sendSubscriptions(r,[e],!0)}this.join(e)}unsubscribe(e){if(this.status.code!==wo.started)throw new Error("Pubsub is not started");let r=this.subscriptions.delete(e);if(this.log("unsubscribe from %s - am subscribed %s",e,r),r)for(let n of this.peers.keys())this.sendSubscriptions(n,[e],!1);this.leave(e).catch(n=>{this.log(n)})}join(e){if(this.status.code!==wo.started)throw new Error("Gossipsub has not started");if(this.mesh.has(e))return;this.log("JOIN %s",e),this.metrics?.onJoin(e);let r=new Set,n=this.fanout.get(e);if(n&&(this.fanout.delete(e),this.fanoutLastpub.delete(e),n.forEach(i=>{!this.direct.has(i)&&this.score.score(i)>=0&&r.add(i)}),this.metrics?.onAddToMesh(e,Jc.Fanout,r.size)),r.size<this.opts.D){let i=r.size;this.getRandomGossipPeers(e,this.opts.D,s=>!r.has(s)&&!this.direct.has(s)&&this.score.score(s)>=0).forEach(s=>{r.add(s)}),this.metrics?.onAddToMesh(e,Jc.Random,r.size-i)}this.mesh.set(e,r),r.forEach(i=>{this.log("JOIN: Add mesh link to %s in %s",i,e),this.sendGraft(i,e)})}async leave(e){if(this.status.code!==wo.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",e),this.metrics?.onLeave(e);let r=this.mesh.get(e);r&&(await Promise.all(Array.from(r).map(async n=>(this.log("LEAVE: Remove mesh link to %s in %s",n,e),await this.sendPrune(n,e)))),this.mesh.delete(e))}selectPeersToForward(e,r,n){let i=new Set,o=this.topics.get(e);o&&(this.direct.forEach(a=>{o.has(a)&&r!==a&&!n?.has(a)&&i.add(a)}),this.floodsubPeers.forEach(a=>{o.has(a)&&r!==a&&!n?.has(a)&&this.score.score(a)>=this.opts.scoreThresholds.publishThreshold&&i.add(a)}));let s=this.mesh.get(e);return s&&s.size>0&&s.forEach(a=>{r!==a&&!n?.has(a)&&i.add(a)}),i}selectPeersToPublish(e){let r=new Set,n={direct:0,floodsub:0,mesh:0,fanout:0},i=this.topics.get(e);if(i)if(this.opts.floodPublish)i.forEach(o=>{this.direct.has(o)?(r.add(o),n.direct++):this.score.score(o)>=this.opts.scoreThresholds.publishThreshold&&(r.add(o),n.floodsub++)});else{this.direct.forEach(s=>{i.has(s)&&(r.add(s),n.direct++)}),this.floodsubPeers.forEach(s=>{i.has(s)&&this.score.score(s)>=this.opts.scoreThresholds.publishThreshold&&(r.add(s),n.floodsub++)});let o=this.mesh.get(e);if(o&&o.size>0)o.forEach(s=>{r.add(s),n.mesh++});else{let s=this.fanout.get(e);if(s&&s.size>0)s.forEach(a=>{r.add(a),n.fanout++});else{let a=this.getRandomGossipPeers(e,this.opts.D,l=>this.score.score(l)>=this.opts.scoreThresholds.publishThreshold);a.size>0&&(this.fanout.set(e,a),a.forEach(l=>{r.add(l),n.fanout++}))}this.fanoutLastpub.set(e,Date.now())}}return{tosend:r,tosendCount:n}}forwardMessage(e,r,n,i){n&&this.score.deliverMessage(n,e,r.topic);let o=this.selectPeersToForward(r.topic,n,i),s=za([r]);o.forEach(a=>{this.sendRpc(a,s)}),this.metrics?.onForwardMsg(r.topic,o.size)}async publish(e,r){let n=this.dataTransform?this.dataTransform.outboundTransform(e,r):r;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");let i=await Ite(this.publishConfig,e,n);if(i.from==null)throw Error("PublishError.InvalidMessage");let o={from:Rr(i.from),data:r,sequenceNumber:i.seqno==null?void 0:BigInt(`0x${F(i.seqno,"base16")}`),topic:e,signature:i.signature,key:i.key},s=await this.msgIdFn(o),a=Ha(s);if(this.seenCache.has(a))throw Error("PublishError.Duplicate");let{tosend:l,tosendCount:u}=this.selectPeersToPublish(i.topic),f=this.opts.emitSelf===!0&&this.subscriptions.has(e);if(l.size===0&&!this.opts.allowPublishToZeroPeers&&!f)throw Error("PublishError.InsufficientPeers");this.seenCache.put(a),this.mcache.put(a,i),this.publishedMessageIds.put(a);let h=za([i]);for(let p of l)this.sendRpc(p,h)||l.delete(p);return this.metrics?.onPublishMsg(e,u,l.size,i.data!=null?i.data.length:0),f&&(l.add(this.components.getPeerId().toString()),super.dispatchEvent(new ee("gossipsub:message",{detail:{propagationSource:this.components.getPeerId(),msgId:a,msg:o}})),super.dispatchEvent(new ee("message",{detail:o}))),{recipients:Array.from(l.values()).map(p=>he(p))}}reportMessageValidationResult(e,r,n){if(n===$a.Accept){let i=this.mcache.validate(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i!=null){let{message:o,originatingPeers:s}=i;this.score.deliverMessage(r.toString(),e,o.topic),this.forwardMessage(e,i.message,r.toString(),s),this.metrics?.onReportValidation(o.topic,n)}}else{let i=this.mcache.remove(e);if(this.metrics?.onReportValidationMcacheHit(i!==null),i){let o=JI(n),{message:s,originatingPeers:a}=i;this.score.rejectMessage(r.toString(),e,s.topic,o);for(let l of a)this.score.rejectMessage(l,e,s.topic,o);this.metrics?.onReportValidation(s.topic,n)}}}sendGraft(e,r){let i=za([],{graft:[{topicID:r}]});this.sendRpc(e,i)}async sendPrune(e,r){let n=[await this.makePrune(e,r,this.opts.doPX)],i=za([],{prune:n});this.sendRpc(e,i)}sendRpc(e,r){let n=this.peers.get(e);if(!n||!n.isWritable)return this.log(`Cannot send RPC to ${e} as there is no open stream to it available`),!1;let i=this.control.get(e);i&&(this.piggybackControl(e,r,i),this.control.delete(e));let o=this.gossip.get(e);o&&(this.piggybackGossip(e,r,o),this.gossip.delete(e));let s=Wu.encode(r);return n.write(s),this.metrics?.onRpcSent(r,s.length),!0}piggybackControl(e,r,n){let i=n.graft.filter(({topicID:s})=>(s&&this.mesh.get(s)||new Set).has(e)),o=n.prune.filter(({topicID:s})=>!(s&&this.mesh.get(s)||new Set).has(e));!i.length&&!o.length||(r.control?(r.control.graft=r.control.graft.concat(i),r.control.prune=r.control.prune.concat(o)):r.control={graft:i,prune:o,ihave:[],iwant:[]})}piggybackGossip(e,r,n){r.control||(r.control={ihave:[],iwant:[],graft:[],prune:[]}),r.control.ihave=n}async sendGraftPrune(e,r,n){let i=this.opts.doPX;for(let[o,s]of e){let a=s.map(h=>({topicID:h})),l=[],u=r.get(o);u&&(l=await Promise.all(u.map(async h=>await this.makePrune(o,h,i&&!(n.get(o)??!1)))),r.delete(o));let f=za([],{graft:a,prune:l});this.sendRpc(o,f)}for(let[o,s]of r){let a=await Promise.all(s.map(async u=>await this.makePrune(o,u,i&&!(n.get(o)??!1)))),l=za([],{prune:a});this.sendRpc(o,l)}}emitGossip(e,r){let n=this.mcache.getGossipIDs(e);if(!n.length)return;Gu(n),n.length>5e3&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",n.length);let i=[],o=this.topics.get(e);if(!o)return;o.forEach(l=>{let u=this.peers.get(l);!u||!r.has(l)&&!this.direct.has(l)&&ZI(u.protocol)&&this.score.score(l)>=this.opts.scoreThresholds.gossipThreshold&&i.push(l)});let s=this.opts.Dlazy,a=.25*i.length;a>s&&(s=a),s>i.length?s=i.length:Gu(i),i.slice(0,s).forEach(l=>{let u=n;n.length>5e3&&(u=Gu(u.slice()).slice(0,5e3)),this.pushGossip(l,{topicID:e,messageIDs:u})})}flush(){for(let[e,r]of this.gossip.entries())this.gossip.delete(e),this.sendRpc(e,za([],{ihave:r}));for(let[e,r]of this.control.entries())this.control.delete(e),this.sendRpc(e,za([],{graft:r.graft,prune:r.prune}))}pushGossip(e,r){this.log("Add gossip to %s",e);let n=this.gossip.get(e)||[];this.gossip.set(e,n.concat(r))}async makePrune(e,r,n){if(this.score.prune(e,r),this.peers.get(e).protocol===py)return{topicID:r,peers:[]};let i=BigInt(this.opts.pruneBackoff/1e3);if(!n)return{topicID:r,peers:[],backoff:i};let o=this.getRandomGossipPeers(r,this.opts.prunePeers,a=>a!==e&&this.score.score(a)>=0),s=await Promise.all(Array.from(o).map(async a=>{let l=he(a);return{peerID:l.toBytes(),signedPeerRecord:await this.components.getPeerStore().addressBook.getRawEnvelope(l)}}));return{topicID:r,peers:s,backoff:i}}async heartbeat(){let{D:e,Dlo:r,Dhi:n,Dscore:i,Dout:o,fanoutTTL:s}=this.opts;this.heartbeatTicks++;let a=new Map,l=d=>{let m=a.get(d);return m===void 0&&(m=this.score.score(d),a.set(d,m)),m},u=new Map,f=new Map,h=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune(),this.mesh.forEach((d,m)=>{let g=(w,b)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",w,m),this.addBackoff(w,m),d.delete(w),this.metrics?.onRemoveFromMesh(m,b,1);let v=f.get(w);v?v.push(m):f.set(w,[m])},y=(w,b)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",w,m),this.score.graft(w,m),d.add(w),this.metrics?.onAddToMesh(m,b,1);let v=u.get(w);v?v.push(m):u.set(w,[m])};if(d.forEach(w=>{let b=l(w);b<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",w,b,m),g(w,td.BadScore),h.set(w,!0))}),d.size<r){let w=this.backoff.get(m),b=e-d.size;this.getRandomGossipPeers(m,b,S=>!d.has(S)&&!this.direct.has(S)&&(w==null||!w.has(S))&&l(S)>=0).forEach(S=>y(S,Jc.NotEnough))}if(d.size>n){let w=Array.from(d);w.sort((v,S)=>l(S)-l(v)),w=w.slice(0,i).concat(Gu(w.slice(i)));let b=0;if(w.slice(0,e).forEach(v=>{this.outbound.get(v)&&b++}),b<o){let v=R=>{let I=w[R];for(let A=R;A>0;A--)w[A]=w[A-1];w[0]=I};if(b>0){let R=b;for(let I=1;I<e&&R>0;I++)this.outbound.get(w[I])&&(v(I),R--)}let S=e-b;for(let R=e;R<w.length&&S>0;R++)this.outbound.get(w[R])&&(v(R),S--)}w.slice(e).forEach(v=>g(v,td.Excess))}if(d.size>=r){let w=0;if(d.forEach(b=>{this.outbound.get(b)&&w++}),w<o){let b=o-w,v=this.backoff.get(m);this.getRandomGossipPeers(m,b,R=>!d.has(R)&&!this.direct.has(R)&&(!v||!v.has(R))&&l(R)>=0).forEach(R=>y(R,Jc.Outbound))}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&d.size>1){let w=Array.from(d).sort((S,R)=>l(S)-l(R)),b=Math.floor(d.size/2),v=l(w[b]);if(v<this.opts.scoreThresholds.opportunisticGraftThreshold){let S=this.backoff.get(m);this.getRandomGossipPeers(m,this.opts.opportunisticGraftPeers,I=>!d.has(I)&&!this.direct.has(I)&&(!S||!S.has(I))&&l(I)>v).forEach(I=>{this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",I,m),y(I,Jc.Opportunistic)})}}this.emitGossip(m,d)});let p=Date.now();this.fanoutLastpub.forEach((d,m)=>{d+s<p&&(this.fanout.delete(m),this.fanoutLastpub.delete(m))}),this.fanout.forEach((d,m)=>{let g=this.topics.get(m);if(d.forEach(y=>{(!g.has(y)||l(y)<this.opts.scoreThresholds.publishThreshold)&&d.delete(y)}),d.size<e){let y=e-d.size;this.getRandomGossipPeers(m,y,b=>!d.has(b)&&!this.direct.has(b)&&l(b)>=this.opts.scoreThresholds.publishThreshold).forEach(b=>{d.add(b)})}this.emitGossip(m,d)}),await this.sendGraftPrune(u,f,h),this.flush(),this.mcache.shift(),this.dispatchEvent(new ee("gossipsub:heartbeat"))}getRandomGossipPeers(e,r,n=()=>!0){let i=this.topics.get(e);if(!i)return new Set;let o=[];return i.forEach(s=>{let a=this.peers.get(s);!a||ZI(a.protocol)&&n(s)&&o.push(s)}),o=Gu(o),r>0&&o.length>r&&(o=o.slice(0,r)),new Set(o)}onScrapeMetrics(e){e.mcacheSize.set(this.mcache.size),e.cacheSize.set({cache:"direct"},this.direct.size),e.cacheSize.set({cache:"seenCache"},this.seenCache.size),e.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),e.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),e.cacheSize.set({cache:"mcache"},this.mcache.size),e.cacheSize.set({cache:"score"},this.score.size),e.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),e.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),e.cacheSize.set({cache:"topics"},this.topics.size),e.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),e.cacheSize.set({cache:"mesh"},this.mesh.size),e.cacheSize.set({cache:"fanout"},this.fanout.size),e.cacheSize.set({cache:"peers"},this.peers.size),e.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),e.cacheSize.set({cache:"gossip"},this.gossip.size),e.cacheSize.set({cache:"control"},this.control.size),e.cacheSize.set({cache:"peerhave"},this.peerhave.size),e.cacheSize.set({cache:"outbound"},this.outbound.size);let r=0;for(let s of this.backoff.values())r+=s.size;e.cacheSize.set({cache:"backoff"},r);for(let[s,a]of this.topics)e.topicPeersCount.set({topicStr:s},a.size);for(let[s,a]of this.mesh)e.meshPeerCounts.set({topicStr:s},a.size);let n=[],i=new Map;e.behaviourPenalty.reset();for(let s of this.peers.keys()){let a=this.score.score(s);n.push(a),i.set(s,a),e.behaviourPenalty.observe(this.score.peerStats.get(s)?.behaviourPenalty??0)}e.registerScores(n,this.opts.scoreThresholds),e.registerScorePerMesh(this.mesh,i);let o=Dte(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,e.topicStrToLabel);e.registerScoreWeights(o)}};vy.multicodec=my;var Lte=()=>({gossipsub:new vy({allowPublishToZeroPeers:!0,fallbackToFloodsub:!0,emitSelf:!0})});c();te();c();var qte=E(ql(),1);c();c();function TC(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var ad=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},tl,Sy=class{constructor(){tl.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&ad(this,tl,"f")[this.size-1].priority>=r.priority){ad(this,tl,"f").push(n);return}let i=TC(ad(this,tl,"f"),n,(o,s)=>s.priority-o.priority);ad(this,tl,"f").splice(i,0,n)}dequeue(){let e=ad(this,tl,"f").shift();return e?.run}filter(e){return ad(this,tl,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return ad(this,tl,"f").length}};tl=new WeakMap;var tr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},we=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},jn,Ry,Ty,Ju,IE,Ay,xE,js,xy,Eo,RE,bo,Iy,Zu,y1,w1,cd,TE,Bte,Mte,Vte,Ute,Fte,Kte,AE,AC,IC,CE,PE=()=>{},XAe=new hi,CC=class extends Error{},Cy=class extends qte.default{constructor(e){var r,n,i,o;if(super(),jn.add(this),Ry.set(this,void 0),Ty.set(this,void 0),Ju.set(this,0),IE.set(this,void 0),Ay.set(this,void 0),xE.set(this,0),js.set(this,void 0),xy.set(this,void 0),Eo.set(this,void 0),RE.set(this,void 0),bo.set(this,0),Iy.set(this,void 0),Zu.set(this,void 0),y1.set(this,PE),w1.set(this,PE),cd.set(this,void 0),TE.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Sy,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);tr(this,Ry,e.carryoverConcurrencyCount,"f"),tr(this,Ty,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),tr(this,IE,e.intervalCap,"f"),tr(this,Ay,e.interval,"f"),tr(this,Eo,new e.queueClass,"f"),tr(this,RE,e.queueClass,"f"),this.concurrency=e.concurrency,tr(this,cd,e.timeout,"f"),tr(this,TE,e.throwOnTimeout===!0,"f"),tr(this,Zu,e.autoStart===!1,"f")}get concurrency(){return we(this,Iy,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);tr(this,Iy,e,"f"),we(this,jn,"m",CE).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;tr(this,bo,(a=we(this,bo,"f"),a++,a),"f"),tr(this,Ju,(l=we(this,Ju,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new CC("The task was aborted."));return}let f=await(we(this,cd,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?we(this,cd,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?we(this,TE,"f"):r.throwOnTimeout)&&i(XAe)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}we(this,jn,"m",Vte).call(this)};we(this,Eo,"f").enqueue(o,r),we(this,jn,"m",AE).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return we(this,Zu,"f")?(tr(this,Zu,!1,"f"),we(this,jn,"m",CE).call(this),this):this}pause(){tr(this,Zu,!0,"f")}clear(){tr(this,Eo,new(we(this,RE,"f")),"f")}async onEmpty(){if(we(this,Eo,"f").size!==0)return new Promise(e=>{let r=we(this,y1,"f");tr(this,y1,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(we(this,Eo,"f").size<e))return new Promise(r=>{let n=()=>{we(this,Eo,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(we(this,bo,"f")===0&&we(this,Eo,"f").size===0))return new Promise(e=>{let r=we(this,w1,"f");tr(this,w1,()=>{r(),e()},"f")})}get size(){return we(this,Eo,"f").size}sizeBy(e){return we(this,Eo,"f").filter(e).length}get pending(){return we(this,bo,"f")}get isPaused(){return we(this,Zu,"f")}get timeout(){return we(this,cd,"f")}set timeout(e){tr(this,cd,e,"f")}};Ry=new WeakMap,Ty=new WeakMap,Ju=new WeakMap,IE=new WeakMap,Ay=new WeakMap,xE=new WeakMap,js=new WeakMap,xy=new WeakMap,Eo=new WeakMap,RE=new WeakMap,bo=new WeakMap,Iy=new WeakMap,Zu=new WeakMap,y1=new WeakMap,w1=new WeakMap,cd=new WeakMap,TE=new WeakMap,jn=new WeakSet,Bte=function(){return we(this,Ty,"f")||we(this,Ju,"f")<we(this,IE,"f")},Mte=function(){return we(this,bo,"f")<we(this,Iy,"f")},Vte=function(){var e;tr(this,bo,(e=we(this,bo,"f"),e--,e),"f"),we(this,jn,"m",AE).call(this),this.emit("next")},Ute=function(){we(this,y1,"f").call(this),tr(this,y1,PE,"f"),we(this,bo,"f")===0&&(we(this,w1,"f").call(this),tr(this,w1,PE,"f"),this.emit("idle"))},Fte=function(){we(this,jn,"m",IC).call(this),we(this,jn,"m",AC).call(this),tr(this,xy,void 0,"f")},Kte=function(){let e=Date.now();if(we(this,js,"f")===void 0){let r=we(this,xE,"f")-e;if(r<0)tr(this,Ju,we(this,Ry,"f")?we(this,bo,"f"):0,"f");else return we(this,xy,"f")===void 0&&tr(this,xy,setTimeout(()=>{we(this,jn,"m",Fte).call(this)},r),"f"),!0}return!1},AE=function(){if(we(this,Eo,"f").size===0)return we(this,js,"f")&&clearInterval(we(this,js,"f")),tr(this,js,void 0,"f"),we(this,jn,"m",Ute).call(this),!1;if(!we(this,Zu,"f")){let e=!we(this,jn,"m",Kte).call(this);if(we(this,jn,"a",Bte)&&we(this,jn,"a",Mte)){let r=we(this,Eo,"f").dequeue();return r?(this.emit("active"),r(),e&&we(this,jn,"m",AC).call(this),!0):!1}}return!1},AC=function(){we(this,Ty,"f")||we(this,js,"f")!==void 0||(tr(this,js,setInterval(()=>{we(this,jn,"m",IC).call(this)},we(this,Ay,"f")),"f"),tr(this,xE,Date.now()+we(this,Ay,"f"),"f"))},IC=function(){we(this,Ju,"f")===0&&we(this,bo,"f")===0&&we(this,js,"f")&&(clearInterval(we(this,js,"f")),tr(this,js,void 0,"f")),tr(this,Ju,we(this,Ry,"f")?we(this,bo,"f"):0,"f"),we(this,jn,"m",CE).call(this)},CE=function(){for(;we(this,jn,"m",AE).call(this););};var Hte=E(V(),1);var PC=E(Ui(),1);var ld=C("libp2p-delegated-peer-routing"),zte=3e4,ZAe=4,NE=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new Cy({concurrency:ZAe});let{protocol:r,host:n,port:i}=e.getEndpointConfig();ld(`enabled DelegatedPeerRouting via ${r}://${n}:${i}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async findPeer(e,r={}){ld("findPeer starts: %p",e),r.timeout=r.timeout??zte,r.signal=(0,PC.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[]));let n=Sr(),i=Sr();this.httpQueue.add(async()=>(n.resolve(),await i.promise));try{await n.promise;for await(let o of this.client.dht.findPeer(e,r))if(o.name==="FINAL_PEER")return{id:o.peer.id,multiaddrs:o.peer.multiaddrs.map(a=>new W(a.toString())),protocols:[]}}catch(o){throw ld.error("findPeer errored: %o",o),o}finally{i.resolve(),ld("findPeer finished: %p",e)}throw(0,Hte.default)(new Error("Not found"),"ERR_NOT_FOUND")}async*getClosestPeers(e,r={}){let n,i=T.asCID(e);i!=null?n=i:n=Rr(e),ld("getClosestPeers starts: %s",n),r.timeout=r.timeout??zte,r.signal=(0,PC.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[]));let o=Sr(),s=Sr();this.httpQueue.add(async()=>(o.resolve(),await s.promise));try{await o.promise;for await(let a of this.client.dht.query(n,r))a.name==="PEER_RESPONSE"&&(yield*a.closer.map(l=>({id:l.id,multiaddrs:l.multiaddrs.map(u=>new W(u.toString())),protocols:[]})))}catch(a){throw ld.error("getClosestPeers errored:",a),a}finally{s.resolve(),ld("getClosestPeers finished: %b",e)}}};c();var LC=E(Ti(),1);c();var Xte=E(ql(),1);c();c();function NC(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var ud=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},rl,Py=class{constructor(){rl.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&ud(this,rl,"f")[this.size-1].priority>=r.priority){ud(this,rl,"f").push(n);return}let i=NC(ud(this,rl,"f"),n,(o,s)=>s.priority-o.priority);ud(this,rl,"f").splice(i,0,n)}dequeue(){let e=ud(this,rl,"f").shift();return e?.run}filter(e){return ud(this,rl,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return ud(this,rl,"f").length}};rl=new WeakMap;var rr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Ee=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Yn,ky,Dy,tf,BE,Oy,kE,Ys,Ny,_o,DE,vo,Ly,ef,E1,b1,fd,OE,$te,Gte,Qte,Wte,jte,Yte,LE,kC,DC,ME,UE=()=>{},JAe=new hi,OC=class extends Error{},_1=class extends Xte.default{constructor(e){var r,n,i,o;if(super(),Yn.add(this),ky.set(this,void 0),Dy.set(this,void 0),tf.set(this,0),BE.set(this,void 0),Oy.set(this,void 0),kE.set(this,0),Ys.set(this,void 0),Ny.set(this,void 0),_o.set(this,void 0),DE.set(this,void 0),vo.set(this,0),Ly.set(this,void 0),ef.set(this,void 0),E1.set(this,UE),b1.set(this,UE),fd.set(this,void 0),OE.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Py,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);rr(this,ky,e.carryoverConcurrencyCount,"f"),rr(this,Dy,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),rr(this,BE,e.intervalCap,"f"),rr(this,Oy,e.interval,"f"),rr(this,_o,new e.queueClass,"f"),rr(this,DE,e.queueClass,"f"),this.concurrency=e.concurrency,rr(this,fd,e.timeout,"f"),rr(this,OE,e.throwOnTimeout===!0,"f"),rr(this,ef,e.autoStart===!1,"f")}get concurrency(){return Ee(this,Ly,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);rr(this,Ly,e,"f"),Ee(this,Yn,"m",ME).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;rr(this,vo,(a=Ee(this,vo,"f"),a++,a),"f"),rr(this,tf,(l=Ee(this,tf,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new OC("The task was aborted."));return}let f=await(Ee(this,fd,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?Ee(this,fd,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?Ee(this,OE,"f"):r.throwOnTimeout)&&i(JAe)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}Ee(this,Yn,"m",Qte).call(this)};Ee(this,_o,"f").enqueue(o,r),Ee(this,Yn,"m",LE).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return Ee(this,ef,"f")?(rr(this,ef,!1,"f"),Ee(this,Yn,"m",ME).call(this),this):this}pause(){rr(this,ef,!0,"f")}clear(){rr(this,_o,new(Ee(this,DE,"f")),"f")}async onEmpty(){if(Ee(this,_o,"f").size!==0)return new Promise(e=>{let r=Ee(this,E1,"f");rr(this,E1,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(Ee(this,_o,"f").size<e))return new Promise(r=>{let n=()=>{Ee(this,_o,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(Ee(this,vo,"f")===0&&Ee(this,_o,"f").size===0))return new Promise(e=>{let r=Ee(this,b1,"f");rr(this,b1,()=>{r(),e()},"f")})}get size(){return Ee(this,_o,"f").size}sizeBy(e){return Ee(this,_o,"f").filter(e).length}get pending(){return Ee(this,vo,"f")}get isPaused(){return Ee(this,ef,"f")}get timeout(){return Ee(this,fd,"f")}set timeout(e){rr(this,fd,e,"f")}};ky=new WeakMap,Dy=new WeakMap,tf=new WeakMap,BE=new WeakMap,Oy=new WeakMap,kE=new WeakMap,Ys=new WeakMap,Ny=new WeakMap,_o=new WeakMap,DE=new WeakMap,vo=new WeakMap,Ly=new WeakMap,ef=new WeakMap,E1=new WeakMap,b1=new WeakMap,fd=new WeakMap,OE=new WeakMap,Yn=new WeakSet,$te=function(){return Ee(this,Dy,"f")||Ee(this,tf,"f")<Ee(this,BE,"f")},Gte=function(){return Ee(this,vo,"f")<Ee(this,Ly,"f")},Qte=function(){var e;rr(this,vo,(e=Ee(this,vo,"f"),e--,e),"f"),Ee(this,Yn,"m",LE).call(this),this.emit("next")},Wte=function(){Ee(this,E1,"f").call(this),rr(this,E1,UE,"f"),Ee(this,vo,"f")===0&&(Ee(this,b1,"f").call(this),rr(this,b1,UE,"f"),this.emit("idle"))},jte=function(){Ee(this,Yn,"m",DC).call(this),Ee(this,Yn,"m",kC).call(this),rr(this,Ny,void 0,"f")},Yte=function(){let e=Date.now();if(Ee(this,Ys,"f")===void 0){let r=Ee(this,kE,"f")-e;if(r<0)rr(this,tf,Ee(this,ky,"f")?Ee(this,vo,"f"):0,"f");else return Ee(this,Ny,"f")===void 0&&rr(this,Ny,setTimeout(()=>{Ee(this,Yn,"m",jte).call(this)},r),"f"),!0}return!1},LE=function(){if(Ee(this,_o,"f").size===0)return Ee(this,Ys,"f")&&clearInterval(Ee(this,Ys,"f")),rr(this,Ys,void 0,"f"),Ee(this,Yn,"m",Wte).call(this),!1;if(!Ee(this,ef,"f")){let e=!Ee(this,Yn,"m",Yte).call(this);if(Ee(this,Yn,"a",$te)&&Ee(this,Yn,"a",Gte)){let r=Ee(this,_o,"f").dequeue();return r?(this.emit("active"),r(),e&&Ee(this,Yn,"m",kC).call(this),!0):!1}}return!1},kC=function(){Ee(this,Dy,"f")||Ee(this,Ys,"f")!==void 0||(rr(this,Ys,setInterval(()=>{Ee(this,Yn,"m",DC).call(this)},Ee(this,Oy,"f")),"f"),rr(this,kE,Date.now()+Ee(this,Oy,"f"),"f"))},DC=function(){Ee(this,tf,"f")===0&&Ee(this,vo,"f")===0&&Ee(this,Ys,"f")&&(clearInterval(Ee(this,Ys,"f")),rr(this,Ys,void 0,"f")),rr(this,tf,Ee(this,ky,"f")?Ee(this,vo,"f"):0,"f"),Ee(this,Yn,"m",ME).call(this)},ME=function(){for(;Ee(this,Yn,"m",LE).call(this););};var Zte=E(V(),1),By=E(Ui(),1),Wa=C("libp2p:delegated-content-routing"),FE=3e4,eIe=4,tIe=2,KE=class{constructor(e){if(e==null)throw new Error("missing ipfs http client");this.client=e,this.started=!1,this.abortController=new AbortController,this.httpQueue=new _1({concurrency:eIe}),this.httpQueueRefs=new _1({concurrency:tIe});let{protocol:r,host:n,port:i}=e.getEndpointConfig();Wa(`enabled DelegatedContentRouting via ${r}://${n}:${i}`)}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.httpQueueRefs.clear(),this.abortController.abort(),this.abortController=new AbortController,this.started=!1}async*findProviders(e,r={}){Wa("findProviders starts: %c",e),r.timeout=r.timeout??FE,r.signal=(0,By.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[]));let n=Sr(),i=Sr();this.httpQueue.add(async()=>(n.resolve(),await i.promise));try{await n.promise;for await(let o of this.client.dht.findProvs(e,r))o.name==="PROVIDER"&&(yield*o.providers.map(s=>({id:s.id,protocols:[],multiaddrs:s.multiaddrs.map(l=>new W(l.toString()))})))}catch(o){throw Wa.error("findProviders errored:",o),o}finally{i.resolve(),Wa("findProviders finished: %c",e)}}async provide(e,r={}){Wa("provide starts: %c",e),r.timeout=r.timeout??FE,r.signal=(0,By.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[])),await this.httpQueueRefs.add(async()=>{await this.client.block.stat(e,r),await(0,LC.default)(this.client.dht.provide(e,r))}),Wa("provide finished: %c",e)}async put(e,r,n={}){Wa("put value start: %b",e),n.timeout=n.timeout??FE,n.signal=(0,By.default)([this.abortController.signal].concat(n.signal!=null?[n.signal]:[])),await this.httpQueue.add(async()=>{await(0,LC.default)(this.client.dht.put(e,r,n))}),Wa("put value finished: %b",e)}async get(e,r={}){return Wa("get value start: %b",e),r.timeout=r.timeout??FE,r.signal=(0,By.default)([this.abortController.signal].concat(r.signal!=null?[r.signal]:[])),await this.httpQueue.add(async()=>{for await(let n of this.client.dht.get(e,r))if(n.name==="VALUE")return Wa("get value finished: %b",e),n.value;throw(0,Zte.default)(new Error("Not found"),"ERR_NOT_FOUND")})}};c();c();var rIe=t=>Promise.reject(new Error(`No base found for "${t}"`)),v1=class{constructor(e){this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase||rIe;for(let r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]||this._basesByPrefix[e.prefix])throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e])return this._basesByName[e];if(this._basesByPrefix[e])return this._basesByPrefix[e];let r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}};c();var nIe=t=>Promise.reject(new Error(`No codec found for "${t}"`)),S1=class{constructor(e){this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec||nIe;for(let r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]||this._codecsByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){let r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e])return r[e];let n=await this._loadCodec(e);return r[e]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}};c();var iIe=t=>Promise.reject(new Error(`No hasher found for "${t}"`)),x1=class{constructor(e){this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher||iIe;for(let r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]||this._hashersByCode[e.code])throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){let r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e])return r[e];let n=await this._loadHasher(e);return r[e]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}};var MIe=E(S9(),1);gc();Vm();c();c();te();c();c();var ja=E(l4(),1);var hd=E(Ip(),1);c();function BC(t){try{t=v0(new W(t))}catch{}return t=t.toString(),t}c();var Jte=()=>{};var ere=C("ipfs-http-client:lib:error-handler"),oIe=Ye.bind({ignoreUndefined:!0}),sIe=ja.isBrowser||ja.isWebWorker?location.protocol:"http",aIe=ja.isBrowser||ja.isWebWorker?location.hostname:"localhost",cIe=ja.isBrowser||ja.isWebWorker?location.port:"5001",lIe=(t={})=>{let e,r={},n;if(typeof t=="string"||W.isMultiaddr(t))e=new URL(BC(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||W.isMultiaddr(t.url))e=new URL(BC(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t||{};let i=(r.protocol||sIe).replace(":",""),o=(r.host||aIe).split(":")[0],s=r.port||cIe;e=new URL(`${i}://${o}:${s}`)}if(r.apiPath?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),ja.isNode){let i=Jte(e);n=r.agent||new i({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:n}},uIe=async t=>{let e;try{if((t.headers.get("Content-Type")||"").startsWith("application/json")){let n=await t.json();ere(n),e=n.Message||n.message}else e=await t.text()}catch(n){ere("Failed to parse error response",n),e=n.message}let r=new hd.default.HTTPError(t);throw e&&(e.includes("deadline has elapsed")&&(r=new hd.default.TimeoutError),e&&e.includes("context deadline exceeded")&&(r=new hd.default.TimeoutError)),e&&e.includes("request timed out")&&(r=new hd.default.TimeoutError),e&&(r.message=e),r},fIe=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,tre=t=>t.replace(fIe,function(e){return"-"+e.toLowerCase()}),hIe=t=>typeof t=="string"?Fl(t):t,rf=class extends hd.default{constructor(e={}){let r=lIe(e);super({timeout:hIe(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:uIe,transformSearchParams:i=>{let o=new URLSearchParams;for(let[s,a]of i)a!=="undefined"&&a!=="null"&&s!=="signal"&&o.append(tre(s),a),s==="timeout"&&!isNaN(a)&&o.append(tre(s),a);return o},agent:r.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;let n=this.fetch;this.fetch=(i,o={})=>(typeof i=="string"&&!i.startsWith("/")&&(i=`${r.url}/${i}`),n.call(this,i,oIe(o,{method:"POST"})))}},mht=hd.default.HTTPError;var P=t=>e=>t(new rf(e),e);c();c();function VE(t){if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}c();var rre=E(V(),1);function qE(t){if(t==null)return;let e;if(t.secs!=null&&(e={secs:t.secs,nsecs:t.nsecs}),t.Seconds!=null&&(e={secs:t.Seconds,nsecs:t.FractionalNanoseconds}),Array.isArray(t)&&(e={secs:t[0],nsecs:t[1]}),t instanceof Date){let r=t.getTime(),n=Math.floor(r/1e3);e={secs:n,nsecs:(r-n*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(e,"secs")){if(e!=null&&e.nsecs!=null&&(e.nsecs<0||e.nsecs>999999999))throw(0,rre.default)(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return e}}function k({arg:t,searchParams:e,hashAlg:r,mtime:n,mode:i,...o}={}){e&&(o={...o,...e}),r&&(o.hash=r),n!=null&&(n=qE(n),o.mtime=n.secs,o.mtimeNsecs=n.nsecs),i!=null&&(o.mode=VE(i)),o.timeout&&!isNaN(o.timeout)&&(o.timeout=`${o.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);let s=new URLSearchParams(o);return t.forEach(a=>s.append("arg",a)),s}var nre=P(t=>{async function e(r={}){return((await(await t.post("bitswap/wantlist",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Keys||[]).map(i=>T.parse(i["/"]))}return e});c();te();var ire=P(t=>{async function e(r,n={}){return((await(await t.post("bitswap/wantlist",{signal:n.signal,searchParams:k({...n,peer:r.toString()}),headers:n.headers})).json()).Keys||[]).map(o=>T.parse(o["/"]))}return e});c();te();var zE=P(t=>{async function e(r={}){let n=await t.post("bitswap/stat",{searchParams:k(r),signal:r.signal,headers:r.headers});return dIe(await n.json())}return e});function dIe(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist||[]).map(e=>T.parse(e["/"])),peers:(t.Peers||[]).map(e=>he(e)),blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}c();var ore=P(t=>{async function e(r,n={}){return(await t.post("bitswap/unwant",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).json()}return e});function sre(t){return{wantlist:nre(t),wantlistForPeer:ire(t),unwant:ore(t),stat:zE(t)}}c();c();var HE=P(t=>{async function e(r,n={}){let i=await t.post("block/get",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await i.arrayBuffer())}return e});c();te();c();c();c();var cre=E(V(),1),lre=E(u0(),1),ure=E(l0(),1),fre=E(Bs(),1);async function hre(t){if(Yo(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if(Lc(t))return t;if(Bc(t)&&(t=(0,ure.default)(t)),Symbol.iterator in t||Symbol.asyncIterator in t){let e=(0,lre.default)(t),{value:r,done:n}=await e.peek();if(n)return are(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await(0,fre.default)(e))]);if(Yo(r)||typeof r=="string"||r instanceof String)return are(e)}throw(0,cre.default)(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT")}async function are(t){let e=[];for await(let r of t)e.push(r);return new Blob(e)}function dre(t){return j6(t,hre,!0)}c();function pre(t){if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}async function En(t,e,r={}){let n=[],i=new FormData,o=0,s=0;for await(let{content:a,path:l,mode:u,mtime:f}of dre(t)){let h="",p=a?"file":"dir";o>0&&(h=`-${o}`);let d=p+h,m=[];if(u!=null&&m.push(`mode=${pre(u)}`),f!=null){let{secs:g,nsecs:y}=f;m.push(`mtime=${g}`),y!=null&&m.push(`mtime-nsecs=${y}`)}if(m.length&&(d=`${d}?${m.join("&")}`),a){i.set(d,a,l!=null?encodeURIComponent(l):void 0);let g=s+a.size;n.push({name:l,start:s,end:g}),s=g}else if(l!=null)i.set(d,new File([""],encodeURIComponent(l),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");o++}return{total:s,parts:n,headers:r,body:i}}c();var mre=E(Ui(),1);function pIe(t){return t.filter(Boolean)}function bn(...t){return(0,mre.anySignal)(pIe(t))}var gre=P(t=>{async function e(r,n={}){let i=new AbortController,o=bn(i.signal,n.signal),s;try{s=await(await t.post("block/put",{signal:o,searchParams:k(n),...await En([r],i,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return e(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return e(r,{...n,format:"cbor"});throw a}return T.parse(s.Key)}return e});c();te();var yre=P(t=>{async function*e(r,n={}){Array.isArray(r)||(r=[r]);let i=await t.post("block/rm",{signal:n.signal,searchParams:k({arg:r.map(o=>o.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(let o of i.ndjson())yield mIe(o)}return e});function mIe(t){let e={cid:T.parse(t.Hash)};return t.Error&&(e.error=new Error(t.Error)),e}c();te();var wre=P(t=>{async function e(r,n={}){let o=await(await t.post("block/stat",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:T.parse(o.Key),size:o.Size}}return e});function Ere(t){return{get:HE(t),put:gre(t),rm:yre(t),stat:wre(t)}}c();c();var bre=P(t=>{async function e(r,n={}){let i=await t.post("bootstrap/add",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Peers:o}=await i.json();return{Peers:o.map(s=>new W(s))}}return e});c();var _re=P(t=>{async function e(r={}){let n=await t.post("bootstrap/rm",{signal:r.signal,searchParams:k({...r,all:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(o=>new W(o))}}return e});c();var vre=P(t=>{async function e(r={}){let n=await t.post("bootstrap/list",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(o=>new W(o))}}return e});c();var Sre=P(t=>{async function e(r={}){let n=await t.post("bootstrap/add",{signal:r.signal,searchParams:k({...r,default:!0}),headers:r.headers}),{Peers:i}=await n.json();return{Peers:i.map(o=>new W(o))}}return e});c();var xre=P(t=>{async function e(r,n={}){let i=await t.post("bootstrap/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Peers:o}=await i.json();return{Peers:o.map(s=>new W(s))}}return e});function Rre(t){return{add:bre(t),clear:_re(t),list:vre(t),reset:Sre(t),rm:xre(t)}}c();c();c();var Tre=P(t=>{async function e(r,n={}){let o=await(await t.post("config/profile/apply",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return{original:o.OldCfg,updated:o.NewCfg}}return e});c();c();function St(t){if(t==null)return t;let e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((n,i)=>(e.test(i)?n[i.toLowerCase()]=t[i]:e.test(i[0])?n[i[0].toLowerCase()+i.slice(1)]=t[i]:n[i]=t[i],n),r)}var Are=P(t=>{async function e(r={}){return(await(await t.post("config/profile/list",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).map(o=>St(o))}return e});function Ire(t){return{apply:Tre(t),list:Are(t)}}c();var Cre=P(t=>async(r,n={})=>{if(!r)throw new Error("key argument is required");return(await(await t.post("config",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json()).Value});c();var Pre=P(t=>async(r={})=>await(await t.post("config/show",{signal:r.signal,searchParams:k({...r}),headers:r.headers})).json());c();Ae();var Nre=P(t=>async(r,n={})=>{let i=new AbortController,o=bn(i.signal,n.signal);await(await t.post("config/replace",{signal:o,searchParams:k(n),...await En([U(JSON.stringify(r))],i,n.headers)})).text()});c();var kre=P(t=>async(r,n,i={})=>{if(typeof r!="string")throw new Error("Invalid key type");let o={...i,...gIe(r,n)};await(await t.post("config",{signal:i.signal,searchParams:k(o),headers:i.headers})).text()}),gIe=(t,e)=>{switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}};function Dre(t){return{getAll:Pre(t),get:Cre(t),set:kre(t),replace:Nre(t),profiles:Ire(t)}}c();c();var Ore=P(t=>{async function*e(r,n={}){yield*(await t.post("dag/export",{signal:n.signal,searchParams:k({arg:r.toString()}),headers:n.headers})).iterator()}return e});c();c();te();var MC=E(V(),1);async function*UC(t,e,r,n,i){let o=async u=>{let f=await r.getCodec(u.code),h=await n(u,i);return f.decode(h)},s=e.split("/").filter(Boolean),a=await o(t),l=t;for(;s.length;){let u=s.shift();if(!u)throw(0,MC.default)(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,u))a=a[u],yield{value:a,remainderPath:s.join("/")};else throw(0,MC.default)(new Error(`no link named "${u}" under ${l}`),"ERR_NO_LINK");let f=T.asCID(a);f&&(l=f,a=await o(a))}yield{value:a,remainderPath:""}}var Lre=E(Kc(),1),Bre=E(Fi(),1),Mre=E(V(),1);var Ure=(t,e)=>P((n,i)=>{let o=HE(i);return async(a,l={})=>{if(l.path){let d=l.localResolve?await(0,Lre.default)(UC(a,l.path,t,o,l)):await(0,Bre.default)(UC(a,l.path,t,o,l));if(!d)throw(0,Mre.default)(new Error("Not found"),"ERR_NOT_FOUND");return d}let u=await t.getCodec(a.code),f=await o(a,l);return{value:u.decode(f),remainderPath:""}}})(e);c();te();var Fre=P(t=>{async function*e(r,n={}){let i=new AbortController,o=bn(i.signal,n.signal),{headers:s,body:a}=await En(r,i,n.headers),l=await t.post("dag/import",{signal:o,headers:s,body:a,searchParams:k({"pin-roots":n.pinRoots})});for await(let{Root:u}of l.ndjson())if(u!==void 0){let{Cid:{"/":f},PinErrorMsg:h}=u;yield{root:{cid:T.parse(f),pinErrorMsg:h}}}}return e});c();te();var $E=(t,e)=>P(n=>async(o,s={})=>{let a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...s},l;if(a.inputCodec){if(!(o instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");l=o}else l=(await t.getCodec(a.storeCodec)).encode(o),a.inputCodec=a.storeCodec;let u=new AbortController,f=bn(u.signal,a.signal),p=await(await n.post("dag/put",{timeout:a.timeout,signal:f,searchParams:k(a),...await En([l],u,a.headers)})).json();return T.parse(p.Cid["/"])})(e);c();te();var Kre=P(t=>async(r,n={})=>{let o=await(await t.post("dag/resolve",{signal:n.signal,searchParams:k({arg:`${r}${n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:T.parse(o.Cid["/"]),remainderPath:o.RemPath}});function Vre(t,e){return{export:Ore(e),get:Ure(t,e),import:Fre(e),put:$E(t,e),resolve:Kre(e)}}c();c();c();Ae();c();var ss=t=>{if(t.Type===0)return{name:"SENDING_QUERY",type:t.Type};if(t.Type===1)return{from:he(t.ID),name:"PEER_RESPONSE",type:t.Type,messageType:0,messageName:"PUT_VALUE",closer:(t.Responses||[]).map(({ID:e,Addrs:r})=>({id:he(e),multiaddrs:r.map(n=>new W(n)),protocols:[]})),providers:(t.Responses||[]).map(({ID:e,Addrs:r})=>({id:he(e),multiaddrs:r.map(n=>new W(n)),protocols:[]}))};if(t.Type===2){let e={id:t.ID??he(t.ID),multiaddrs:[],protocols:[]};return t.Responses&&t.Responses.length&&(e={id:he(t.Responses[0].ID),multiaddrs:t.Responses[0].Addrs.map(r=>new W(r)),protocols:[]}),{name:"FINAL_PEER",type:t.Type,peer:e}}if(t.Type===3)return{name:"QUERY_ERROR",type:t.Type,error:new Error(t.Extra)};if(t.Type===4)return{name:"PROVIDER",type:t.Type,providers:t.Responses.map(({ID:e,Addrs:r})=>({id:he(e),multiaddrs:r.map(n=>new W(n)),protocols:[]}))};if(t.Type===5)return{name:"VALUE",type:t.Type,value:U(t.Extra,"base64pad")};if(t.Type===6){let e=t.Responses.map(({ID:r})=>he(r));if(!e.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:t.Type,peer:e[0]}}if(t.Type===7)return{name:"DIALING_PEER",type:t.Type,peer:he(t.ID)};throw new Error("Unknown DHT event type")};var qre=P(t=>{async function*e(r,n={}){let i=await t.post("dht/findpeer",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers});for await(let o of i.ndjson())yield ss(o)}return e});c();var zre=P(t=>{async function*e(r,n={}){let i=await t.post("dht/findprovs",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});for await(let o of i.ndjson())yield ss(o)}return e});c();Re();var Hre=P(t=>{async function*e(r,n={}){let i=await t.post("dht/get",{signal:n.signal,searchParams:k({arg:r instanceof Uint8Array?F(r):r.toString(),...n}),headers:n.headers});for await(let o of i.ndjson())yield ss(o)}return e});c();var $re=P(t=>{async function*e(r,n={recursive:!1}){let i=Array.isArray(r)?r:[r],o=await t.post("dht/provide",{signal:n.signal,searchParams:k({arg:i.map(s=>s.toString()),...n}),headers:n.headers});for await(let s of o.ndjson())yield ss(s)}return e});c();Re();var Gre=P(t=>{async function*e(r,n,i={}){let o=new AbortController,s=bn(o.signal,i.signal),a=await t.post("dht/put",{signal:s,searchParams:k({arg:r instanceof Uint8Array?F(r):r.toString(),...i}),...await En([n],o,i.headers)});for await(let l of a.ndjson())yield ss(l)}return e});c();var Wre=P(t=>{async function*e(r,n={}){let i=await t.post("dht/query",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers});for await(let o of i.ndjson())yield ss(o)}return e});function jre(t){return{findPeer:qre(t),findProvs:zre(t),get:Hre(t),provide:$re(t),put:Gre(t),query:Wre(t)}}c();c();var Yre=P(t=>{async function e(r={}){return(await t.post("diag/cmds",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return e});c();var Qre=P(t=>{async function e(r={}){return(await t.post("diag/net",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return e});c();var Xre=P(t=>{async function e(r={}){return(await t.post("diag/sys",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()}return e});function Zre(t){return{cmds:Yre(t),net:Qre(t),sys:Xre(t)}}c();c();var Jre=P(t=>{async function e(r,n,i={}){await(await t.post("files/chmod",{signal:i.signal,searchParams:k({arg:r,mode:n,...i}),headers:i.headers})).text()}return e});c();te();var ene=P(t=>{async function e(r,n,i={}){let o=Array.isArray(r)?r:[r];await(await t.post("files/cp",{signal:i.signal,searchParams:k({arg:o.concat(n).map(a=>T.asCID(a)?`/ipfs/${a}`:a),...i}),headers:i.headers})).text()}return e});c();te();var tne=P(t=>{async function e(r,n={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");let o=await(await t.post("files/flush",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return T.parse(o.Cid)}return e});c();te();c();function My(t){let e=St(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs||0},delete e.mtimeNsecs),e}var nne=P(t=>{async function*e(r,n={}){if(!r)throw new Error("ipfs.files.ls requires a path");let i=await t.post("files/ls",{signal:n.signal,searchParams:k({arg:T.asCID(r)?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(let o of i.ndjson())if("Entries"in o)for(let s of o.Entries||[])yield rne(My(s));else yield rne(My(o))}return e});function rne(t){return t.hash&&(t.cid=T.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}c();var ine=P(t=>{async function e(r,n={}){await(await t.post("files/mkdir",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).text()}return e});c();var one=P(t=>{async function e(r,n,i={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{signal:i.signal,searchParams:k({arg:r.concat(n),...i}),headers:i.headers})).text()}return e});c();var cne=E(ane(),1),lne=P(t=>{async function*e(r,n={}){let i=await t.post("files/read",{signal:n.signal,searchParams:k({arg:r,count:n.length,...n}),headers:n.headers});yield*(0,cne.default)(i.body)}return e});c();var une=E(Ip(),1),fne=P(t=>{async function e(r,n={}){let i=await t.post("files/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),o=await i.text();if(o!==""){let s=new une.default.HTTPError(i);throw s.message=o,s}}return e});c();te();var GE=P(t=>{async function e(r,n={}){let o=await(await t.post("files/stat",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return o.WithLocality=o.WithLocality||!1,RIe(My(o))}return e});function RIe(t){return t.cid=T.parse(t.hash),delete t.hash,t}c();var hne=P(t=>{async function e(r,n={}){await(await t.post("files/touch",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).text()}return e});c();var dne=P(t=>{async function e(r,n,i={}){let o=new AbortController,s=bn(o.signal,i.signal);await(await t.post("files/write",{signal:s,searchParams:k({arg:r,streamChannels:!0,count:i.length,...i}),...await En([{content:n,path:"arg",mode:VE(i.mode),mtime:qE(i.mtime)}],o,i.headers)})).text()}return e});function pne(t){return{chmod:Jre(t),cp:ene(t),flush:tne(t),ls:nne(t),mkdir:ine(t),mv:one(t),read:lne(t),rm:fne(t),stat:GE(t),touch:hne(t),write:dne(t)}}c();c();var mne=E(V(),1),gne=P(t=>async(r,n,i={})=>{throw(0,mne.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var yne=P(t=>{async function e(r,n={type:"Ed25519"}){let o=await(await t.post("key/gen",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return St(o)}return e});c();var wne=P(t=>{async function e(r,n,i,o={}){let a=await(await t.post("key/import",{signal:o.signal,searchParams:k({arg:r,pem:n,password:i,...o}),headers:o.headers})).json();return St(a)}return e});c();var Ene=E(V(),1),bne=P(t=>async(r,n={})=>{throw(0,Ene.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var _ne=P(t=>{async function e(r={}){return((await(await t.post("key/list",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Keys||[]).map(o=>St(o))}return e});c();var vne=P(t=>{async function e(r,n,i={}){let o=await t.post("key/rename",{signal:i.signal,searchParams:k({arg:[r,n],...i}),headers:i.headers});return St(await o.json())}return e});c();var Sne=P(t=>{async function e(r,n={}){let o=await(await t.post("key/rm",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json();return St(o.Keys[0])}return e});function xne(t){return{export:gne(t),gen:yne(t),import:wne(t),info:bne(t),list:_ne(t),rename:vne(t),rm:Sne(t)}}c();c();var Rne=P(t=>{async function e(r,n,i={}){let o=await t.post("log/level",{signal:i.signal,searchParams:k({arg:[r,n],...i}),headers:i.headers});return St(await o.json())}return e});c();var Tne=P(t=>{async function e(r={}){return(await(await t.post("log/ls",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Strings}return e});c();var Ane=P(t=>{async function*e(r={}){yield*(await t.post("log/tail",{signal:r.signal,searchParams:k(r),headers:r.headers})).ndjson()}return e});function Ine(t){return{level:Rne(t),ls:Tne(t),tail:Ane(t)}}c();c();var Cne=P(t=>{async function e(r,n={}){let i=await t.post("name/publish",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers});return St(await i.json())}return e});c();var Pne=P(t=>{async function*e(r,n={}){let i=await t.post("name/resolve",{signal:n.signal,searchParams:k({arg:r,stream:!0,...n}),headers:n.headers});for await(let o of i.ndjson())yield o.Path}return e});c();c();var Nne=P(t=>{async function e(r,n={}){let i=await t.post("name/pubsub/cancel",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers});return St(await i.json())}return e});c();var kne=P(t=>{async function e(r={}){let n=await t.post("name/pubsub/state",{signal:r.signal,searchParams:k(r),headers:r.headers});return St(await n.json())}return e});c();var Dne=P(t=>{async function e(r={}){return(await(await t.post("name/pubsub/subs",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Strings||[]}return e});function One(t){return{cancel:Nne(t),state:kne(t),subs:Dne(t)}}function Lne(t){return{publish:Cne(t),resolve:Pne(t),pubsub:One(t)}}c();c();te();var Bne=P(t=>{async function e(r,n={}){let o=await(await t.post("object/data",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?T.decode(r):r}`,...n}),headers:n.headers})).arrayBuffer();return new Uint8Array(o,0,o.byteLength)}return e});c();te();Ae();var Mne=P(t=>{async function e(r,n={}){let o=await(await t.post("object/get",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?T.decode(r):r}`,dataEncoding:"base64",...n}),headers:n.headers})).json();return{Data:U(o.Data,"base64pad"),Links:(o.Links||[]).map(s=>({Name:s.Name,Hash:T.parse(s.Hash),Tsize:s.Size}))}}return e});c();te();var Une=P(t=>{async function e(r,n={}){return((await(await t.post("object/links",{signal:n.signal,searchParams:k({arg:`${r instanceof Uint8Array?T.decode(r):r}`,...n}),headers:n.headers})).json()).Links||[]).map(s=>({Name:s.Name,Tsize:s.Size,Hash:T.parse(s.Hash)}))}return e});c();te();var Fne=P(t=>{async function e(r={}){let n=await t.post("object/new",{signal:r.signal,searchParams:k({arg:r.template,...r}),headers:r.headers}),{Hash:i}=await n.json();return T.parse(i)}return e});c();var Kne=(t,e)=>P(n=>{let i=$E(t,e);async function o(s,a={}){return i(s,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return o})(e);c();te();var Vne=P(t=>{async function e(r,n={}){let o=await(await t.post("object/stat",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers})).json();return{...o,Hash:T.parse(o.Hash)}}return e});c();c();te();var qne=P(t=>{async function e(r,n,i={}){let o=await t.post("object/patch/add-link",{signal:i.signal,searchParams:k({arg:[`${r}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...i}),headers:i.headers}),{Hash:s}=await o.json();return T.parse(s)}return e});c();te();var zne=P(t=>{async function e(r,n,i={}){let o=new AbortController,s=bn(o.signal,i.signal),a=await t.post("object/patch/append-data",{signal:s,searchParams:k({arg:`${r}`,...i}),...await En([n],o,i.headers)}),{Hash:l}=await a.json();return T.parse(l)}return e});c();te();var Hne=P(t=>{async function e(r,n,i={}){let o=await t.post("object/patch/rm-link",{signal:i.signal,searchParams:k({arg:[`${r}`,n.Name||n.name||null],...i}),headers:i.headers}),{Hash:s}=await o.json();return T.parse(s)}return e});c();te();var $ne=P(t=>{async function e(r,n,i={}){let o=new AbortController,s=bn(o.signal,i.signal),a=await t.post("object/patch/set-data",{signal:s,searchParams:k({arg:[`${r}`],...i}),...await En([n],o,i.headers)}),{Hash:l}=await a.json();return T.parse(l)}return e});function Gne(t){return{addLink:qne(t),appendData:zne(t),rmLink:Hne(t),setData:$ne(t)}}function Wne(t,e){return{data:Bne(e),get:Mne(e),links:Une(e),new:Fne(e),put:Kne(t,e),stat:Vne(e),patch:Gne(e)}}c();c();te();var WE=P(t=>{async function*e(r,n={}){for await(let{path:i,recursive:o,metadata:s}of wa(r)){let a=await t.post("pin/add",{signal:n.signal,searchParams:k({...n,arg:i,recursive:o,metadata:s?JSON.stringify(s):void 0,stream:!0}),headers:n.headers});for await(let l of a.ndjson()){if(l.Pins){for(let u of l.Pins)yield T.parse(u);continue}yield T.parse(l)}}}return e});c();var jne=E(Fi(),1);function Yne(t){let e=WE(t);return P(()=>{async function r(n,i={}){return(0,jne.default)(e([{path:n,...i}],i))}return r})(t)}c();te();function Qne(t,e,r){let n={type:t,cid:T.parse(e)};return r&&(n.metadata=r),n}var Xne=P(t=>{async function*e(r={}){let n=[];r.paths&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);let i=await t.post("pin/ls",{signal:r.signal,searchParams:k({...r,arg:n.map(o=>`${o}`),stream:!0}),headers:r.headers});for await(let o of i.ndjson()){if(o.Keys){for(let s of Object.keys(o.Keys))yield Qne(o.Keys[s].Type,s,o.Keys[s].Metadata);return}yield Qne(o.Type,o.Cid,o.Metadata)}}return e});c();te();var jE=P(t=>{async function*e(r,n={}){for await(let{path:i,recursive:o}of wa(r)){let s=new URLSearchParams(n.searchParams);s.append("arg",`${i}`),o!=null&&s.set("recursive",String(o));let a=await t.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:k({...n,arg:`${i}`,recursive:o})});for await(let l of a.ndjson()){if(l.Pins){yield*l.Pins.map(u=>T.parse(u));continue}yield T.parse(l)}}}return e});c();var Zne=E(Fi(),1);var Jne=t=>{let e=jE(t);return P(()=>{async function r(n,i={}){return(0,Zne.default)(e([{path:n,...i}],i))}return r})(t)};c();c();c();te();var YE=({Name:t,Status:e,Cid:r})=>({cid:T.parse(r),name:t,status:e}),eie=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},tie=t=>{if(T.asCID(t))return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},R1=({service:t,cid:e,name:r,status:n,all:i})=>{let o=k({service:eie(t),name:r,force:i?!0:void 0});if(e)for(let s of e)o.append("cid",tie(s));if(n)for(let s of n)o.append("status",s);return o},rie=({cid:t,service:e,background:r,name:n,origins:i})=>{let o=k({arg:tie(t),service:eie(e),name:n,background:r?!0:void 0});if(i)for(let s of i)o.append("origin",s.toString());return o};function nie(t){async function e(r,{timeout:n,signal:i,headers:o,...s}){let a=await t.post("pin/remote/add",{timeout:n,signal:i,headers:o,searchParams:rie({cid:r,...s})});return YE(await a.json())}return e}c();function iie(t){async function*e({timeout:r,signal:n,headers:i,...o}){let s=await t.post("pin/remote/ls",{timeout:r,signal:n,headers:i,searchParams:R1(o)});for await(let a of s.ndjson())yield YE(a)}return e}c();function oie(t){async function e({timeout:r,signal:n,headers:i,...o}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:R1({...o,all:!1})})}return e}c();function sie(t){async function e({timeout:r,signal:n,headers:i,...o}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:i,searchParams:R1({...o,all:!0})})}return e}c();c();c();function aie(t){let e=String(t);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function cie(t){return{service:t.Service,endpoint:new URL(t.ApiEndpoint),...t.Stat&&{stat:TIe(t.Stat)}}}function TIe(t){switch(t.Status){case"valid":{let{Pinning:e,Pinned:r,Queued:n,Failed:i}=t.PinCount;return{status:"valid",pinCount:{queued:n,pinning:e,pinned:r,failed:i}}}case"invalid":return{status:"invalid"};default:return{status:t.Status}}}function lie(t){async function e(r,n){let{endpoint:i,key:o,headers:s,timeout:a,signal:l}=n;await t.post("pin/remote/service/add",{timeout:a,signal:l,searchParams:k({arg:[r,aie(i),o]}),headers:s})}return e}c();function uie(t){async function e(r={}){let{stat:n,headers:i,timeout:o,signal:s}=r,a=await t.post("pin/remote/service/ls",{timeout:o,signal:s,headers:i,searchParams:n===!0?k({stat:n}):void 0}),{RemoteServices:l}=await a.json();return l.map(cie)}return e}c();function fie(t){async function e(r,n={}){await t.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:k({arg:r})})}return e}function hie(t){let e=new rf(t);return{add:lie(e),ls:uie(e),rm:fie(e)}}function die(t){let e=new rf(t);return{add:nie(e),ls:iie(e),rm:oie(e),rmAll:sie(e),service:hie(t)}}function pie(t){return{addAll:WE(t),add:Yne(t),ls:Xne(t),rmAll:jE(t),rm:Jne(t),remote:die(t)}}c();c();c();Ae();Re();Cl();var mie=t=>Array.isArray(t)?t.map(FC):t,FC=t=>F(KC(t)),KC=t=>xm.decode(t),gie=t=>BigInt(`0x${F(xm.decode(t),"base16")}`),T1=t=>xm.encode(U(t));var yie=P(t=>{async function e(r={}){let{Strings:n}=await(await t.post("pubsub/ls",{signal:r.signal,searchParams:k(r),headers:r.headers})).json();return mie(n)||[]}return e});c();var wie=P(t=>{async function e(r,n={}){let i=await t.post("pubsub/peers",{signal:n.signal,searchParams:k({arg:T1(r),...n}),headers:n.headers}),{Strings:o}=await i.json();return o||[]}return e});c();var Eie=P(t=>{async function e(r,n,i={}){let o=k({arg:T1(r),...i}),s=new AbortController,a=bn(s.signal,i.signal);await(await t.post("pubsub/pub",{signal:a,searchParams:o,...await En([n],s,i.headers)})).text()}return e});c();var AIe=C("ipfs-http-client:pubsub:subscribe"),bie=(t,e)=>P(r=>{async function n(i,o,s={}){s.signal=e.subscribe(i,o,s.signal);let a,l,u=new Promise((h,p)=>{a=h,l=p}),f=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{signal:s.signal,searchParams:k({arg:T1(i),...s}),headers:s.headers}).catch(h=>{e.unsubscribe(i,o),l(h)}).then(h=>{clearTimeout(f),h&&(IIe(h,{onMessage:p=>{if(!!o){if(typeof o=="function"){o(p);return}typeof o.handleEvent=="function"&&o.handleEvent(p)}},onEnd:()=>e.unsubscribe(i,o),onError:s.onError}),a())}),u}return n})(t);async function IIe(t,{onMessage:e,onEnd:r,onError:n}){n=n||AIe;try{for await(let i of t.ndjson())try{if(!i.from)continue;e({from:i.from,data:KC(i.data),sequenceNumber:gie(i.seqno),topic:FC(i.topicIDs[0])})}catch(o){o.message=`Failed to parse pubsub message: ${o.message}`,n(o,!1,i)}}catch(i){CIe(i)||n(i,!0)}finally{r()}}var CIe=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}};c();var _ie=(t,e)=>{async function r(n,i){e.unsubscribe(n,i)}return r};c();var QE=class{constructor(){this._subs=new Map}subscribe(e,r,n){let i=this._subs.get(e)||[];if(i.find(s=>s.handler===r))throw new Error(`Already subscribed to ${e} with this handler`);let o=new AbortController;return this._subs.set(e,[{handler:r,controller:o}].concat(i)),n&&n.addEventListener("abort",()=>this.unsubscribe(e,r)),o.signal}unsubscribe(e,r){let n=this._subs.get(e)||[],i;r?(this._subs.set(e,n.filter(o=>o.handler!==r)),i=n.filter(o=>o.handler===r)):(this._subs.set(e,[]),i=n),(this._subs.get(e)||[]).length||this._subs.delete(e),i.forEach(o=>o.controller.abort())}};function vie(t){let e=new QE;return{ls:yie(t),peers:wie(t),publish:Eie(t),subscribe:bie(t,e),unsubscribe:_ie(t,e)}}c();te();c();var Sie=P(t=>{async function*e(r={}){yield*(await t.post("refs/local",{signal:r.signal,transform:St,searchParams:k(r),headers:r.headers})).ndjson()}return e});var xie=P((t,e)=>Object.assign(async function*(n,i={}){let o=Array.isArray(n)?n:[n];yield*(await t.post("refs",{signal:i.signal,searchParams:k({arg:o.map(a=>`${a instanceof Uint8Array?T.decode(a):a}`),...i}),headers:i.headers,transform:St})).ndjson()},{local:Sie(e)}));c();c();te();var Rie=P(t=>{async function*e(r={}){yield*(await t.post("repo/gc",{signal:r.signal,searchParams:k(r),headers:r.headers,transform:i=>({err:i.Error?new Error(i.Error):null,cid:(i.Key||{})["/"]?T.parse(i.Key["/"]):null})})).ndjson()}return e});c();var XE=P(t=>{async function e(r={}){let i=await(await t.post("repo/stat",{signal:r.signal,searchParams:k(r),headers:r.headers})).json();return{numObjects:BigInt(i.NumObjects),repoSize:BigInt(i.RepoSize),repoPath:i.RepoPath,version:i.Version,storageMax:BigInt(i.StorageMax)}}return e});c();var Tie=P(t=>{async function e(r={}){return(await(await t.post("repo/version",{signal:r.signal,searchParams:k(r),headers:r.headers})).json()).Version}return e});function Aie(t){return{gc:Rie(t),stat:XE(t),version:Tie(t)}}c();c();var Iie=P(t=>{async function*e(r={}){yield*(await t.post("stats/bw",{signal:r.signal,searchParams:k(r),headers:r.headers,transform:i=>({totalIn:BigInt(i.TotalIn),totalOut:BigInt(i.TotalOut),rateIn:parseFloat(i.RateIn),rateOut:parseFloat(i.RateOut)})})).ndjson()}return e});function Cie(t){return{bitswap:zE(t),repo:XE(t),bw:Iie(t)}}c();c();var Pie=P(t=>{async function e(r={}){let n=await t.post("swarm/addrs",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Addrs:i}=await n.json();return Object.keys(i).map(o=>({id:he(o),addrs:(i[o]||[]).map(s=>new W(s))}))}return e});c();var Nie=P(t=>{async function e(r,n={}){let i=await t.post("swarm/connect",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Strings:o}=await i.json();return o||[]}return e});c();var kie=P(t=>{async function e(r,n={}){let i=await t.post("swarm/disconnect",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Strings:o}=await i.json();return o||[]}return e});c();var Die=P(t=>{async function e(r={}){let n=await t.post("swarm/addrs/local",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Strings:i}=await n.json();return(i||[]).map(o=>new W(o))}return e});c();var Oie=P(t=>{async function e(r={}){let n=await t.post("swarm/peers",{signal:r.signal,searchParams:k(r),headers:r.headers}),{Peers:i}=await n.json();return(i||[]).map(o=>({addr:new W(o.Addr),peer:he(o.Peer),muxer:o.Muxer,latency:o.Latency,streams:o.Streams,direction:o.Direction==null?void 0:o.Direction===0?"inbound":"outbound"}))}return e});function Lie(t){return{addrs:Pie(t),connect:Nie(t),disconnect:kie(t),localAddrs:Die(t),peers:Oie(t)}}c();c();te();var ZE=P(t=>{async function*e(r,n={}){let i=new AbortController,o=bn(i.signal,n.signal),{headers:s,body:a,total:l,parts:u}=await En(r,i,n.headers),[f,h]=typeof n.progress=="function"?PIe(l,u,n.progress):[void 0,void 0],p=await t.post("add",{searchParams:k({"stream-channels":!0,...n,progress:Boolean(f)}),onUploadProgress:h,signal:o,headers:s,body:a});for await(let d of p.ndjson())d=St(d),d.hash!==void 0?yield kIe(d):f&&f(d.bytes||0,d.name)}return e}),PIe=(t,e,r)=>e?[void 0,NIe(t,e,r)]:[r,void 0],NIe=(t,e,r)=>{let n=0,i=e.length;return({loaded:o,total:s})=>{let a=Math.floor(o/s*t);for(;n<i;){let{start:l,end:u,name:f}=e[n];if(a<u){r(a-l,f);break}else r(u-l,f),n+=1}}};function kIe({name:t,hash:e,size:r,mode:n,mtime:i,mtimeNsecs:o}){let s={path:t,cid:T.parse(e),size:parseInt(r)};return n!=null&&(s.mode=parseInt(n,8)),i!=null&&(s.mtime={secs:i,nsecs:o||0}),s}var Bie=E(Fi(),1);function Mie(t){let e=ZE(t);return P(()=>{async function r(n,i={}){return await(0,Bie.default)(e(V6(n),i))}return r})(t)}c();var Uie=P(t=>{async function*e(r,n={}){yield*(await t.post("cat",{signal:n.signal,searchParams:k({arg:r.toString(),...n}),headers:n.headers})).iterator()}return e});c();var Fie=P(t=>async(r={})=>(await t.post("commands",{signal:r.signal,searchParams:k(r),headers:r.headers})).json());c();var Kie=P(t=>async(r,n={})=>(await(await t.post("dns",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers})).json()).Path);c();var Vie=P(t=>()=>{let e=new URL(t.opts.base||"");return{host:e.hostname,port:e.port,protocol:e.protocol,pathname:e.pathname,"api-path":e.pathname}});c();te();var qie=P(t=>{async function*e(r,n={}){let i={arg:`${r instanceof Uint8Array?T.decode(r):r}`,...n};i.compressionLevel&&(i["compression-level"]=i.compressionLevel,delete i.compressionLevel),yield*(await t.post("get",{signal:n.signal,searchParams:k(i),headers:n.headers})).iterator()}return e});c();var JE=P(t=>{async function e(r={}){let i=await(await t.post("id",{signal:r.signal,searchParams:k({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),o={...St(i)};return o.id=he(o.id),o.addresses&&(o.addresses=o.addresses.map(s=>new W(s))),o}return e});c();var zie=t=>{let e=JE(t);async function r(n={}){let i=await e(n);return Boolean(i&&i.addresses&&i.addresses.length)}return r};c();te();var Hie=P((t,e)=>{async function*r(n,i={}){let o=`${n instanceof Uint8Array?T.decode(n):n}`;async function s(l){let u=l.Hash;if(u.includes("/")){let h=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await GE(e)(h)).cid}else u=T.parse(u);let f={name:l.Name,path:o+(l.Name?`/${l.Name}`:""),size:l.Size,cid:u,type:DIe(l)};return l.Mode&&(f.mode=parseInt(l.Mode,8)),l.Mtime!==void 0&&l.Mtime!==null&&(f.mtime={secs:l.Mtime},l.MtimeNsecs!==void 0&&l.MtimeNsecs!==null&&(f.mtime.nsecs=l.MtimeNsecs)),f}let a=await t.post("ls",{signal:i.signal,searchParams:k({arg:o,...i}),headers:i.headers});for await(let l of a.ndjson()){if(l=l.Objects,!l)throw new Error("expected .Objects in results");if(l=l[0],!l)throw new Error("expected one array in results.Objects");let u=l.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield s(l);return}yield*u.map(s)}}return r});function DIe(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}c();var $ie=P(t=>{async function e(r={}){let n=await t.post("dns",{signal:r.signal,searchParams:k(r),headers:r.headers});return St(await n.json())}return e});c();var Gie=P(t=>{async function*e(r,n={}){yield*(await t.post("ping",{signal:n.signal,searchParams:k({arg:`${r}`,...n}),headers:n.headers,transform:St})).ndjson()}return e});c();var Wie=P(t=>{async function e(r,n={}){let i=await t.post("resolve",{signal:n.signal,searchParams:k({arg:r,...n}),headers:n.headers}),{Path:o}=await i.json();return o}return e});c();var jie=E(V(),1),Yie=P(t=>async(r={})=>{throw(0,jie.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")});c();var Qie=P(t=>{async function e(r={}){await(await t.post("shutdown",{signal:r.signal,searchParams:k(r),headers:r.headers})).text()}return e});c();var Xie=P(t=>{async function e(r={}){let n=await t.post("version",{signal:r.signal,searchParams:k(r),headers:r.headers});return{...St(await n.json()),"ipfs-http-client":"1.0.0"}}return e});var UIe=E(VC(),1);te();var FIe=E(qC(),1);function Jie(t={}){let e={name:hn.name,code:hn.code,encode:u=>u,decode:u=>u},r=Object.values(ya);(t.ipld&&t.ipld.bases?t.ipld.bases:[]).forEach(u=>r.push(u));let n=new v1({bases:r,loadBase:t.ipld&&t.ipld.loadBase}),i=Object.values(K4);[Tt,mc,lp,MIe,e].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>i.push(u));let o=new S1({codecs:i,loadCodec:t.ipld&&t.ipld.loadCodec}),s=Object.values(F4);(t.ipld&&t.ipld.hashers?t.ipld.hashers:[]).forEach(u=>s.push(u));let a=new x1({hashers:s,loadHasher:t.ipld&&t.ipld.loadHasher});return{add:Mie(t),addAll:ZE(t),bitswap:sre(t),block:Ere(t),bootstrap:Rre(t),cat:Uie(t),commands:Fie(t),config:Dre(t),dag:Vre(o,t),dht:jre(t),diag:Zre(t),dns:Kie(t),files:pne(t),get:qie(t),getEndpointConfig:Vie(t),id:JE(t),isOnline:zie(t),key:xne(t),log:Ine(t),ls:Hie(t),mount:$ie(t),name:Lne(t),object:Wne(o,t),pin:pie(t),ping:Gie(t),pubsub:vie(t),refs:xie(t),repo:Aie(t),resolve:Wie(t),start:Yie(t),stats:Cie(t),stop:Qie(t),swarm:Lie(t),version:Xie(t),bases:n,codecs:o,hashers:a}}c();c();var hb=E(V(),1);c();c();var Foe=E(V(),1);c();c();c();c();c();c();c();c();c();c();var Qs=Object.create(null);Qs.open="0";Qs.close="1";Qs.ping="2";Qs.pong="3";Qs.message="4";Qs.upgrade="5";Qs.noop="6";var Uy=Object.create(null);Object.keys(Qs).forEach(t=>{Uy[Qs[t]]=t});var eoe={type:"error",data:"parser error"};var KIe=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",VIe=typeof ArrayBuffer=="function",qIe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,zIe=({type:t,data:e},r,n)=>KIe&&e instanceof Blob?r?n(e):toe(e,n):VIe&&(e instanceof ArrayBuffer||qIe(e))?r?n(e):toe(new Blob([e]),n):n(Qs[t]+(e||"")),toe=(t,e)=>{let r=new FileReader;return r.onload=function(){let n=r.result.split(",")[1];e("b"+n)},r.readAsDataURL(t)},eb=zIe;c();c();var roe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fy=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<roe.length;t++)Fy[roe.charCodeAt(t)]=t;var noe=t=>{let e=t.length*.75,r=t.length,n,i=0,o,s,a,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);let u=new ArrayBuffer(e),f=new Uint8Array(u);for(n=0;n<r;n+=4)o=Fy[t.charCodeAt(n)],s=Fy[t.charCodeAt(n+1)],a=Fy[t.charCodeAt(n+2)],l=Fy[t.charCodeAt(n+3)],f[i++]=o<<2|s>>4,f[i++]=(s&15)<<4|a>>2,f[i++]=(a&3)<<6|l&63;return u};var HIe=typeof ArrayBuffer=="function",$Ie=(t,e)=>{if(typeof t!="string")return{type:"message",data:ioe(t,e)};let r=t.charAt(0);return r==="b"?{type:"message",data:GIe(t.substring(1),e)}:Uy[r]?t.length>1?{type:Uy[r],data:t.substring(1)}:{type:Uy[r]}:eoe},GIe=(t,e)=>{if(HIe){let r=noe(t);return ioe(r,e)}else return{base64:!0,data:t}},ioe=(t,e)=>{switch(e){case"blob":return t instanceof ArrayBuffer?new Blob([t]):t;case"arraybuffer":default:return t}},tb=$Ie;var ooe=String.fromCharCode(30),soe=(t,e)=>{let r=t.length,n=new Array(r),i=0;t.forEach((o,s)=>{eb(o,!1,a=>{n[s]=a,++i===r&&e(n.join(ooe))})})},aoe=(t,e)=>{let r=t.split(ooe),n=[];for(let i=0;i<r.length;i++){let o=tb(r[i],e);if(n.push(o),o.type==="error")break}return n},zC=4;c();function xr(t){if(t)return WIe(t)}function WIe(t){for(var e in xr.prototype)t[e]=xr.prototype[e];return t}xr.prototype.on=xr.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};xr.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};xr.prototype.off=xr.prototype.removeListener=xr.prototype.removeAllListeners=xr.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,i=0;i<r.length;i++)if(n=r[i],n===e||n.fn===e){r.splice(i,1);break}return r.length===0&&delete this._callbacks["$"+t],this};xr.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n)r[n].apply(this,e)}return this};xr.prototype.emitReserved=xr.prototype.emit;xr.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};xr.prototype.hasListeners=function(t){return!!this.listeners(t).length};c();c();var as=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function rb(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}var jIe=setTimeout,YIe=clearTimeout;function nl(t,e){e.useNativeTimers?(t.setTimeoutFn=jIe.bind(as),t.clearTimeoutFn=YIe.bind(as)):(t.setTimeoutFn=setTimeout.bind(as),t.clearTimeoutFn=clearTimeout.bind(as))}var QIe=1.33;function coe(t){return typeof t=="string"?XIe(t):Math.ceil((t.byteLength||t.size)*QIe)}function XIe(t){let e=0,r=0;for(let n=0,i=t.length;n<i;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}var HC=class extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}},dd=class extends xr{constructor(e){super(),this.writable=!1,nl(this,e),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,r,n){return super.emitReserved("error",new HC(e,r,n)),this}open(){return(this.readyState==="closed"||this.readyState==="")&&(this.readyState="opening",this.doOpen()),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){let r=tb(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}};c();var hoe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),$C=64,ZIe={},loe=0,nb=0,uoe;function foe(t){let e="";do e=hoe[t%$C]+e,t=Math.floor(t/$C);while(t>0);return e}function ib(){let t=foe(+new Date);return t!==uoe?(loe=0,uoe=t):t+"."+foe(loe++)}for(;nb<$C;nb++)ZIe[hoe[nb]]=nb;c();function ob(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function doe(t){let e={},r=t.split("&");for(let n=0,i=r.length;n<i;n++){let o=r[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}c();c();var poe=!1;try{poe=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var moe=poe;function GC(t){let e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||moe))return new XMLHttpRequest}catch{}if(!e)try{return new as[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function JIe(){}var eCe=function(){return new GC({xdomain:!1}).responseType!=null}(),sb=class extends dd{constructor(e){if(super(e),this.polling=!1,typeof location<"u"){let n=location.protocol==="https:",i=location.port;i||(i=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||i!==e.port,this.xs=e.secure!==n}let r=e&&e.forceBase64;this.supportsBinary=eCe&&!r}get name(){return"polling"}doOpen(){this.poll()}pause(e){this.readyState="pausing";let r=()=>{this.readyState="paused",e()};if(this.polling||!this.writable){let n=0;this.polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){let r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};aoe(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){let e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,soe(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let e=this.query||{},r=this.opts.secure?"https":"http",n="";this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=ib()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.opts.port&&(r==="https"&&Number(this.opts.port)!==443||r==="http"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port);let i=ob(e),o=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(o?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new cs(this.uri(),e)}doWrite(e,r){let n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(i,o)=>{this.onError("xhr post error",i,o)})}doPoll(){let e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}},cs=class extends xr{constructor(e,r){super(),nl(this,r),this.opts=r,this.method=r.method||"GET",this.uri=e,this.async=r.async!==!1,this.data=r.data!==void 0?r.data:null,this.create()}create(){let e=rb(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;let r=this.xhr=new GC(e);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let n in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(n)&&r.setRequestHeader(n,this.opts.extraHeaders[n])}}catch{}if(this.method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=()=>{r.readyState===4&&(r.status===200||r.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof r.status=="number"?r.status:0)},0))},r.send(this.data)}catch(n){this.setTimeoutFn(()=>{this.onError(n)},0);return}typeof document<"u"&&(this.index=cs.requestsCount++,cs.requests[this.index]=this)}onError(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}cleanup(e){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=JIe,e)try{this.xhr.abort()}catch{}typeof document<"u"&&delete cs.requests[this.index],this.xhr=null}}onLoad(){let e=this.xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};cs.requestsCount=0;cs.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",goe);else if(typeof addEventListener=="function"){let t="onpagehide"in as?"pagehide":"unload";addEventListener(t,goe,!1)}}function goe(){for(let t in cs.requests)cs.requests.hasOwnProperty(t)&&cs.requests[t].abort()}c();c();var yoe=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0))(),Ky=as.WebSocket||as.MozWebSocket,ab=!0,woe="arraybuffer";var Eoe=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",cb=class extends dd{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let e=this.uri(),r=this.opts.protocols,n=Eoe?{}:rb(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=ab&&!Eoe?r?new Ky(e,r):new Ky(e):new Ky(e,r,n)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||woe,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){let n=e[r],i=r===e.length-1;eb(n,this.supportsBinary,o=>{let s={};ab||(n.options&&(s.compress=n.options.compress),this.opts.perMessageDeflate&&(typeof o=="string"?Buffer.byteLength(o):o.length)<this.opts.perMessageDeflate.threshold&&(s.compress=!1));try{ab?this.ws.send(o):this.ws.send(o,s)}catch{}i&&yoe(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{},r=this.opts.secure?"wss":"ws",n="";this.opts.port&&(r==="wss"&&Number(this.opts.port)!==443||r==="ws"&&Number(this.opts.port)!==80)&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=ib()),this.supportsBinary||(e.b64=1);let i=ob(e),o=this.opts.hostname.indexOf(":")!==-1;return r+"://"+(o?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!Ky}};var WC={websocket:cb,polling:sb};c();var tCe=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,rCe=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function A1(t){let e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let i=tCe.exec(t||""),o={},s=14;for(;s--;)o[rCe[s]]=i[s]||"";return r!=-1&&n!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=nCe(o,o.path),o.queryKey=iCe(o,o.query),o}function nCe(t,e){let r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.substr(0,1)=="/"||e.length===0)&&n.splice(0,1),e.substr(e.length-1,1)=="/"&&n.splice(n.length-1,1),n}function iCe(t,e){let r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,i,o){i&&(r[i]=o)}),r}var So=class extends xr{constructor(e,r={}){super(),e&&typeof e=="object"&&(r=e,e=null),e?(e=A1(e),r.hostname=e.host,r.secure=e.protocol==="https"||e.protocol==="wss",r.port=e.port,e.query&&(r.query=e.query)):r.host&&(r.hostname=A1(r.host).host),nl(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=r.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},r),this.opts.path=this.opts.path.replace(/\/$/,"")+"/",typeof this.opts.query=="string"&&(this.opts.query=doe(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){let r=Object.assign({},this.opts.query);r.EIO=zC,r.transport=e,this.id&&(r.sid=this.id);let n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new WC[e](n)}open(){let e;if(this.opts.rememberUpgrade&&So.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)e="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else e=this.transports[0];this.readyState="opening";try{e=this.createTransport(e)}catch{this.transports.shift(),this.open();return}e.open(),this.setTransport(e)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",r=>this.onClose("transport close",r))}probe(e){let r=this.createTransport(e),n=!1;So.priorWebsocketSuccess=!1;let i=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;So.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(f(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{let p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function o(){n||(n=!0,f(),r.close(),r=null)}let s=h=>{let p=new Error("probe error: "+h);p.transport=r.name,o(),this.emitReserved("upgradeError",p)};function a(){s("transport closed")}function l(){s("socket closed")}function u(h){r&&h.name!==r.name&&o()}let f=()=>{r.removeListener("open",i),r.removeListener("error",s),r.removeListener("close",a),this.off("close",l),this.off("upgrading",u)};r.once("open",i),r.once("error",s),r.once("close",a),this.once("close",l),this.once("upgrading",u),r.open()}onOpen(){if(this.readyState="open",So.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade&&this.transport.pause){let e=0,r=this.upgrades.length;for(;e<r;e++)this.probe(this.upgrades[e])}}onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let r=new Error("server error");r.code=e.data,this.onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){let i=this.writeBuffer[n].data;if(i&&(r+=coe(i)),n>0&&r>this.maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}write(e,r,n){return this.sendPacket("message",e,r,n),this}send(e,r,n){return this.sendPacket("message",e,r,n),this}sendPacket(e,r,n,i){if(typeof r=="function"&&(i=r,r=void 0),typeof n=="function"&&(i=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;let o={type:e,data:r,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}close(){let e=()=>{this.onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}onError(e){So.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}onClose(e,r){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(e){let r=[],n=0,i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}};So.protocol=zC;var h5t=So.protocol;function boe(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=A1(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let o=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+e,n.href=n.protocol+"://"+o+(r&&r.port===n.port?"":":"+n.port),n}c();c();var ZC={};_t(ZC,{Decoder:()=>zy,Encoder:()=>QC,PacketType:()=>It,protocol:()=>xoe});c();c();c();var oCe=typeof ArrayBuffer=="function",sCe=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,_oe=Object.prototype.toString,aCe=typeof Blob=="function"||typeof Blob<"u"&&_oe.call(Blob)==="[object BlobConstructor]",cCe=typeof File=="function"||typeof File<"u"&&_oe.call(File)==="[object FileConstructor]";function qy(t){return oCe&&(t instanceof ArrayBuffer||sCe(t))||aCe&&t instanceof Blob||cCe&&t instanceof File}function Vy(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Vy(t[r]))return!0;return!1}if(qy(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Vy(t.toJSON(),!0);for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Vy(t[r]))return!0;return!1}function voe(t){let e=[],r=t.data,n=t;return n.data=jC(r,e),n.attachments=e.length,{packet:n,buffers:e}}function jC(t,e){if(!t)return t;if(qy(t)){let r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){let r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=jC(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){let r={};for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=jC(t[n],e));return r}return t}function Soe(t,e){return t.data=YC(t.data,e),t.attachments=void 0,t}function YC(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=YC(t[r],e);else if(typeof t=="object")for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=YC(t[r],e));return t}var xoe=5,It;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(It||(It={}));var QC=class{constructor(e){this.replacer=e}encode(e){return(e.type===It.EVENT||e.type===It.ACK)&&Vy(e)?(e.type=e.type===It.EVENT?It.BINARY_EVENT:It.BINARY_ACK,this.encodeAsBinary(e)):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===It.BINARY_EVENT||e.type===It.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){let r=voe(e),n=this.encodeAsString(r.packet),i=r.buffers;return i.unshift(n),i}},zy=class extends xr{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string")r=this.decodeString(e),r.type===It.BINARY_EVENT||r.type===It.BINARY_ACK?(this.reconstructor=new XC(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r);else if(qy(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0,n={type:Number(e.charAt(0))};if(It[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===It.BINARY_EVENT||n.type===It.BINARY_ACK){let o=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);let s=e.substring(o,r);if(s!=Number(s)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(s)}if(e.charAt(r+1)==="/"){let o=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(o,r)}else n.nsp="/";let i=e.charAt(r+1);if(i!==""&&Number(i)==i){let o=r+1;for(;++r;){let s=e.charAt(r);if(s==null||Number(s)!=s){--r;break}if(r===e.length)break}n.id=Number(e.substring(o,r+1))}if(e.charAt(++r)){let o=this.tryParse(e.substr(r));if(zy.isPayloadValid(n.type,o))n.data=o;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case It.CONNECT:return typeof r=="object";case It.DISCONNECT:return r===void 0;case It.CONNECT_ERROR:return typeof r=="string"||typeof r=="object";case It.EVENT:case It.BINARY_EVENT:return Array.isArray(r)&&r.length>0;case It.ACK:case It.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}},XC=class{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){let r=Soe(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};c();function xo(t,e,r){return t.on(e,r),function(){t.off(e,r)}}var lCe=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),I1=class extends xr{constructor(e,r,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let e=this.io;this.subs=[xo(e,"open",this.onopen.bind(this)),xo(e,"packet",this.onpacket.bind(this)),xo(e,"error",this.onerror.bind(this)),xo(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){if(lCe.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');r.unshift(e);let n={type:It.EVENT,data:r};if(n.options={},n.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){let s=this.ids++,a=r.pop();this._registerAckCallback(s,a),n.id=s}let i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(e,r){let n=this.flags.timeout;if(n===void 0){this.acks[e]=r;return}let i=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===e&&this.sendBuffer.splice(o,1);r.call(this,new Error("operation has timed out"))},n);this.acks[e]=(...o)=>{this.io.clearTimeoutFn(i),r.apply(this,[null,...o])}}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this.packet({type:It.CONNECT,data:e})}):this.packet({type:It.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case It.CONNECT:if(e.data&&e.data.sid){let i=e.data.sid;this.onconnect(i)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case It.EVENT:case It.BINARY_EVENT:this.onevent(e);break;case It.ACK:case It.BINARY_ACK:this.onack(e);break;case It.DISCONNECT:this.ondisconnect();break;case It.CONNECT_ERROR:this.destroy();let n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){let r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){let r=this._anyListeners.slice();for(let n of r)n.apply(this,e)}super.emit.apply(this,e)}ack(e){let r=this,n=!1;return function(...i){n||(n=!0,r.packet({type:It.ACK,id:e,data:i}))}}onack(e){let r=this.acks[e.id];typeof r=="function"&&(r.apply(this,e.data),delete this.acks[e.id])}onconnect(e){this.id=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:It.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){let r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){let r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let r=this._anyOutgoingListeners.slice();for(let n of r)n.apply(this,e.data)}}};c();function pd(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}pd.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};pd.prototype.reset=function(){this.attempts=0};pd.prototype.setMin=function(t){this.ms=t};pd.prototype.setMax=function(t){this.max=t};pd.prototype.setJitter=function(t){this.jitter=t};var C1=class extends xr{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,nl(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new pd({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;let i=r.parser||ZC;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new So(this.uri,this.opts);let r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;let i=xo(r,"open",function(){n.onopen(),e&&e()}),o=xo(r,"error",s=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",s),e?e(s):n.maybeReconnectOnOpen()});if(this._timeout!==!1){let s=this._timeout;s===0&&i();let a=this.setTimeoutFn(()=>{i(),r.close(),r.emit("error",new Error("timeout"))},s);this.opts.autoUnref&&a.unref(),this.subs.push(function(){clearTimeout(a)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let e=this.engine;this.subs.push(xo(e,"ping",this.onping.bind(this)),xo(e,"data",this.ondata.bind(this)),xo(e,"error",this.onerror.bind(this)),xo(e,"close",this.onclose.bind(this)),xo(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n||(n=new I1(this,e,r),this.nsps[e]=n),n}_destroy(e){let r=Object.keys(this.nsps);for(let n of r)if(this.nsps[n].active)return;this._close()}_packet(e){let r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e,r){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let r=this.backoff.duration();this._reconnecting=!0;let n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(i=>{i?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",i)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(function(){clearTimeout(n)})}}onreconnect(){let e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}};var Hy={};function $y(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};let r=boe(t,e.path||"/socket.io"),n=r.source,i=r.id,o=r.path,s=Hy[i]&&o in Hy[i].nsps,a=e.forceNew||e["force new connection"]||e.multiplex===!1||s,l;return a?l=new C1(n,e):(Hy[i]||(Hy[i]=new C1(n,e)),l=Hy[i]),r.query&&!e.query&&(e.query=r.queryKey),l.socket(r.path,e)}Object.assign($y,{Manager:C1,Socket:I1,io:$y,connect:$y});c();c();c();var Gy=E(V(),1),Poe=E(Fp(),1);Re();c();var Toe=E(V(),1);var Roe=64*1024,uCe=5*1e3,lb=class{constructor(e,r){this.label=e.label,this.open=Sr(),this.channel=e,this.channel.binaryType="arraybuffer",this.log=r.log,typeof this.channel.bufferedAmountLowThreshold=="number"&&(this.channel.bufferedAmountLowThreshold=Roe),e.addEventListener("message",i=>{r.onMessage(i)}),e.addEventListener("bufferedamountlow",()=>{this.log("stop backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open.resolve()}),e.addEventListener("open",()=>{this.open.resolve(),r.onOpen()}),e.addEventListener("close",()=>{r.onClose()}),e.addEventListener("error",i=>{if(i.error?.message==="Transport channel closed")return this.close();r.log.error('channel encounter an error in state "%s" message: "%s" detail: "%s',e.readyState,i.error?.message,i.error?.errorDetail);let o=i.error instanceof Error?i.error:new Error(`datachannel error: ${i.error?.message} ${i.error?.errorDetail}`);r.onError((0,Toe.default)(o,"ERR_DATA_CHANNEL"))});let n=!1;this.closingInterval=setInterval(()=>{e.readyState==="closing"?(n&&r.onClose(),n=!0):n=!1},uCe)}async send(e){await this.open.promise,this.channel.send(e),this.channel.bufferedAmount>Roe&&(this.log("start backpressure: bufferedAmount %d",this.channel.bufferedAmount),this.open=Sr())}close(){clearInterval(this.closingInterval),this.channel.close()}get bufferedAmount(){return this.channel.bufferedAmount}};var Noe=E(tP(),1),hCe={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]};function dCe(){if(typeof globalThis>"u")throw(0,Gy.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");let t={RTCPeerConnection:globalThis.RTCPeerConnection??globalThis.mozRTCPeerConnection??globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription??globalThis.mozRTCSessionDescription??globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate??globalThis.mozRTCIceCandidate??globalThis.webkitRTCIceCandidate};if(t.RTCPeerConnection==null)throw(0,Gy.default)(new Error("No WebRTC support detected"),"ERR_WEBRTC_SUPPORT");return t}var md=class extends Ue{constructor(e){super(),this.id=e.id??F((0,Poe.default)(4),"hex").slice(0,7),this.log=C(`libp2p:webrtc-peer:${e.logPrefix}:${this.id}`),this.wrtc=e.wrtc??dCe(),this.peerConnection=new this.wrtc.RTCPeerConnection(Object.assign({},hCe,e.peerConnectionConfig)),this.closed=!1,this.connected=Sr(),this.source=Us(),this.sink=async r=>{if(await this.connected.promise,this.channel==null)throw(0,Gy.default)(new Error("Connected but no channel?!"),"ERR_DATA_CHANNEL");for await(let n of r)await this.channel.send(n);await this.close()}}handleDataChannelEvent(e){let r=e.channel;if(r==null){this.close((0,Gy.default)(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL")).catch(n=>{this.log("Error closing after event channel was found to be null",n)});return}this.channel=new lb(r,{log:this.log,onMessage:n=>{this.source.push(new Uint8Array(n.data))},onOpen:()=>{this.connected.resolve(),this.dispatchEvent(new ee("ready"))},onClose:()=>{this.close().catch(n=>{this.log("error closing connection after channel close",n)})},onError:n=>{this.close(n).catch(i=>{this.log("error closing connection after channel error",i)})}})}async close(e){if(this.closed=!0,e==null&&this.channel!=null)for(;this.channel.bufferedAmount>0;)await(0,Noe.default)(100);this.channel?.close(),this.peerConnection.close(),this.source.end(e),this.dispatchEvent(new ee("close"))}};c();var koe=E(V(),1),P1=class extends Ue{constructor(e){super(),this.log=e.log,this.peerConnection=e.peerConnection,this.wrtc=e.wrtc,this.status="idle",this.peerConnection.addEventListener("negotiationneeded",()=>{this.log("peer connection negotiation needed"),this.handleRenegotiate({type:"renegotiate"}).catch(r=>{this.log.error("could not renegotiate %o",r)})})}async handleSignal(e){if(this.log('incoming signal "%s"',e.type),e.type==="offer")return await this.handleOffer(e);if(e.type==="answer")return await this.handleAnswer(e);if(e.type==="candidate")return await this.handleCandidate(e);if(e.type==="renegotiate")return await this.handleRenegotiate(e);if(e.type==="goodbye")return await this.handleGoodye(e);this.log(`Unknown signal type ${e.type}`)}async handleOffer(e){}async handleAnswer(e){}async handleRenegotiate(e){}async handleGoodye(e){this.peerConnection.close()}async handleCandidate(e){let r=new this.wrtc.RTCIceCandidate(e.candidate);try{await this.peerConnection.addIceCandidate(r)}catch(n){if(r.address==null||r.address.endsWith(".local"))this.log("ignoring unsupported ICE candidate.");else throw(0,koe.default)(n,"ERR_ADD_ICE_CANDIDATE")}}};var Doe=C("libp2p:webrtc-peer:receiver"),Wy=class extends md{constructor(e={}){super({...e,logPrefix:"receiver"}),this.handshake=new rP({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,answerOptions:e.answerOptions}),this.handshake.addEventListener("signal",r=>this.dispatchEvent(new ee("signal",{detail:r.detail}))),this.peerConnection.addEventListener("datachannel",r=>{this.handleDataChannelEvent(r)})}handleSignal(e){this.handshake.handleSignal(e).catch(r=>{this.log("error handling signal %o %o",e,r)})}},rP=class extends P1{constructor(e){super(e),this.options=e,this.status="idle",this.iceCandidates=[]}async handleRenegotiate(){Doe.trace("renegotiate"),this.dispatchEvent(new ee("signal",{detail:{type:"renegotiate"}}))}async handleOffer(e){await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e));for(let n of this.iceCandidates)await this.handleCandidate(n);this.iceCandidates=[];let r=await this.peerConnection.createAnswer(this.options.answerOptions);await this.peerConnection.setLocalDescription(r),Doe.trace("handle offer",this.peerConnection.localDescription),this.dispatchEvent(new ee("signal",{detail:this.peerConnection.localDescription??r}))}async handleCandidate(e){if(this.peerConnection.remoteDescription==null||this.peerConnection.remoteDescription.type==null){this.iceCandidates.push(e);return}await super.handleCandidate(e)}};c();var Loe=E(Fp(),1);Re();c();var pCe=t=>{let e=t.on||t.addListener||t.addEventListener,r=t.off||t.removeListener||t.removeEventListener;if(!e||!r)throw new TypeError("Emitter is not compatible");return{addListener:e.bind(t),removeListener:r.bind(t)}};function mCe(t,e,r){let n,i=new Promise((o,s)=>{if(r={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,...r},!(r.count>=0&&(r.count===Number.POSITIVE_INFINITY||Number.isInteger(r.count))))throw new TypeError("The `count` option should be at least 0 or more");let a=[e].flat(),l=[],{addListener:u,removeListener:f}=pCe(t),h=(...d)=>{let m=r.multiArgs?d:d[0];r.filter&&!r.filter(m)||(l.push(m),r.count===l.length&&(n(),o(l)))},p=d=>{n(),s(d)};n=()=>{for(let d of a)f(d,h);for(let d of r.rejectionEvents)f(d,p)};for(let d of a)u(d,h);for(let d of r.rejectionEvents)u(d,p);r.resolveImmediately&&o(l)});if(i.cancel=n,typeof r.timeout=="number"){let o=rn(i,r.timeout);return o.cancel=n,o}return i}function Ooe(t,e,r){typeof r=="function"&&(r={filter:r}),r={...r,count:1,resolveImmediately:!1};let n=mCe(t,e,r),i=n.then(o=>o[0]);return i.cancel=n.cancel,i}var Boe=E(tP(),1);var nP=C("libp2p:webrtc-peer:initator"),gCe=1e3,jy=class extends md{constructor(e={}){super({...e,logPrefix:"initiator"}),this.handleDataChannelEvent({channel:this.peerConnection.createDataChannel(e.dataChannelLabel??F((0,Loe.default)(20),"hex").slice(0,7),e.dataChannelInit)}),this.handshake=new iP({log:this.log,peerConnection:this.peerConnection,wrtc:this.wrtc,offerOptions:e.offerOptions}),this.handshake.addEventListener("signal",r=>{this.dispatchEvent(new ee("signal",{detail:r.detail}))})}handleSignal(e){this.handshake.handleSignal(e).catch(r=>{this.log("error handling signal %o %o",e,r)})}},iP=class extends P1{constructor(e){super(e),this.options=e,this.status="idle",this.peerConnection.addEventListener("icecandidate",r=>{if(r.candidate==null)return;let n={type:"candidate",candidate:{candidate:r.candidate.candidate,sdpMLineIndex:r.candidate.sdpMLineIndex,sdpMid:r.candidate.sdpMid}};nP.trace("create candidate",n),this.dispatchEvent(new ee("signal",{detail:n})),this.dispatchEvent(new ee("ice-candidate"))})}async handleRenegotiate(){if(this.status==="negotiating"){this.log("already negotiating, queueing");return}this.status="negotiating";let e=await this.peerConnection.createOffer(this.options.offerOptions);await this.peerConnection.setLocalDescription(e),await Ooe(this,"ice-candidate"),await(0,Boe.default)(gCe),nP.trace("renegotiate",this.peerConnection.localDescription),this.dispatchEvent(new ee("signal",{detail:this.peerConnection.localDescription??e}))}async handleAnswer(e){nP.trace("handle answer",e),await this.peerConnection.setRemoteDescription(new this.wrtc.RTCSessionDescription(e)),this.status="idle"}};c();var oP=C("libp2p:webrtc-star:socket");function ub(t,e){let{sink:r,source:n}=t,i={remoteAddr:e.remoteAddr,async sink(o){e.signal!=null&&(o=Pn(o,e.signal));try{await r(o)}catch(s){s.type!=="aborted"&&oP.error(s)}},source:e.signal!=null?Pn(n,e.signal):n,timeline:{open:Date.now()},async close(){if(t.closed)return;let o=Date.now(),s=setTimeout(()=>{if(i.remoteAddr!=null){let{host:a,port:l}=i.remoteAddr.toOptions();oP("timeout closing socket to %s:%s after %dms, destroying it manually",a,l,Date.now()-o)}t.closed||t.close().catch(a=>{oP.error("could not close socket",a)})},2e3);try{await t.close()}finally{clearTimeout(s)}}};return t.addEventListener("close",()=>{i.timeline.close==null&&(i.timeline.close=Date.now())},{once:!0}),i}c();function fb(t){let e=t.toString().split("/"),r=t.protos()[1].name,n=t.protos()[2].name,i=t.stringTuples()[1][1];if(r!=="tcp"||n!=="ws"&&n!=="wss")throw new Error(`invalid multiaddr: ${t.toString()}`);if(!W.isName(t))return`http://${e[2]}:${e[4]}`;if(n==="ws")return`http://${e[2]}${i==null||i==="80"?"":`:${i}`}`;if(n==="wss")return`https://${e[2]}${i==null||i==="443"?"":`:${i}`}`;throw new Error("invalid multiaddr: "+t.toString())}function Moe(t){let e="/libp2p-webrtc-star";if(t.startsWith(e)){t=t.substring(e.length,t.length);let r=new W(t),n=r.stringTuples().filter(i=>i[0]===421)[0];if(n[1]==null)throw new Error("invalid multiaddr: "+t);r=r.decapsulate("p2p"),r=r.encapsulate("/p2p-webrtc-star"),r=r.encapsulate(`/p2p/${n[1]}`),t=r.toString()}return t}var wi=C("libp2p:webrtc-star:listener"),wCe={transports:["websocket"],"force new connection":!0,path:"/socket.io-next/"},sP=class extends Ue{constructor(e,r,n,i,o){super(),this.signallingAddr=r,this.socket=$y(e,wCe),this.connections=[],this.channels=new Map,this.pendingSignals=new Map,this.upgrader=n,this.handler=i,this.channelOptions=o,this.handleWsHandshake=this.handleWsHandshake.bind(this),this.socket.once("connect_error",s=>{this.dispatchEvent(new ee("error",{detail:s}))}),this.socket.once("error",s=>{this.dispatchEvent(new ee("error",{detail:s}))}),this.socket.on("ws-handshake",this.handleWsHandshake),this.socket.on("ws-peer",s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),this.socket.on("connect",()=>this.socket.emit("ss-join",r.toString())),this.socket.once("connect",()=>{this.dispatchEvent(new ee("listening"))})}_createChannel(e,r,n){let i={...this.channelOptions},o=new Wy(i),s=a=>{let l=a.detail;wi.error("incoming connection errored",l)};return o.addEventListener("error",s),o.addEventListener("close",()=>{o.removeEventListener("error",s)},{once:!0}),o.addEventListener("signal",a=>{let l=a.detail;this.socket.emit("ss-handshake",{intentId:e,srcMultiaddr:r,dstMultiaddr:n,answer:!0,signal:l})}),o.addEventListener("ready",()=>{let a=ub(o,{remoteAddr:this.signallingAddr});wi("new inbound connection %s",a.remoteAddr);try{this.upgrader.upgradeInbound(a).then(l=>{wi("inbound connection %s upgraded",a.remoteAddr),this.connections.push(a);let u=()=>{this.connections=this.connections.filter(f=>f!==a),this.channels.delete(e),this.pendingSignals.delete(e)};o.addEventListener("close",u,{once:!0}),this.dispatchEvent(new ee("connection",{detail:l})),this.handler(l)}).catch(l=>{wi.error("inbound connection failed to upgrade",l),a.close().catch(u=>{wi.error("inbound connection failed to close after failing to upgrade",u)})})}catch(l){wi.error("inbound connection failed to upgrade",l),a.close().catch(u=>{wi.error("inbound connection failed to close after failing to upgrade",u)})}},{once:!0}),o}handleWsHandshake(e){if(wi('incoming handshake. signal type "%s" is answer %s',e.signal.type,e.answer),e.answer===!0||e.err!=null||e.intentId==null)return;let r=e.intentId,n=this.pendingSignals.get(r);n==null&&(n=[],this.pendingSignals.set(r,n)),n.push(e);let i=this.channels.get(r);if(i==null){if(e.signal.type!=="offer"){wi("handshake is not an offer and channel does not exist, buffering until we receive an offer");return}wi("creating new channel to handle offer handshake"),i=this._createChannel(e.intentId,e.srcMultiaddr,e.dstMultiaddr),this.channels.set(r,i)}else wi("channel already exists, using it to handle handshake");for(;n.length>0;){let o=n.shift();o?.signal!=null&&i.handleSignal(o.signal)}}async close(){this.socket.emit("ss-leave",this.signallingAddr.toString()),this.socket.removeAllListeners(),this.socket.close(),await Promise.all([...this.connections.map(async e=>await e.close()),...Array.from(this.channels.values()).map(async e=>await e.close())]),this.dispatchEvent(new ee("close"))}},aP=class extends Ue{constructor(e,r,n,i,o){super(),this.upgrader=e,this.handler=r,this.peerId=n,this.transport=i,this.options=o}async listen(e){if(this.listeningAddr!=null)throw(0,Foe.default)(new Error("listener already in use"),"ERR_ALREADY_LISTENING");let r=Sr();this.listeningAddr=e;let n;e.protoCodes().includes(421)?n=e:n=e.encapsulate(`/p2p/${this.peerId.toString()}`),this.signallingUrl=fb(e),wi("connecting to signalling server on: %s",this.signallingUrl);let i=new sP(this.signallingUrl,n,this.upgrader,this.handler,this.options.channelOptions);return i.addEventListener("error",o=>{let s=o.detail;wi("error connecting to signalling server %o",s),i.close().catch(a=>{wi.error("error closing server after error",a)}),r.reject(s)}),i.addEventListener("listening",()=>{wi("connected to signalling server"),this.dispatchEvent(new ee("listening")),r.resolve()}),i.addEventListener("peer",o=>{this.transport.peerDiscovered(o.detail)}),i.addEventListener("connection",o=>{let s=o.detail;if(s.remoteAddr==null)try{s.remoteAddr=e.decapsulateCode(421).encapsulate(`/p2p/${s.remotePeer.toString()}`)}catch(a){wi.error("could not determine remote address",a)}this.dispatchEvent(new ee("connection",{detail:s}))}),this.transport.sigServers.set(this.signallingUrl,i),await r.promise}async close(){if(this.signallingUrl!=null){let e=this.transport.sigServers.get(this.signallingUrl);e!=null&&(await e.close(),this.transport.sigServers.delete(this.signallingUrl))}this.dispatchEvent(new ee("close")),this.listeningAddr=void 0}getAddrs(){return this.listeningAddr!=null?[this.listeningAddr]:[]}};function Koe(t,e,r,n,i){return new aP(t,e,r,n,i)}var Voe=E(Fp(),1);c();var N1=Symbol.for("@libp2p/transport");c();var Ya=Symbol.for("@libp2p/peer-discovery");var bCe="RTCPeerConnection"in globalThis,gd=C("libp2p:webrtc-star"),_Ce=()=>{},cP=class extends Ue{constructor(){super(...arguments),this.started=!1}get[Ya](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star-discovery"}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}dispatchEvent(e){return this.isStarted()?super.dispatchEvent(e):!1}},db=class{constructor(e){this.components=new ze,e?.wrtc!=null&&(this.wrtc=e.wrtc),this.sigServers=new Map,this.discovery=new cP,this.peerDiscovered=this.peerDiscovered.bind(this)}get[N1](){return!0}get[Symbol.toStringTag](){return"@libp2p/webrtc-star"}init(e){this.components=e}async dial(e,r){let n=await this._connect(e,r),i=ub(n,{remoteAddr:e,signal:r.signal});gd("new outbound connection %s",i.remoteAddr);let o=await r.upgrader.upgradeOutbound(i);return gd("outbound connection %s upgraded",i.remoteAddr),o}async _connect(e,r){if(r.signal?.aborted===!0)throw new $u;let n={...r.channelOptions??{}};this.wrtc!=null&&(n.wrtc=this.wrtc);let i=e.toOptions(),o=F((0,Voe.default)(36),"hex");return await new Promise((s,a)=>{let l=this.sigServers.get(fb(e));if(l?.socket==null)return a((0,hb.default)(new Error("unknown signal server to use"),"ERR_UNKNOWN_SIGNAL_SERVER"));let u=!1;gd("dialing %s:%s",i.host,i.port);let f=new jy(n),h=g=>{let y=g.detail;if(!u){let w=`connection error ${i.host}:${i.port}: ${y.message}`;gd.error(w),m(y)}},p=()=>{u=!0,gd("connection opened %s:%s",i.host,i.port),m()},d=()=>{gd.error("connection aborted %s:%s",i.host,i.port),f.close().finally(()=>{m(new $u)})},m=g=>{f.removeEventListener("ready",p),r.signal?.removeEventListener("abort",d),g==null?s(f):a(g)};f.addEventListener("ready",p,{once:!0}),f.addEventListener("close",()=>{f.removeEventListener("error",h)}),r.signal?.addEventListener("abort",d),f.addEventListener("signal",g=>{let y=g.detail;l.socket.emit("ss-handshake",{intentId:o,srcMultiaddr:l.signallingAddr.toString(),dstMultiaddr:e.toString(),signal:y})}),l.socket.on("ws-handshake",g=>{g.intentId===o&&g.err!=null&&f.close().finally(()=>{a((0,hb.default)(new Error(g.err),"ERR_SIGNALLING_FAILED"))}),!(g.intentId!==o||g.answer==null||f.closed)&&f.handleSignal(g.signal)})})}createListener(e){if(!bCe&&this.wrtc==null)throw(0,hb.default)(new Error("no WebRTC support"),"ERR_NO_WEBRTC_SUPPORT");return e.channelOptions=e.channelOptions??{},this.wrtc!=null&&(e.channelOptions.wrtc=this.wrtc),Koe(e.upgrader,e.handler??_Ce,this.components.getPeerId(),this,e)}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>r.protoCodes().includes(290)?!1:A6.matches(r))}peerDiscovered(e){gd("peer discovered: %s",e),e=Moe(e);let r=new W(e),n=r.getPeerId();if(n==null)return;let i=he(n);this.discovery.dispatchEvent(new ee("peer",{detail:{id:i,multiaddrs:[r],protocols:[]}}))}};function qoe(){let t=new db;return{transports:[t],peerDiscovery:[t.discovery],connectionManager:{maxParallelDials:150,maxDialsPerPeer:4,dialTimeout:1e4,autoDial:!0},nat:{enabled:!1},metrics:{enabled:!0}}}c();c();c();var Qy=E(V(),1);c();var bt;(function(t){t.NOT_STARTED_YET="The libp2p node is not started yet",t.DHT_DISABLED="DHT is not available",t.PUBSUB_DISABLED="PubSub is not available",t.CONN_ENCRYPTION_REQUIRED="At least one connection encryption module is required",t.ERR_TRANSPORTS_REQUIRED="At least one transport module is required",t.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",t.NOT_FOUND="Not found"})(bt||(bt={}));var K;(function(t){t.DHT_DISABLED="ERR_DHT_DISABLED",t.ERR_PUBSUB_DISABLED="ERR_PUBSUB_DISABLED",t.PUBSUB_NOT_STARTED="ERR_PUBSUB_NOT_STARTED",t.DHT_NOT_STARTED="ERR_DHT_NOT_STARTED",t.CONN_ENCRYPTION_REQUIRED="ERR_CONN_ENCRYPTION_REQUIRED",t.ERR_TRANSPORTS_REQUIRED="ERR_TRANSPORTS_REQUIRED",t.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",t.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",t.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",t.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",t.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",t.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",t.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",t.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",t.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",t.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",t.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",t.ERR_DIALED_SELF="ERR_DIALED_SELF",t.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",t.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",t.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",t.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",t.ERR_INVALID_KEY="ERR_INVALID_KEY",t.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",t.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",t.ERR_INVALID_PEER="ERR_INVALID_PEER",t.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",t.ERR_NOT_FOUND="ERR_NOT_FOUND",t.ERR_TIMEOUT="ERR_TIMEOUT",t.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",t.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",t.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",t.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",t.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",t.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",t.ERR_FIND_SELF="ERR_FIND_SELF",t.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",t.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",t.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",t.ERR_KEYCHAIN_REQUIRED="ERR_KEYCHAIN_REQUIRED",t.ERR_INVALID_CMS="ERR_INVALID_CMS",t.ERR_MISSING_KEYS="ERR_MISSING_KEYS",t.ERR_NO_KEY="ERR_NO_KEY",t.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",t.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",t.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",t.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",t.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",t.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",t.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",t.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",t.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",t.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",t.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",t.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",t.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",t.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",t.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",t.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",t.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",t.ERR_INVALID_RECORD="ERR_INVALID_RECORD",t.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED"})(K||(K={}));c();var zoe=E(V(),1),Hoe=E(Hi(),1),$oe=E(ei(),1);async function*Yy(t,e){yield*(0,$oe.default)(t,async r=>(await e.addressBook.add(r.id,r.multiaddrs),r))}function pb(t){let e=new Set;return(0,Hoe.default)(t,r=>e.has(r.id.toString())?!1:(e.add(r.id.toString()),!0))}async function*mb(t,e=1){let r=0;for await(let n of t)r++,yield n;if(r<e)throw(0,zoe.default)(new Error("not found"),"NOT_FOUND")}var joe=E(Vo(),1),uP=E(Dc(),1);var Yoe=E(Kc(),1),Qoe=E(Ti(),1),Xoe=E(Hi(),1),yb=E(lP(),1),Zoe=E(In(),1),Woe=C("libp2p:peer-routing"),gb=class{constructor(e,r){this.components=e,this.routers=r.routers,this.refreshManagerInit=r.refreshManager??{},this.started=!1,this._findClosestPeersTask=this._findClosestPeersTask.bind(this)}isStarted(){return this.started}async start(){this.started||this.routers.length===0||this.timeoutId!=null||this.refreshManagerInit.enabled===!1||(this.timeoutId=(0,yb.setDelayedInterval)(this._findClosestPeersTask,this.refreshManagerInit.interval,this.refreshManagerInit.bootDelay),this.started=!0)}async _findClosestPeersTask(){if(this.abortController==null)try{this.abortController=new joe.TimeoutController(this.refreshManagerInit.timeout??1e4);try{(0,Zoe.setMaxListeners)?.(1/0,this.abortController.signal)}catch{}await(0,Qoe.default)(this.getClosestPeers(this.components.getPeerId().toBytes(),{signal:this.abortController.signal}))}catch(e){Woe.error(e)}finally{this.abortController?.clear(),this.abortController=void 0}}async stop(){(0,yb.clearDelayedInterval)(this.timeoutId),this.abortController?.abort(),this.started=!1}async findPeer(e,r){if(this.routers.length===0)throw(0,Qy.default)(new Error("No peer routers available"),K.ERR_NO_ROUTERS_AVAILABLE);if(e.toString()===this.components.getPeerId().toString())throw(0,Qy.default)(new Error("Should not try to find self"),K.ERR_FIND_SELF);let n=await Se((0,uP.default)(...this.routers.map(i=>async function*(){try{yield await i.findPeer(e,r)}catch(o){Woe.error(o)}}())),i=>(0,Xoe.default)(i,Boolean),i=>Yy(i,this.components.getPeerStore()),async i=>await(0,Yoe.default)(i));if(n!=null)return n;throw(0,Qy.default)(new Error(bt.NOT_FOUND),K.ERR_NOT_FOUND)}async*getClosestPeers(e,r){if(this.routers.length===0)throw(0,Qy.default)(new Error("No peer routers available"),K.ERR_NO_ROUTERS_AVAILABLE);yield*Se((0,uP.default)(...this.routers.map(n=>n.getClosestPeers(e,r))),n=>Yy(n,this.components.getPeerStore()),n=>pb(n),n=>mb(n))}};c();var nf=E(V(),1);var Joe=E(Ti(),1),ese=E(Dc(),1);var wb=class{constructor(e,r){this.routers=r.routers??[],this.started=!1,this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(e,r={}){if(this.routers.length===0)throw(0,nf.default)(new Error("No content this.routers available"),K.ERR_NO_ROUTERS_AVAILABLE);yield*Se((0,ese.default)(...this.routers.map(n=>n.findProviders(e,r))),n=>Yy(n,this.components.getPeerStore()),n=>pb(n),n=>mb(n))}async provide(e,r={}){if(this.routers.length===0)throw(0,nf.default)(new Error("No content routers available"),K.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async n=>await n.provide(e,r)))}async put(e,r,n){if(!this.isStarted())throw(0,nf.default)(new Error(bt.NOT_STARTED_YET),K.DHT_NOT_STARTED);let i=this.components.getDHT();i!=null&&await(0,Joe.default)(i.put(e,r,n))}async get(e,r){if(!this.isStarted())throw(0,nf.default)(new Error(bt.NOT_STARTED_YET),K.DHT_NOT_STARTED);let n=this.components.getDHT();if(n!=null){for await(let i of n.get(e,r))if(i.name==="VALUE")return i.value}throw(0,nf.default)(new Error(bt.NOT_FOUND),K.ERR_NOT_FOUND)}async*getMany(e,r,n){if(!this.isStarted())throw(0,nf.default)(new Error(bt.NOT_STARTED_YET),K.DHT_NOT_STARTED);if(r==null||r===0)return;let i=0,o=this.components.getDHT();if(o!=null){for await(let s of o.get(e,n))if(s.name==="VALUE"&&(yield{from:s.from,val:s.value},i++,i===r))break}if(i===0)throw(0,nf.default)(new Error(bt.NOT_FOUND),K.ERR_NOT_FOUND)}};c();var fP=E(V(),1);function TCe(t){let e=t.getPeerId();if(e==null)throw(0,fP.default)(new Error(`${t.toString()} does not have a valid peer type`),K.ERR_INVALID_MULTIADDR);try{return he(e)}catch{throw(0,fP.default)(new Error(`${t.toString()} is not a valid peer type`),K.ERR_INVALID_MULTIADDR)}}function yd(t){if(qo(t))return{id:t,multiaddrs:[],protocols:[]};typeof t=="string"&&(t=new W(t));let e;return W.isMultiaddr(t)&&(e=t,t=TCe(t)),{id:t,multiaddrs:e!=null?[e]:[],protocols:[]}}c();var ACe=t=>t,Eb=class extends Ue{constructor(e,r){super();let{listen:n=[],announce:i=[]}=r;this.components=e,this.listen=new Set(n.map(o=>o.toString())),this.announce=new Set(i.map(o=>o.toString())),this.observed=new Set,this.announceFilter=r.announceFilter??ACe}getListenAddrs(){return Array.from(this.listen).map(e=>new W(e))}getAnnounceAddrs(){return Array.from(this.announce).map(e=>new W(e))}getObservedAddrs(){return Array.from(this.observed).map(e=>new W(e))}addObservedAddr(e){let r=new W(e),n=r.getPeerId();n!=null&&he(n).equals(this.components.getPeerId())&&(r=r.decapsulate(new W(`/p2p/${this.components.getPeerId().toString()}`)));let i=r.toString();this.observed.has(i)||(this.observed.add(i),this.dispatchEvent(new ee("change:addresses")))}getAddresses(){let e=this.getAnnounceAddrs().map(n=>n.toString());e.length===0&&(e=this.components.getTransportManager().getAddrs().map(n=>n.toString())),e=e.concat(this.getObservedAddrs().map(n=>n.toString()));let r=new Set(e);return this.announceFilter(Array.from(r).map(n=>new W(n))).map(n=>n.getPeerId()===this.components.getPeerId().toString()?n:n.encapsulate(`/p2p/${this.components.getPeerId().toString()}`))}};c();var vP=E(V(),1);c();c();var tse=C("libp2p:connection-manager:latency-monitor:visibility-change-emitter"),bb=class extends Ue{constructor(){super(),this.hidden="hidden",this.visibilityChange="visibilityChange",globalThis.document!=null&&(this._initializeVisibilityVarNames(),this._addVisibilityChangeListener())}_initializeVisibilityVarNames(){let e="hidden",r="visibilitychange";typeof globalThis.document.hidden<"u"?(e="hidden",r="visibilitychange"):typeof globalThis.document.mozHidden<"u"?(e="mozHidden",r="mozvisibilitychange"):typeof globalThis.document.msHidden<"u"?(e="msHidden",r="msvisibilitychange"):typeof globalThis.document.webkitHidden<"u"&&(e="webkitHidden",r="webkitvisibilitychange"),this.hidden=e,this.visibilityChange=r}_addVisibilityChangeListener(){typeof globalThis.document.addEventListener>"u"||typeof document[this.hidden]>"u"?tse("Checking page visibility requires a browser that supports the Page Visibility API."):globalThis.document.addEventListener(this.visibilityChange,this._handleVisibilityChange.bind(this),!1)}isVisible(){if(!(this.hidden===void 0||document[this.hidden]===void 0))return document[this.hidden]==null}_handleVisibilityChange(){let e=globalThis.document[this.hidden]===!1;tse(e?"Page Visible":"Page Hidden"),this.dispatchEvent(new ee("visibilityChange",{detail:e}))}};var il=C("libp2p:connection-manager:latency-monitor"),_b=class extends Ue{constructor(e={}){super();let{latencyCheckIntervalMs:r,dataEmitIntervalMs:n,asyncTestFn:i,latencyRandomPercentage:o}=e;this.latencyCheckIntervalMs=r??500,this.latencyRandomPercentage=o??10,this.latencyCheckMultiply=2*(this.latencyRandomPercentage/100)*this.latencyCheckIntervalMs,this.latencyCheckSubtract=this.latencyCheckMultiply/2,this.dataEmitIntervalMs=n===null||n===0?void 0:n??5*1e3,il("latencyCheckIntervalMs: %s dataEmitIntervalMs: %s",this.latencyCheckIntervalMs,this.dataEmitIntervalMs),this.dataEmitIntervalMs!=null?il("Expecting ~%s events per summary",this.latencyCheckIntervalMs/this.dataEmitIntervalMs):il("Not emitting summaries"),this.asyncTestFn=i,globalThis.process?.hrtime!=null?(il("Using process.hrtime for timing"),this.now=globalThis.process.hrtime,this.getDeltaMS=s=>{let a=this.now(s);return a[0]*1e3+a[1]/1e6}):typeof window<"u"&&window.performance?.now!=null?(il("Using performance.now for timing"),this.now=window.performance.now.bind(window.performance),this.getDeltaMS=s=>Math.round(this.now()-s)):(il("Using Date.now for timing"),this.now=Date.now,this.getDeltaMS=s=>this.now()-s),this.latencyData=this.initLatencyData()}start(){ICe()&&(this.visibilityChangeEmitter=new bb,this.visibilityChangeEmitter.addEventListener("visibilityChange",e=>{let{detail:r}=e;r?this._startTimers():(this._emitSummary(),this._stopTimers())})),this.visibilityChangeEmitter?.isVisible()===!0&&this._startTimers()}stop(){this._stopTimers()}_startTimers(){this.checkLatencyID==null&&(this.checkLatency(),this.dataEmitIntervalMs!=null&&(this.emitIntervalID=setInterval(()=>this._emitSummary(),this.dataEmitIntervalMs),typeof this.emitIntervalID.unref=="function"&&this.emitIntervalID.unref()))}_stopTimers(){this.checkLatencyID!=null&&(clearTimeout(this.checkLatencyID),this.checkLatencyID=void 0),this.emitIntervalID!=null&&(clearInterval(this.emitIntervalID),this.emitIntervalID=void 0)}_emitSummary(){let e=this.getSummary();e.events>0&&this.dispatchEvent(new ee("data",{detail:e}))}getSummary(){let e={events:this.latencyData.events,minMs:this.latencyData.minMs,maxMs:this.latencyData.maxMs,avgMs:this.latencyData.events>0?this.latencyData.totalMs/this.latencyData.events:Number.POSITIVE_INFINITY,lengthMs:this.getDeltaMS(this.latencyData.startTime)};return this.latencyData=this.initLatencyData(),il.trace("Summary: %O",e),e}checkLatency(){let e=Math.random()*this.latencyCheckMultiply-this.latencyCheckSubtract,r={deltaOffset:Math.ceil(this.latencyCheckIntervalMs+e),startTime:this.now()},n=()=>{if(this.checkLatencyID==null)return;let i=this.getDeltaMS(r.startTime)-r.deltaOffset;this.checkLatency(),this.latencyData.events++,this.latencyData.minMs=Math.min(this.latencyData.minMs,i),this.latencyData.maxMs=Math.max(this.latencyData.maxMs,i),this.latencyData.totalMs+=i,il.trace("MS: %s Data: %O",i,this.latencyData)};il.trace("localData: %O",r),this.checkLatencyID=setTimeout(()=>{this.asyncTestFn!=null?(r.deltaOffset=0,r.startTime=this.now(),this.asyncTestFn(n)):(r.deltaOffset-=1,n())},r.deltaOffset),typeof this.checkLatencyID.unref=="function"&&this.checkLatencyID.unref()}initLatencyData(){return{startTime:this.now(),minMs:Number.POSITIVE_INFINITY,maxMs:Number.NEGATIVE_INFINITY,events:0,totalMs:0}}};function ICe(){return typeof globalThis.window<"u"}var SP=E(Zm(),1);c();var hP=class extends Map{constructor(e){super();let{system:r,component:n,metric:i,metrics:o}=e;this.system=r??"libp2p",this.component=n,this.metric=i,this.metrics=o,this.updateComponentMetric()}set(e,r){return super.set(e,r),this.updateComponentMetric(),this}delete(e){let r=super.delete(e);return this.updateComponentMetric(),r}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metrics.updateComponentMetric({system:this.system,component:this.component,metric:this.metric,value:this.size})}};function Nn(t){let{system:e,component:r,metric:n,metrics:i}=t,o;return i!=null?o=new hP({system:e,component:r,metric:n,metrics:i}):o=new Map,o}var Ose=E(In(),1);c();var vb="OPEN",dP="CLOSING",Sb="CLOSED";c();var Tse=E(Bs(),1),Ase=E(Hi(),1);var L1=E(V(),1);var Ise=E(Vo(),1);c();var Qa=class extends Error{constructor(e="The operation was aborted"){super(e),this.code=Qa.code,this.type=Qa.type}static get code(){return"ABORT_ERR"}static get type(){return"aborted"}};var Cse=E(Ui(),1),Pse=E(In(),1);c();var Xy=E(V(),1),lse=E(Ui(),1),use=E(ase(),1),pP=E(In(),1);var cse=C("libp2p:dialer:dial-request"),xb=class{constructor(e){let{addrs:r,dialAction:n,dialer:i}=e;this.addrs=r,this.dialer=i,this.dialAction=n}async run(e={}){let r=this.dialer.getTokens(this.addrs.length);if(r.length<1)throw(0,Xy.default)(new Error("No dial tokens available"),K.ERR_NO_DIAL_TOKENS);let n=new use.default;for(let a of r)n.push(a).catch(l=>{cse.error(l)});let i=this.addrs.map(()=>{let a=new AbortController;try{(0,pP.setMaxListeners)?.(1/0,a.signal)}catch{}return a});if(e.signal!=null)try{(0,pP.setMaxListeners)?.(1/0,e.signal)}catch{}let o=0,s=!1;try{return await Promise.any(this.addrs.map(async(a,l)=>{let u=await n.shift();if(s)throw this.dialer.releaseToken(r.splice(r.indexOf(u),1)[0]),(0,Xy.default)(new Error("dialAction already succeeded"),K.ERR_ALREADY_SUCCEEDED);let f=i[l];if(f==null)throw(0,Xy.default)(new Error("dialAction did not come with an AbortController"),K.ERR_INVALID_PARAMETERS);let h;try{let p=f.signal;h=await this.dialAction(a,{...e,signal:e.signal!=null?(0,lse.anySignal)([p,e.signal]):p}),i[l]=void 0}finally{o++,this.addrs.length-o>=r.length?n.push(u).catch(p=>{cse.error(p)}):this.dialer.releaseToken(r.splice(r.indexOf(u),1)[0])}if(h==null)throw(0,Xy.default)(new Error("dialAction led to empty object"),K.ERR_TRANSPORT_DIAL_FAILED);return s=!0,h}))}finally{i.forEach(a=>{a!==void 0&&a.abort()}),r.forEach(a=>this.dialer.releaseToken(a))}}};c();c();var Sse=E(Ab(),1);function wP(t){let{address:e}=t.nodeAddress();return Boolean((0,Sse.default)(e))}function O1(t,e){let r=wP(t.multiaddr),n=wP(e.multiaddr);return r&&!n?1:!r&&n||t.isCertified&&!e.isCertified?-1:!t.isCertified&&e.isCertified?1:0}c();var xse={computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[6e4,3e5,9e5],maxOldPeersRetention:50};var Nse=E(Gg(),1);var kse=E(ei(),1),Xa=C("libp2p:dialer"),Rse="dialler",qCe="pending-dials",zCe="pending-dial-targets",Ib=class{constructor(e={}){this.components=new ze,this.started=!1,this.addressSorter=e.addressSorter??O1,this.maxAddrsToDial=e.maxAddrsToDial??25,this.timeout=e.dialTimeout??3e4,this.maxDialsPerPeer=e.maxDialsPerPeer??4,this.tokens=[...new Array(e.maxParallelDials??100)].map((r,n)=>n),this.pendingDials=Nn({component:Rse,metric:qCe,metrics:e.metrics}),this.pendingDialTargets=Nn({component:Rse,metric:zCe,metrics:e.metrics});for(let[r,n]of Object.entries(e.resolvers??{}))W.resolvers.set(r,n)}init(e){this.components=e}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1;for(let e of this.pendingDials.values())try{e.controller.abort()}catch(r){Xa.error(r)}this.pendingDials.clear();for(let e of this.pendingDialTargets.values())e.reject(new Qa("Dialer was destroyed"));this.pendingDialTargets.clear()}async dial(e,r={}){let{id:n,multiaddrs:i}=yd(e);if(this.components.getPeerId().equals(n))throw(0,L1.default)(new Error("Tried to dial self"),K.ERR_DIALED_SELF);if(Xa("check multiaddrs %p",n),i!=null&&i.length>0&&(Xa("storing multiaddrs %p",n,i),await this.components.getPeerStore().addressBook.add(n,i)),await this.components.getConnectionGater().denyDialPeer(n))throw(0,L1.default)(new Error("The dial request is blocked by gater.allowDialPeer"),K.ERR_PEER_DIAL_INTERCEPTED);Xa("creating dial target for %p",n);let o=await this._createCancellableDialTarget(n);if(o.addrs.length===0)throw(0,L1.default)(new Error("The dial request has no valid addresses"),K.ERR_NO_VALID_ADDRESSES);let s=this.pendingDials.get(o.id)??this._createPendingDial(o,r);try{let a=await s.promise;return Xa("dial succeeded to %s",o.id),a}catch(a){throw Xa("dial failed to %s",o.id,a),s.controller.signal.aborted&&(a.code=K.ERR_TIMEOUT),Xa.error(a),a}finally{s.destroy()}}async _createCancellableDialTarget(e){let r=`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`,n=new Promise((i,o)=>{this.pendingDialTargets.set(r,{resolve:i,reject:o})});try{return await Promise.race([this._createDialTarget(e),n])}finally{this.pendingDialTargets.delete(r)}}async _createDialTarget(e){let r=await Se(await this.components.getPeerStore().addressBook.get(e),o=>(0,Ase.default)(o,async s=>!await this.components.getConnectionGater().denyDialMultiaddr(e,s.multiaddr)),o=>(0,Nse.default)(o,this.addressSorter),o=>(0,kse.default)(o,s=>{let a=s.multiaddr;return e.toString()===a.getPeerId()?a:a.encapsulate(`/p2p/${e.toString()}`)}),async o=>await(0,Tse.default)(o)),n=[];for(let o of r)(await this._resolve(o)).forEach(a=>n.push(a));let i=n.filter(o=>this.components.getTransportManager().transportForMultiaddr(o));if(i.length>this.maxAddrsToDial)throw await this.components.getPeerStore().delete(e),(0,L1.default)(new Error("dial with more addresses than allowed"),K.ERR_TOO_MANY_ADDRESSES);return{id:e.toString(),addrs:i}}_createPendingDial(e,r={}){let n=async(u,f={})=>{if(f.signal?.aborted===!0)throw(0,L1.default)(new Error("already aborted"),K.ERR_ALREADY_ABORTED);return await this.components.getTransportManager().dial(u,f)},i=new xb({addrs:e.addrs,dialAction:n,dialer:this}),o=new Ise.TimeoutController(this.timeout),s=[o.signal];r.signal!=null&&s.push(r.signal);let a=(0,Cse.anySignal)(s);try{(0,Pse.setMaxListeners)?.(1/0,a)}catch{}let l={dialRequest:i,controller:o,promise:i.run({...r,signal:a}),destroy:()=>{o.clear(),this.pendingDials.delete(e.id)}};return this.pendingDials.set(e.id,l),l}getTokens(e){let r=Math.min(e,this.maxDialsPerPeer,this.tokens.length),n=this.tokens.splice(0,r);return Xa("%d tokens request, returning %d, %d remaining",e,r,this.tokens.length),n}releaseToken(e){this.tokens.includes(e)||(Xa("token %d released",e),this.tokens.push(e))}async _resolve(e){if(!e.protoNames().includes("dnsaddr"))return[e];let n=await this._resolveRecord(e);return(await Promise.all(n.map(async s=>await this._resolve(s)))).flat().reduce((s,a)=>(s.find(l=>l.equals(a))==null&&s.push(a),s),[])}async _resolveRecord(e){try{return e=new W(e.toString()),await e.resolve()}catch(r){return Xa.error(`multiaddr ${e.toString()} could not be resolved`,r),[]}}};var Ci=C("libp2p:connection-manager"),HCe={maxConnections:1/0,minConnections:0,maxData:1/0,maxSentData:1/0,maxReceivedData:1/0,maxEventLoopDelay:1/0,pollInterval:2e3,autoDialInterval:1e4,movingAverageInterval:6e4,defaultPeerValue:.5},Dse="connection-manager",$Ce="peer-connections",GCe="peer-values",Cb=class extends Ue{constructor(e){if(super(),this.components=new ze,this.opts=Ye.call({ignoreUndefined:!0},HCe,e),this.opts.maxConnections<this.opts.minConnections)throw(0,vP.default)(new Error("Connection Manager maxConnections must be greater than minConnections"),K.ERR_INVALID_PARAMETERS);Ci("options: %o",this.opts),this.peerValues=Nn({component:Dse,metric:GCe,metrics:this.components.getMetrics()}),this.connections=Nn({component:Dse,metric:$Ce,metrics:this.components.getMetrics()}),this.started=!1,this._checkMetrics=this._checkMetrics.bind(this),this.latencyMonitor=new _b({latencyCheckIntervalMs:e.pollInterval,dataEmitIntervalMs:e.pollInterval});try{(0,Ose.setMaxListeners)?.(1/0,this)}catch{}this.dialer=new Ib(this.opts),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this)}init(e){this.components=e,this.dialer.init(e)}isStarted(){return this.started}async start(){this.components.getMetrics()!=null&&(this.timer=this.timer??(0,SP.default)(this._checkMetrics,this.opts.pollInterval)),this.latencyMonitor.start(),this._onLatencyMeasure=this._onLatencyMeasure.bind(this),this.latencyMonitor.addEventListener("data",this._onLatencyMeasure),await this.dialer.start(),this.started=!0,Ci("started")}async afterStart(){this.components.getUpgrader().addEventListener("connection",this.onConnect),this.components.getUpgrader().addEventListener("connectionEnd",this.onDisconnect)}async beforeStop(){this.components.getUpgrader().removeEventListener("connection",this.onConnect),this.components.getUpgrader().removeEventListener("connectionEnd",this.onDisconnect)}async stop(){this.timer?.clear(),this.latencyMonitor.removeEventListener("data",this._onLatencyMeasure),this.latencyMonitor.stop(),await this.dialer.stop(),this.started=!1,await this._close(),Ci("stopped")}async _close(){let e=[];for(let r of this.connections.values())for(let n of r)e.push((async()=>{try{await n.close()}catch(i){Ci.error(i)}})());Ci("closing %d connections",e.length),await Promise.all(e),this.connections.clear()}setPeerValue(e,r){if(r<0||r>1)throw new Error("value should be a number between 0 and 1");this.peerValues.set(e.toString(),r)}async _checkMetrics(){let e=this.components.getMetrics();if(e!=null)try{let r=e.getGlobal().getMovingAverages(),n=r.dataReceived[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxReceivedData",n);let i=r.dataSent[this.opts.movingAverageInterval].movingAverage;await this._checkMaxLimit("maxSentData",i);let o=n+i;await this._checkMaxLimit("maxData",o),Ci.trace("metrics update",o)}finally{this.timer=(0,SP.default)(this._checkMetrics,this.opts.pollInterval)}}onConnect(e){this._onConnect(e).catch(r=>{Ci.error(r)})}async _onConnect(e){let{detail:r}=e;if(!this.started){await r.close();return}let n=r.remotePeer,i=n.toString(),o=this.connections.get(i);o!=null?o.push(r):this.connections.set(i,[r]),n.publicKey!=null&&await this.components.getPeerStore().keyBook.set(n,n.publicKey),this.peerValues.has(i)||this.peerValues.set(i,this.opts.defaultPeerValue);let s=this.getConnections().length,a=s-this.opts.maxConnections;await this._checkMaxLimit("maxConnections",s,a),this.dispatchEvent(new ee("peer:connect",{detail:r}))}onDisconnect(e){let{detail:r}=e;if(!this.started)return;let n=r.remotePeer.toString(),i=this.connections.get(n);i!=null&&i.length>1?(i=i.filter(o=>o.id!==r.id),this.connections.set(n,i)):i!=null&&(this.connections.delete(n),this.peerValues.delete(r.remotePeer.toString()),this.dispatchEvent(new ee("peer:disconnect",{detail:r})),this.components.getMetrics()?.onPeerDisconnected(r.remotePeer))}getConnections(e){if(e!=null)return this.connections.get(e.toString())??[];let r=[];for(let n of this.connections.values())r=r.concat(n);return r}async openConnection(e,r){Ci("dial to %p",e);let n=this.getConnections(e);if(n.length>0)return Ci("had an existing connection to %p",e),n[0];let i=await this.dialer.dial(e,r),o=this.connections.get(e.toString());o==null&&(o=[],this.connections.set(e.toString(),o));let s=!1;for(let a of o)a.id===i.id&&(s=!0);return s||o.push(i),i}async closeConnections(e){let r=this.connections.get(e.toString())??[];await Promise.all(r.map(async n=>await n.close()))}getAll(e){if(!qo(e))throw(0,vP.default)(new Error("peerId must be an instance of peer-id"),K.ERR_INVALID_PARAMETERS);let r=e.toString(),n=this.connections.get(r);return n!=null?n.filter(i=>i.stat.status===vb):[]}_onLatencyMeasure(e){let{detail:r}=e;this._checkMaxLimit("maxEventLoopDelay",r.avgMs,1).catch(n=>{Ci.error(n)})}async _checkMaxLimit(e,r,n=1){let i=this.opts[e];Ci.trace("checking limit of %s. current value: %d of %d",e,r,i),r>i&&(Ci("%s: limit exceeded: %p, %d, pruning %d connection(s)",this.components.getPeerId(),e,r,n),await this._maybePruneConnections(n))}async _maybePruneConnections(e){let r=this.getConnections();if(r.length<=this.opts.minConnections||e<1)return;let n=Array.from(new Map([...this.peerValues.entries()].sort((o,s)=>o[1]-s[1])));Ci.trace("sorted peer values: %j",n);let i=[];for(let[o]of n){Ci("too many connections open - closing a connection to %p",o);for(let s of r)if(s.remotePeer.toString()===o&&i.push(s),i.length===e)break}await Promise.all(i.map(async o=>{try{await o.close()}catch(s){Ci.error(s)}this.onDisconnect(new ee("connectionEnd",{detail:o}))}))}};c();var xP=E(Zm(),1),Lse=E(Bs(),1);var Bse=E(Hi(),1),Mse=E(Gg(),1),sf=C("libp2p:connection-manager:auto-dialler"),WCe={enabled:!0,minConnections:0,autoDialInterval:1e4},Pb=class{constructor(e,r){this.components=e,this.options=Ye.call({ignoreUndefined:!0},WCe,r),this.running=!1,this._autoDial=this._autoDial.bind(this),sf("options: %j",this.options)}isStarted(){return this.running}async start(){if(!this.options.enabled){sf("not enabled");return}this.running=!0,this._autoDial().catch(e=>{sf.error("could start autodial",e)}),sf("started")}async stop(){if(!this.options.enabled){sf("not enabled");return}this.running=!1,this.autoDialTimeout!=null&&this.autoDialTimeout.clear(),sf("stopped")}async _autoDial(){this.autoDialTimeout!=null&&this.autoDialTimeout.clear();let e=this.options.minConnections;if(this.components.getConnectionManager().getConnections().length>=e){this.autoDialTimeout=(0,xP.default)(this._autoDial,this.options.autoDialInterval);return}let r=await this.components.getPeerStore().all(),n=await Se(r.sort(()=>Math.random()>.5?1:-1),i=>(0,Bse.default)(i,o=>!o.id.equals(this.components.getPeerId())),i=>(0,Mse.default)(i,(o,s)=>s.protocols.length>o.protocols.length||s.id.publicKey!=null&&o.id.publicKey==null?1:-1),async i=>await(0,Lse.default)(i));for(let i=0;this.running&&i<n.length&&this.components.getConnectionManager().getConnections().length<e;i++){if(!this.running)return;let o=n[i];if(this.components.getConnectionManager().getConnections(o.id).length===0){sf("connecting to a peerStore stored peer %p",o.id);try{await this.components.getConnectionManager().openConnection(o.id)}catch(s){sf.error("could not connect to peerStore stored peer",s)}}}!this.running||(this.autoDialTimeout=(0,xP.default)(this._autoDial,this.options.autoDialInterval))}};c();var Wse=E(V(),1);c();var rt;(function(t){let e;(function(s){s.SUCCESS="SUCCESS",s.HOP_SRC_ADDR_TOO_LONG="HOP_SRC_ADDR_TOO_LONG",s.HOP_DST_ADDR_TOO_LONG="HOP_DST_ADDR_TOO_LONG",s.HOP_SRC_MULTIADDR_INVALID="HOP_SRC_MULTIADDR_INVALID",s.HOP_DST_MULTIADDR_INVALID="HOP_DST_MULTIADDR_INVALID",s.HOP_NO_CONN_TO_DST="HOP_NO_CONN_TO_DST",s.HOP_CANT_DIAL_DST="HOP_CANT_DIAL_DST",s.HOP_CANT_OPEN_DST_STREAM="HOP_CANT_OPEN_DST_STREAM",s.HOP_CANT_SPEAK_RELAY="HOP_CANT_SPEAK_RELAY",s.HOP_CANT_RELAY_TO_SELF="HOP_CANT_RELAY_TO_SELF",s.STOP_SRC_ADDR_TOO_LONG="STOP_SRC_ADDR_TOO_LONG",s.STOP_DST_ADDR_TOO_LONG="STOP_DST_ADDR_TOO_LONG",s.STOP_SRC_MULTIADDR_INVALID="STOP_SRC_MULTIADDR_INVALID",s.STOP_DST_MULTIADDR_INVALID="STOP_DST_MULTIADDR_INVALID",s.STOP_RELAY_REFUSED="STOP_RELAY_REFUSED",s.MALFORMED_MESSAGE="MALFORMED_MESSAGE"})(e=t.Status||(t.Status={}));let r;(function(s){s[s.SUCCESS=100]="SUCCESS",s[s.HOP_SRC_ADDR_TOO_LONG=220]="HOP_SRC_ADDR_TOO_LONG",s[s.HOP_DST_ADDR_TOO_LONG=221]="HOP_DST_ADDR_TOO_LONG",s[s.HOP_SRC_MULTIADDR_INVALID=250]="HOP_SRC_MULTIADDR_INVALID",s[s.HOP_DST_MULTIADDR_INVALID=251]="HOP_DST_MULTIADDR_INVALID",s[s.HOP_NO_CONN_TO_DST=260]="HOP_NO_CONN_TO_DST",s[s.HOP_CANT_DIAL_DST=261]="HOP_CANT_DIAL_DST",s[s.HOP_CANT_OPEN_DST_STREAM=262]="HOP_CANT_OPEN_DST_STREAM",s[s.HOP_CANT_SPEAK_RELAY=270]="HOP_CANT_SPEAK_RELAY",s[s.HOP_CANT_RELAY_TO_SELF=280]="HOP_CANT_RELAY_TO_SELF",s[s.STOP_SRC_ADDR_TOO_LONG=320]="STOP_SRC_ADDR_TOO_LONG",s[s.STOP_DST_ADDR_TOO_LONG=321]="STOP_DST_ADDR_TOO_LONG",s[s.STOP_SRC_MULTIADDR_INVALID=350]="STOP_SRC_MULTIADDR_INVALID",s[s.STOP_DST_MULTIADDR_INVALID=351]="STOP_DST_MULTIADDR_INVALID",s[s.STOP_RELAY_REFUSED=390]="STOP_RELAY_REFUSED",s[s.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE"})(r||(r={})),function(s){s.codec=()=>so(r)}(e=t.Status||(t.Status={}));let n;(function(s){s.HOP="HOP",s.STOP="STOP",s.STATUS="STATUS",s.CAN_HOP="CAN_HOP"})(n=t.Type||(t.Type={}));let i;(function(s){s[s.HOP=1]="HOP",s[s.STOP=2]="STOP",s[s.STATUS=3]="STATUS",s[s.CAN_HOP=4]="CAN_HOP"})(i||(i={})),function(s){s.codec=()=>so(i)}(n=t.Type||(t.Type={}));let o;(function(s){s.codec=()=>et({1:{name:"id",codec:ve},2:{name:"addrs",codec:ve,repeats:!0}}),s.encode=a=>Je(a,s.codec()),s.decode=a=>Ze(a,s.codec())})(o=t.Peer||(t.Peer={})),t.codec=()=>et({1:{name:"type",codec:t.Type.codec(),optional:!0},2:{name:"srcPeer",codec:t.Peer.codec(),optional:!0},3:{name:"dstPeer",codec:t.Peer.codec(),optional:!0},4:{name:"code",codec:t.Status.codec(),optional:!0}}),t.encode=s=>Je(s,t.codec()),t.decode=s=>Ze(s,t.codec())})(rt||(rt={}));c();var jCe=C("libp2p:stream:converter");function RP(t,e={}){let{stream:r,remoteAddr:n}=t,{sink:i,source:o}=r,s={async sink(l){e.signal!=null&&(l=Pn(l,e.signal));try{await i(l),await a()}catch(u){u.type!=="aborted"&&jCe(u)}},source:e.signal!=null?Pn(o,e.signal):o,remoteAddr:n,timeline:{open:Date.now(),close:void 0},async close(){await i(async function*(){yield new Uint8Array(0)}()),await a()}};async function a(){return s.timeline.close==null&&(s.timeline.close=Date.now()),await Promise.resolve()}return s}c();var ol="/libp2p/circuit/relay/0.1.0";c();function Use(t){let e=new Map;async function r(o){let s=o.toString().split("/p2p-circuit").find(p=>p!==""),a=new W(s),l=a.getPeerId();if(l==null)throw new Error("Could not determine relay peer from multiaddr");let u=he(l);await t.peerStore.addressBook.add(u,[a]);let f=await t.connectionManager.openConnection(u),h=f.remoteAddr.encapsulate("/p2p-circuit");e.set(f.remotePeer.toString(),h),i.dispatchEvent(new ee("listening"))}function n(){let o=[];for(let s of e.values())o.push(s);return o}let i=Object.assign(new Ue,{close:async()=>await Promise.resolve(),listen:r,getAddrs:n});return t.connectionManager.addEventListener("peer:disconnect",o=>{let{detail:s}=o;e.delete(s.remotePeer.toString())&&i.dispatchEvent(new ee("close"))}),i}c();var TP=E(V(),1);c();function Fse(t,e){t.write({type:rt.Type.STATUS,code:e})}function Nb(t,e){try{t.dstPeer?.addrs!=null&&t.dstPeer.addrs.forEach(r=>new W(r))}catch(r){throw Fse(e,t.type===rt.Type.HOP?rt.Status.HOP_DST_MULTIADDR_INVALID:rt.Status.STOP_DST_MULTIADDR_INVALID),r}try{t.srcPeer?.addrs!=null&&t.srcPeer.addrs.forEach(r=>new W(r))}catch(r){throw Fse(e,t.type===rt.Type.HOP?rt.Status.HOP_SRC_MULTIADDR_INVALID:rt.Status.STOP_SRC_MULTIADDR_INVALID),r}}c();c();var Kse=E(ei(),1);function Ro(t){let e=Us(),r=ng(t.source),n=Sr(),i,o=t.sink(async function*(){yield*e,yield*await n.promise}());o.catch(a=>{i=a});let s={sink:async a=>i!=null?await Promise.reject(i):(n.resolve(a),await o),source:(0,Kse.default)(r,a=>a.slice())};return{reader:r,writer:e,stream:s,rest:()=>e.end(),write:e.push,read:async()=>{let a=await r.next();if(a.value!=null)return a.value.slice()}}}var e3=C("libp2p:circuit:stream-handler"),sl=class{constructor(e){let{stream:r,maxLength:n=4096}=e;this.stream=r,this.shake=Ro(this.stream),this.decoder=gr.fromReader(this.shake.reader,{maxDataLength:n})}async read(){let e=await this.decoder.next();if(e.value!=null){let r=rt.decode(e.value.slice());return e3("read message type",r.type),r}e3("read received no value, closing stream"),this.close()}write(e){e3("write message type %s",e.type),this.shake.write(Cr.single(rt.encode(e)).slice())}rest(){return this.shake.rest(),this.shake.stream}end(e){this.write(e),this.close()}close(){e3("closing the stream"),this.rest().sink([]).catch(e=>{e3.error(e)})}};c();var t3=C("libp2p:circuit:stop");function Vse(t){let{connection:e,request:r,streamHandler:n}=t;try{Nb(r,n)}catch(i){t3.error("invalid stop request via peer %p %o",e.remotePeer,i);return}return t3("stop request is valid"),n.write({type:rt.Type.STATUS,code:rt.Status.SUCCESS}),n.rest()}async function qse(t){let{connection:e,request:r}=t,{stream:n}=await e.newStream([ol]);t3("starting stop request to %p",e.remotePeer);let i=new sl({stream:n});i.write(r);let o=await i.read();if(o==null){i.close();return}if(o.code===rt.Status.SUCCESS)return t3("stop request to %p was successful",e.remotePeer),i.rest();t3("stop request failed with code %d",o.code),i.close()}var ls=C("libp2p:circuit:hop");async function zse(t){let{connection:e,request:r,streamHandler:n,circuit:i,connectionManager:o}=t;if(!i.hopEnabled())return ls("HOP request received but we are not acting as a relay"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_CANT_SPEAK_RELAY});try{Nb(r,n)}catch(h){ls.error("invalid hop request via peer %p %o",e.remotePeer,h);return}if(r.dstPeer==null){ls("HOP request received but we do not receive a dstPeer");return}let s=Rr(r.dstPeer.id),a=o.getConnections(s);if(a.length===0&&!i.hopActive())return ls("HOP request received but we are not connected to the destination peer"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_NO_CONN_TO_DST});if(a.length===0)return ls("did not have connection to remote peer"),n.end({type:rt.Type.STATUS,code:rt.Status.HOP_NO_CONN_TO_DST});let l={type:rt.Type.STOP,dstPeer:r.dstPeer,srcPeer:r.srcPeer},u;try{ls("performing STOP request");let h=await qse({connection:a[0],request:l});if(h==null)throw new Error("Could not stop");u=h}catch(h){ls.error(h);return}ls("hop request from %p is valid",e.remotePeer),n.write({type:rt.Type.STATUS,code:rt.Status.SUCCESS});let f=n.rest();return ls("creating related connections"),await Se(f,u,f)}async function Hse(t){let{connection:e,request:r}=t,{stream:n}=await e.newStream(ol),i=new sl({stream:n});i.write(r);let o=await i.read();if(o==null)throw(0,TP.default)(new Error("HOP request had no response"),K.ERR_HOP_REQUEST_FAILED);if(o.code===rt.Status.SUCCESS)return ls("hop request was successful"),i.rest();throw ls("hop request failed with code %d, closing stream",o.code),i.close(),(0,TP.default)(new Error(`HOP request failed with code "${o.code??"unknown"}"`),K.ERR_HOP_REQUEST_FAILED)}async function $se(t){let{connection:e}=t,{stream:r}=await e.newStream(ol),n=new sl({stream:r});n.write({type:rt.Type.CAN_HOP});let i=await n.read();return await n.close(),!(i==null||i.code!==rt.Status.SUCCESS)}function Gse(t){let{connection:e,streamHandler:r,circuit:n}=t,i=n.hopEnabled();ls("can hop (%s) request from %p",i,e.remotePeer),r.end({type:rt.Type.STATUS,code:i?rt.Status.SUCCESS:rt.Status.HOP_CANT_SPEAK_RELAY})}var us=C("libp2p:circuit"),kb=class{constructor(){this.components=new ze}init(e){this.components=e,this.components.getRegistrar().handle(ol,r=>{this._onProtocol(r).catch(n=>{us.error(n)})}).catch(r=>{us.error(r)})}hopEnabled(){return!0}hopActive(){return!0}get[N1](){return!0}get[Symbol.toStringTag](){return"libp2p/circuit-relay-v1"}async _onProtocol(e){let{connection:r,stream:n}=e,i=new sl({stream:n}),o=await i.read();if(o==null){us("request was invalid, could not read from stream"),i.write({type:rt.Type.STATUS,code:rt.Status.MALFORMED_MESSAGE}),i.close();return}let s;switch(o.type){case rt.Type.CAN_HOP:{us("received CAN_HOP request from %p",r.remotePeer),await Gse({circuit:this,connection:r,streamHandler:i});break}case rt.Type.HOP:{us("received HOP request from %p",r.remotePeer),s=await zse({connection:r,request:o,streamHandler:i,circuit:this,connectionManager:this.components.getConnectionManager()});break}case rt.Type.STOP:{us("received STOP request from %p",r.remotePeer),s=await Vse({connection:r,request:o,streamHandler:i});break}default:{us("Request of type %s not supported",o.type),i.write({type:rt.Type.STATUS,code:rt.Status.MALFORMED_MESSAGE}),i.close();return}}if(s!=null){let a=new W(o.dstPeer.addrs[0]),l=new W(o.srcPeer.addrs[0]),u=RP({stream:s,remoteAddr:a,localAddr:l}),f=o.type===rt.Type.HOP?"relay":"inbound";us("new %s connection %s",f,u.remoteAddr);let h=await this.components.getUpgrader().upgradeInbound(u);us("%s connection %s upgraded",f,u.remoteAddr),this.handler!=null&&this.handler(h)}}async dial(e,r={}){let n=e.toString().split("/p2p-circuit"),i=new W(n[0]),o=new W(n[n.length-1]),s=i.getPeerId(),a=o.getPeerId();if(s==null||a==null){let d="Circuit relay dial failed as addresses did not have peer id";throw us.error(d),(0,Wse.default)(new Error(d),K.ERR_RELAYED_DIAL)}let l=he(s),u=he(a),f=!1,p=this.components.getConnectionManager().getConnections(l)[0];p==null&&(await this.components.getPeerStore().addressBook.add(l,[i]),p=await this.components.getConnectionManager().openConnection(l,r),f=!0);try{let d=await Hse({connection:p,request:{type:rt.Type.HOP,srcPeer:{id:this.components.getPeerId().toBytes(),addrs:this.components.getAddressManager().getAddresses().map(y=>y.bytes)},dstPeer:{id:u.toBytes(),addrs:[new W(o).bytes]}}}),m=i.encapsulate(`/p2p-circuit/p2p/${this.components.getPeerId().toString()}`),g=RP({stream:d,remoteAddr:e,localAddr:m});return us("new outbound connection %s",g.remoteAddr),await this.components.getUpgrader().upgradeOutbound(g)}catch(d){throw us.error("Circuit relay dial failed",d),f&&await p.close(),d}}createListener(e){return this.handler=e.handler,Use({connectionManager:this.components.getConnectionManager(),peerStore:this.components.getPeerStore()})}filter(e){return e=Array.isArray(e)?e:[e],e.filter(r=>fh.matches(r))}};c();var Mb=E(lP(),1);c();Ae();Re();c();te();zr();async function Db(t){let e=new TextEncoder().encode(t),r=await Be.digest(e);return T.createV0(r)}c();var AP="hop_relay",IP="true",Ob="/libp2p/relay";var jse=E(Gg(),1),Yse=E(Bs(),1);var r3=C("libp2p:auto-relay"),XCe=()=>{},Lb=class{constructor(e,r){this.components=e,this.addressSorter=r.addressSorter??O1,this.maxListeners=r.maxListeners??1,this.listenRelays=new Set,this.onError=r.onError??XCe,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this),this.components.getPeerStore().addEventListener("change:protocols",n=>{this._onProtocolChange(n).catch(i=>{r3.error(i)})}),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onPeerDisconnected)}async _onProtocolChange(e){let{peerId:r,protocols:n}=e.detail,i=r.toString();if(n.find(s=>s===ol)==null){this.listenRelays.has(i)&&await this._removeListenRelay(i);return}if(!this.listenRelays.has(i))try{let s=this.components.getConnectionManager().getConnections(r);if(s.length===0)return;let a=s[0];if(a.remoteAddr.protoCodes().includes(290)){r3(`relayed connection to ${i} will not be used to hop on`);return}await $se({connection:a})&&(await this.components.getPeerStore().metadataBook.setValue(r,AP,U(IP)),await this._addListenRelay(a,i))}catch(s){this.onError(s)}}_onPeerDisconnected(e){let i=e.detail.remotePeer.toString();!this.listenRelays.has(i)||this._removeListenRelay(i).catch(o=>{r3.error(o)})}async _addListenRelay(e,r){try{if(this.listenRelays.size>=this.maxListeners)return;let n=await Se(await this.components.getPeerStore().addressBook.get(e.remotePeer),o=>(0,jse.default)(o,this.addressSorter),async o=>await(0,Yse.default)(o));(await Promise.all(n.map(async o=>{try{let s=o.multiaddr;return s.getPeerId()==null&&(s=s.encapsulate(`/p2p/${e.remotePeer.toString()}`)),s=s.encapsulate("/p2p-circuit"),await this.components.getTransportManager().listen([s]),!0}catch(s){r3.error("error listening on circuit address",s),this.onError(s)}return!1}))).includes(!0)&&this.listenRelays.add(r)}catch(n){this.onError(n),this.listenRelays.delete(r)}}async _removeListenRelay(e){this.listenRelays.delete(e)&&await this._listenOnAvailableHopRelays([e])}async _listenOnAvailableHopRelays(e=[]){if(this.listenRelays.size>=this.maxListeners)return;let r=[],n=await this.components.getPeerStore().all();for(let{id:i,metadata:o}of n){let s=i.toString();if(this.listenRelays.has(s)||e.includes(s))continue;let a=o.get(AP);if(a==null||F(a)!==IP)continue;let l=this.components.getConnectionManager().getConnections(i);if(l.length===0){r.push(i);continue}if(await this._addListenRelay(l[0],s),this.listenRelays.size>=this.maxListeners)return}for(let i of r)if(await this._tryToListenOnRelay(i),this.listenRelays.size>=this.maxListeners)return;try{let i=await Db(Ob);for await(let o of this.components.getContentRouting().findProviders(i)){if(o.multiaddrs.length===0)continue;let s=o.id;if(await this.components.getPeerStore().addressBook.add(s,o.multiaddrs),await this._tryToListenOnRelay(s),this.listenRelays.size>=this.maxListeners)return}}catch(i){this.onError(i)}}async _tryToListenOnRelay(e){try{let r=await this.components.getConnectionManager().openConnection(e);await this._addListenRelay(r,e.toString())}catch(r){r3.error("Could not use %p as relay",e,r),this.onError(r,`could not connect and listen on known hop relay ${e.toString()}`)}}};var Qse=C("libp2p:relay"),Bb=class{constructor(e,r){this.components=e,this.autoRelay=r.autoRelay?.enabled!==!1?new Lb(e,{addressSorter:r.addressSorter,...r.autoRelay}):void 0,this.started=!1,this.init=r,this._advertiseService=this._advertiseService.bind(this)}isStarted(){return this.started}async start(){this.init.hop.enabled!==!1&&this.init.advertise.enabled!==!1&&(this.timeout=(0,Mb.setDelayedInterval)(this._advertiseService,this.init.advertise.ttl,this.init.advertise.bootDelay)),this.started=!0}async stop(){this.timeout!=null&&(0,Mb.clearDelayedInterval)(this.timeout),this.started=!1}async _advertiseService(){try{let e=await Db(Ob);await this.components.getContentRouting().provide(e)}catch(e){e.code===K.ERR_NO_ROUTERS_AVAILABLE?(Qse.error("a content router, such as a DHT, must be provided in order to advertise the relay service",e),await this.stop()):Qse.error(e)}}};c();var kae=E(oae(),1);c();var H_t=E(Sae(),1),$_t=E(nx(),1),al=E(wt(),1);c();var q_t=E(PP(),1),Rae=E(wt(),1),xae=Rae.default.pki,Tae=(t,e)=>{let r=xae.rsa.setPublicKey(e.n,e.e),n=xae.createCertificate();n.publicKey=r,n.serialNumber="01",n.validity.notBefore=new Date,n.validity.notAfter=new Date,n.validity.notAfter.setFullYear(n.validity.notBefore.getFullYear()+10);let i=[{name:"organizationName",value:"ipfs"},{shortName:"OU",value:"keystore"},{name:"commonName",value:t.id}];return n.setSubject(i),n.setIssuer(i),n.setExtensions([{name:"basicConstraints",cA:!0},{name:"keyUsage",keyCertSign:!0,digitalSignature:!0,nonRepudiation:!0,keyEncipherment:!0,dataEncipherment:!0},{name:"extKeyUsage",serverAuth:!0,clientAuth:!0,codeSigning:!0,emailProtection:!0,timeStamping:!0},{name:"nsCertType",client:!0,server:!0,email:!0,objsign:!0,sslCA:!0,emailCA:!0,objCA:!0}]),n.sign(e),n};async function Aae(t,e){let r=t.map(e),i=(await Promise.all(r)).findIndex(o=>o);return t[i]}var cl=E(V(),1);Ae();Re();var APe=C("libp2p:keychain:cms"),DP=new WeakMap,Vb=class{constructor(e,r){if(e==null)throw(0,cl.default)(new Error("keychain is required"),K.ERR_KEYCHAIN_REQUIRED);this.keychain=e,DP.set(this,{dek:r})}async encrypt(e,r){if(!(r instanceof Uint8Array))throw(0,cl.default)(new Error("Plain data must be a Uint8Array"),K.ERR_INVALID_PARAMETERS);let n=await this.keychain.findKeyByName(e),i=await this.keychain.getPrivateKey(e),o=DP.get(this);if(o==null)throw(0,cl.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let s=o.dek,a=al.default.pki.decryptRsaPrivateKey(i,s),l=await Tae(n,a),u=al.default.pkcs7.createEnvelopedData();u.addRecipient(l),u.content=al.default.util.createBuffer(r),u.encrypt();let f=al.default.asn1.toDer(u.toAsn1()).getBytes();return U(f,"ascii")}async decrypt(e){if(!(e instanceof Uint8Array))throw(0,cl.default)(new Error("CMS data is required"),K.ERR_INVALID_PARAMETERS);let r;try{let f=al.default.util.createBuffer(F(e,"ascii")),h=al.default.asn1.fromDer(f);r=al.default.pkcs7.messageFromAsn1(h)}catch(f){throw APe.error(f),(0,cl.default)(new Error("Invalid CMS"),K.ERR_INVALID_CMS)}let n=r.recipients.filter(f=>f.issuer.find(h=>h.shortName==="O"&&h.value==="ipfs")).filter(f=>f.issuer.find(h=>h.shortName==="CN")).map(f=>({recipient:f,keyId:f.issuer.find(h=>h.shortName==="CN").value})),i=await Aae(n,async f=>{try{if(await this.keychain.findKeyById(f.keyId)!=null)return!0}catch{return!1}return!1});if(i==null){let f=n.map(h=>h.keyId);throw(0,cl.default)(new Error(`Decryption needs one of the key(s): ${f.join(", ")}`),K.ERR_MISSING_KEYS,{missingKeys:f})}let o=await this.keychain.findKeyById(i.keyId);if(o==null)throw(0,cl.default)(new Error("No key available to decrypto"),K.ERR_NO_KEY);let s=await this.keychain.getPrivateKey(o.name),a=DP.get(this);if(a==null)throw(0,cl.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let l=a.dek,u=al.default.pki.decryptRsaPrivateKey(s,l);return r.decrypt(i.recipient,u),U(r.content.getBytes(),"ascii")}};var Gt=E(V(),1);Re();Ae();c();c();c();var Z_t=E(Lp(),1),IPe=E(wt(),1);Re();Ae();c();var PPe=E(V(),1);c();var Cae=E(WS(),1),Pae=E(Er(),1),Nae=E(V(),1),Iae={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function n3(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let a=Object.keys(Iae).join(" / ");throw(0,Nae.default)(new Error(`Hash '${i}' is unknown or not supported. Must be ${a}`),"ERR_UNSUPPORTED_HASH_TYPE")}let o=Iae[i],s=(0,Cae.default)(t,e,r,n,o);return Pae.default.encode64(s,null)}var qb=C("libp2p:keychain"),kPe="/pkcs8/",Dae="/info/",cf=new WeakMap,bd={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},OP={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function ll(t){return t==null||typeof t!="string"?!1:t===(0,kae.default)(t.trim())&&t.length>0}async function dr(){let r=Math.random()*800+200;await new Promise(n=>setTimeout(n,r))}function Za(t){return new ae(kPe+t)}function lf(t){return new ae(Dae+t)}var i3=class{constructor(e,r){if(this.components=e,this.init=Ye(OP,r),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<bd.minKeyLength)throw new Error(`dek.keyLength must be least ${bd.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<bd.minSaltLength)throw new Error(`dek.saltLength must be least ${bd.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<bd.minIterationCount)throw new Error(`dek.iterationCount must be least ${bd.minIterationCount}`);let n=this.init.pass!=null&&this.init.dek?.salt!=null?n3(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";cf.set(this,{dek:n})}get cms(){let e=cf.get(this);if(e==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let r=e.dek;return new Vb(this,r)}static generateOptions(){let e=Object.assign({},OP),r=Math.ceil(bd.minSaltLength/3)*3;return e.dek.salt=F(Os(r),"base64"),e}static get options(){return OP}async createKey(e,r,n=2048){if(!ll(e)||e==="self")throw await dr(),(0,Gt.default)(new Error("Invalid key name"),K.ERR_INVALID_KEY_NAME);if(typeof r!="string")throw await dr(),(0,Gt.default)(new Error("Invalid key type"),K.ERR_INVALID_KEY_TYPE);let i=Za(e);if(await this.components.getDatastore().has(i))throw await dr(),(0,Gt.default)(new Error("Key name already exists"),K.ERR_KEY_ALREADY_EXISTS);switch(r.toLowerCase()){case"rsa":if(!Number.isSafeInteger(n)||n<2048)throw await dr(),(0,Gt.default)(new Error("Invalid RSA key size"),K.ERR_INVALID_KEY_SIZE);break;default:break}let s;try{let a=await Yp(r,n),l=await a.id(),u=cf.get(this);if(u==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let f=u.dek,h=await a.export(f);s={name:e,id:l};let p=this.components.getDatastore().batch();p.put(i,U(h)),p.put(lf(e),U(JSON.stringify(s))),await p.commit()}catch(a){throw await dr(),a}return s}async listKeys(){let e={prefix:Dae},r=[];for await(let n of this.components.getDatastore().query(e))r.push(JSON.parse(F(n.value)));return r}async findKeyById(e){try{return(await this.listKeys()).find(n=>n.id===e)}catch(r){throw await dr(),r}}async findKeyByName(e){if(!ll(e))throw await dr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);let r=lf(e);try{let n=await this.components.getDatastore().get(r);return JSON.parse(F(n))}catch(n){throw await dr(),qb.error(n),(0,Gt.default)(new Error(`Key '${e}' does not exist.`),K.ERR_KEY_NOT_FOUND)}}async removeKey(e){if(!ll(e)||e==="self")throw await dr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);let r=Za(e),n=await this.findKeyByName(e),i=this.components.getDatastore().batch();return i.delete(r),i.delete(lf(e)),await i.commit(),n}async renameKey(e,r){if(!ll(e)||e==="self")throw await dr(),(0,Gt.default)(new Error(`Invalid old key name '${e}'`),K.ERR_OLD_KEY_NAME_INVALID);if(!ll(r)||r==="self")throw await dr(),(0,Gt.default)(new Error(`Invalid new key name '${r}'`),K.ERR_NEW_KEY_NAME_INVALID);let n=Za(e),i=Za(r),o=lf(e),s=lf(r);if(await this.components.getDatastore().has(i))throw await dr(),(0,Gt.default)(new Error(`Key '${r}' already exists`),K.ERR_KEY_ALREADY_EXISTS);try{let l=await this.components.getDatastore().get(n),u=await this.components.getDatastore().get(o),f=JSON.parse(F(u));f.name=r;let h=this.components.getDatastore().batch();return h.put(i,l),h.put(s,U(JSON.stringify(f))),h.delete(n),h.delete(o),await h.commit(),f}catch(l){throw await dr(),l}}async exportKey(e,r){if(!ll(e))throw await dr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);if(r==null)throw await dr(),(0,Gt.default)(new Error("Password is required"),K.ERR_PASSWORD_REQUIRED);let n=Za(e);try{let i=await this.components.getDatastore().get(n),o=F(i),s=cf.get(this);if(s==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let a=s.dek;return await(await Nc(o,a)).export(r)}catch(i){throw await dr(),i}}async importKey(e,r,n){if(!ll(e)||e==="self")throw await dr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);if(r==null)throw await dr(),(0,Gt.default)(new Error("PEM encoded key is required"),K.ERR_PEM_REQUIRED);let i=Za(e);if(await this.components.getDatastore().has(i))throw await dr(),(0,Gt.default)(new Error(`Key '${e}' already exists`),K.ERR_KEY_ALREADY_EXISTS);let s;try{s=await Nc(r,n)}catch{throw await dr(),(0,Gt.default)(new Error("Cannot read the key, most likely the password is wrong"),K.ERR_CANNOT_READ_KEY)}let a;try{a=await s.id();let f=cf.get(this);if(f==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let h=f.dek;r=await s.export(h)}catch(f){throw await dr(),f}let l={name:e,id:a},u=this.components.getDatastore().batch();return u.put(i,U(r)),u.put(lf(e),U(JSON.stringify(l))),await u.commit(),l}async importPeer(e,r){try{if(!ll(e))throw(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);if(r==null||r.privateKey==null)throw(0,Gt.default)(new Error("Peer.privKey is required"),K.ERR_MISSING_PRIVATE_KEY);let n=await Hn(r.privateKey),i=Za(e);if(await this.components.getDatastore().has(i))throw await dr(),(0,Gt.default)(new Error(`Key '${e}' already exists`),K.ERR_KEY_ALREADY_EXISTS);let s=cf.get(this);if(s==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let a=s.dek,l=await n.export(a),u={name:e,id:r.toString()},f=this.components.getDatastore().batch();return f.put(i,U(l)),f.put(lf(e),U(JSON.stringify(u))),await f.commit(),u}catch(n){throw await dr(),n}}async getPrivateKey(e){if(!ll(e))throw await dr(),(0,Gt.default)(new Error(`Invalid key name '${e}'`),K.ERR_INVALID_KEY_NAME);try{let r=Za(e),n=await this.components.getDatastore().get(r);return F(n)}catch(r){throw await dr(),qb.error(r),(0,Gt.default)(new Error(`Key '${e}' does not exist.`),K.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(e,r){if(typeof e!="string")throw await dr(),(0,Gt.default)(new Error(`Invalid old pass type '${typeof e}'`),K.ERR_INVALID_OLD_PASS_TYPE);if(typeof r!="string")throw await dr(),(0,Gt.default)(new Error(`Invalid new pass type '${typeof r}'`),K.ERR_INVALID_NEW_PASS_TYPE);if(r.length<20)throw await dr(),(0,Gt.default)(new Error(`Invalid pass length ${r.length}`),K.ERR_INVALID_PASS_LENGTH);qb("recreating keychain");let n=cf.get(this);if(n==null)throw(0,Gt.default)(new Error("dek missing"),K.ERR_INVALID_PARAMETERS);let i=n.dek;this.init.pass=r;let o=r!=null&&this.init.dek?.salt!=null?n3(r,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";cf.set(this,{dek:o});let s=await this.listKeys();for(let a of s){let l=await this.components.getDatastore().get(Za(a.name)),u=F(l),f=await Nc(u,i),h=o.toString(),p=await f.export(h),d=this.components.getDatastore().batch(),m={name:a.name,id:a.id};d.put(Za(a.name),U(p)),d.put(lf(a.name),U(JSON.stringify(m))),await d.commit()}qb("keychain reconstructed")}};c();var UP=E(LP(),1),Bae=E(xp(),1);c();c();var BP=class{constructor(e){if(typeof e!="number")throw new Error("must provide a timespan to the moving average constructor");if(e<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");this.timespan=e,this.movingAverage=0,this.variance=0,this.deviation=0,this.forecast=0}alpha(e,r){return 1-Math.exp(-(e-r)/this.timespan)}push(e,r){if(this.previousTime!=null){let n=this.alpha(e,this.previousTime),i=r-this.movingAverage,o=n*i;this.movingAverage=n*r+(1-n)*this.movingAverage,this.variance=(1-n)*(this.variance+i*o),this.deviation=Math.sqrt(this.variance),this.forecast=this.movingAverage+n*i}else this.movingAverage=r;this.previousTime=e}};function MP(t){return new BP(t)}var Lae=E(Zm(),1),F1=class extends Ue{constructor(e){super(),this.enabled=e.enabled,this.queue=[],this.stats={dataReceived:0n,dataSent:0n},this.frequencyLastTime=Date.now(),this.frequencyAccumulators={},this.movingAverages={dataReceived:[],dataSent:[]},this.computeThrottleMaxQueueSize=e.computeThrottleMaxQueueSize,this.computeThrottleTimeout=e.computeThrottleTimeout,this._update=this._update.bind(this),this.movingAverageIntervals=e.movingAverageIntervals;for(let r=0;r<e.initialCounters.length;r++){let n=e.initialCounters[r];this.stats[n]=0n,this.movingAverages[n]=[];for(let i=0;i<this.movingAverageIntervals.length;i++){let o=this.movingAverageIntervals[i];(this.movingAverages[n][o]=MP(o)).push(this.frequencyLastTime,0)}}}start(){!this.enabled||this.queue.length>0&&this._resetComputeTimeout()}stop(){this.timeout!=null&&(this.timeout.clear(),this.timeout=null)}getSnapshot(){return Object.assign({},this.stats)}getMovingAverages(){return Object.assign({},this.movingAverages)}push(e,r){this.queue.push([e,r,Date.now()]),this._resetComputeTimeout()}_resetComputeTimeout(){this.timeout=(0,Lae.default)(this._update,this._nextTimeout())}_nextTimeout(){let e=this.queue.length/this.computeThrottleMaxQueueSize;return Math.max(this.computeThrottleTimeout*(1-e),0)}_update(){if(this.timeout=null,this.queue.length>0){let e=["",0,0];for(e of this.queue)this._applyOp(e);this.queue=[],e.length>2&&e[0]!==""&&this._updateFrequency(e[2]),this.dispatchEvent(new ee("update",{detail:this.stats}))}}_updateFrequency(e){let r=e-this.frequencyLastTime;this._updateFrequencyFor("dataReceived",r,e),this._updateFrequencyFor("dataSent",r,e),this.frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this.frequencyAccumulators[e]??0;this.frequencyAccumulators[e]=0;let s=i/(r??1)*1e3,a=this.movingAverages[e];a==null&&(a=this.movingAverages[e]=[]);let l=this.movingAverageIntervals;for(let u=0;u<l.length;u++){let f=l[u],h=a[f];h==null&&(h=a[f]=MP(f)),h.push(n,s)}}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error("invalid increment number");let i;Object.prototype.hasOwnProperty.call(this.stats,r)?i=this.stats[r]:i=this.stats[r]=0n,this.stats[r]=i+BigInt(n),this.frequencyAccumulators[r]==null&&(this.frequencyAccumulators[r]=0),this.frequencyAccumulators[r]+=n}};var OPe=["dataReceived","dataSent"],LPe={in:"dataReceived",out:"dataSent"},zb=class{constructor(e){this.enabled=e.enabled,this.statsInit={...e,initialCounters:OPe},this.globalStats=new F1(this.statsInit),this.peerStats=new Map,this.protocolStats=new Map,this.oldPeers=(0,Bae.default)(e.maxOldPeersRetention??xse.maxOldPeersRetention),this.running=!1,this._onMessage=this._onMessage.bind(this),this.systems=new Map}isStarted(){return this.running}async start(){!this.enabled||(this.running=!0)}async stop(){if(!!this.running){this.running=!1,this.globalStats.stop();for(let e of this.peerStats.values())e.stop();for(let e of this.protocolStats.values())e.stop()}}getGlobal(){return this.globalStats}getPeers(){return Array.from(this.peerStats.keys())}getComponentMetrics(){return this.systems}updateComponentMetric(e){let{system:r="libp2p",component:n,metric:i,value:o}=e;this.systems.has(r)||this.systems.set(r,new Map);let s=this.systems.get(r);if(s==null)throw new Error("Unknown metric system");s.has(n)||s.set(n,new Map);let a=s.get(n);if(a==null)throw new Error("Unknown metric component");a.set(i,o)}forPeer(e){let r=e.toString();return this.peerStats.get(r)??this.oldPeers.get(r)}getProtocols(){return Array.from(this.protocolStats.keys())}forProtocol(e){return this.protocolStats.get(e)}onPeerDisconnected(e){let r=e.toString(),n=this.peerStats.get(r);n!=null&&(n.stop(),this.peerStats.delete(r),this.oldPeers.set(r,n))}_onMessage(e){if(!this.running)return;let{remotePeer:r,protocol:n,direction:i,dataLength:o}=e,s=LPe[i],a=this.forPeer(r);if(a==null){let l=new F1(this.statsInit);this.peerStats.set(r.toString(),l),a=l}if(a.push(s,o),this.globalStats.push(s,o),n!=null){let l=this.forProtocol(n);if(l==null){let u=new F1(this.statsInit);this.protocolStats.set(n,u),l=u}l.push(s,o)}}updatePlaceholder(e,r){if(!this.running)return;let n=e.toString(),i=this.peerStats.get(n)??this.oldPeers.get(n),o=r.toString(),s=this.peerStats.get(o)??this.oldPeers.get(o),a=i;s!=null&&(a=BPe(s,a),this.oldPeers.remove(o)),this.peerStats.delete(e.toString()),this.peerStats.set(o,a),a.start()}trackStream(e){let{stream:r,remotePeer:n,protocol:i}=e;if(!this.running)return r;let o=r.source;r.source=(0,UP.default)(o,a=>this._onMessage({remotePeer:n,protocol:i,direction:"in",dataLength:a.length}));let s=r.sink;return r.sink=async a=>await Se(a,l=>(0,UP.default)(l,u=>{this._onMessage({remotePeer:n,protocol:i,direction:"out",dataLength:u.length})}),s),r}};function BPe(t,e){return t.stop(),e.stop(),t.queue=[...t.queue,...e.queue],t}c();c();c();async function o3(t){try{let e=await t;return{isFulfilled:!0,isRejected:!1,value:e}}catch(e){return{isFulfilled:!1,isRejected:!0,reason:e}}}c();c();var FP=class{value;next;constructor(e){this.value=e}},s3=class{#e;#t;#r;constructor(){this.clear()}enqueue(e){let r=new FP(e);this.#e?(this.#t.next=r,this.#t=r):(this.#e=r,this.#t=r),this.#r++}dequeue(){let e=this.#e;if(!!e)return this.#e=this.#e.next,this.#r--,e.value}clear(){this.#e=void 0,this.#t=void 0,this.#r=0}get size(){return this.#r}*[Symbol.iterator](){let e=this.#e;for(;e;)yield e.value,e=e.next}};function KP(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up");let e=new s3,r=0,n=()=>{r--,e.size>0&&e.dequeue()()},i=async(a,l,u)=>{r++;let f=(async()=>a(...u))();l(f);try{await f}catch{}n()},o=(a,l,u)=>{e.enqueue(i.bind(void 0,a,l,u)),(async()=>(await Promise.resolve(),r<t&&e.size>0&&e.dequeue()()))()},s=(a,...l)=>new Promise(u=>{o(a,u,l)});return Object.defineProperties(s,{activeCount:{get:()=>r},pendingCount:{get:()=>e.size},clearQueue:{value:()=>{e.clear()}}}),s}async function VP(t,e={}){let{concurrency:r=Number.POSITIVE_INFINITY}=e,n=KP(r);return Promise.all(t.map(i=>i&&typeof i.then=="function"?o3(i):typeof i=="function"?o3(n(()=>i())):o3(Promise.resolve(i))))}var K1=E(V(),1);var _d=C("libp2p:transports"),Hb=class extends Ue{constructor(e,r={}){super(),this.components=e,this.started=!1,this.transports=new Map,this.listeners=Nn({component:"transport-manager",metric:"listeners",metrics:this.components.getMetrics()}),this.faultTolerance=r.faultTolerance??vd.FATAL_ALL}add(e){let r=e[Symbol.toStringTag];if(r==null)throw(0,K1.default)(new Error("Transport must have a valid tag"),K.ERR_INVALID_KEY);if(this.transports.has(r))throw(0,K1.default)(new Error("There is already a transport with this tag"),K.ERR_DUPLICATE_TRANSPORT);_d("adding transport %s",r),this.transports.set(r,e),this.listeners.has(r)||this.listeners.set(r,[])}isStarted(){return this.started}async start(){let e=this.components.getAddressManager().getListenAddrs();await this.listen(e),this.started=!0}async stop(){let e=[];for(let[r,n]of this.listeners)for(_d("closing listeners for %s",r);n.length>0;){let i=n.pop();i!=null&&e.push(i.close())}await Promise.all(e),_d("all listeners closed");for(let r of this.listeners.keys())this.listeners.set(r,[]);this.started=!1}async dial(e,r){let n=this.transportForMultiaddr(e);if(n==null)throw(0,K1.default)(new Error(`No transport available for address ${String(e)}`),K.ERR_TRANSPORT_UNAVAILABLE);try{return await n.dial(e,{...r,upgrader:this.components.getUpgrader()})}catch(i){throw i.code==null&&(i.code=K.ERR_TRANSPORT_DIAL_FAILED),i}}getAddrs(){let e=[];for(let r of this.listeners.values())for(let n of r)e=[...e,...n.getAddrs()];return e}getTransports(){return Array.of(...this.transports.values())}transportForMultiaddr(e){for(let r of this.transports.values())if(r.filter([e]).length>0)return r}async listen(e){if(e==null||e.length===0){_d("no addresses were provided for listening, this node is dial only");return}let r=[];for(let[n,i]of this.transports.entries()){let o=i.filter(e),s=[];for(let u of o){_d("creating listener for %s on %s",n,u);let f=i.createListener({upgrader:this.components.getUpgrader()}),h=this.listeners.get(n);h==null&&(h=[],this.listeners.set(n,h)),h.push(f),f.addEventListener("listening",()=>{this.dispatchEvent(new ee("listener:listening",{detail:f}))}),f.addEventListener("close",()=>{this.dispatchEvent(new ee("listener:close",{detail:f}))}),s.push(f.listen(u))}if(s.length===0){r.push(n);continue}if((await VP(s)).find(u=>u.isFulfilled)==null&&this.faultTolerance!==vd.NO_FATAL)throw(0,K1.default)(new Error(`Transport (${n}) could not listen on any available address`),K.ERR_NO_VALID_ADDRESSES)}if(r.length===this.transports.size){let n=`no valid addresses were provided for transports [${r.join(", ")}]`;if(this.faultTolerance===vd.FATAL_ALL)throw(0,K1.default)(new Error(n),K.ERR_NO_VALID_ADDRESSES);_d(`libp2p in dial mode only: ${n}`)}}async remove(e){_d("removing %s",e);for(let r of this.listeners.get(e)??[])await r.close();this.transports.delete(e),this.listeners.delete(e)}async removeAll(){let e=[];for(let r of this.transports.keys())e.push(this.remove(r));await Promise.all(e)}},vd;(function(t){t[t.FATAL_ALL=0]="FATAL_ALL",t[t.NO_FATAL=1]="NO_FATAL"})(vd||(vd={}));c();var Ni=E(V(),1);c();c();var Kae=E(V(),1);c();var qP=E(V(),1);Ae();var Mae=E(Kc(),1);Re();var Uae=U(`
`);function $b(t){let e=new Ve(t,Uae);return Cr.single(e).slice()}function Ja(t,e){t.push($b(e).slice())}function Fae(t,e){let r=new Ve;for(let n of e)r.append($b(n));t.push(r.slice())}async function zP(t,e){let r=1,n={[Symbol.asyncIterator]:()=>n,next:async()=>await t.next(r)},i=n;e?.signal!=null&&(i=Pn(n,e.signal));let s=await Se(i,gr({onLength:a=>{r=a}}),async a=>await(0,Mae.default)(a));if(s==null)throw(0,qP.default)(new Error("no buffer returned"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");if(s[s.length-1]!==Uae[0])throw(0,qP.default)(new Error("missing newline"),"ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return s.slice(0,-1)}async function V1(t,e){let r=await zP(t,e);return F(r)}Ae();var q1=C("libp2p:mss:select");async function $P(t,e,r,n){e=Array.isArray(e)?[...e]:[e];let{reader:i,writer:o,rest:s,stream:a}=Ro(t),l=e.shift();if(l==null)throw new Error("At least one protocol must be specified");r!=null?(q1('select: write ["%s", "%s"]',r,l),Fae(o,[U(r),U(l)])):(q1('select: write "%s"',l),Ja(o,U(l)));let u=await V1(i,n);if(q1('select: read "%s"',u),u===r&&(u=await V1(i,n),q1('select: read "%s"',u)),u===l)return s(),{stream:a,protocol:l};for(let f of e){q1('select: write "%s"',f),Ja(o,U(f));let h=await V1(i,n);if(q1('select: read "%s" for "%s"',h,f),h===f)return s(),{stream:a,protocol:f}}throw s(),(0,Kae.default)(new Error("protocol selection failed"),"ERR_UNSUPPORTED_PROTOCOL")}c();c();var Sd="/multistream/1.0.0";Ae();var a3=C("libp2p:mss:handle");async function Vae(t,e,r){e=Array.isArray(e)?e:[e];let{writer:n,reader:i,rest:o,stream:s}=Ro(t);for(;;){let a=await V1(i,r);if(a3('read "%s"',a),a===Sd){a3('respond with "%s" for "%s"',Sd,a),Ja(n,U(Sd));continue}if(e.includes(a))return Ja(n,U(a)),a3('respond with "%s" for "%s"',a,a),o(),{stream:s,protocol:a};if(a==="ls"){Ja(n,new Ve(...e.map(l=>$b(U(l))))),a3('respond with "%s" for %s',e,a);continue}Ja(n,U("na")),a3('respond with "na" for "%s"',a)}}c();Re();Ae();var MPe=C("libp2p:mss:ls");async function qae(t,e){let{reader:r,writer:n,rest:i,stream:o}=Ro(t);MPe('write "ls"'),Ja(n,U("ls")),i();let s=await zP(r,e),a=ng([s]),l=[];return await Se(a,gr(),async f=>{for await(let h of f)l.push(F(h.slice(0,-1)))}),{stream:o,protocols:l}}var Gb=class{constructor(e){this.stream=e,this.shaken=!1}async _handshake(e){if(this.shaken)return;let{stream:r}=await $P(this.stream,Sd,void 0,e);this.stream=r,this.shaken=!0}},z1=class extends Gb{async select(e,r){return await $P(this.stream,e,this.shaken?void 0:Sd,r)}async ls(e){await this._handshake(e);let r=await qae(this.stream,e),{stream:n,protocols:i}=r;return this.stream=n,i}},H1=class extends Gb{async handle(e,r){return await Vae(this.stream,e,r)}};var jP=E(Hae(),1);c();var GP=E(V(),1);c();var $ae=Symbol.for("@libp2p/connection");var FPe=C("libp2p:connection"),WP=class{constructor(e){let{remoteAddr:r,remotePeer:n,newStream:i,close:o,getStreams:s,stat:a}=e;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=r,this.remotePeer=n,this.stat={...a,status:vb},this._newStream=i,this._close=o,this._getStreams=s,this.registry=new Map,this.tags=[],this._closing=!1}get[Symbol.toStringTag](){return"Connection"}get[$ae](){return!0}get streams(){return this._getStreams()}async newStream(e,r){if(this.stat.status===dP)throw(0,GP.default)(new Error("the connection is being closed"),"ERR_CONNECTION_BEING_CLOSED");if(this.stat.status===Sb)throw(0,GP.default)(new Error("the connection is closed"),"ERR_CONNECTION_CLOSED");Array.isArray(e)||(e=[e]);let{stream:n,protocol:i}=await this._newStream(e,r);return this.addStream(n,{protocol:i,metadata:{}}),{stream:n,protocol:i}}addStream(e,r={}){this.registry.set(e.id,{protocol:r.protocol??"",metadata:r.metadata??{}})}removeStream(e){this.registry.delete(e)}async close(){if(!(this.stat.status===Sb||this._closing)){this.stat.status=dP;try{this.streams.forEach(e=>e.close())}catch(e){FPe.error(e)}this._closing=!0,await this._close(),this._closing=!1,this.stat.timeline.close=Date.now(),this.stat.status=Sb}}};function Gae(t){return new WP(t)}var Vr=C("libp2p:upgrader"),Wb=class extends Ue{constructor(e,r){super(),this.components=e,this.connectionEncryption=new Map,r.connectionEncryption.forEach(n=>{this.connectionEncryption.set(n.protocol,n)}),this.muxers=new Map,r.muxers.forEach(n=>{this.muxers.set(n.protocol,n)})}async upgradeInbound(e){let r,n,i,o,s,a,l,u=this.components.getMetrics();if(await this.components.getConnectionGater().denyInboundConnection(e))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by gater.acceptConnection"),K.ERR_CONNECTION_INTERCEPTED);if(u!=null){({setTarget:a,proxy:l}=(0,jP.default)());let p=`${(Math.random()*1e9).toString(36)}${Date.now()}`;a({toString:()=>p}),e=u.trackStream({stream:e,remotePeer:l})}Vr("starting the inbound connection upgrade");let f=e,h=this.components.getConnectionProtector();h!=null&&(Vr("protecting the inbound connection"),f=await h.protect(e));try{if({conn:r,remotePeer:n,protocol:s}=await this._encryptInbound(f),await this.components.getConnectionGater().denyInboundEncryptedConnection(n,{...f,...r}))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),K.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let p=await this._multiplexInbound({...f,...r},this.muxers);o=p.muxerFactory,i=p.stream}else i=r}catch(p){throw Vr.error("Failed to upgrade inbound connection",p),await e.close(p),p}if(await this.components.getConnectionGater().denyInboundUpgradedConnection(n,{...f,...r}))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),K.ERR_CONNECTION_INTERCEPTED);return u!=null&&(u.updatePlaceholder(l,n),a(n)),Vr("Successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:s,direction:"inbound",maConn:e,upgradedConn:i,muxerFactory:o,remotePeer:n})}async upgradeOutbound(e){let r=e.remoteAddr.getPeerId();if(r==null)throw(0,Ni.default)(new Error("outbound connection must have a peer id"),K.ERR_INVALID_MULTIADDR);let n=he(r);if(await this.components.getConnectionGater().denyOutboundConnection(n,e))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by connectionGater.denyOutboundConnection"),K.ERR_CONNECTION_INTERCEPTED);let i,o,s,a,l,u,f,h=this.components.getMetrics();if(h!=null){({setTarget:u,proxy:f}=(0,jP.default)());let m=`${(Math.random()*1e9).toString(36)}${Date.now()}`;u({toB58String:()=>m}),e=h.trackStream({stream:e,remotePeer:f})}Vr("Starting the outbound connection upgrade");let p=e,d=this.components.getConnectionProtector();d!=null&&(p=await d.protect(e));try{if({conn:i,remotePeer:o,protocol:a}=await this._encryptOutbound(p,n),await this.components.getConnectionGater().denyOutboundEncryptedConnection(o,{...p,...i}))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),K.ERR_CONNECTION_INTERCEPTED);if(this.muxers.size>0){let m=await this._multiplexOutbound({...p,...i},this.muxers);l=m.muxerFactory,s=m.stream}else s=i}catch(m){throw Vr.error("Failed to upgrade outbound connection",m),await e.close(m),m}if(await this.components.getConnectionGater().denyOutboundUpgradedConnection(o,{...p,...i}))throw(0,Ni.default)(new Error("The multiaddr connection is blocked by gater.acceptEncryptedConnection"),K.ERR_CONNECTION_INTERCEPTED);return h!=null&&(h.updatePlaceholder(f,o),u(o)),Vr("Successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:a,direction:"outbound",maConn:e,upgradedConn:s,muxerFactory:l,remotePeer:o})}_createConnection(e){let{cryptoProtocol:r,direction:n,maConn:i,upgradedConn:o,remotePeer:s,muxerFactory:a}=e,l,u,f;a!=null&&(l=a.createStreamMuxer(this.components,{onIncomingStream:d=>{f!=null&&Promise.resolve().then(async()=>{let m=new H1(d),g=this.components.getRegistrar().getProtocols(),{stream:y,protocol:w}=await m.handle(g);Vr("%s: incoming stream opened on %s",n,w);let b=this.components.getMetrics();b?.trackStream({stream:y,remotePeer:s,protocol:w}),f!=null&&(f.addStream(d,{protocol:w}),this._onStream({connection:f,stream:{...d,...y},protocol:w}))}).catch(m=>{Vr.error(m),d.timeline.close==null&&d.close()})},onStreamEnd:d=>{f?.removeStream(d.id)}}),u=async(d,m={})=>{if(l==null)throw(0,Ni.default)(new Error("Stream is not multiplexed"),K.ERR_MUXER_UNAVAILABLE);Vr("%s: starting new stream on %s",n,d);let g=l.newStream(),y=new z1(g),w=this.components.getMetrics();try{let{stream:b,protocol:v}=await y.select(d,m);return w!=null&&(b=w.trackStream({stream:b,remotePeer:s,protocol:v})),{stream:{...g,...b},protocol:v}}catch(b){throw Vr.error("could not create new stream",b),g.timeline.close==null&&g.close(),b.code!=null?b:(0,Ni.default)(b,K.ERR_UNSUPPORTED_PROTOCOL)}},Se(o,l,o).catch(Vr.error));let h=i.timeline;i.timeline=new Proxy(h,{set:(...d)=>(f!=null&&d[1]==="close"&&d[2]!=null&&h.close==null&&(async()=>{try{f.stat.status==="OPEN"&&await f.close()}catch(m){Vr.error(m)}finally{this.dispatchEvent(new ee("connectionEnd",{detail:f}))}})().catch(m=>{Vr.error(m)}),Reflect.set(...d))}),i.timeline.upgraded=Date.now();let p=()=>{throw(0,Ni.default)(new Error("connection is not multiplexed"),K.ERR_CONNECTION_NOT_MULTIPLEXED)};return f=Gae({remoteAddr:i.remoteAddr,remotePeer:s,stat:{status:"OPEN",direction:n,timeline:i.timeline,multiplexer:l?.protocol,encryption:r},newStream:u??p,getStreams:()=>l!=null?l.streams:p(),close:async()=>{await i.close(),l!=null&&await Promise.all(l.streams.map(async d=>{await d.close()}))}}),this.dispatchEvent(new ee("connection",{detail:f})),f}_onStream(e){let{connection:r,stream:n,protocol:i}=e;this.components.getRegistrar().getHandler(i)({connection:r,stream:n,protocol:i})}async _encryptInbound(e){let r=new H1(e),n=Array.from(this.connectionEncryption.keys());Vr("handling inbound crypto protocol selection",n);try{let{stream:i,protocol:o}=await r.handle(n),s=this.connectionEncryption.get(o);if(s==null)throw new Error(`no crypto module found for ${o}`);return Vr("encrypting inbound connection..."),{...await s.secureInbound(this.components.getPeerId(),i),protocol:o}}catch(i){throw(0,Ni.default)(i,K.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(e,r){let n=new z1(e),i=Array.from(this.connectionEncryption.keys());Vr("selecting outbound crypto protocol",i);try{let{stream:o,protocol:s}=await n.select(i),a=this.connectionEncryption.get(s);if(a==null)throw new Error(`no crypto module found for ${s}`);return Vr("encrypting outbound connection to %p",r),{...await a.secureOutbound(this.components.getPeerId(),o,r),protocol:s}}catch(o){throw(0,Ni.default)(o,K.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(e,r){let n=new z1(e),i=Array.from(r.keys());Vr("outbound selecting muxer %s",i);try{let{stream:o,protocol:s}=await n.select(i);Vr("%s selected as muxer protocol",s);let a=r.get(s);return{stream:o,muxerFactory:a}}catch(o){throw Vr.error("error multiplexing outbound stream",o),(0,Ni.default)(o,K.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(e,r){let n=new H1(e),i=Array.from(r.keys());Vr("inbound handling muxers %s",i);try{let{stream:o,protocol:s}=await n.handle(i),a=r.get(s);return{stream:o,muxerFactory:a}}catch(o){throw Vr.error("error multiplexing inbound stream",o),(0,Ni.default)(o,K.ERR_MUXER_UNAVAILABLE)}}};c();var QP=E(V(),1);var Wae=C("libp2p:registrar");function YP(t,e){for(let r of t)if(e.includes(r))return!0;return!1}var jb=class{constructor(e){this.topologies=new Map,this.handlers=new Map,this.components=e,this._onDisconnect=this._onDisconnect.bind(this),this._onProtocolChange=this._onProtocolChange.bind(this),this.components.getConnectionManager().addEventListener("peer:disconnect",this._onDisconnect),this.components.getPeerStore().addEventListener("change:protocols",this._onProtocolChange)}getProtocols(){let e=new Set;for(let r of this.topologies.values())r.protocols.forEach(n=>e.add(n));for(let r of this.handlers.keys())e.add(r);return Array.from(e).sort()}getHandler(e){let r=this.handlers.get(e);if(r==null)throw new Error(`No handler registered for protocol ${e}`);return r}getTopologies(e){let r=[];for(let{topology:n,protocols:i}of this.topologies.values())i.includes(e)&&r.push(n);return r}async handle(e,r){let n=Array.isArray(e)?e:[e];for(let i of n){if(this.handlers.has(i))throw(0,QP.default)(new Error(`Handler already registered for protocol ${i}`),K.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);this.handlers.set(i,r)}await this.components.getPeerStore().protoBook.add(this.components.getPeerId(),n)}async unhandle(e){let r=Array.isArray(e)?e:[e];r.forEach(n=>{this.handlers.delete(n)}),await this.components.getPeerStore().protoBook.remove(this.components.getPeerId(),r)}async register(e,r){if(!fee(r))throw Wae.error("topology must be an instance of interfaces/topology"),(0,QP.default)(new Error("topology must be an instance of interfaces/topology"),K.ERR_INVALID_PARAMETERS);let n=`${(Math.random()*1e9).toString(36)}${Date.now()}`;return this.topologies.set(n,{topology:r,protocols:Array.isArray(e)?e:[e]}),await r.setRegistrar(this),n}unregister(e){this.topologies.delete(e)}_onDisconnect(e){let r=e.detail;this.components.getPeerStore().protoBook.get(r.remotePeer).then(n=>{for(let{topology:i,protocols:o}of this.topologies.values())YP(n,o)&&i.onDisconnect(r.remotePeer)}).catch(n=>{Wae.error(n)})}_onProtocolChange(e){let{peerId:r,protocols:n,oldProtocols:i}=e.detail,o=i.filter(a=>!n.includes(a)),s=n.filter(a=>!i.includes(a));for(let{topology:a,protocols:l}of this.topologies.values())YP(o,l)&&a.onDisconnect(r);for(let{topology:a,protocols:l}of this.topologies.values())if(YP(s,l)){let u=this.components.getConnectionManager().getConnections(r)[0];if(u==null)continue;a.onConnect(r,u)}}};c();var Rd=E(V(),1);var XP=E(Ti(),1),ZP=E(Kc(),1);Ae();c();var xd;(function(t){t.codec=()=>et({5:{name:"protocolVersion",codec:pn,optional:!0},6:{name:"agentVersion",codec:pn,optional:!0},1:{name:"publicKey",codec:ve,optional:!0},2:{name:"listenAddrs",codec:ve,repeats:!0},4:{name:"observedAddr",codec:ve,optional:!0},3:{name:"protocols",codec:pn,repeats:!0},8:{name:"signedPeerRecord",codec:ve,optional:!0}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(xd||(xd={}));c();c();var Yb="0.0.0",jae="libp2p";var Yae=`js-libp2p/${Yb}`;var Qae="0.1.0",Xae="id",Zae="id/push",Jae="1.0.0",ece="1.0.0";var c3=E(Vo(),1);var yr=C("libp2p:identify"),Qb=6e4,tce=1024*8,$1=class{constructor(e,r){this.components=e,this.started=!1,this.init=r,this.handleMessage=this.handleMessage.bind(this),this.identifyProtocolStr=`/${r.protocolPrefix}/${Xae}/${Jae}`,this.identifyPushProtocolStr=`/${r.protocolPrefix}/${Zae}/${ece}`,this.host={protocolVersion:`${r.protocolPrefix}/${Qae}`,...r.host},this.components.getConnectionManager().addEventListener("peer:connect",n=>{let i=n.detail;this.identify(i).catch(yr.error)}),this.components.getPeerStore().addEventListener("change:multiaddrs",n=>{let{peerId:i}=n.detail;this.components.getPeerId().equals(i)&&this.pushToPeerStore().catch(o=>yr.error(o))}),this.components.getPeerStore().addEventListener("change:protocols",n=>{let{peerId:i}=n.detail;this.components.getPeerId().equals(i)&&this.pushToPeerStore().catch(o=>yr.error(o))})}isStarted(){return this.started}async start(){this.started||(await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"AgentVersion",U(this.host.agentVersion)),await this.components.getPeerStore().metadataBook.setValue(this.components.getPeerId(),"ProtocolVersion",U(this.host.protocolVersion)),await this.components.getRegistrar().handle([this.identifyProtocolStr,this.identifyPushProtocolStr],e=>{this.handleMessage(e)?.catch(r=>{yr.error(r)})}),this.started=!0)}async stop(){await this.components.getRegistrar().unhandle(this.identifyProtocolStr),await this.components.getRegistrar().unhandle(this.identifyPushProtocolStr),this.started=!1}async push(e){let r=await this.components.getPeerStore().addressBook.getRawEnvelope(this.components.getPeerId()),n=this.components.getAddressManager().getAddresses().map(s=>s.bytes),i=await this.components.getPeerStore().protoBook.get(this.components.getPeerId()),o=e.map(async s=>{let a=new c3.TimeoutController(this.init.timeout??Qb),l;try{l=(await s.newStream([this.identifyPushProtocolStr],{signal:a.signal})).stream;let f=ns(l,a.signal);await Se([xd.encode({listenAddrs:n,signedPeerRecord:r,protocols:i})],Cr(),f,XP.default)}catch(u){yr.error("could not push identify update to peer",u)}finally{l?.close(),a.clear()}});await Promise.all(o)}async pushToPeerStore(){if(!this.isStarted())return;let e=[];for(let r of this.components.getConnectionManager().getConnections()){let n=r.remotePeer;!(await this.components.getPeerStore().get(n)).protocols.includes(this.identifyPushProtocolStr)||e.push(r)}await this.push(e)}async _identify(e,r={}){let{stream:n}=await e.newStream([this.identifyProtocolStr],r),i=n,o,s=r.signal;s==null&&(o=new c3.TimeoutController(this.init.timeout??Qb),s=o.signal),i=ns(n,s);try{let a=await Se([],i,gr({maxDataLength:this.init.maxIdentifyMessageSize??tce}),async l=>await(0,ZP.default)(l));if(a==null)throw(0,Rd.default)(new Error("No data could be retrieved"),K.ERR_CONNECTION_ENDED);try{return xd.decode(a)}catch(l){throw(0,Rd.default)(l,K.ERR_INVALID_MESSAGE)}}finally{o?.clear(),n.close()}}async identify(e,r={}){let n=await this._identify(e,r),{publicKey:i,listenAddrs:o,protocols:s,observedAddr:a,signedPeerRecord:l,agentVersion:u,protocolVersion:f}=n;if(i==null)throw(0,Rd.default)(new Error("public key was missing from identify message"),K.ERR_MISSING_PUBLIC_KEY);let h=await on(i);if(!e.remotePeer.equals(h))throw(0,Rd.default)(new Error("identified peer does not match the expected peer"),K.ERR_INVALID_PEER);if(this.components.getPeerId().equals(h))throw(0,Rd.default)(new Error("identified peer is our own peer id?"),K.ERR_INVALID_PEER);let p=$1.getCleanMultiaddr(a);if(l!=null){yr("received signed peer record from %p",h);try{let d=await ln.openAndCertify(l,wn.DOMAIN);if(!d.peerId.equals(h))throw(0,Rd.default)(new Error("identified peer does not match the expected peer"),K.ERR_INVALID_PEER);if(await this.components.getPeerStore().addressBook.consumePeerRecord(d)){await this.components.getPeerStore().protoBook.set(h,s),u!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"AgentVersion",U(u)),f!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"ProtocolVersion",U(f)),yr("identify completed for peer %p and protocols %o",h,s);return}}catch(d){yr("received invalid envelope, discard it and fallback to listenAddrs is available",d)}}else yr("no signed peer record received from %p",h);yr("falling back to legacy addresses from %p",h);try{await this.components.getPeerStore().addressBook.set(h,o.map(d=>new W(d)))}catch(d){yr.error("received invalid addrs",d)}await this.components.getPeerStore().protoBook.set(h,s),u!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"AgentVersion",U(u)),f!=null&&await this.components.getPeerStore().metadataBook.setValue(h,"ProtocolVersion",U(f)),yr("identify completed for peer %p and protocols %o",h,s),yr("received observed address of %s",p?.toString())}handleMessage(e){let{protocol:r}=e;switch(r){case this.identifyProtocolStr:return this._handleIdentify(e);case this.identifyPushProtocolStr:return this._handlePush(e);default:yr.error("cannot handle unknown protocol %s",r)}}async _handleIdentify(e){let{connection:r,stream:n}=e,i=new c3.TimeoutController(this.init.timeout??Qb);try{let o=this.components.getPeerId().publicKey??new Uint8Array(0),s=await this.components.getPeerStore().get(this.components.getPeerId()),a=this.components.getAddressManager().getAddresses().map(h=>h.decapsulateCode(An("p2p").code)),l=s.peerRecordEnvelope;if(a.length>0&&l==null){let h=new wn({peerId:this.components.getPeerId(),multiaddrs:a}),p=await ln.seal(h,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(p),l=p.marshal()}let u=xd.encode({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:o,listenAddrs:a.map(h=>h.bytes),signedPeerRecord:l,observedAddr:r.remoteAddr.bytes,protocols:s.protocols}),f=ns(n,i.signal);await Se([u],Cr(),f,XP.default)}catch(o){yr.error("could not respond to identify request",o)}finally{n.close(),i.clear()}}async _handlePush(e){let{connection:r,stream:n}=e,i=new c3.TimeoutController(this.init.timeout??Qb),o;try{let a=ns(n,i.signal),l=await Se([],a,gr({maxDataLength:this.init.maxIdentifyMessageSize??tce}),async u=>await(0,ZP.default)(u));l!=null&&(o=xd.decode(l))}catch(a){return yr.error("received invalid message",a)}finally{n.close(),i.clear()}if(o==null)return yr.error("received invalid message");let s=r.remotePeer;if(this.components.getPeerId().equals(s)){yr("received push from ourselves?");return}if(yr("received push from %p",s),o.signedPeerRecord!=null){yr("received signedPeerRecord in push");try{let a=await ln.openAndCertify(o.signedPeerRecord,wn.DOMAIN);if(await this.components.getPeerStore().addressBook.consumePeerRecord(a)){yr("consumed signedPeerRecord sent in push"),await this.components.getPeerStore().protoBook.set(s,o.protocols);return}else yr("failed to consume signedPeerRecord sent in push")}catch(a){yr("received invalid envelope, discard it and fallback to listenAddrs is available",a)}}else yr("did not receive signedPeerRecord in push");try{await this.components.getPeerStore().addressBook.set(s,o.listenAddrs.map(a=>new W(a)))}catch(a){yr.error("received invalid addrs",a)}try{await this.components.getPeerStore().protoBook.set(s,o.protocols)}catch(a){yr.error("received invalid protocols",a)}yr("handled push from %p",s)}static getCleanMultiaddr(e){if(e!=null&&e.length>0)try{return new W(e)}catch{}}};c();var Xb=E(V(),1);c();var l3;(function(t){t.codec=()=>et({1:{name:"identifier",codec:pn}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(l3||(l3={}));var Zs;(function(t){let e;(function(n){n.OK="OK",n.NOT_FOUND="NOT_FOUND",n.ERROR="ERROR"})(e=t.StatusCode||(t.StatusCode={}));let r;(function(n){n[n.OK=0]="OK",n[n.NOT_FOUND=1]="NOT_FOUND",n[n.ERROR=2]="ERROR"})(r||(r={})),function(n){n.codec=()=>so(r)}(e=t.StatusCode||(t.StatusCode={})),t.codec=()=>et({1:{name:"status",codec:t.StatusCode.codec()},2:{name:"data",codec:ve}}),t.encode=n=>Je(n,t.codec()),t.decode=n=>Ze(n,t.codec())})(Zs||(Zs={}));c();var rce="0.0.1",nce="fetch";var ice=C("libp2p:fetch"),Zb=class{constructor(e,r){this.started=!1,this.components=e,this.protocol=`/${r.protocolPrefix??"libp2p"}/${nce}/${rce}`,this.lookupFunctions=new Map,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.getRegistrar().handle(this.protocol,e=>{this.handleMessage(e).catch(r=>{ice.error(r)})}),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}async fetch(e,r,n={}){ice("dialing %s to %p",this.protocol,e);let i=await this.components.getConnectionManager().openConnection(e,n),{stream:o}=await i.newStream([this.protocol],n),s=o;n.signal!=null&&(s=ns(o,n.signal));let a=Ro(s);a.write(Cr.single(l3.encode({identifier:r})).slice());let l=Zs.decode((await gr.fromReader(a.reader).next()).value.slice());switch(l.status){case Zs.StatusCode.OK:return l.data;case Zs.StatusCode.NOT_FOUND:return null;case Zs.StatusCode.ERROR:{let u=new TextDecoder().decode(l.data);throw(0,Xb.default)(new Error("Error in fetch protocol response: "+u),K.ERR_INVALID_PARAMETERS)}default:throw(0,Xb.default)(new Error("Unknown response status"),K.ERR_INVALID_MESSAGE)}}async handleMessage(e){let{stream:r}=e,n=Ro(r),i=l3.decode((await gr.fromReader(n.reader).next()).value.slice()),o,s=this._getLookupFunction(i.identifier);if(s!=null){let a=await s(i.identifier);a!=null?o={status:Zs.StatusCode.OK,data:a}:o={status:Zs.StatusCode.NOT_FOUND,data:new Uint8Array(0)}}else{let a=new TextEncoder().encode("No lookup function registered for key: "+i.identifier);o={status:Zs.StatusCode.ERROR,data:a}}n.write(Cr.single(Zs.encode(o)).slice())}_getLookupFunction(e){for(let r of this.lookupFunctions.keys())if(e.startsWith(r))return this.lookupFunctions.get(r)}registerLookupFunction(e,r){if(this.lookupFunctions.has(e))throw(0,Xb.default)(new Error("Fetch protocol handler for key prefix '"+e+"' already registered"),K.ERR_KEY_ALREADY_EXISTS);this.lookupFunctions.set(e,r)}unregisterLookupFunction(e,r){r!=null&&this.lookupFunctions.get(e)!==r||this.lookupFunctions.delete(e)}};c();var cce=E(V(),1);var lce=E(Kc(),1);Mr();c();var oce="1.0.0",sce="ping";var ace=C("libp2p:ping"),Jb=class{constructor(e,r){this.components=e,this.started=!1,this.protocol=`/${r.protocolPrefix}/${sce}/${oce}`}async start(){await this.components.getRegistrar().handle(this.protocol,this.handleMessage),this.started=!0}async stop(){await this.components.getRegistrar().unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(e){let{stream:r}=e;Se(r,r).catch(n=>{ace.error(n)})}async ping(e,r={}){ace("dialing %s to %p",this.protocol,e);let n=await this.components.getConnectionManager().openConnection(e,r),{stream:i}=await n.newStream([this.protocol],r),o=Date.now(),s=Os(32),a=i;r.signal!=null&&(a=ns(i,r.signal));try{let l=await Se([s],a,async f=>await(0,lce.default)(f)),u=Date.now();if(l==null||!Me(s,l))throw(0,cce.default)(new Error("Received wrong ping ack"),K.ERR_WRONG_PING_ACK);return u-o}finally{i.close()}}};c();c();async function uce(){throw new Error("Not supported in browsers")}var rN=E(JP(),1),pce=E(Ab(),1);var mce=E(V(),1);c();c();function hce(t){return/^127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(t)||/^::1$/.test(t)}function dce(t){let{address:e}=t.nodeAddress();return hce(e)}var eN=C("libp2p:nat"),tN=7200;function QPe(t=1024,e=65535){return Math.floor(Math.random()*(e-t+1)+t)}var t_=class{constructor(e,r){if(this.components=e,this.started=!1,this.enabled=r.enabled,this.externalAddress=r.externalAddress,this.localAddress=r.localAddress,this.description=r.description??`${jae}@${Yb} ${this.components.getPeerId().toString()}`,this.ttl=r.ttl??tN,this.keepAlive=r.keepAlive??!0,this.gateway=r.gateway,this.ttl<tN)throw(0,mce.default)(new Error(`NatManager ttl should be at least ${tN} seconds`),K.ERR_INVALID_PARAMETERS)}isStarted(){return this.started}start(){}afterStart(){rN.isBrowser||!this.enabled||this.started||(this.started=!0,this._start().catch(e=>{eN.error(e)}))}async _start(){let e=this.components.getTransportManager().getAddrs();for(let r of e){let{family:n,host:i,port:o,transport:s}=r.toOptions();if(!r.isThinWaistAddress()||s!=="tcp"||dce(r)||n!==4)continue;let a=await this._getClient(),l=this.externalAddress??await a.externalIp();if((0,pce.default)(l))throw new Error(`${l} is private - please set config.nat.externalIp to an externally routable IP or ensure you are not behind a double NAT`);let u=QPe();eN(`opening uPnP connection from ${l}:${u} to ${i}:${o}`),await a.map({publicPort:u,localPort:o,localAddress:this.localAddress,protocol:s.toUpperCase()==="TCP"?"TCP":"UDP"}),this.components.getAddressManager().addObservedAddr(W.fromNodeAddress({family:4,address:l,port:u},s))}}async _getClient(){return this.client!=null?this.client:(this.client=await uce({description:this.description,ttl:this.ttl,keepAlive:this.keepAlive,gateway:this.gateway}),this.client)}async stop(){if(!(rN.isBrowser||this.client==null))try{await this.client.close(),this.client=void 0}catch(e){eN.error(e)}}};c();var XPe=C("libp2p:peer-record-updater"),r_=class{constructor(e){this.components=e,this.started=!1,this.update=this.update.bind(this)}isStarted(){return this.started}async start(){this.started=!0,this.components.getTransportManager().addEventListener("listener:listening",this.update),this.components.getTransportManager().addEventListener("listener:close",this.update),this.components.getAddressManager().addEventListener("change:addresses",this.update)}async stop(){this.started=!1,this.components.getTransportManager().removeEventListener("listener:listening",this.update),this.components.getTransportManager().removeEventListener("listener:close",this.update),this.components.getAddressManager().removeEventListener("change:addresses",this.update)}update(){Promise.resolve().then(async()=>{let e=new wn({peerId:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(n=>n.decapsulateCode(An("p2p").code))}),r=await ln.seal(e,this.components.getPeerId());await this.components.getPeerStore().addressBook.consumePeerRecord(r)}).catch(e=>{XPe.error("Could not update self peer record: %o",e)})}};c();var gce=E(V(),1);var n_=class{constructor(e){this.dht=e}async findPeer(e,r={}){for await(let n of this.dht.findPeer(e,r))if(n.name==="FINAL_PEER")return n.peer;throw(0,gce.default)(new Error(bt.NOT_FOUND),K.ERR_NOT_FOUND)}async*getClosestPeers(e,r={}){for await(let n of this.dht.getClosestPeers(e,r))n.name==="PEER_RESPONSE"&&(yield*n.closer)}};c();c();var o_=E(V(),1);c();var gt={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_NOT_FOUND:"ERR_NOT_FOUND"};var yce=E(Bs(),1),wce=E(Hi(),1),Ece=E(ei(),1),bce=E(LP(),1);var pr=C("libp2p:peer-store:address-book"),i_="change:multiaddrs";async function ZPe(){return!0}var s_=class{constructor(e,r,n){this.dispatchEvent=e,this.store=r,this.addressFilter=n??ZPe}async consumePeerRecord(e){pr.trace("consumePeerRecord await write lock");let r=await this.store.lock.writeLock();pr.trace("consumePeerRecord got write lock");let n,i,o;try{let s;try{s=wn.createFromProtobuf(e.payload)}catch{return pr.error("invalid peer record received"),!1}n=s.peerId;let a=s.multiaddrs;if(!n.equals(e.peerId))return pr("signing key does not match PeerId in the PeerRecord"),!1;if(a==null||a.length===0)return!1;if(await this.store.has(n)&&(i=await this.store.load(n),i.peerRecordEnvelope!=null)){let u=await ln.createFromProtobuf(i.peerRecordEnvelope),f=wn.createFromProtobuf(u.payload);if(f.seqNumber>=s.seqNumber)return pr("sequence number was lower or equal to existing sequence number - stored: %d received: %d",f.seqNumber,s.seqNumber),!1}let l=await nN(n,a,this.addressFilter,!0);o=await this.store.patchOrCreate(n,{addresses:l,peerRecordEnvelope:e.marshal()}),pr("stored provided peer record for %p",s.peerId)}finally{pr.trace("consumePeerRecord release write lock"),r()}return this.dispatchEvent(new ee(i_,{detail:{peerId:n,multiaddrs:o.addresses.map(({multiaddr:s})=>s),oldMultiaddrs:i==null?[]:i.addresses.map(({multiaddr:s})=>s)}})),!0}async getRawEnvelope(e){pr.trace("getRawEnvelope await read lock");let r=await this.store.lock.readLock();pr.trace("getRawEnvelope got read lock");try{return(await this.store.load(e)).peerRecordEnvelope}catch(n){if(n.code!==gt.ERR_NOT_FOUND)throw n}finally{pr.trace("getRawEnvelope release read lock"),r()}}async getPeerRecord(e){let r=await this.getRawEnvelope(e);if(r!=null)return await ln.createFromProtobuf(r)}async get(e){e=nn(e),pr.trace("get wait for read lock");let r=await this.store.lock.readLock();pr.trace("get got read lock");try{return(await this.store.load(e)).addresses}catch(n){if(n.code!==gt.ERR_NOT_FOUND)throw n}finally{pr.trace("get release read lock"),r()}return[]}async set(e,r){if(e=nn(e),!Array.isArray(r))throw pr.error("multiaddrs must be an array of Multiaddrs"),(0,o_.default)(new Error("multiaddrs must be an array of Multiaddrs"),gt.ERR_INVALID_PARAMETERS);pr.trace("set await write lock");let n=await this.store.lock.writeLock();pr.trace("set got write lock");let i=!1,o,s;try{let a=await nN(e,r,this.addressFilter);if(a.length===0)return;try{if(o=await this.store.load(e),i=!0,new Set([...a.map(({multiaddr:l})=>l.toString()),...o.addresses.map(({multiaddr:l})=>l.toString())]).size===o.addresses.length&&a.length===o.addresses.length)return}catch(l){if(l.code!==gt.ERR_NOT_FOUND)throw l}s=await this.store.patchOrCreate(e,{addresses:a}),pr("set multiaddrs for %p",e)}finally{pr.trace("set multiaddrs for %p",e),pr("set release write lock"),n()}this.dispatchEvent(new ee(i_,{detail:{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr),oldMultiaddrs:o==null?[]:o.addresses.map(({multiaddr:a})=>a)}})),i||this.dispatchEvent(new ee("peer",{detail:{id:e,multiaddrs:s.addresses.map(a=>a.multiaddr),protocols:s.protocols}}))}async add(e,r){if(e=nn(e),!Array.isArray(r))throw pr.error("multiaddrs must be an array of Multiaddrs"),(0,o_.default)(new Error("multiaddrs must be an array of Multiaddrs"),gt.ERR_INVALID_PARAMETERS);pr.trace("add await write lock");let n=await this.store.lock.writeLock();pr.trace("add got write lock");let i,o,s;try{let a=await nN(e,r,this.addressFilter);if(a.length===0)return;try{if(o=await this.store.load(e),i=!0,new Set([...a.map(({multiaddr:l})=>l.toString()),...o.addresses.map(({multiaddr:l})=>l.toString())]).size===o.addresses.length)return}catch(l){if(l.code!==gt.ERR_NOT_FOUND)throw l}s=await this.store.mergeOrCreate(e,{addresses:a}),pr("added multiaddrs for %p",e)}finally{pr.trace("set release write lock"),n()}this.dispatchEvent(new ee(i_,{detail:{peerId:e,multiaddrs:s.addresses.map(a=>a.multiaddr),oldMultiaddrs:o==null?[]:o.addresses.map(({multiaddr:a})=>a)}})),i===!0&&this.dispatchEvent(new ee("peer",{detail:{id:e,multiaddrs:s.addresses.map(a=>a.multiaddr),protocols:s.protocols}}))}async delete(e){e=nn(e),pr.trace("delete await write lock");let r=await this.store.lock.writeLock();pr.trace("delete got write lock");let n;try{try{n=await this.store.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(e,{addresses:[]})}finally{pr.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new ee(i_,{detail:{peerId:e,multiaddrs:[],oldMultiaddrs:n==null?[]:n.addresses.map(({multiaddr:i})=>i)}}))}};async function nN(t,e,r,n=!1){return await Se(e,i=>(0,bce.default)(i,o=>{if(!W.isMultiaddr(o))throw pr.error("multiaddr must be an instance of Multiaddr"),(0,o_.default)(new Error("multiaddr must be an instance of Multiaddr"),gt.ERR_INVALID_PARAMETERS)}),i=>(0,wce.default)(i,async o=>await r(t,o)),i=>(0,Ece.default)(i,o=>({multiaddr:new W(o.toString()),isCertified:n})),async i=>await(0,yce.default)(i))}c();var vce=E(V(),1);Mr();var ec=C("libp2p:peer-store:key-book"),_ce="change:pubkey",a_=class{constructor(e,r){this.dispatchEvent=e,this.store=r}async set(e,r){if(e=nn(e),!(r instanceof Uint8Array))throw ec.error("publicKey must be an instance of Uint8Array to store data"),(0,vce.default)(new Error("publicKey must be an instance of PublicKey"),gt.ERR_INVALID_PARAMETERS);ec.trace("set await write lock");let n=await this.store.lock.writeLock();ec.trace("set got write lock");let i=!1,o;try{try{if(o=await this.store.load(e),o.pubKey!=null&&Me(o.pubKey,r))return}catch(s){if(s.code!==gt.ERR_NOT_FOUND)throw s}await this.store.patchOrCreate(e,{pubKey:r}),i=!0}finally{ec.trace("set release write lock"),n()}i&&this.dispatchEvent(new ee(_ce,{detail:{peerId:e,publicKey:r,oldPublicKey:o?.pubKey}}))}async get(e){e=nn(e),ec.trace("get await write lock");let r=await this.store.lock.readLock();ec.trace("get got write lock");try{return(await this.store.load(e)).pubKey}catch(n){if(n.code!==gt.ERR_NOT_FOUND)throw n}finally{ec("get release write lock"),r()}}async delete(e){e=nn(e),ec.trace("delete await write lock");let r=await this.store.lock.writeLock();ec.trace("delete got write lock");let n;try{try{n=await this.store.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(e,{pubKey:void 0})}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}finally{ec.trace("delete release write lock"),r()}this.dispatchEvent(new ee(_ce,{detail:{peerId:e,publicKey:void 0,oldPublicKey:n?.pubKey}}))}};c();var iN=E(V(),1);Mr();var vn=C("libp2p:peer-store:metadata-book"),c_="change:metadata",l_=class{constructor(e,r){this.dispatchEvent=e,this.store=r}async get(e){e=nn(e),vn.trace("get await read lock");let r=await this.store.lock.readLock();vn.trace("get got read lock");try{return(await this.store.load(e)).metadata}catch(n){if(n.code!==gt.ERR_NOT_FOUND)throw n}finally{vn.trace("get release read lock"),r()}return new Map}async getValue(e,r){e=nn(e),vn.trace("getValue await read lock");let n=await this.store.lock.readLock();vn.trace("getValue got read lock");try{return(await this.store.load(e)).metadata.get(r)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}finally{vn.trace("getValue release write lock"),n()}}async set(e,r){if(e=nn(e),!(r instanceof Map))throw vn.error("valid metadata must be provided to store data"),(0,iN.default)(new Error("valid metadata must be provided"),gt.ERR_INVALID_PARAMETERS);vn.trace("set await write lock");let n=await this.store.lock.writeLock();vn.trace("set got write lock");let i;try{try{i=await this.store.load(e)}catch(o){if(o.code!==gt.ERR_NOT_FOUND)throw o}await this.store.mergeOrCreate(e,{metadata:r})}finally{vn.trace("set release write lock"),n()}this.dispatchEvent(new ee(c_,{detail:{peerId:e,metadata:r,oldMetadata:i==null?new Map:i.metadata}}))}async setValue(e,r,n){if(e=nn(e),typeof r!="string"||!(n instanceof Uint8Array))throw vn.error("valid key and value must be provided to store data"),(0,iN.default)(new Error("valid key and value must be provided"),gt.ERR_INVALID_PARAMETERS);vn.trace("setValue await write lock");let i=await this.store.lock.writeLock();vn.trace("setValue got write lock");let o,s;try{try{o=await this.store.load(e);let a=o.metadata.get(r);if(a!=null&&Me(n,a))return}catch(a){if(a.code!==gt.ERR_NOT_FOUND)throw a}s=await this.store.mergeOrCreate(e,{metadata:new Map([[r,n]])})}finally{vn.trace("setValue release write lock"),i()}this.dispatchEvent(new ee(c_,{detail:{peerId:e,metadata:s.metadata,oldMetadata:o==null?new Map:o.metadata}}))}async delete(e){e=nn(e),vn.trace("delete await write lock");let r=await this.store.lock.writeLock();vn.trace("delete got write lock");let n;try{try{n=await this.store.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}n!=null&&await this.store.patch(e,{metadata:new Map})}finally{vn.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new ee(c_,{detail:{peerId:e,metadata:new Map,oldMetadata:n.metadata}}))}async deleteValue(e,r){e=nn(e),vn.trace("deleteValue await write lock");let n=await this.store.lock.writeLock();vn.trace("deleteValue got write lock");let i,o;try{o=await this.store.load(e),i=o.metadata,i.delete(r),await this.store.patch(e,{metadata:i})}catch(s){if(s.code!==gt.ERR_NOT_FOUND)throw s}finally{vn.trace("deleteValue release write lock"),n()}i!=null&&this.dispatchEvent(new ee(c_,{detail:{peerId:e,metadata:i,oldMetadata:o==null?new Map:o.metadata}}))}};c();var f_=E(V(),1);var Sn=C("libp2p:peer-store:proto-book"),u_="change:protocols",h_=class{constructor(e,r){this.dispatchEvent=e,this.store=r}async get(e){Sn.trace("get wait for read lock");let r=await this.store.lock.readLock();Sn.trace("get got read lock");try{return(await this.store.load(e)).protocols}catch(n){if(n.code!==gt.ERR_NOT_FOUND)throw n}finally{Sn.trace("get release read lock"),r()}return[]}async set(e,r){if(e=nn(e),!Array.isArray(r))throw Sn.error("protocols must be provided to store data"),(0,f_.default)(new Error("protocols must be provided"),gt.ERR_INVALID_PARAMETERS);Sn.trace("set await write lock");let n=await this.store.lock.writeLock();Sn.trace("set got write lock");let i,o;try{try{if(i=await this.store.load(e),new Set([...r]).size===i.protocols.length)return}catch(s){if(s.code!==gt.ERR_NOT_FOUND)throw s}o=await this.store.patchOrCreate(e,{protocols:r}),Sn("stored provided protocols for %p",e)}finally{Sn.trace("set release write lock"),n()}this.dispatchEvent(new ee(u_,{detail:{peerId:e,protocols:o.protocols,oldProtocols:i==null?[]:i.protocols}}))}async add(e,r){if(e=nn(e),!Array.isArray(r))throw Sn.error("protocols must be provided to store data"),(0,f_.default)(new Error("protocols must be provided"),gt.ERR_INVALID_PARAMETERS);Sn.trace("add await write lock");let n=await this.store.lock.writeLock();Sn.trace("add got write lock");let i,o;try{try{if(i=await this.store.load(e),new Set([...i.protocols,...r]).size===i.protocols.length)return}catch(s){if(s.code!==gt.ERR_NOT_FOUND)throw s}o=await this.store.mergeOrCreate(e,{protocols:r}),Sn("added provided protocols for %p",e)}finally{Sn.trace("add release write lock"),n()}this.dispatchEvent(new ee(u_,{detail:{peerId:e,protocols:o.protocols,oldProtocols:i==null?[]:i.protocols}}))}async remove(e,r){if(e=nn(e),!Array.isArray(r))throw Sn.error("protocols must be provided to store data"),(0,f_.default)(new Error("protocols must be provided"),gt.ERR_INVALID_PARAMETERS);Sn.trace("remove await write lock");let n=await this.store.lock.writeLock();Sn.trace("remove got write lock");let i,o;try{try{i=await this.store.load(e);let s=new Set(i.protocols);for(let a of r)s.delete(a);if(i.protocols.length===s.size)return;r=Array.from(s)}catch(s){if(s.code!==gt.ERR_NOT_FOUND)throw s}o=await this.store.patchOrCreate(e,{protocols:r})}finally{Sn.trace("remove release write lock"),n()}this.dispatchEvent(new ee(u_,{detail:{peerId:e,protocols:o.protocols,oldProtocols:i==null?[]:i.protocols}}))}async delete(e){e=nn(e),Sn.trace("delete await write lock");let r=await this.store.lock.writeLock();Sn.trace("delete got write lock");let n;try{try{n=await this.store.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i}await this.store.patchOrCreate(e,{protocols:[]})}finally{Sn.trace("delete release write lock"),r()}n!=null&&this.dispatchEvent(new ee(u_,{detail:{peerId:e,protocols:[],oldProtocols:n.protocols}}))}};c();var bN=E(V(),1);si();c();var f3;(function(t){t.codec=()=>et({1:{name:"addresses",codec:oN.codec(),repeats:!0},2:{name:"protocols",codec:pn,repeats:!0},3:{name:"metadata",codec:sN.codec(),repeats:!0},4:{name:"pubKey",codec:ve,optional:!0},5:{name:"peerRecordEnvelope",codec:ve,optional:!0}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(f3||(f3={}));var oN;(function(t){t.codec=()=>et({1:{name:"multiaddr",codec:ve},2:{name:"isCertified",codec:h2,optional:!0}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(oN||(oN={}));var sN;(function(t){t.codec=()=>et({1:{name:"key",codec:pn},2:{name:"value",codec:ve}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(sN||(sN={}));c();c();var Cce=E(ql(),1);c();c();function aN(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var Td=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ul,h3=class{constructor(){ul.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&Td(this,ul,"f")[this.size-1].priority>=r.priority){Td(this,ul,"f").push(n);return}let i=aN(Td(this,ul,"f"),n,(o,s)=>s.priority-o.priority);Td(this,ul,"f").splice(i,0,n)}dequeue(){let e=Td(this,ul,"f").shift();return e?.run}filter(e){return Td(this,ul,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return Td(this,ul,"f").length}};ul=new WeakMap;var nr=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},be=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Qn,p3,m3,ff,y_,g3,d_,Js,d3,To,p_,Ao,y3,uf,G1,W1,Ad,m_,Sce,xce,Ice,Rce,Tce,Ace,g_,cN,lN,w_,E_=()=>{},JPe=new hi,uN=class extends Error{},j1=class extends Cce.default{constructor(e){var r,n,i,o;if(super(),Qn.add(this),p3.set(this,void 0),m3.set(this,void 0),ff.set(this,0),y_.set(this,void 0),g3.set(this,void 0),d_.set(this,0),Js.set(this,void 0),d3.set(this,void 0),To.set(this,void 0),p_.set(this,void 0),Ao.set(this,0),y3.set(this,void 0),uf.set(this,void 0),G1.set(this,E_),W1.set(this,E_),Ad.set(this,void 0),m_.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:h3,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);nr(this,p3,e.carryoverConcurrencyCount,"f"),nr(this,m3,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),nr(this,y_,e.intervalCap,"f"),nr(this,g3,e.interval,"f"),nr(this,To,new e.queueClass,"f"),nr(this,p_,e.queueClass,"f"),this.concurrency=e.concurrency,nr(this,Ad,e.timeout,"f"),nr(this,m_,e.throwOnTimeout===!0,"f"),nr(this,uf,e.autoStart===!1,"f")}get concurrency(){return be(this,y3,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);nr(this,y3,e,"f"),be(this,Qn,"m",w_).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;nr(this,Ao,(a=be(this,Ao,"f"),a++,a),"f"),nr(this,ff,(l=be(this,ff,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new uN("The task was aborted."));return}let f=await(be(this,Ad,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?be(this,Ad,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?be(this,m_,"f"):r.throwOnTimeout)&&i(JPe)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}be(this,Qn,"m",Ice).call(this)};be(this,To,"f").enqueue(o,r),be(this,Qn,"m",g_).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return be(this,uf,"f")?(nr(this,uf,!1,"f"),be(this,Qn,"m",w_).call(this),this):this}pause(){nr(this,uf,!0,"f")}clear(){nr(this,To,new(be(this,p_,"f")),"f")}async onEmpty(){if(be(this,To,"f").size!==0)return new Promise(e=>{let r=be(this,G1,"f");nr(this,G1,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(be(this,To,"f").size<e))return new Promise(r=>{let n=()=>{be(this,To,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(be(this,Ao,"f")===0&&be(this,To,"f").size===0))return new Promise(e=>{let r=be(this,W1,"f");nr(this,W1,()=>{r(),e()},"f")})}get size(){return be(this,To,"f").size}sizeBy(e){return be(this,To,"f").filter(e).length}get pending(){return be(this,Ao,"f")}get isPaused(){return be(this,uf,"f")}get timeout(){return be(this,Ad,"f")}set timeout(e){nr(this,Ad,e,"f")}};p3=new WeakMap,m3=new WeakMap,ff=new WeakMap,y_=new WeakMap,g3=new WeakMap,d_=new WeakMap,Js=new WeakMap,d3=new WeakMap,To=new WeakMap,p_=new WeakMap,Ao=new WeakMap,y3=new WeakMap,uf=new WeakMap,G1=new WeakMap,W1=new WeakMap,Ad=new WeakMap,m_=new WeakMap,Qn=new WeakSet,Sce=function(){return be(this,m3,"f")||be(this,ff,"f")<be(this,y_,"f")},xce=function(){return be(this,Ao,"f")<be(this,y3,"f")},Ice=function(){var e;nr(this,Ao,(e=be(this,Ao,"f"),e--,e),"f"),be(this,Qn,"m",g_).call(this),this.emit("next")},Rce=function(){be(this,G1,"f").call(this),nr(this,G1,E_,"f"),be(this,Ao,"f")===0&&(be(this,W1,"f").call(this),nr(this,W1,E_,"f"),this.emit("idle"))},Tce=function(){be(this,Qn,"m",lN).call(this),be(this,Qn,"m",cN).call(this),nr(this,d3,void 0,"f")},Ace=function(){let e=Date.now();if(be(this,Js,"f")===void 0){let r=be(this,d_,"f")-e;if(r<0)nr(this,ff,be(this,p3,"f")?be(this,Ao,"f"):0,"f");else return be(this,d3,"f")===void 0&&nr(this,d3,setTimeout(()=>{be(this,Qn,"m",Tce).call(this)},r),"f"),!0}return!1},g_=function(){if(be(this,To,"f").size===0)return be(this,Js,"f")&&clearInterval(be(this,Js,"f")),nr(this,Js,void 0,"f"),be(this,Qn,"m",Rce).call(this),!1;if(!be(this,uf,"f")){let e=!be(this,Qn,"m",Ace).call(this);if(be(this,Qn,"a",Sce)&&be(this,Qn,"a",xce)){let r=be(this,To,"f").dequeue();return r?(this.emit("active"),r(),e&&be(this,Qn,"m",cN).call(this),!0):!1}}return!1},cN=function(){be(this,m3,"f")||be(this,Js,"f")!==void 0||(nr(this,Js,setInterval(()=>{be(this,Qn,"m",lN).call(this)},be(this,g3,"f")),"f"),nr(this,d_,Date.now()+be(this,g3,"f"),"f"))},lN=function(){be(this,ff,"f")===0&&be(this,Ao,"f")===0&&be(this,Js,"f")&&(clearInterval(be(this,Js,"f")),nr(this,Js,void 0,"f")),nr(this,ff,be(this,p3,"f")?be(this,Ao,"f"):0,"f"),be(this,Qn,"m",w_).call(this)},w_=function(){for(;be(this,Qn,"m",g_).call(this););};c();vp();c();var fN="lock:worker:request-read",hN="lock:worker:release-read",dN="lock:master:grant-read",pN="lock:worker:request-write",mN="lock:worker:release-write",gN="lock:master:grant-write";c();var hf={},Y1=t=>{t.addEventListener("message",e=>{Y1.dispatchEvent("message",t,e)}),t.port!=null&&t.port.addEventListener("message",e=>{Y1.dispatchEvent("message",t,e)})};Y1.addEventListener=(t,e)=>{hf[t]==null&&(hf[t]=[]),hf[t].push(e)};Y1.removeEventListener=(t,e)=>{hf[t]!=null&&(hf[t]=hf[t].filter(r=>r===e))};Y1.dispatchEvent=function(t,e,r){hf[t]!=null&&hf[t].forEach(n=>n(e,r))};var yN=Y1;var Pce=(t,e,r,n,i)=>(o,s)=>{if(s.data.type!==r)return;let a={type:s.data.type,name:s.data.name,identifier:s.data.identifier};t.dispatchEvent(new MessageEvent(e,{data:{name:a.name,handler:async()=>(o.postMessage({type:i,name:a.name,identifier:a.identifier}),await new Promise(l=>{let u=f=>{if(f==null||f.data==null)return;let h={type:f.data.type,name:f.data.name,identifier:f.data.identifier};h.type===n&&h.identifier===a.identifier&&(o.removeEventListener("message",u),l())};o.addEventListener("message",u)}))}}))},Nce=(t,e,r,n)=>async()=>{let i=Vf();return globalThis.postMessage({type:e,identifier:i,name:t}),await new Promise(o=>{let s=a=>{if(a==null||a.data==null)return;let l={type:a.data.type,identifier:a.data.identifier};l.type===r&&l.identifier===i&&(globalThis.removeEventListener("message",s),o(()=>{globalThis.postMessage({type:n,identifier:i,name:t})}))};globalThis.addEventListener("message",s)})},eNe={singleProcess:!1},kce=t=>{if(t=Object.assign({},eNe,t),Boolean(globalThis.document)||t.singleProcess){let r=new EventTarget;return yN.addEventListener("message",Pce(r,"requestReadLock",fN,hN,dN)),yN.addEventListener("message",Pce(r,"requestWriteLock",pN,mN,gN)),r}return{isWorker:!0,readLock:r=>Nce(r,fN,dN,hN),writeLock:r=>Nce(r,pN,gN,mN)}};var Id={},df;async function wN(t,e){let r,n=new Promise(i=>{r=i});return t.add(async()=>await rn((async()=>await new Promise(i=>{r(()=>{i()})}))(),e.timeout)),await n}var tNe=(t,e)=>{if(df.isWorker===!0)return{readLock:df.readLock(t,e),writeLock:df.writeLock(t,e)};let r=new j1({concurrency:1}),n;return{async readLock(){if(n!=null)return await wN(n,e);n=new j1({concurrency:e.concurrency,autoStart:!1});let i=n,o=wN(n,e);return r.add(async()=>(i.start(),await i.onIdle().then(()=>{n===i&&(n=null)}))),await o},async writeLock(){return n=null,await wN(r,e)}}},rNe={name:"lock",concurrency:1/0,timeout:846e5,global:globalThis,singleProcess:!1};function EN(t){let e=Object.assign({},rNe,t);return df==null&&(df=kce(e),df.isWorker!==!0&&(df.addEventListener("requestReadLock",r=>{Id[r.data.name]!=null&&Id[r.data.name].readLock().then(async n=>await r.data.handler().finally(()=>n()))}),df.addEventListener("requestWriteLock",async r=>{Id[r.data.name]!=null&&Id[r.data.name].writeLock().then(async n=>await r.data.handler().finally(()=>n()))}))),Id[e.name]==null&&(Id[e.name]=tNe(e.name,e)),Id[e.name]}Mr();var Dce=C("libp2p:peer-store:store"),Oce="/peers/",b_=class{constructor(){this.components=new ze,this.lock=EN({name:"peer-store",singleProcess:!0})}init(e){this.components=e}_peerIdToDatastoreKey(e){if(e.type==null)throw Dce.error("peerId must be an instance of peer-id to store data"),(0,bN.default)(new Error("peerId must be an instance of peer-id"),gt.ERR_INVALID_PARAMETERS);let r=e.toCID().toString();return new ae(`${Oce}${r}`)}async has(e){return await this.components.getDatastore().has(this._peerIdToDatastoreKey(e))}async delete(e){await this.components.getDatastore().delete(this._peerIdToDatastoreKey(e))}async load(e){let r=await this.components.getDatastore().get(this._peerIdToDatastoreKey(e)),n=f3.decode(r),i=new Map;for(let o of n.metadata)i.set(o.key,o.value);return{...n,id:e,addresses:n.addresses.map(({multiaddr:o,isCertified:s})=>({multiaddr:new W(o),isCertified:s??!1})),metadata:i,pubKey:n.pubKey??void 0,peerRecordEnvelope:n.peerRecordEnvelope??void 0}}async save(e){if(e.pubKey!=null&&e.id.publicKey!=null&&!Me(e.pubKey,e.id.publicKey))throw Dce.error("peer publicKey bytes do not match peer id publicKey bytes"),(0,bN.default)(new Error("publicKey bytes do not match peer id publicKey bytes"),gt.ERR_INVALID_PARAMETERS);let r=new Set,n=e.addresses.filter(s=>r.has(s.multiaddr.toString())?!1:(r.add(s.multiaddr.toString()),!0)).sort((s,a)=>s.multiaddr.toString().localeCompare(a.multiaddr.toString())).map(({multiaddr:s,isCertified:a})=>({multiaddr:s.bytes,isCertified:a})),i=[];[...e.metadata.keys()].sort().forEach(s=>{let a=e.metadata.get(s);a!=null&&i.push({key:s,value:a})});let o=f3.encode({addresses:n,protocols:e.protocols.sort(),pubKey:e.pubKey,metadata:i,peerRecordEnvelope:e.peerRecordEnvelope});return await this.components.getDatastore().put(this._peerIdToDatastoreKey(e.id),o),await this.load(e.id)}async patch(e,r){let n=await this.load(e);return await this._patch(e,r,n)}async patchOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._patch(e,r,n)}async _patch(e,r,n){return await this.save({...n,...r,id:e})}async merge(e,r){let n=await this.load(e);return await this._merge(e,r,n)}async mergeOrCreate(e,r){let n;try{n=await this.load(e)}catch(i){if(i.code!==gt.ERR_NOT_FOUND)throw i;n={id:e,addresses:[],protocols:[],metadata:new Map}}return await this._merge(e,r,n)}async _merge(e,r,n){let i=new Map;return n.addresses.forEach(o=>{i.set(o.multiaddr.toString(),o.isCertified)}),(r.addresses??[]).forEach(o=>{let s=o.multiaddr.toString(),l=Boolean(i.get(s))||o.isCertified;i.set(s,l)}),await this.save({id:e,addresses:Array.from(i.entries()).map(([o,s])=>({multiaddr:new W(o),isCertified:s})),protocols:Array.from(new Set([...n.protocols??[],...r.protocols??[]])),metadata:new Map([...n.metadata?.entries()??[],...r.metadata?.entries()??[]]),pubKey:r.pubKey??n?.pubKey,peerRecordEnvelope:r.peerRecordEnvelope??n?.peerRecordEnvelope})}async*all(){for await(let e of this.components.getDatastore().queryKeys({prefix:Oce})){let r=e.toString().split("/")[2],n=xt.decode(r);yield this.load(Rr(n))}}};var hs=C("libp2p:peer-store"),__=class extends Ue{constructor(e={}){super(),this.components=new ze,this.store=new b_,this.addressBook=new s_(this.dispatchEvent.bind(this),this.store,e.addressFilter),this.keyBook=new a_(this.dispatchEvent.bind(this),this.store),this.metadataBook=new l_(this.dispatchEvent.bind(this),this.store),this.protoBook=new h_(this.dispatchEvent.bind(this),this.store)}init(e){this.components=e,this.store.init(e)}async forEach(e){hs.trace("getPeers await read lock");let r=await this.store.lock.readLock();hs.trace("getPeers got read lock");try{for await(let n of this.store.all())n.id.equals(this.components.getPeerId())||e(n)}finally{hs.trace("getPeers release read lock"),r()}}async all(){let e=[];return await this.forEach(r=>{e.push(r)}),e}async delete(e){hs.trace("delete await write lock");let r=await this.store.lock.writeLock();hs.trace("delete got write lock");try{await this.store.delete(e)}finally{hs.trace("delete release write lock"),r()}}async get(e){hs.trace("get await read lock");let r=await this.store.lock.readLock();hs.trace("get got read lock");try{return await this.store.load(e)}finally{hs.trace("get release read lock"),r()}}async has(e){hs.trace("has await read lock");let r=await this.store.lock.readLock();hs.trace("has got read lock");try{return await this.store.has(e)}finally{hs.trace("has release read lock"),r()}}};c();var _N=E(Ti(),1),Lce=E(V(),1),v_=class{constructor(e){this.dht=e}async provide(e){await(0,_N.default)(this.dht.provide(e))}async*findProviders(e,r={}){for await(let n of this.dht.findProviders(e,r))n.name==="PROVIDER"&&(yield*n.providers)}async put(e,r,n){await(0,_N.default)(this.dht.put(e,r,n))}async get(e,r){for await(let n of this.dht.get(e,r))if(n.name==="VALUE")return n.value;throw(0,Lce.default)(new Error("Not found"),"ERR_NOT_FOUND")}};c();var Mce=E(Vo(),1),Bce=C("libp2p:dialer:auto-dialer"),S_=class{constructor(e,r){this.components=e,this.enabled=r.enabled,this.minConnections=r.minConnections,this.dialTimeout=r.dialTimeout}handle(e){let{detail:r}=e;if(!this.enabled)return;if(this.components.getConnectionManager().getConnections(r.id).length===0){let i=this.minConnections??0,o=this.components.getConnectionManager().getConnections();if(i>o.length){Bce("auto-dialing discovered peer %p with timeout %d",r.id,this.dialTimeout);let s=new Mce.TimeoutController(this.dialTimeout);this.components.getConnectionManager().openConnection(r.id,{signal:s.signal}).catch(a=>{Bce.error("could not connect to discovered peer %p with %o",r.id,a)}).finally(()=>{s.clear()})}}}};c();c();c();c();var SN=E(Oi(),1),xN=E(Kce(),1);c();c();var Vce=globalThis.fetch,qce=globalThis.Headers,WSt=globalThis.Request,jSt=globalThis.Response;function x_(t,e,r){return`${t}?name=${e}&type=${r}`}async function zce(t){return await(await Vce(t,{headers:new qce({accept:"application/dns-json"})})).json()}function Cd(t,e){return`${e}_${t}`}var vN=Object.assign((0,SN.default)("dns-over-http-resolver"),{error:(0,SN.default)("dns-over-http-resolver:error")}),RN=class{constructor(e={}){this._cache=new xN.default({max:e?.maxCache??100}),this._TXTcache=new xN.default({max:e?.maxCache??100}),this._servers=["https://cloudflare-dns.com/dns-query","https://dns.google/resolve"],this._request=e.request??zce}getServers(){return this._servers}_getShuffledServers(){let e=[...this._servers];for(let r=e.length-1;r>0;r--){let n=Math.floor(Math.random()*r),i=e[r];e[r]=e[n],e[n]=i}return e}setServers(e){this._servers=e}async resolve(e,r="A"){switch(r){case"A":return await this.resolve4(e);case"AAAA":return await this.resolve6(e);case"TXT":return await this.resolveTxt(e);default:throw new Error(`${r} is not supported`)}}async resolve4(e){let r="A",n=this._cache.get(Cd(e,r));if(n!=null)return n;for(let i of this._getShuffledServers())try{let o=await this._request(x_(i,e,r)),s=o.Answer.map(l=>l.data),a=Math.min(...o.Answer.map(l=>l.TTL));return this._cache.set(Cd(e,r),s,{ttl:a}),s}catch{vN.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolve6(e){let r="AAAA",n=this._cache.get(Cd(e,r));if(n!=null)return n;for(let i of this._getShuffledServers())try{let o=await this._request(x_(i,e,r)),s=o.Answer.map(l=>l.data),a=Math.min(...o.Answer.map(l=>l.TTL));return this._cache.set(Cd(e,r),s,{ttl:a}),s}catch{vN.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}async resolveTxt(e){let r="TXT",n=this._TXTcache.get(Cd(e,r));if(n!=null)return n;for(let i of this._getShuffledServers())try{let o=await this._request(x_(i,e,r)),s=o.Answer.map(l=>[l.data.replace(/['"]+/g,"")]),a=Math.min(...o.Answer.map(l=>l.TTL));return this._TXTcache.set(Cd(e,r),s,{ttl:a}),s}catch{vN.error(`${i} could not resolve ${e} record ${r}`)}throw new Error(`Could not resolve ${e} record ${r}`)}clearCache(){this._cache.clear(),this._TXTcache.clear()}},Hce=RN;var $ce=Hce;var{code:aNe}=An("dnsaddr");async function Gce(t){let e=new $ce,r=t.getPeerId(),[,n]=t.stringTuples().find(([s])=>s===aNe)??[];if(n==null)throw new Error("No hostname found in multiaddr");let o=(await e.resolveTxt(`_dnsaddr.${n}`)).flat().map(s=>s.split("=")[1]);return r!=null&&(o=o.filter(s=>s.includes(r))),o}var R_=E(V(),1),uNe={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:t=>t},connectionManager:{maxConnections:300,minConnections:50,autoDial:!0,autoDialInterval:1e4,maxParallelDials:100,maxDialsPerPeer:4,dialTimeout:3e4,resolvers:{dnsaddr:Gce},addressSorter:O1},connectionGater:{},transportManager:{faultTolerance:vd.FATAL_ALL},metrics:{enabled:!1,computeThrottleMaxQueueSize:1e3,computeThrottleTimeout:2e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3],maxOldPeersRetention:50},peerRouting:{refreshManager:{enabled:!0,interval:6e5,bootDelay:1e4}},nat:{enabled:!0,ttl:7200,keepAlive:!0},relay:{enabled:!0,advertise:{bootDelay:9e5,enabled:!1,ttl:18e5},hop:{enabled:!1,active:!1},autoRelay:{enabled:!1,maxListeners:2}},identify:{protocolPrefix:"ipfs",host:{agentVersion:Yae},timeout:3e4},ping:{protocolPrefix:"ipfs"},fetch:{protocolPrefix:"libp2p"}};function Wce(t){let e=Ye(uNe,t);if(e.transports==null||e.transports.length<1)throw(0,R_.default)(new Error(bt.ERR_TRANSPORTS_REQUIRED),K.ERR_TRANSPORTS_REQUIRED);if(e.connectionEncryption==null||e.connectionEncryption.length===0)throw(0,R_.default)(new Error(bt.CONN_ENCRYPTION_REQUIRED),K.CONN_ENCRYPTION_REQUIRED);if(e.connectionProtector===null&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw(0,R_.default)(new Error(bt.ERR_PROTECTOR_REQUIRED),K.ERR_PROTECTOR_REQUIRED);return e}c();Ae();c();var TN;(function(t){t.codec=()=>et({1:{name:"id",codec:ve},2:{name:"pubKey",codec:ve,optional:!0},3:{name:"privKey",codec:ve,optional:!0}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(TN||(TN={}));var T_=async()=>{let t=await Yp("Ed25519"),e=await Yce(t);if(e.type==="Ed25519")return e;throw new Error(`Generated unexpected PeerId type "${e.type}"`)};var jce=async t=>{let e=await Yp("RSA",t?.bits??2048),r=await Yce(e);if(r.type==="RSA")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function Yce(t){return await on(Dx(t.public),Ox(t))}Pr();Ae();var b3=E(V(),1);c();var ds=E(V(),1);var A_=class extends Ue{get[Ya](){return!0}get[Symbol.toStringTag](){return"@libp2p/dummy-dht"}get wan(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}get lan(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}get(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}findProviders(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}findPeer(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}getClosestPeers(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}provide(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}put(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}async getMode(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}async setMode(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}async refreshRoutingTable(){throw(0,ds.default)(new Error(bt.DHT_DISABLED),K.DHT_DISABLED)}};c();var fl=E(V(),1);var I_=class extends Ue{isStarted(){return!1}start(){}stop(){}get globalSignaturePolicy(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}get multicodecs(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}getPeers(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}getTopics(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}subscribe(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}unsubscribe(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}getSubscribers(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}async publish(){throw(0,fl.default)(new Error(bt.PUBSUB_DISABLED),K.ERR_PUBSUB_DISABLED)}};c();c();c();function hl(t,e){let r={[Symbol.iterator]:()=>r,next:()=>{let n=t.next(),i=n.value;return n.done===!0||i==null?{done:!0,value:void 0}:{done:!1,value:e(i)}}};return r}var w3=class{constructor(e){if(this.map=new Map,e!=null)for(let[r,n]of e.entries())this.map.set(r.toString(),n)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(e){this.map.delete(e.toString())}entries(){return hl(this.map.entries(),e=>[he(e[0]),e[1]])}forEach(e){this.map.forEach((r,n)=>{e(r,he(n),this)})}get(e){return this.map.get(e.toString())}has(e){return this.map.has(e.toString())}set(e,r){this.map.set(e.toString(),r)}keys(){return hl(this.map.keys(),e=>he(e))}values(){return this.map.values()}get size(){return this.map.size}};c();var E3=class{constructor(e){if(this.set=new Set,e!=null)for(let r of e)this.set.add(r.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(e){this.set.add(e.toString())}clear(){this.set.clear()}delete(e){this.set.delete(e.toString())}entries(){return hl(this.set.entries(),e=>{let r=he(e[0]);return[r,r]})}forEach(e){this.set.forEach(r=>{let n=he(r);e(n,n,this)})}has(e){return this.set.has(e.toString())}values(){return hl(this.set.values(),e=>he(e))}};c();var Q1=class{constructor(e){if(this.list=[],e!=null)for(let r of e)this.list.push(r.toString())}[Symbol.iterator](){return hl(this.list.entries(),e=>he(e[1]))}concat(e){let r=new Q1(this);for(let n of e)r.push(n);return r}entries(){return hl(this.list.entries(),e=>[e[0],he(e[1])])}every(e){return this.list.every((r,n)=>e(he(r),n,this))}filter(e){let r=new Q1;return this.list.forEach((n,i)=>{let o=he(n);e(o,i,this)&&r.push(o)}),r}find(e){let r=this.list.find((n,i)=>e(he(n),i,this));if(r!=null)return he(r)}findIndex(e){return this.list.findIndex((r,n)=>e(he(r),n,this))}forEach(e){this.list.forEach((r,n)=>{e(he(r),n,this)})}includes(e){return this.list.includes(e.toString())}indexOf(e){return this.list.indexOf(e.toString())}pop(){let e=this.list.pop();if(e!=null)return he(e)}push(...e){for(let r of e)this.list.push(r.toString())}shift(){let e=this.list.shift();if(e!=null)return he(e)}unshift(...e){let r=this.list.length;for(let n=e.length-1;n>-1;n--)r=this.list.unshift(e[n].toString());return r}get length(){return this.list.length}};var dl=C("libp2p"),AN=class extends Ue{constructor(e){super(),this.initializables=[],this.started=!1,this.peerId=e.peerId,this.components=new ze({peerId:e.peerId,datastore:e.datastore??new K2,connectionGater:{denyDialPeer:async()=>await Promise.resolve(!1),denyDialMultiaddr:async()=>await Promise.resolve(!1),denyInboundConnection:async()=>await Promise.resolve(!1),denyOutboundConnection:async()=>await Promise.resolve(!1),denyInboundEncryptedConnection:async()=>await Promise.resolve(!1),denyOutboundEncryptedConnection:async()=>await Promise.resolve(!1),denyInboundUpgradedConnection:async()=>await Promise.resolve(!1),denyOutboundUpgradedConnection:async()=>await Promise.resolve(!1),filterMultiaddrForPeer:async()=>await Promise.resolve(!0),...e.connectionGater}}),this.components.setPeerStore(new __({addressFilter:this.components.getConnectionGater().filterMultiaddrForPeer,...e.peerStore})),this.services=[this.components],e.metrics.enabled&&(this.metrics=this.components.setMetrics(new zb(e.metrics))),this.peerStore=this.components.getPeerStore(),this.peerStore.addEventListener("peer",s=>{let{detail:a}=s;this.dispatchEvent(new ee("peer:discovery",{detail:a}))}),e.connectionProtector!=null&&this.components.setConnectionProtector(e.connectionProtector),this.components.setUpgrader(new Wb(this.components,{connectionEncryption:(e.connectionEncryption??[]).map(s=>this.configureComponent(s)),muxers:(e.streamMuxers??[]).map(s=>this.configureComponent(s))})),this.connectionManager=this.components.setConnectionManager(new Cb(e.connectionManager)),this.registrar=this.components.setRegistrar(new jb(this.components)),this.components.setTransportManager(new Hb(this.components,e.transportManager)),this.components.setAddressManager(new Eb(this.components,e.addresses)),this.configureComponent(new r_(this.components)),this.configureComponent(new Pb(this.components,{enabled:e.connectionManager.autoDial,minConnections:e.connectionManager.minConnections,autoDialInterval:e.connectionManager.autoDialInterval}));let r=i3.generateOptions();this.keychain=this.configureComponent(new i3(this.components,{...r,...e.keychain})),this.services.push(new t_(this.components,e.nat)),e.transports.forEach(s=>{this.components.getTransportManager().add(this.configureComponent(s))}),e.streamMuxers!=null&&e.streamMuxers.length>0&&(this.identifyService=new $1(this.components,{...e.identify}),this.configureComponent(this.identifyService)),e.dht!=null?this.dht=this.components.setDHT(e.dht):this.dht=new A_,e.pubsub!=null?this.pubsub=this.components.setPubSub(e.pubsub):this.pubsub=new I_;let n=(e.peerRouters??[]).map(s=>this.configureComponent(s));e.dht!=null&&(n.push(this.configureComponent(new n_(this.dht))),this.dht.addEventListener("peer",s=>{this.onDiscoveryPeer(s)})),this.peerRouting=this.components.setPeerRouting(this.configureComponent(new gb(this.components,{...e.peerRouting,routers:n})));let i=(e.contentRouters??[]).map(s=>this.configureComponent(s));e.dht!=null&&i.push(this.configureComponent(new v_(this.dht))),this.contentRouting=this.components.setContentRouting(this.configureComponent(new wb(this.components,{routers:i}))),e.relay.enabled&&(this.components.getTransportManager().add(this.configureComponent(new kb)),this.configureComponent(new Bb(this.components,{addressSorter:e.connectionManager.addressSorter,...e.relay}))),this.fetchService=this.configureComponent(new Zb(this.components,{...e.fetch})),this.pingService=this.configureComponent(new Jb(this.components,{...e.ping}));let o=this.configureComponent(new S_(this.components,{enabled:e.connectionManager.autoDial!==!1,minConnections:e.connectionManager.minConnections,dialTimeout:e.connectionManager.dialTimeout??3e4}));this.addEventListener("peer:discovery",s=>{!this.isStarted()||o.handle(s)});for(let s of e.peerDiscovery??[])this.configureComponent(s),s.addEventListener("peer",a=>{this.onDiscoveryPeer(a)})}configureComponent(e){return Zc(e)&&this.services.push(e),yi(e)&&this.initializables.push(e),e}async start(){if(!this.started){this.started=!0,dl("libp2p is starting");try{this.initializables.forEach(e=>{e.init(this.components)}),await Promise.all(this.services.map(async e=>{e.beforeStart!=null&&await e.beforeStart()})),await Promise.all(this.services.map(e=>e.start())),await Promise.all(this.services.map(async e=>{e.afterStart!=null&&await e.afterStart()})),dl("libp2p has started"),await this.components.getPeerStore().forEach(e=>{this.dispatchEvent(new ee("peer:discovery",{detail:{id:e.id,multiaddrs:e.addresses.map(r=>r.multiaddr),protocols:e.protocols}}))})}catch(e){throw dl.error("An error occurred starting libp2p",e),await this.stop(),e}}}async stop(){!this.started||(dl("libp2p is stopping"),this.started=!1,await Promise.all(this.services.map(async e=>{e.beforeStop!=null&&await e.beforeStop()})),await Promise.all(this.services.map(e=>e.stop())),await Promise.all(this.services.map(async e=>{e.afterStop!=null&&await e.afterStop()})),dl("libp2p has stopped"))}async loadKeychain(){if(this.keychain!=null)try{await this.keychain.findKeyByName("self")}catch{await this.keychain.importPeer("self",this.peerId)}}isStarted(){return this.started}getConnections(e){return this.components.getConnectionManager().getConnections(e)}getPeers(){let e=new E3;for(let r of this.components.getConnectionManager().getConnections())e.add(r.remotePeer);return Array.from(e)}async dial(e,r={}){let{id:n,multiaddrs:i}=yd(e);return await this.components.getPeerStore().addressBook.add(n,i),await this.components.getConnectionManager().openConnection(n,r)}async dialProtocol(e,r,n={}){if(r==null)throw(0,b3.default)(new Error("no protocols were provided to open a stream"),K.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(r=Array.isArray(r)?r:[r],r.length===0)throw(0,b3.default)(new Error("no protocols were provided to open a stream"),K.ERR_INVALID_PROTOCOLS_FOR_STREAM);return await(await this.dial(e,n)).newStream(r,n)}getMultiaddrs(){return this.components.getAddressManager().getAddresses()}async hangUp(e){let{id:r}=yd(e);await this.components.getConnectionManager().closeConnections(r)}async getPublicKey(e,r={}){if(dl("getPublicKey %p",e),e.publicKey!=null)return e.publicKey;let n=await this.peerStore.get(e);if(n.pubKey!=null)return n.pubKey;if(this.dht==null)throw(0,b3.default)(new Error("Public key was not in the peer store and the DHT is not enabled"),K.ERR_NO_ROUTERS_AVAILABLE);let i=Pe([U("/pk/"),e.multihash.digest]);for await(let o of this.dht.get(i,r))if(o.name==="VALUE"){let s=qi(o.value);return await this.peerStore.keyBook.set(e,o.value),s.bytes}throw(0,b3.default)(new Error(`Node not responding with its public key: ${e.toString()}`),K.ERR_INVALID_RECORD)}async fetch(e,r,n={}){let{id:i,multiaddrs:o}=yd(e);return o!=null&&await this.components.getPeerStore().addressBook.add(i,o),await this.fetchService.fetch(i,r,n)}async ping(e,r={}){let{id:n,multiaddrs:i}=yd(e);return i.length>0&&await this.components.getPeerStore().addressBook.add(n,i),await this.pingService.ping(n,r)}async handle(e,r){return await this.components.getRegistrar().handle(e,r)}async unhandle(e){return await this.components.getRegistrar().unhandle(e)}onDiscoveryPeer(e){let{detail:r}=e;if(r.id.toString()===this.peerId.toString()){dl.error(new Error(K.ERR_DISCOVERED_SELF));return}r.multiaddrs.length>0&&this.components.getPeerStore().addressBook.add(r.id,r.multiaddrs).catch(n=>dl.error(n)),r.protocols.length>0&&this.components.getPeerStore().protoBook.set(r.id,r.protocols).catch(n=>dl.error(n)),this.dispatchEvent(new ee("peer:discovery",{detail:r}))}};async function Qce(t){return t.peerId==null&&(t.peerId=await T_()),new AN(Wce(t))}async function Xce(t){return await Qce(t)}c();c();c();var xle=E(ile(),1);c();zr();Ae();Re();Pr();var DN=E(Ab(),1);c();var ole="/lan",sle="/ipfs",ale="/kad/1.0.0",cle="/dht/record",kN="/dht/provider";var lle=Number(3e5),ule=Number(30*1e3),fle=Number(5*6e4),hle=Number(30*1e3),dle=Number(30*1e3);var yNe=U("/pk/");function Z1(t){return{...t,multiaddrs:t.multiaddrs.filter(e=>{let[[r,n]]=e.stringTuples();return r!==4&&r!==6||n==null?!1:!(0,DN.default)(n)})}}function J1(t){return{...t,multiaddrs:t.multiaddrs.filter(e=>{let[[r,n]]=e.stringTuples();return r!==4&&r!==6||n==null?!1:(0,DN.default)(n)})}}async function rc(t){return(await Be.digest(t)).digest}async function Io(t){return await rc(t.toBytes())}function pl(t){return new ae(`${cle}/${F(t,"base32")}`,!1)}function ple(t){return Pe([yNe,t.toBytes()])}function mle(t){return F(t.slice(0,4))==="/pk/"}function gle(t){return Rr(t.slice(4))}function ON(t,e){let r=new Date;return new Kr(t,e,r).serialize()}c();var Sle=E(ql(),1);c();c();function BN(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var Nd=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},ml,v3=class{constructor(){ml.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&Nd(this,ml,"f")[this.size-1].priority>=r.priority){Nd(this,ml,"f").push(n);return}let i=BN(Nd(this,ml,"f"),n,(o,s)=>s.priority-o.priority);Nd(this,ml,"f").splice(i,0,n)}dequeue(){let e=Nd(this,ml,"f").shift();return e?.run}filter(e){return Nd(this,ml,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return Nd(this,ml,"f").length}};ml=new WeakMap;var ir=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},_e=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Xn,x3,R3,gf,L_,T3,N_,ea,S3,Co,k_,Po,A3,mf,em,tm,kd,D_,yle,wle,vle,Ele,ble,_le,O_,MN,UN,B_,M_=()=>{},wNe=new hi,FN=class extends Error{},gl=class extends Sle.default{constructor(e){var r,n,i,o;if(super(),Xn.add(this),x3.set(this,void 0),R3.set(this,void 0),gf.set(this,0),L_.set(this,void 0),T3.set(this,void 0),N_.set(this,0),ea.set(this,void 0),S3.set(this,void 0),Co.set(this,void 0),k_.set(this,void 0),Po.set(this,0),A3.set(this,void 0),mf.set(this,void 0),em.set(this,M_),tm.set(this,M_),kd.set(this,void 0),D_.set(this,void 0),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:v3,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);ir(this,x3,e.carryoverConcurrencyCount,"f"),ir(this,R3,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),ir(this,L_,e.intervalCap,"f"),ir(this,T3,e.interval,"f"),ir(this,Co,new e.queueClass,"f"),ir(this,k_,e.queueClass,"f"),this.concurrency=e.concurrency,ir(this,kd,e.timeout,"f"),ir(this,D_,e.throwOnTimeout===!0,"f"),ir(this,mf,e.autoStart===!1,"f")}get concurrency(){return _e(this,A3,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);ir(this,A3,e,"f"),_e(this,Xn,"m",B_).call(this)}async add(e,r={}){return new Promise((n,i)=>{let o=async()=>{var s,a,l;ir(this,Po,(a=_e(this,Po,"f"),a++,a),"f"),ir(this,gf,(l=_e(this,gf,"f"),l++,l),"f");try{if(!((s=r.signal)===null||s===void 0)&&s.aborted){i(new FN("The task was aborted."));return}let f=await(_e(this,kd,"f")===void 0&&r.timeout===void 0?e({signal:r.signal}):rn(Promise.resolve(e({signal:r.signal})),r.timeout===void 0?_e(this,kd,"f"):r.timeout,()=>{(r.throwOnTimeout===void 0?_e(this,D_,"f"):r.throwOnTimeout)&&i(wNe)}));n(f),this.emit("completed",f)}catch(u){i(u),this.emit("error",u)}_e(this,Xn,"m",vle).call(this)};_e(this,Co,"f").enqueue(o,r),_e(this,Xn,"m",O_).call(this),this.emit("add")})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return _e(this,mf,"f")?(ir(this,mf,!1,"f"),_e(this,Xn,"m",B_).call(this),this):this}pause(){ir(this,mf,!0,"f")}clear(){ir(this,Co,new(_e(this,k_,"f")),"f")}async onEmpty(){if(_e(this,Co,"f").size!==0)return new Promise(e=>{let r=_e(this,em,"f");ir(this,em,()=>{r(),e()},"f")})}async onSizeLessThan(e){if(!(_e(this,Co,"f").size<e))return new Promise(r=>{let n=()=>{_e(this,Co,"f").size<e&&(this.removeListener("next",n),r())};this.on("next",n)})}async onIdle(){if(!(_e(this,Po,"f")===0&&_e(this,Co,"f").size===0))return new Promise(e=>{let r=_e(this,tm,"f");ir(this,tm,()=>{r(),e()},"f")})}get size(){return _e(this,Co,"f").size}sizeBy(e){return _e(this,Co,"f").filter(e).length}get pending(){return _e(this,Po,"f")}get isPaused(){return _e(this,mf,"f")}get timeout(){return _e(this,kd,"f")}set timeout(e){ir(this,kd,e,"f")}};x3=new WeakMap,R3=new WeakMap,gf=new WeakMap,L_=new WeakMap,T3=new WeakMap,N_=new WeakMap,ea=new WeakMap,S3=new WeakMap,Co=new WeakMap,k_=new WeakMap,Po=new WeakMap,A3=new WeakMap,mf=new WeakMap,em=new WeakMap,tm=new WeakMap,kd=new WeakMap,D_=new WeakMap,Xn=new WeakSet,yle=function(){return _e(this,R3,"f")||_e(this,gf,"f")<_e(this,L_,"f")},wle=function(){return _e(this,Po,"f")<_e(this,A3,"f")},vle=function(){var e;ir(this,Po,(e=_e(this,Po,"f"),e--,e),"f"),_e(this,Xn,"m",O_).call(this),this.emit("next")},Ele=function(){_e(this,em,"f").call(this),ir(this,em,M_,"f"),_e(this,Po,"f")===0&&(_e(this,tm,"f").call(this),ir(this,tm,M_,"f"),this.emit("idle"))},ble=function(){_e(this,Xn,"m",UN).call(this),_e(this,Xn,"m",MN).call(this),ir(this,S3,void 0,"f")},_le=function(){let e=Date.now();if(_e(this,ea,"f")===void 0){let r=_e(this,N_,"f")-e;if(r<0)ir(this,gf,_e(this,x3,"f")?_e(this,Po,"f"):0,"f");else return _e(this,S3,"f")===void 0&&ir(this,S3,setTimeout(()=>{_e(this,Xn,"m",ble).call(this)},r),"f"),!0}return!1},O_=function(){if(_e(this,Co,"f").size===0)return _e(this,ea,"f")&&clearInterval(_e(this,ea,"f")),ir(this,ea,void 0,"f"),_e(this,Xn,"m",Ele).call(this),!1;if(!_e(this,mf,"f")){let e=!_e(this,Xn,"m",_le).call(this);if(_e(this,Xn,"a",yle)&&_e(this,Xn,"a",wle)){let r=_e(this,Co,"f").dequeue();return r?(this.emit("active"),r(),e&&_e(this,Xn,"m",MN).call(this),!0):!1}}return!1},MN=function(){_e(this,R3,"f")||_e(this,ea,"f")!==void 0||(ir(this,ea,setInterval(()=>{_e(this,Xn,"m",UN).call(this)},_e(this,T3,"f")),"f"),ir(this,N_,Date.now()+_e(this,T3,"f"),"f"))},UN=function(){_e(this,gf,"f")===0&&_e(this,Po,"f")===0&&_e(this,ea,"f")&&(clearInterval(_e(this,ea,"f")),ir(this,ea,void 0,"f")),ir(this,gf,_e(this,x3,"f")?_e(this,Po,"f"):0,"f"),_e(this,Xn,"m",B_).call(this)},B_=function(){for(;_e(this,Xn,"m",O_).call(this););};var Rle=E(Vo(),1);var KN="routing-table-size",ENe="ping-queue-size",bNe="ping-running",U_=class{constructor(e){this.components=new ze;let{kBucketSize:r,pingTimeout:n,lan:i,pingConcurrency:o,protocol:s}=e;this.log=C(`libp2p:kad-dht:${i?"lan":"wan"}:routing-table`),this.kBucketSize=r??20,this.pingTimeout=n??1e4,this.pingConcurrency=o??10,this.lan=i,this.running=!1,this.protocol=s;let a=()=>{this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:ENe,value:this.pingQueue.size}),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:bNe,value:this.pingQueue.pending})};this.pingQueue=new gl({concurrency:this.pingConcurrency}),this.pingQueue.addListener("add",a),this.pingQueue.addListener("next",a),this._onPing=this._onPing.bind(this)}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0;let e=new xle.default({localNodeId:await Io(this.components.getPeerId()),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});e.on("ping",this._onPing),this.kb=e}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_onPing(e,r){this.pingQueue.add(async()=>{if(!this.running)return;let n=0;try{await Promise.all(e.map(async i=>{let o;try{o=new Rle.TimeoutController(this.pingTimeout);let s={signal:o.signal};this.log("pinging old contact %p",i.peer);let a=await this.components.getConnectionManager().openConnection(i.peer,s),{stream:l}=await a.newStream(this.protocol,s);l.close(),n++}catch(s){this.running&&this.kb!=null&&(this.log.error("could not ping peer %p",i.peer,s),this.log("evicting old contact after ping failed %p",i),this.kb.remove(i.id))}finally{o?.clear(),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:KN,value:this.size})}})),this.running&&n<e.length&&this.kb!=null&&(this.log("adding new contact %p",r.peer),this.kb.add(r))}catch(i){this.log.error("could not process k-bucket ping event",i)}}).catch(n=>{this.log.error("could not process k-bucket ping event",n)})}get size(){return this.kb==null?0:this.kb.count()}async find(e){let r=await Io(e),n=this.closestPeer(r);if(n!=null&&e.equals(n))return n}closestPeer(e){let r=this.closestPeers(e,1);if(r.length>0)return r[0]}closestPeers(e,r=this.kBucketSize){return this.kb==null?[]:this.kb.closest(e,r).map(i=>i.peer)}async add(e){if(this.kb==null)throw new Error("RoutingTable is not started");let r=await Io(e);this.kb.add({id:r,peer:e}),this.log("added %p with kad id %b",e,r),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:KN,value:this.size})}async remove(e){if(this.kb==null)throw new Error("RoutingTable is not started");let r=await Io(e);this.kb.remove(r),this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:KN,value:this.size})}};c();c();var Tle=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782];zr();var Ale=E(Bg(),1),Ile=E(Vo(),1);var F_=15,K_=class{constructor(e){let{peerRouting:r,routingTable:n,refreshInterval:i,refreshQueryTimeout:o,lan:s}=e;this.log=C(`libp2p:kad-dht:${s?"lan":"wan"}:routing-table:refresh`),this.peerRouting=r,this.routingTable=n,this.refreshInterval=i??fle,this.refreshQueryTimeout=o??hle,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}init(e){}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){this.refreshTimeoutId!=null&&clearTimeout(this.refreshTimeoutId)}refreshTable(e=!1){this.log("refreshing routing table");let r=this._maxCommonPrefix(),n=this._getTrackedCommonPrefixLengthsForRefresh(r);this.log(`max common prefix length ${r}`),this.log(`tracked CPLs [ ${n.map(i=>i.toISOString()).join(", ")} ]`),Promise.all(n.map(async(i,o)=>{try{if(await this._refreshCommonPrefixLength(o,i,e),this._numPeersForCpl(r)===0){let s=Math.min(2*(o+1),n.length-1);for(let a=o+1;a<s+1;a++)try{await this._refreshCommonPrefixLength(a,i,e)}catch(l){this.log.error(l)}}}catch(s){this.log.error(s)}})).catch(i=>{this.log.error(i)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),this.refreshTimeoutId.unref!=null&&this.refreshTimeoutId.unref()}).catch(i=>{this.log.error(i)})}async _refreshCommonPrefixLength(e,r,n){if(!n&&r.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",e);return}let i=await this._generateRandomPeerId(e);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",e,i,this.routingTable.size);let o=new Ile.TimeoutController(this.refreshQueryTimeout);try{let s=await(0,Ale.default)(this.peerRouting.getClosestPeers(i.toBytes(),{signal:o.signal}));this.log(`found ${s} peers that were close to imaginary peer %p`,i),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",e,i,this.routingTable.size)}finally{o.clear()}}_getTrackedCommonPrefixLengthsForRefresh(e){e>F_&&(e=F_);let r=[];for(let n=0;n<=e;n++)r[n]=this.commonPrefixLengthRefreshedAt[n]??new Date;return r}async _generateRandomPeerId(e){if(this.routingTable.kb==null)throw new Error("Routing table not started");let r=Os(2),n=(r[1]<<8)+r[0],i=await this._makePeerId(this.routingTable.kb.localNodeId,n,e);return Rr(i)}async _makePeerId(e,r,n){if(n>F_)throw new Error(`Cannot generate peer ID for common prefix length greater than ${F_}`);let s=new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1)^32768>>n,a=65535<<16-(n+1),l=s&a|r&~a,u=Tle[l],f=new ArrayBuffer(34),h=new DataView(f,0,f.byteLength);return h.setUint8(0,Be.code),h.setUint8(1,32),h.setUint32(2,u,!1),new Uint8Array(h.buffer,h.byteOffset,h.byteLength)}_maxCommonPrefix(){let e=0;for(let r of this._prefixLengths())r>e&&(e=r);return e}_numPeersForCpl(e){let r=0;for(let n of this._prefixLengths())n===e&&r++;return r}*_prefixLengths(){if(this.routingTable.kb!=null)for(let{id:e}of this.routingTable.kb.toIterable()){let r=xc(this.routingTable.kb.localNodeId,e),n=0;for(let i of r)if(i===0)n++;else break;yield n}}};c();var Dle=E(V(),1);var Ole=E(Ti(),1),Lle=E(Kc(),1);c();c();var Cle;(function(t){t.codec=()=>et({1:{name:"key",codec:ve,optional:!0},2:{name:"value",codec:ve,optional:!0},3:{name:"author",codec:ve,optional:!0},4:{name:"signature",codec:ve,optional:!0},5:{name:"timeReceived",codec:pn,optional:!0}}),t.encode=e=>Je(e,t.codec()),t.decode=e=>Ze(e,t.codec())})(Cle||(Cle={}));var yf;(function(t){let e;(function(s){s.PUT_VALUE="PUT_VALUE",s.GET_VALUE="GET_VALUE",s.ADD_PROVIDER="ADD_PROVIDER",s.GET_PROVIDERS="GET_PROVIDERS",s.FIND_NODE="FIND_NODE",s.PING="PING"})(e=t.MessageType||(t.MessageType={}));let r;(function(s){s[s.PUT_VALUE=0]="PUT_VALUE",s[s.GET_VALUE=1]="GET_VALUE",s[s.ADD_PROVIDER=2]="ADD_PROVIDER",s[s.GET_PROVIDERS=3]="GET_PROVIDERS",s[s.FIND_NODE=4]="FIND_NODE",s[s.PING=5]="PING"})(r||(r={})),function(s){s.codec=()=>so(r)}(e=t.MessageType||(t.MessageType={}));let n;(function(s){s.NOT_CONNECTED="NOT_CONNECTED",s.CONNECTED="CONNECTED",s.CAN_CONNECT="CAN_CONNECT",s.CANNOT_CONNECT="CANNOT_CONNECT"})(n=t.ConnectionType||(t.ConnectionType={}));let i;(function(s){s[s.NOT_CONNECTED=0]="NOT_CONNECTED",s[s.CONNECTED=1]="CONNECTED",s[s.CAN_CONNECT=2]="CAN_CONNECT",s[s.CANNOT_CONNECT=3]="CANNOT_CONNECT"})(i||(i={})),function(s){s.codec=()=>so(i)}(n=t.ConnectionType||(t.ConnectionType={}));let o;(function(s){s.codec=()=>et({1:{name:"id",codec:ve,optional:!0},2:{name:"addrs",codec:ve,repeats:!0},3:{name:"connection",codec:t.ConnectionType.codec(),optional:!0}}),s.encode=a=>Je(a,s.codec()),s.decode=a=>Ze(a,s.codec())})(o=t.Peer||(t.Peer={})),t.codec=()=>et({1:{name:"type",codec:t.MessageType.codec(),optional:!0},10:{name:"clusterLevelRaw",codec:DS,optional:!0},2:{name:"key",codec:ve,optional:!0},3:{name:"record",codec:ve,optional:!0},8:{name:"closerPeers",codec:t.Peer.codec(),repeats:!0},9:{name:"providerPeers",codec:t.Peer.codec(),repeats:!0}}),t.encode=s=>Je(s,t.codec()),t.decode=s=>Ze(s,t.codec())})(yf||(yf={}));var un=yf.MessageType,_Ne=yf.ConnectionType,kle=Object.keys(un),Lr=class{constructor(e,r,n){if(!(r instanceof Uint8Array))throw new Error("Key must be a Uint8Array");this.type=e,this.key=r,this.clusterLevelRaw=n,this.closerPeers=[],this.providerPeers=[],this.record=void 0}get clusterLevel(){let e=this.clusterLevelRaw-1;return e<0?0:e}set clusterLevel(e){this.clusterLevelRaw=e}serialize(){return yf.encode({key:this.key,type:this.type,clusterLevelRaw:this.clusterLevelRaw,closerPeers:this.closerPeers.map(Ple),providerPeers:this.providerPeers.map(Ple),record:this.record==null?void 0:this.record.serialize()})}static deserialize(e){let r=yf.decode(e),n=new Lr(r.type??yf.MessageType.PUT_VALUE,r.key??Uint8Array.from([]),r.clusterLevelRaw??0);return n.closerPeers=r.closerPeers.map(Nle),n.providerPeers=r.providerPeers.map(Nle),r.record?.length!=null&&(n.record=Kr.deserialize(r.record)),n}};function Ple(t){return{id:t.id.toBytes(),addrs:(t.multiaddrs??[]).map(r=>r.bytes),connection:_Ne.CONNECTED}}function Nle(t){if(t.id==null)throw new Error("Invalid peer in message");return{id:Rr(t.id),multiaddrs:(t.addrs??[]).map(e=>new W(e)),protocols:[]}}c();function VN(t){return{...t,name:"SENDING_QUERY",type:0,messageName:t.type,messageType:kle.indexOf(t.type.toString())}}function I3(t){return{...t,name:"PEER_RESPONSE",type:1,messageName:t.messageType,closer:t.closer!=null?t.closer:[],providers:t.providers!=null?t.providers:[]}}function C3(t){return{...t,name:"FINAL_PEER",type:2}}function ki(t){return{...t,name:"QUERY_ERROR",type:3}}function qN(t){return{...t,name:"PROVIDER",type:4}}function P3(t){return{...t,name:"VALUE",type:5}}function zN(t){return{...t,name:"DIALING_PEER",type:7}}var V_=class extends Ue{constructor(e){super(),this.components=new ze;let{protocol:r,lan:n}=e;this.log=C(`libp2p:kad-dht:${n?"lan":"wan"}:network`),this.running=!1,this.protocol=r}init(e){this.components=e}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(e,r,n={}){if(!this.running)return;this.log("sending %s to %p",r.type,e),yield zN({peer:e}),yield VN({to:e,type:r.type});let i;try{i=(await(await this.components.getConnectionManager().openConnection(e,n)).newStream(this.protocol,n)).stream;let a=await this._writeReadMessage(i,r.serialize(),n);yield I3({from:e,messageType:a.type,closer:a.closerPeers,providers:a.providerPeers,record:a.record})}catch(o){yield ki({from:e,error:o})}finally{i?.close()}}async*sendMessage(e,r,n={}){if(!this.running)return;this.log("sending %s to %p",r.type,e),yield zN({peer:e}),yield VN({to:e,type:r.type});let i;try{i=(await(await this.components.getConnectionManager().openConnection(e,n)).newStream(this.protocol,n)).stream,await this._writeMessage(i,r.serialize(),n),yield I3({from:e,messageType:r.type})}catch(o){yield ki({from:e,error:o})}finally{i?.close()}}async _writeMessage(e,r,n){n.signal!=null&&(e=ns(e,n.signal)),await Se([r],Cr(),e,Ole.default)}async _writeReadMessage(e,r,n){n.signal!=null&&(e=ns(e,n.signal));let i=await Se([r],Cr(),e,gr(),async s=>{let a=await(0,Lle.default)(s);if(a!=null)return a;throw(0,Dle.default)(new Error("No message received"),"ERR_NO_MESSAGE_RECEIVED")}),o=Lr.deserialize(i);return o.closerPeers.forEach(s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),o.providerPeers.forEach(s=>{this.dispatchEvent(new ee("peer",{detail:s}))}),o}};c();var z_=E(V(),1);Mr();c();var rm=E(V(),1);Re();zr();Mr();function nm(t,e){let r=e.key,i=F(r).split("/");if(i.length<3)return;let o=t[i[1].toString()];if(o==null){let s="Invalid record keytype";throw(0,rm.default)(new Error(s),"ERR_INVALID_RECORD_KEY_TYPE")}return o(r,e.value)}var vNe=async(t,e)=>{if(!(t instanceof Uint8Array))throw(0,rm.default)(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(t.byteLength<5)throw(0,rm.default)(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(F(t.subarray(0,4))!=="/pk/")throw(0,rm.default)(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");let n=t.slice(4),i=await Be.digest(e);if(!Me(n,i.bytes))throw(0,rm.default)(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},Ble={pk:vNe};c();var q_=E(V(),1);Re();function Mle(t,e,r){if(r.length===0){let s="No records given";throw(0,q_.default)(new Error(s),"ERR_NO_RECORDS_RECEIVED")}let i=F(e).split("/");if(i.length<3){let s="Record key does not have a selector function";throw(0,q_.default)(new Error(s),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}let o=t[i[1].toString()];if(o==null){let s=`Unrecognized key prefix: ${i[1]}`;throw(0,q_.default)(new Error(s),"ERR_UNRECOGNIZED_KEY_PREFIX")}return r.length===1?0:o(e,r)}function SNe(t,e){return 0}var Ule={pk:SNe};var Fle=E(D6(),1),Kle=E(ei(),1);var H_=class{constructor(e){this.components=new ze;let{validators:r,selectors:n,peerRouting:i,queryManager:o,routingTable:s,network:a,lan:l}=e;this.log=C(`libp2p:kad-dht:${l?"lan":"wan"}:content-fetching`),this.validators=r,this.selectors=n,this.peerRouting=i,this.queryManager=o,this.routingTable=s,this.network=a}init(e){this.components=e}async putLocal(e,r){let n=pl(e);await this.components.getDatastore().put(n,r)}async getLocal(e){this.log("getLocal %b",e);let r=pl(e);this.log("fetching record for key %k",r);let n=await this.components.getDatastore().get(r);this.log("found %k in local datastore",r);let i=Kr.deserialize(n);return await nm(this.validators,i),i}async*sendCorrectionRecord(e,r,n,i={}){this.log("sendCorrection for %b",e);let o=await ON(e,n);for(let{value:s,from:a}of r){if(Me(s,n)){this.log("record was ok");continue}if(this.components.getPeerId().equals(a)){try{let f=pl(e);this.log(`Storing corrected record for key ${f.toString()}`),await this.components.getDatastore().put(f,o)}catch(f){this.log.error("Failed error correcting self",f)}continue}let l=!1,u=new Lr(un.PUT_VALUE,e,0);u.record=Kr.deserialize(o);for await(let f of this.network.sendRequest(a,u,i))f.name==="PEER_RESPONSE"&&f.record!=null&&Me(f.record.value,Kr.deserialize(o).value)&&(l=!0),yield f;l||(yield ki({from:a,error:(0,z_.default)(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})),this.log.error("Failed error correcting entry")}}async*put(e,r,n={}){this.log("put key %b value %b",e,r);let i=await ON(e,r),o=pl(e);this.log(`storing record for key ${o.toString()}`),await this.components.getDatastore().put(o,i),yield*Se(this.peerRouting.getClosestPeers(e,{signal:n.signal}),s=>(0,Kle.default)(s,a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let l=[],u=new Lr(un.PUT_VALUE,e,0);u.record=Kr.deserialize(i),this.log("send put to %p",a.peer.id);for await(let f of this.network.sendRequest(a.peer.id,u,n))l.push(f),f.name==="PEER_RESPONSE"&&(f.record!=null&&Me(f.record.value,Kr.deserialize(i).value)||l.push(ki({from:a.peer.id,error:(0,z_.default)(new Error("value not put correctly"),"ERR_PUT_VALUE_INVALID")})));return l}),s=>(0,Fle.default)(s,{ordered:!1,concurrency:3}),async function*(s){for await(let a of s)yield*a})}async*get(e,r={}){this.log("get %b",e);let n=[];for await(let a of this.getMany(e,r))a.name==="VALUE"&&n.push(a),yield a;if(n.length===0)return;let i=n.map(a=>a.value),o=0;try{o=Mle(this.selectors,e,i)}catch(a){if(a.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw a}let s=i[o];if(this.log("GetValue %b %b",e,s),s==null)throw(0,z_.default)(new Error("best value was not found"),"ERR_NOT_FOUND");yield*this.sendCorrectionRecord(e,n,s,r),yield n[o]}async*getMany(e,r={}){this.log("getMany values for %b",e);try{let a=await this.getLocal(e);yield P3({value:a.value,from:this.components.getPeerId()})}catch(a){this.log("error getting local value for %b",e,a)}let n=await rc(e),i=this.routingTable.closestPeers(n);this.log("found %d peers in routing table",i.length);let o=this,s=async function*({peer:a,signal:l}){for await(let u of o.peerRouting.getValueOrPeers(a,e,{signal:l}))yield u,u.name==="PEER_RESPONSE"&&u.record!=null&&(yield P3({from:a,value:u.record.value}))};yield*this.queryManager.run(e,i,s,r)}};c();var Vle=E(D6(),1),qle=E(ei(),1);var $_=class{constructor(e){this.components=new ze;let{network:r,peerRouting:n,queryManager:i,routingTable:o,providers:s,lan:a}=e;this.log=C(`libp2p:kad-dht:${a?"lan":"wan"}:content-routing`),this.network=r,this.peerRouting=n,this.queryManager=i,this.routingTable=o,this.providers=s}init(e){this.components=e}async*provide(e,r,n={}){this.log("provide %s",e),await this.providers.addProvider(e,this.components.getPeerId());let i=new Lr(un.ADD_PROVIDER,e.bytes,0);i.providerPeers=[{id:this.components.getPeerId(),multiaddrs:r,protocols:[]}];let o=0,s=a=>async()=>{if(a.name!=="FINAL_PEER")return[a];let l=[];this.log("putProvider %s to %p",e,a.peer.id);try{this.log("sending provider record for %s to %p",e,a.peer.id);for await(let u of this.network.sendMessage(a.peer.id,i,n))u.name==="PEER_RESPONSE"&&(this.log("sent provider record for %s to %p",e,a.peer.id),o++),l.push(u)}catch(u){this.log.error("error sending provide record to peer %p",a.peer.id,u),l.push(ki({from:a.peer.id,error:u}))}return l};yield*Se(this.peerRouting.getClosestPeers(e.multihash.bytes,n),a=>(0,qle.default)(a,l=>s(l)),a=>(0,Vle.default)(a,{ordered:!1,concurrency:3}),async function*(a){for await(let l of a)yield*l}),this.log("sent provider records to %d peers",o)}async*findProviders(e,r){let n=this.routingTable.kBucketSize,i=e.multihash.bytes,o=await rc(i),s=this;this.log("findProviders %c",e);let a=await this.providers.getProviders(e);if(a.length>0){let f=[];for(let h of a.slice(0,n))f.push({id:h,multiaddrs:(await this.components.getPeerStore().addressBook.get(h)??[]).map(p=>p.multiaddr),protocols:[]});yield I3({from:this.components.getPeerId(),messageType:un.GET_PROVIDERS,providers:f}),yield qN({from:this.components.getPeerId(),providers:f})}if(a.length>=n)return;let l=async function*({peer:f,signal:h}){let p=new Lr(un.GET_PROVIDERS,i,0);yield*s.network.sendRequest(f,p,{signal:h})},u=new Set(a.map(f=>f.toString()));for await(let f of this.queryManager.run(i,this.routingTable.closestPeers(o),l,r))if(yield f,f.name==="PEER_RESPONSE"){this.log("Found %d provider entries for %c and %d closer peers",f.providers.length,e,f.closer.length);let h=[];for(let p of f.providers)u.has(p.id.toString())||(u.add(p.id.toString()),h.push(p));if(h.length>0&&(yield qN({from:f.from,providers:h})),u.size===n)return}}};c();var Dd=E(V(),1);Re();c();var G_=class{constructor(e,r){this.originDhtKey=e,this.capacity=r,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(e=>e.peerId)}async add(e){if(this.peerDistances.find(i=>i.peerId.equals(e))!=null)return;let r=await Io(e),n={peerId:e,distance:xc(this.originDhtKey,r)};this.peerDistances.push(n),this.peerDistances.sort((i,o)=>Wf(i.distance,o.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(e){if(e.length===0)return!1;if(this.length===0)return!0;let r=await Promise.all(e.map(Io)),n=this.peerDistances[this.peerDistances.length-1].distance;for(let i of r){let o=xc(this.originDhtKey,i);if(Wf(o,n)<0)return!0}return!1}};var W_=class{constructor(e){this.components=new ze;let{routingTable:r,network:n,validators:i,queryManager:o,lan:s}=e;this.routingTable=r,this.network=n,this.validators=i,this.queryManager=o,this.log=C(`libp2p:kad-dht:${s?"lan":"wan"}:peer-routing`)}init(e){this.components=e}async findPeerLocal(e){let r,n=await this.routingTable.find(e);if(n!=null){this.log("findPeerLocal found %p in routing table",e);try{r=await this.components.getPeerStore().get(n)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i}}if(r==null)try{r=await this.components.getPeerStore().get(e)}catch(i){if(i.code!=="ERR_NOT_FOUND")throw i}if(r!=null)return this.log("findPeerLocal found %p in peer store",e),{id:r.id,multiaddrs:r.addresses.map(i=>i.multiaddr),protocols:[]}}async*_getValueSingle(e,r,n={}){let i=new Lr(un.GET_VALUE,r,0);yield*this.network.sendRequest(e,i,n)}async*getPublicKeyFromNode(e,r={}){let n=ple(e);for await(let i of this._getValueSingle(e,n,r))if(yield i,i.name==="PEER_RESPONSE"&&i.record!=null){let o=await on(Zw.marshalPublicKey({bytes:i.record.value}));if(!o.equals(e))throw(0,Dd.default)(new Error("public key does not match id"),"ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(o.publicKey==null)throw(0,Dd.default)(new Error("public key missing"),"ERR_PUBLIC_KEY_MISSING");yield P3({from:e,value:o.publicKey})}throw(0,Dd.default)(new Error(`Node not responding with its public key: ${e.toString()}`),"ERR_INVALID_RECORD")}async*findPeer(e,r={}){this.log("findPeer %p",e);let n=await this.findPeerLocal(e);if(n!=null){this.log("found local"),yield C3({from:this.components.getPeerId(),peer:n});return}let i=await Io(e),o=this.routingTable.closestPeers(i);if(o.find(f=>f.equals(e))!=null)try{let f=await this.components.getPeerStore().get(e);this.log("found in peerStore"),yield C3({from:this.components.getPeerId(),peer:{id:f.id,multiaddrs:f.addresses.map(h=>h.multiaddr),protocols:[]}});return}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f}let a=this,l=async function*({peer:f,signal:h}){let p=new Lr(un.FIND_NODE,e.toBytes(),0);for await(let d of a.network.sendRequest(f,p,{signal:h}))if(yield d,d.name==="PEER_RESPONSE"){let m=d.closer.find(g=>g.id.equals(e));m!=null&&(yield C3({from:d.from,peer:m}))}},u=!1;for await(let f of this.queryManager.run(e.toBytes(),o,l,r))f.name==="FINAL_PEER"&&(u=!0),yield f;u||(yield ki({from:this.components.getPeerId(),error:(0,Dd.default)(new Error("Not found"),"ERR_NOT_FOUND")}))}async*getClosestPeers(e,r={}){this.log("getClosestPeers to %b",e);let n=await rc(e),i=this.routingTable.closestPeers(n),o=this,s=new G_(n,this.routingTable.kBucketSize);await Promise.all(i.map(async l=>await s.add(l)));let a=async function*({peer:l,signal:u}){o.log("closerPeersSingle %s from %p",F(e,"base32"),l);let f=new Lr(un.FIND_NODE,e,0);yield*o.network.sendRequest(l,f,{signal:u})};for await(let l of this.queryManager.run(e,i,a,r))yield l,l.name==="PEER_RESPONSE"&&await Promise.all(l.closer.map(async u=>await s.add(u.id)));this.log("found %d peers close to %b",s.length,e);for(let l of s.peers)yield C3({from:this.components.getPeerId(),peer:{id:l,multiaddrs:(await this.components.getPeerStore().addressBook.get(l)??[]).map(u=>u.multiaddr),protocols:[]}})}async*getValueOrPeers(e,r,n={}){for await(let i of this._getValueSingle(e,r,n)){if(i.name==="PEER_RESPONSE"&&i.record!=null)try{await this._verifyRecordOnline(i.record)}catch{let s="invalid record received, discarded";this.log(s),yield ki({from:i.from,error:(0,Dd.default)(new Error(s),"ERR_INVALID_RECORD")});continue}yield i}}async _verifyRecordOnline(e){if(e.timeReceived==null)throw(0,Dd.default)(new Error("invalid record received"),"ERR_INVALID_RECORD");await nm(this.validators,new Kr(e.key,e.value,e.timeReceived))}async getCloserPeersOffline(e,r){let n=await rc(e),i=this.routingTable.closestPeers(n),o=[];for(let s of i)if(!s.equals(r))try{let a=await this.components.getPeerStore().addressBook.get(s),l=await this.components.getPeerStore().protoBook.get(s);o.push({id:s,multiaddrs:a.map(u=>u.multiaddr),protocols:l})}catch(a){if(a.code!=="ERR_NOT_FOUND")throw a}return o.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",o.length,e,r):this.log("getCloserPeersOffline could not find peer closer to %b than %p",e,r),o}};c();var zle=E(xp(),1),HN=E(ai(),1);Re();var yl=C("libp2p:kad-dht:providers"),j_=class{constructor(e={}){this.components=new ze;let{cacheSize:r,cleanupInterval:n,provideValidity:i}=e;this.cleanupInterval=n??36e5,this.provideValidity=i??864e5,this.cache=(0,zle.default)(r??256),this.syncQueue=new gl({concurrency:1}),this.started=!1}init(e){this.components=e}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(e=>{yl.error(e)})},this.cleanupInterval))}async stop(){this.started=!1,this.cleaner!=null&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){return await this.syncQueue.add(async()=>{let e=Date.now(),r=0,n=0,i=new Map,o=this.components.getDatastore().batch(),s=this.components.getDatastore().query({prefix:kN});for await(let a of s)try{let{cid:l,peerId:u}=Hle(a.key),f=$le(a.value).getTime(),h=Date.now(),p=h-f,d=p>this.provideValidity;if(yl("comparing: %d - %d = %d > %d %s",h,f,p,this.provideValidity,d?"(expired)":""),d){n++,o.delete(a.key);let m=i.get(l)??new Set;m.add(u),i.set(l,m)}r++}catch(l){yl.error(l.message)}i.size>0?(yl("deleting %d / %d entries",n,r),await o.commit()):yl("nothing to delete");for(let[a,l]of i){let u=N3(a),f=this.cache.get(u);if(f!=null){for(let h of l)f.delete(h);f.size===0?this.cache.remove(u):this.cache.set(u,f)}}yl("Cleanup successful (%dms)",Date.now()-e)})}async _getProvidersMap(e){let r=N3(e),n=this.cache.get(r);return n==null&&(n=await INe(this.components.getDatastore(),e),this.cache.set(r,n)),n}async addProvider(e,r){return await this.syncQueue.add(async()=>{yl("%p provides %s",r,e);let n=await this._getProvidersMap(e);yl("loaded %s provs",n.size);let i=new Date;n.set(r.toString(),i);let o=N3(e);this.cache.set(o,n),await ANe(this.components.getDatastore(),e,r,i)})}async getProviders(e){return await this.syncQueue.add(async()=>(yl("get providers for %s",e),[...(await this._getProvidersMap(e)).keys()].map(n=>he(n))))}};function N3(t){let e=typeof t=="string"?t:F(t.multihash.bytes,"base32");return`${kN}/${e}`}async function ANe(t,e,r,n){let i=[N3(e),"/",r.toString()].join(""),o=new ae(i),s=Uint8Array.from(HN.default.encode(n.getTime()));return await t.put(o,s)}function Hle(t){let e=t.toString().split("/");if(e.length!==5)throw new Error(`incorrectly formatted provider entry key in datastore: ${t.toString()}`);return{cid:e[3],peerId:e[4]}}async function INe(t,e){let r=new Map,n=t.query({prefix:N3(e)});for await(let i of n){let{peerId:o}=Hle(i.key);r.set(o,$le(i.value))}return r}function $le(t){return new Date(HN.default.decode(t))}c();var Xle=E(Vo(),1),Zle=E(Ui(),1);Re();c();Re();var Gle=E(V(),1);var Wle=E(Vo(),1),jle=E(Ui(),1);var CNe=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*Yle(t){let{key:e,startingPeer:r,ourPeerId:n,signal:i,query:o,alpha:s,pathIndex:a,numPaths:l,cleanUp:u,queryFuncTimeout:f,log:h}=t,p=new gl({concurrency:s}),d=await rc(e),m=new Set;function g(y,w){if(y==null)return;m.add(y.toString());let b=BigInt("0x"+F(xc(w,d),"base16"));p.add(async()=>{let v,S=[i];f!=null&&(v=new Wle.TimeoutController(f),S.push(v.signal));let R=(0,jle.anySignal)(S);try{for await(let I of o({key:e,peer:y,signal:R,pathIndex:a,numPaths:l})){if(R.aborted)return;if(I.name==="PEER_RESPONSE")for(let A of I.closer){if(m.has(A.id.toString())){h("already seen %p in query",A.id);continue}if(n.equals(A.id)){h("not querying ourselves");continue}let L=await Io(A.id);if(BigInt("0x"+F(xc(L,d),"base16"))>b){h("skipping %p as they are not closer to %b than %p",A.id,e,y);continue}h("querying closer peer %p",A.id),g(A.id,L)}p.emit("completed",I)}v?.clear()}catch(I){i.aborted?p.emit("error",I):p.emit("completed",ki({from:y,error:I}))}finally{v?.clear()}},{priority:CNe-b}).catch(v=>{h.error(v)})}g(r,await Io(r)),yield*PNe(p,i,u,h)}async function*PNe(t,e,r,n){let i=Sr(),o=!0,s=[],a=()=>{!o||(n("clean up queue, results %d, queue size %d, pending tasks %d",s.length,t.size,t.pending),o=!1,t.clear(),s.splice(0,s.length))};for(t.on("completed",l=>{s.push(l),i.resolve()}),t.on("error",l=>{n("queue error",l),a(),i.reject(l)}),t.on("idle",()=>{n("queue idle"),o=!1,i.resolve()}),e.addEventListener("abort",()=>{n("abort queue");let l=o;a(),l&&i.reject((0,Gle.default)(new Error("Query aborted"),"ERR_QUERY_ABORTED"))}),r.addEventListener("cleanup",()=>{a(),i.resolve()});o;)for(await i.promise,i=Sr();s.length>0;){let l=s.shift();l!=null&&(yield l)}yield*s}var Jle=E(Dc(),1),k3=E(In(),1);var Qle="running-queries",Q_=class{constructor(e){this.components=new ze;let{lan:r=!1,disjointPaths:n=20,alpha:i=3}=e;this.disjointPaths=n??20,this.controllers=new Set,this.running=!1,this.alpha=i??3,this.lan=r,this.queries=0}init(e){this.components=e}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1;for(let e of this.controllers)e.abort();this.controllers.clear()}async*run(e,r,n,i={}){if(!this.running)throw new Error("QueryManager not started");let o;if(i.signal==null){o=new Xle.TimeoutController(dle),i.signal=o.signal;try{k3.setMaxListeners!=null&&(0,k3.setMaxListeners)(1/0,o.signal)}catch{}}let s=new AbortController;this.controllers.add(s);let a=[s.signal];i.signal!=null&&a.push(i.signal);let l=(0,Zle.anySignal)(a);try{k3.setMaxListeners!=null&&(0,k3.setMaxListeners)(1/0,l)}catch{}let u=C(`libp2p:kad-dht:${this.lan?"lan":"wan"}:query:`+F(e,"base58btc")),f=r.slice(0,Math.min(this.disjointPaths,r.length)),h=Date.now(),p=new Ue;try{if(u("query:start"),this.queries++,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:Qle,value:this.queries}),r.length===0){u.error("Running query with no peers");return}let d=f.map((m,g)=>Yle({key:e,startingPeer:m,ourPeerId:this.components.getPeerId(),signal:l,query:n,pathIndex:g,numPaths:f.length,alpha:this.alpha,cleanUp:p,queryFuncTimeout:i.queryFuncTimeout,log:u}));for await(let m of(0,Jle.default)(...d))yield m,m.name==="QUERY_ERROR"&&u("error",m.error)}catch(d){if(!(!this.running&&d.code==="ERR_QUERY_ABORTED"))throw d}finally{this.controllers.delete(s),o?.clear(),this.queries--,this.components.getMetrics()?.updateComponentMetric({system:"libp2p",component:`kad-dht-${this.lan?"lan":"wan"}`,metric:Qle,value:this.queries}),p.dispatchEvent(new ee("cleanup")),u("query:done in %dms",Date.now()-h)}}};c();c();te();var $N=E(V(),1);var D3=C("libp2p:kad-dht:rpc:handlers:add-provider"),X_=class{constructor(e){let{providers:r}=e;this.providers=r}init(){}async handle(e,r){if(D3("start"),r.key==null||r.key.length===0)throw(0,$N.default)(new Error("Missing key"),"ERR_MISSING_KEY");let n;try{n=T.decode(r.key)}catch{throw(0,$N.default)(new Error("Invalid CID"),"ERR_INVALID_CID")}(r.providerPeers==null||r.providerPeers.length===0)&&D3.error("no providers found in message"),await Promise.all(r.providerPeers.map(async i=>{if(!i.id.equals(e)){D3("invalid provider peer %p from %p",i.id,e);return}if(i.multiaddrs.length<1){D3("no valid addresses for provider %p. Ignore",e);return}D3("received provider %p for %s (addrs %s)",e,n,i.multiaddrs.map(o=>o.toString())),await this.providers.addProvider(n,i.id)}))}};c();var eue=C("libp2p:kad-dht:rpc:handlers:find-node"),Z_=class{constructor(e){this.components=new ze;let{peerRouting:r,lan:n}=e;this.peerRouting=r,this.lan=Boolean(n)}init(e){this.components=e}async handle(e,r){eue("incoming request from %p for peers closer to %b",e,r.key);let n=[];Me(this.components.getPeerId().toBytes(),r.key)?n=[{id:this.components.getPeerId(),multiaddrs:this.components.getAddressManager().getAddresses().map(o=>o.decapsulateCode(An("p2p").code)),protocols:[]}]:n=await this.peerRouting.getCloserPeersOffline(r.key,e),n=n.map(this.lan?J1:Z1).filter(({multiaddrs:o})=>o.length);let i=new Lr(r.type,new Uint8Array(0),r.clusterLevel);return n.length>0?i.closerPeers=n:eue("could not find any peers closer to %b than %p",r.key,e),i}};c();te();var rue=E(V(),1);var tue=C("libp2p:kad-dht:rpc:handlers:get-providers"),J_=class{constructor(e){this.components=new ze;let{peerRouting:r,providers:n,lan:i}=e;this.peerRouting=r,this.providers=n,this.lan=Boolean(i)}init(e){this.components=e}async handle(e,r){let n;try{n=T.decode(r.key)}catch{throw(0,rue.default)(new Error("Invalid CID"),"ERR_INVALID_CID")}tue("%p asking for providers for %s",e,n);let[i,o]=await Promise.all([this.providers.getProviders(n),this.peerRouting.getCloserPeersOffline(r.key,e)]),s=await this._getPeers(i),a=await this._getPeers(o.map(({id:u})=>u)),l=new Lr(r.type,r.key,r.clusterLevel);return s.length>0&&(l.providerPeers=s),a.length>0&&(l.closerPeers=a),tue("got %s providers %s closerPeers",s.length,a.length),l}async _getAddresses(e){return(await this.components.getPeerStore().addressBook.get(e)).map(n=>n.multiaddr)}async _getPeers(e){let r=[],n=this.lan?J1:Z1;for(let i of e){let o=n({id:i,multiaddrs:await this._getAddresses(i),protocols:[]});o.multiaddrs.length>0&&r.push(o)}return r}};c();var e7=E(V(),1);var om=C("libp2p:kad-dht:rpc:handlers:get-value"),t7=class{constructor(e){this.components=new ze;let{peerRouting:r}=e;this.peerRouting=r}init(e){this.components=e}async handle(e,r){let n=r.key;if(om("%p asked for key %b",e,n),n==null||n.length===0)throw(0,e7.default)(new Error("Invalid key"),"ERR_INVALID_KEY");let i=new Lr(un.GET_VALUE,n,r.clusterLevel);if(mle(n)){om("is public key");let a=gle(n),l;try{let u=await this.components.getPeerStore().keyBook.get(a);if(u==null)throw(0,e7.default)(new Error("No public key found in key book"),"ERR_NOT_FOUND");l=u}catch(u){if(u.code!=="ERR_NOT_FOUND")throw u}if(l!=null)return om("returning found public key"),i.record=new Kr(n,l,new Date),i}let[o,s]=await Promise.all([this._checkLocalDatastore(n),this.peerRouting.getCloserPeersOffline(r.key,e)]);return o!=null&&(om("had record for %b in local datastore",n),i.record=o),s.length>0&&(om("had %s closer peers in routing table",s.length),i.closerPeers=s),i}async _checkLocalDatastore(e){om("checkLocalDatastore looking for %b",e);let r=pl(e),n;try{n=await this.components.getDatastore().get(r)}catch(o){if(o.code==="ERR_NOT_FOUND")return;throw o}let i=Kr.deserialize(n);if(i==null)throw(0,e7.default)(new Error("Invalid record"),"ERR_INVALID_RECORD");if(i.timeReceived==null||Date.now()-i.timeReceived.getTime()>1296e5){await this.components.getDatastore().delete(r);return}return i}};c();var kNe=C("libp2p:kad-dht:rpc:handlers:ping"),r7=class{async handle(e,r){return kNe("ping from %p",e),r}init(){}};c();var nue=E(V(),1);var n7=class{constructor(e){this.components=new ze;let{validators:r}=e;this.log=C("libp2p:kad-dht:rpc:handlers:put-value"),this.validators=r}init(e){this.components=e}async handle(e,r){let n=r.key;this.log("%p asked us to store value for key %b",e,n);let i=r.record;if(i==null){let o=`Empty record from: ${e.toString()}`;throw this.log.error(o),(0,nue.default)(new Error(o),"ERR_EMPTY_RECORD")}try{await nm(this.validators,i),i.timeReceived=new Date;let o=pl(i.key);await this.components.getDatastore().put(o,i.serialize()),this.log("put record for %b into datastore under key %k",n,o)}catch(o){this.log("did not put record for key %b into datastore %o",n,o)}return r}};var i7=class{constructor(e){let{providers:r,peerRouting:n,validators:i,lan:o}=e;this.log=C("libp2p:kad-dht:rpc"),this.routingTable=e.routingTable,this.handlers={[un.GET_VALUE]:new t7({peerRouting:n}),[un.PUT_VALUE]:new n7({validators:i}),[un.FIND_NODE]:new Z_({peerRouting:n,lan:o}),[un.ADD_PROVIDER]:new X_({providers:r}),[un.GET_PROVIDERS]:new J_({peerRouting:n,providers:r,lan:o}),[un.PING]:new r7}}init(e){for(let r of Object.values(this.handlers))r.init(e)}async handleMessage(e,r){try{await this.routingTable.add(e)}catch(i){this.log.error("Failed to update the kbucket store",i)}let n=this.handlers[r.type];if(n==null){this.log.error(`no handler found for message type: ${r.type}`);return}return await n.handle(e,r)}onIncomingStream(e){Promise.resolve().then(async()=>{let{stream:r,connection:n}=e,i=n.remotePeer;try{await this.routingTable.add(i)}catch(s){this.log.error(s)}let o=this;await Se(r,gr(),async function*(s){for await(let a of s){let l=Lr.deserialize(a);o.log("incoming %s from %p",l.type,i);let u=await o.handleMessage(i,l);u!=null&&(yield u.serialize())}},Cr(),r)}).catch(r=>{this.log.error(r)})}};c();var o7=class extends Ue{constructor(e){super(),this.components=new ze;let{protocol:r,lan:n}=e;this.log=C(`libp2p:kad-dht:topology-listener:${n?"lan":"wan"}`),this.running=!1,this.protocol=r}init(e){this.components=e}isStarted(){return this.running}async start(){if(this.running)return;this.running=!0;let e=i1({onConnect:r=>{this.log("observed peer %p with protocol %s",r,this.protocol),this.dispatchEvent(new ee("peer",{detail:r}))}});this.registrarId=await this.components.getRegistrar().register(this.protocol,e)}stop(){this.running=!1,this.registrarId!=null&&(this.components.getRegistrar().unregister(this.registrarId),this.registrarId=void 0)}};c();var GN=E(In(),1),iue=E(Jp(),1),oue=E(Bg(),1);var sue=E(Vo(),1),aue=E(Ui(),1);var s7=class{constructor(e){this.components=new ze;let{peerRouting:r,lan:n,count:i,interval:o,queryTimeout:s}=e;this.log=C(`libp2p:kad-dht:${n?"lan":"wan"}:query-self`),this.running=!1,this.peerRouting=r,this.count=i??20,this.interval=o??lle,this.queryTimeout=s??ule}init(e){this.components=e}isStarted(){return this.running}async start(){this.running||(this.running=!0,this._querySelf())}async stop(){this.running=!1,this.timeoutId!=null&&clearTimeout(this.timeoutId),this.controller!=null&&this.controller.abort()}_querySelf(){Promise.resolve().then(async()=>{let e=new sue.TimeoutController(this.queryTimeout);try{this.controller=new AbortController;let r=(0,aue.anySignal)([this.controller.signal,e.signal]);try{GN.setMaxListeners!=null&&(0,GN.setMaxListeners)(1/0,r)}catch{}let n=await Se(this.peerRouting.getClosestPeers(this.components.getPeerId().toBytes(),{signal:r}),i=>(0,iue.default)(i,this.count),async i=>await(0,oue.default)(i));this.log("query ran successfully - found %d peers",n)}catch(r){this.log("query error",r)}finally{this.timeoutId=setTimeout(this._querySelf.bind(this),this.interval),e.clear()}}).catch(e=>{this.log("query error",e)})}};var O3=class extends Ue{constructor(e){super(),this.components=new ze;let{kBucketSize:r,clientMode:n,validators:i,selectors:o,querySelfInterval:s,lan:a,protocolPrefix:l,pingTimeout:u,pingConcurrency:f}=e;this.running=!1,this.lan=Boolean(a),this.log=C(`libp2p:kad-dht:${a===!0?"lan":"wan"}`),this.protocol=`${l??sle}${a===!0?ole:""}${ale}`,this.kBucketSize=r??20,this.clientMode=n??!0,this.routingTable=new U_({kBucketSize:r,lan:this.lan,pingTimeout:u,pingConcurrency:f,protocol:this.protocol}),this.providers=new j_,this.validators={...Ble,...i},this.selectors={...Ule,...o},this.network=new V_({protocol:this.protocol,lan:this.lan}),this.queryManager=new Q_({disjointPaths:Math.ceil(this.kBucketSize/2),lan:a}),this.peerRouting=new W_({routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,lan:this.lan}),this.contentFetching=new H_({validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,network:this.network,lan:this.lan}),this.contentRouting=new $_({network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,lan:this.lan}),this.routingTableRefresh=new K_({peerRouting:this.peerRouting,routingTable:this.routingTable,lan:this.lan}),this.rpc=new i7({routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,lan:this.lan}),this.topologyListener=new o7({protocol:this.protocol,lan:this.lan}),this.querySelf=new s7({peerRouting:this.peerRouting,interval:s,lan:this.lan}),this.network.addEventListener("peer",h=>{let p=h.detail;this.onPeerConnect(p).catch(d=>{this.log.error("could not add %p to routing table",p.id,d)}),this.dispatchEvent(new ee("peer",{detail:p}))}),this.topologyListener.addEventListener("peer",h=>{let p=h.detail;Promise.resolve().then(async()=>{let d=await this.components.getPeerStore().addressBook.get(p),m={id:p,multiaddrs:d.map(g=>g.multiaddr),protocols:[]};await this.onPeerConnect(m)}).catch(d=>{this.log.error("could not add %p to routing table",p,d)})})}get[Ya](){return!0}get[Symbol.toStringTag](){return"@libp2p/kad-dht"}init(e){this.components=e,this.routingTable.init(e),this.providers.init(e),this.network.init(e),this.queryManager.init(e),this.peerRouting.init(e),this.contentFetching.init(e),this.contentRouting.init(e),this.routingTableRefresh.init(e),this.rpc.init(e),this.topologyListener.init(e),this.querySelf.init(e)}async onPeerConnect(e){if(this.log("peer %p connected with protocols %s",e.id,e.protocols),this.lan?e=J1(e):e=Z1(e),e.multiaddrs.length===0){this.log("ignoring %p as they do not have any %s addresses in %s",e.id,this.lan?"private":"public",e.multiaddrs.map(r=>r.toString()));return}try{await this.routingTable.add(e.id)}catch(r){this.log.error("could not add %p to routing table",e.id,r)}}isStarted(){return this.running}async getMode(){return this.clientMode?"client":"server"}async setMode(e){await this.components.getRegistrar().unhandle(this.protocol),e==="client"?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.getRegistrar().handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc)))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.querySelf.start()]),await this.routingTableRefresh.start()}async stop(){this.running=!1,await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop(),this.querySelf.stop()])}async*put(e,r,n={}){yield*this.contentFetching.put(e,r,n)}async*get(e,r={}){yield*this.contentFetching.get(e,r)}async*provide(e,r={}){yield*this.contentRouting.provide(e,this.components.getAddressManager().getAddresses(),r)}async*findProviders(e,r={}){yield*this.contentRouting.findProviders(e,r)}async*findPeer(e,r={}){yield*this.peerRouting.findPeer(e,r)}async*getClosestPeers(e,r={}){yield*this.peerRouting.getClosestPeers(e,r)}async refreshRoutingTable(){await this.routingTableRefresh.refreshTable(!0)}};c();var sm=E(V(),1),Od=E(Dc(),1);var DNe=C("libp2p:kad-dht"),a7=class extends Ue{constructor(e,r){super(),this.components=new ze,this.wan=e,this.lan=r,this.wan.addEventListener("peer",n=>{this.dispatchEvent(new ee("peer",{detail:n.detail}))}),this.lan.addEventListener("peer",n=>{this.dispatchEvent(new ee("peer",{detail:n.detail}))})}get[Ya](){return!0}get[Symbol.toStringTag](){return"@libp2p/dual-kad-dht"}init(e){this.components=e,this.wan.init(e),this.lan.init(e)}isStarted(){return this.wan.isStarted()&&this.lan.isStarted()}async getMode(){return await this.wan.getMode()}async setMode(e){await this.wan.setMode(e)}async start(){await Promise.all([this.lan.start(),this.wan.start()])}async stop(){await Promise.all([this.lan.stop(),this.wan.stop()])}async*put(e,r,n={}){for await(let i of(0,Od.default)(this.lan.put(e,r,n),this.wan.put(e,r,n)))yield i}async*get(e,r={}){let n=!1,i=!1;for await(let o of(0,Od.default)(this.lan.get(e,r),this.wan.get(e,r)))yield o,o.name==="DIALING_PEER"&&(n=!0),o.name==="VALUE"&&(n=!0,o.value!=null&&(i=!0)),o.name==="SENDING_QUERY"&&(n=!0);if(!n)throw(0,sm.default)(new Error("No peers found in routing table!"),"ERR_NO_PEERS_IN_ROUTING_TABLE");i||(yield ki({from:this.components.getPeerId(),error:(0,sm.default)(new Error("Not found"),"ERR_NOT_FOUND")}))}async*provide(e,r={}){let n=0,i=0,o=[],s=[this.lan];await this.wan.getMode()==="server"&&s.push(this.wan);for await(let a of(0,Od.default)(...s.map(l=>l.provide(e,r))))yield a,a.name==="SENDING_QUERY"&&n++,a.name==="QUERY_ERROR"&&o.push(a.error),a.name==="PEER_RESPONSE"&&a.messageName==="ADD_PROVIDER"&&(DNe("sent provider record for %s to %p",e,a.from),i++);if(i===0)throw o.length>0?(0,sm.default)(new Error(`Failed to provide to ${o.length} of ${n} peers`),"ERR_PROVIDES_FAILED",{errors:o}):(0,sm.default)(new Error("Failed to provide - no peers found"),"ERR_PROVIDES_FAILED")}async*findProviders(e,r={}){yield*(0,Od.default)(this.lan.findProviders(e,r),this.wan.findProviders(e,r))}async*findPeer(e,r={}){let n=!1;for await(let i of(0,Od.default)(this.lan.findPeer(e,r),this.wan.findPeer(e,r)))yield i,(i.name==="SENDING_QUERY"||i.name==="FINAL_PEER")&&(n=!0);if(!n)throw(0,sm.default)(new Error("Peer lookup failed"),"ERR_LOOKUP_FAILED")}async*getClosestPeers(e,r={}){yield*(0,Od.default)(this.lan.getClosestPeers(e,r),this.wan.getClosestPeers(e,r))}async refreshRoutingTable(){await Promise.all([this.lan.refreshRoutingTable(),this.wan.refreshRoutingTable()])}};var c7=class extends a7{constructor(e){super(new O3({protocolPrefix:"/ipfs",...e,lan:!1}),new O3({protocolPrefix:"/ipfs",...e,clientMode:!1,lan:!0}))}};c();var WN=C("libp2p:bootstrap"),L3=class extends Ue{constructor(e={list:[]}){if(e.list==null||e.list.length===0)throw new Error("Bootstrap requires a list of peer addresses");super(),this.interval=e.interval??1e4,this.list=[];for(let r of e.list){if(!gR.matches(r)){WN.error("Invalid multiaddr");continue}let n=new W(r),i=n.getPeerId();if(i==null){WN.error("Invalid bootstrap multiaddr without peer id");continue}let o={id:he(i),multiaddrs:[n],protocols:[]};this.list.push(o)}}get[Ya](){return!0}get[Symbol.toStringTag](){return"@libp2p/bootstrap"}isStarted(){return Boolean(this.timer)}start(){this.timer==null&&(this.timer=setInterval(()=>this._discoverBootstrapPeers(),this.interval),WN("Starting bootstrap node discovery"),this._discoverBootstrapPeers())}_discoverBootstrapPeers(){this.timer!=null&&this.list.forEach(e=>{this.dispatchEvent(new ee("peer",{detail:e}))})}stop(){this.timer!=null&&clearInterval(this.timer),this.timer=void 0}};L3.tag="bootstrap";c();c();c();var cue=WebSocket;c();c();var hue=E(uue(),1);Ae();function fue(t){return t instanceof ArrayBuffer||t?.constructor?.name==="ArrayBuffer"&&typeof t?.byteLength=="number"}var due=t=>{t.binaryType="arraybuffer";let e=async()=>await new Promise((o,s)=>{if(n)return o();if(i!=null)return s(i);let a=f=>{t.removeEventListener("open",l),t.removeEventListener("error",u),f()},l=()=>a(o),u=f=>{a(()=>s(f.error??new Error(`connect ECONNREFUSED ${t.url}`)))};t.addEventListener("open",l),t.addEventListener("error",u)}),r=async function*(){let o=new hue.EventIterator(({push:s,stop:a,fail:l})=>{let u=h=>{let p=null;typeof h.data=="string"&&(p=U(h.data)),fue(h.data)&&(p=new Uint8Array(h.data)),h.data instanceof Uint8Array&&(p=h.data),p!=null&&s(p)},f=h=>l(h.error??new Error("Socket error"));return t.addEventListener("message",u),t.addEventListener("error",f),t.addEventListener("close",a),()=>{t.removeEventListener("message",u),t.removeEventListener("error",f),t.removeEventListener("close",a)}},{highWaterMark:1/0});await e();for await(let s of o)yield fue(s)?new Uint8Array(s):s}(),n=t.readyState===1,i;return t.addEventListener("open",()=>{n=!0,i=null}),t.addEventListener("close",()=>{n=!1,i=null}),t.addEventListener("error",o=>{n||(i=o.error??new Error(`connect ECONNREFUSED ${t.url}`))}),Object.assign(r,{connected:e})};c();c();var pue=t=>{if(t.readyState>=2)throw new Error("socket closed");if(t.readyState!==1)return new Promise((e,r)=>{function n(){t.removeEventListener("open",i),t.removeEventListener("error",o)}function i(){n(),e()}function o(s){n(),r(s.error??new Error(`connect ECONNREFUSED ${t.url}`))}t.addEventListener("open",i),t.addEventListener("error",o)})};var mue=(t,e)=>(e=e??{},e.closeOnEnd=e.closeOnEnd!==!1,async n=>{for await(let i of n){try{await pue(t)}catch(o){if(o.message==="socket closed")break;throw o}t.send(i)}if(e.closeOnEnd!=null&&t.readyState<=1)return await new Promise((i,o)=>{t.addEventListener("close",s=>{if(s.wasClean||s.code===1006)i();else{let a=Object.assign(new Error("ws error"),{event:s});o(a)}}),setTimeout(()=>t.close())})});var gue=(t,e)=>{e=e??{};let r=due(t),n=e.remoteAddress,i=e.remotePort;if(t.url!=null)try{let s=new URL(t.url);n=s.hostname,i=parseInt(s.port,10)}catch{}if(n==null||i==null)throw new Error("Remote connection did not have address and/or port");return{sink:mue(t,e),source:r,connected:async()=>await r.connected(),close:async()=>{(t.readyState===t.CONNECTING||t.readyState===t.OPEN)&&await new Promise(s=>{t.addEventListener("close",()=>{s()}),t.close()})},destroy:()=>{t.terminate!=null?t.terminate():t.close()},remoteAddress:n,remotePort:i,socket:t}};c();var yue=E(Z4(),1),LNe={http:"ws",https:"wss"},BNe="ws",wue=(t,e)=>(0,yue.relative)(t,e,LNe,BNe);function Eue(t,e){let r=typeof window>"u"?"":window.location;e=e??{};let n=wue(t,r.toString()),i=new cue(n,e.websocket);return gue(i,e)}var QN=E(JP(),1);c();function bue(){throw new Error("WebSocket Servers can not be created in the browser!")}c();c();var _ue=C("libp2p:websockets:socket");function vue(t,e,r){r=r??{};let n={async sink(i){r?.signal!=null&&(i=Pn(i,r.signal));try{await t.sink(i)}catch(o){o.type!=="aborted"&&_ue.error(o)}},source:r.signal!=null?Pn(t.source,r.signal):t.source,remoteAddr:e,timeline:{open:Date.now()},async close(){let i=Date.now();try{await rn(t.close(),2e3)}catch{let{host:s,port:a}=n.remoteAddr.toOptions();_ue("timeout closing stream to %s:%s after %dms, destroying it manually",s,a,Date.now()-i),t.destroy()}finally{n.timeline.close=Date.now()}}};return t.socket.once!=null&&t.socket.once("close",()=>{n.timeline.close==null&&(n.timeline.close=Date.now())}),n}c();function f7(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return hh.matches(r)||cu.matches(r)})}function Rue(t){return t.filter(e=>{if(e.protoCodes().includes(290))return!1;let r=e.decapsulateCode(421);return cu.matches(r)&&lu.matches(r.decapsulateCode(6).decapsulateCode(478))})}var wf=C("libp2p:websockets"),h7=class{constructor(e){this.init=e}get[Symbol.toStringTag](){return"@libp2p/websockets"}get[N1](){return!0}async dial(e,r){wf("dialing %s",e),r=r??{};let n=await this._connect(e,r),i=vue(n,e);wf("new outbound connection %s",i.remoteAddr);let o=await r.upgrader.upgradeOutbound(i);return wf("outbound connection %s upgraded",i.remoteAddr),o}async _connect(e,r){if(r?.signal?.aborted===!0)throw new Qa;let n=e.toOptions();wf("dialing %s:%s",n.host,n.port);let i=Sr(),o=u=>{wf.error("connection error:",u),i.reject(u)},s=Eue(v0(e),this.init);if(s.socket.on!=null?s.socket.on("error",o):s.socket.onerror=o,r.signal==null)return await Promise.race([s.connected(),i.promise]),wf("connected %s",e),s;let a,l=new Promise((u,f)=>{if(a=()=>{f(new Qa),setTimeout(()=>{s.close().catch(h=>{wf.error("error closing raw socket",h)})})},r?.signal?.aborted===!0)return a();r?.signal?.addEventListener("abort",a)});try{await Promise.race([l,i.promise,s.connected()])}finally{a!=null&&r?.signal?.removeEventListener("abort",a)}return wf("connected %s",e),s}createListener(e){return bue({...this.init,...e})}filter(e){return e=Array.isArray(e)?e:[e],this.init?.filter!=null?this.init?.filter(e):QN.default.isBrowser||QN.default.isWebWorker?Rue(e):f7(e)}};c();c();c();c();var d7=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},am=class{constructor(e={}){this.hwm=e.splitLimit??16,this.head=new d7(this.hwm),this.tail=this.head,this.size=0,this.objectMode=Boolean(e.objectMode)}push(e){if(e?.value!=null)if(this.objectMode)e.value!=null&&this.size++;else if(e.value instanceof Uint8Array)this.size+=e.value.byteLength;else throw new Error("objectMode was false but tried to push non-Uint8Array value");if(!this.head.push(e)){let r=this.head;this.head=r.next=new d7(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}if(e?.value!=null)if(this.objectMode)this.size--;else if(e.value instanceof Uint8Array)this.size-=e.value.byteLength;else throw new Error("objectMode was false but tried to shift non-Uint8Array value");return e}isEmpty(){return this.head.isEmpty()}};function Aue(t={}){return Cue(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function Iue(t={}){return Cue(r=>{let n,i=[];for(;!r.isEmpty()&&(n=r.shift(),n!=null);){if(n.error!=null)throw n.error;n.done===!1&&i.push(n.value)}return n==null?{done:!0}:{done:n.done===!0,value:i}},t)}function Cue(t,e){e=e??{};let r=e.onEnd,n=new am(e),i,o,s,a=async()=>n.isEmpty()?s?{done:!0}:await new Promise((g,y)=>{o=w=>{o=null,n.push(w);try{g(t(n))}catch(b){y(b)}return i}}):t(n),l=g=>o!=null?o(g):(n.push(g),i),u=g=>(n=new am,o!=null?o({error:g}):(n.push({error:g}),i)),f=g=>s?i:l({done:!1,value:g}),h=g=>s?i:(s=!0,g!=null?u(g):l({done:!0})),p=()=>(n=new am,h(),{done:!0}),d=g=>(h(g),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:a,return:p,throw:d,push:f,end:h,get readableLength(){return n.size}},r==null)return i;let m=i;return i={[Symbol.asyncIterator](){return this},next(){return m.next()},throw(g){return m.throw(g),r!=null&&(r(g),r=void 0),{done:!0}},return(){return m.return(),r!=null&&(r(),r=void 0),{done:!0}},push:f,end(g){return m.end(g),r!=null&&(r(g),r=void 0),i},get readableLength(){return m.readableLength}},i}c();var cm=E(ai(),1);c();var ct;(function(t){t[t.NEW_STREAM=0]="NEW_STREAM",t[t.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",t[t.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",t[t.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",t[t.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",t[t.RESET_RECEIVER=5]="RESET_RECEIVER",t[t.RESET_INITIATOR=6]="RESET_INITIATOR"})(ct||(ct={}));var p7=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),XN=Object.freeze({NEW_STREAM:ct.NEW_STREAM,MESSAGE:ct.MESSAGE_INITIATOR,CLOSE:ct.CLOSE_INITIATOR,RESET:ct.RESET_INITIATOR}),Pue=Object.freeze({MESSAGE:ct.MESSAGE_RECEIVER,CLOSE:ct.CLOSE_RECEIVER,RESET:ct.RESET_RECEIVER});var ZN=10*1024;function Nue(t){return globalThis.Buffer!=null?Buffer.allocUnsafe(t):new Uint8Array(t)}var JN=class{constructor(){this._pool=Nue(ZN),this._poolOffset=0}write(e){let r=this._pool,n=this._poolOffset;cm.default.encode(e.id<<3|e.type,r,n),n+=cm.default.encode.bytes,(e.type===ct.NEW_STREAM||e.type===ct.MESSAGE_INITIATOR||e.type===ct.MESSAGE_RECEIVER)&&e.data!=null?cm.default.encode(e.data.length,r,n):cm.default.encode(0,r,n),n+=cm.default.encode.bytes;let i=r.slice(this._poolOffset,n);return ZN-n<100?(this._pool=Nue(ZN),this._poolOffset=0):this._poolOffset=n,(e.type===ct.NEW_STREAM||e.type===ct.MESSAGE_INITIATOR||e.type===ct.MESSAGE_RECEIVER)&&e.data!=null?[i,e.data instanceof Uint8Array?e.data:e.data.slice()]:[i]}},kue=new JN;async function*Due(t){for await(let e of t)if(Array.isArray(e))for(let r of e)yield*kue.write(r);else yield*kue.write(e)}c();var ek=class{constructor(){this._buffer=new Ve,this._headerInfo=null}write(e){if(e==null||e.length===0)return[];this._buffer.append(e);let r=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch{break}let{id:n,type:i,length:o,offset:s}=this._headerInfo;if(this._buffer.length-s<o)break;let l={id:n,type:i};(i===ct.NEW_STREAM||i===ct.MESSAGE_INITIATOR||i===ct.MESSAGE_RECEIVER)&&(l.data=this._buffer.slice(s,s+o)),r.push(l),this._buffer.consume(s+o),this._headerInfo=null}return r}_decodeHeader(e){let{value:r,offset:n}=Lue(e),{value:i,offset:o}=Lue(e,n),s=r&7;if(p7[s]==null)throw new Error(`Invalid type received: ${s}`);return{id:r>>3,type:s,offset:n+o,length:i}}},KNe=128,Oue=127;function Lue(t,e=0){let r=0,n=0,i=e,o,s=t.length;do{if(i>=s||n>49)throw e=0,new RangeError("Could not decode varint");o=t.get(i++),r+=n<28?(o&Oue)<<n:(o&Oue)*Math.pow(2,n),n+=7}while(o>=KNe);return e=i-e,{value:r,offset:e}}async function*Bue(t){let e=new ek;for await(let r of t){let n=e.write(r);n.length>0&&(yield n)}}c();var tk=1<<20;function Mue(t){let e=t??tk,r=n=>{if(!(n.type!==ct.NEW_STREAM&&n.type!==ct.MESSAGE_INITIATOR&&n.type!==ct.MESSAGE_RECEIVER)&&n.data.byteLength>e)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"})};return n=>async function*(){for await(let o of n)Array.isArray(o)?(o.forEach(r),yield*o):(r(o),yield o)}()}c();var nk=E(V(),1);var Uue=E(Ui(),1);Ae();var ta=C("libp2p:mplex:stream"),rk="ERR_MPLEX_STREAM_RESET",VNe="ERR_MPLEX_STREAM_ABORT",qNe="ERR_MPLEX_SINK_ENDED";function Fue(t){let{id:e,name:r,send:n,onEnd:i,type:o="initiator",maxMsgSize:s=tk}=t,a=new AbortController,l=new AbortController,u=new AbortController,f=o==="initiator"?XN:Pue,h=o==="initiator"?`i${e}`:`r${e}`,p=`${r??e}`,d=!1,m=!1,g,y={open:Date.now()},w=S=>{d||(d=!0,ta.trace("%s stream %s source end - err: %o",o,p,S),S!=null&&g==null&&(g=S),m&&(v.timeline.close=Date.now(),i?.(g)))},b=S=>{m||(m=!0,ta.trace("%s stream %s sink end - err: %o",o,p,S),S!=null&&g==null&&(g=S),d&&(y.close=Date.now(),i?.(g)))},v={close:()=>{ta.trace("%s stream %s close",o,p),v.closeRead(),v.closeWrite()},closeRead:()=>{ta.trace("%s stream %s closeRead",o,p),!d&&v.source.end()},closeWrite:()=>{if(ta.trace("%s stream %s closeWrite",o,p),!m){u.abort();try{n({id:e,type:f.CLOSE})}catch(S){ta.trace("%s stream %s error sending close",o,r,S)}b()}},abort:S=>{ta.trace("%s stream %s abort",o,p,S),v.source.end(S),a.abort(),b(S)},reset:()=>{let S=(0,nk.default)(new Error("stream reset"),rk);l.abort(),v.source.end(S),b(S)},sink:async S=>{if(m)throw(0,nk.default)(new Error("stream closed for writing"),qNe);S=Pn(S,(0,Uue.anySignal)([a.signal,l.signal,u.signal]));try{o==="initiator"&&n({id:e,type:XN.NEW_STREAM,data:U(p)});let R=new Ve;for await(let I of S)for(R.append(I);R.length!==0;){if(R.length<=s){n({id:e,type:f.MESSAGE,data:R.subarray()}),R.consume(R.length);break}let A=R.length-s;n({id:e,type:f.MESSAGE,data:R.subarray(0,A)}),R.consume(A)}}catch(R){if(R.type==="aborted"&&R.message==="The operation was aborted"){if(u.signal.aborted)return;l.signal.aborted&&(R.message="stream reset",R.code=rk),a.signal.aborted&&(R.message="stream aborted",R.code=VNe)}if(R.code===rk)ta.trace("%s stream %s reset",o,r);else{ta.trace("%s stream %s error",o,r,R);try{n({id:e,type:f.RESET})}catch(I){ta.trace("%s stream %s error sending reset",o,r,I)}}v.source.end(R),b(R);return}try{n({id:e,type:f.CLOSE})}catch(R){ta.trace("%s stream %s error sending close",o,r,R)}b()},source:Aue({onEnd:w}),timeline:y,id:h};return v}var m7=E(V(),1),wl=C("libp2p:mplex"),zNe=1024,HNe=1024*1024*4;function Kue(t){let e={...t,type:`${p7[t.type]} (${t.type})`};return t.type===ct.NEW_STREAM&&(e.data=F(t.data instanceof Uint8Array?t.data:t.data.slice())),(t.type===ct.MESSAGE_INITIATOR||t.type===ct.MESSAGE_RECEIVER)&&(e.data=F(t.data instanceof Uint8Array?t.data:t.data.slice(),"base16")),e}var g7=class{constructor(e,r){this.protocol="/mplex/6.7.0",r=r??{},this._streamId=0,this._streams={initiators:Nn({metrics:e.getMetrics(),component:"mplex",metric:"initiatorStreams"}),receivers:Nn({metrics:e.getMetrics(),component:"mplex",metric:"receiverStreams"})},this._init=r,this.sink=this._createSink();let n=this._createSource();this._source=n,this.source=n}init(e){}get streams(){let e=[];return this._streams.initiators.forEach(r=>{e.push(r)}),this._streams.receivers.forEach(r=>{e.push(r)}),e}newStream(e){let r=this._streamId++;e=e==null?r.toString():e.toString();let n=this._streams.initiators;return this._newStream({id:r,name:e,type:"initiator",registry:n})}_newReceiverStream(e){let{id:r,name:n}=e,i=this._streams.receivers;return this._newStream({id:r,name:n,type:"receiver",registry:i})}_newStream(e){let r=this._init.maxStreamsPerConnection??zNe;if(this._streams.initiators.size+this._streams.receivers.size===r)throw(0,m7.default)(new Error("Too many streams open"),"ERR_TOO_MANY_STREAMS");let{id:n,name:i,type:o,registry:s}=e;if(wl("new %s stream %s %s",o,n,i),s.has(n))throw new Error(`${o} stream ${n} already exists!`);let u=Fue({id:n,name:i,send:f=>{if(!s.has(n))throw(0,m7.default)(new Error("the stream is not in the muxer registry, it may have already been closed"),"ERR_STREAM_DOESNT_EXIST");wl.enabled&&wl.trace("%s stream %s send",o,n,Kue(f)),(f.type===ct.NEW_STREAM||f.type===ct.MESSAGE_INITIATOR||f.type===ct.MESSAGE_RECEIVER)&&(f.data=f.data instanceof Uint8Array?f.data:f.data.slice()),this._source.push(f)},type:o,onEnd:()=>{wl("%s stream %s %s ended",o,n,i),s.delete(n),this._init.onStreamEnd!=null&&this._init.onStreamEnd(u)},maxMsgSize:this._init.maxMsgSize});return s.set(n,u),u}_createSink(){return async r=>{this._init.signal!=null&&(r=Pn(r,this._init.signal));try{await Se(r,Bue,Mue(this._init.maxMsgSize),async n=>{for await(let i of n)this._handleIncoming(i)}),this._source.end()}catch(n){wl("error in sink",n),this._source.end(n)}}}_createSource(){let r=Iue({objectMode:!0,onEnd:n=>{let{initiators:i,receivers:o}=this._streams;for(let s of i.values())n!=null?s.abort(n):s.close();for(let s of o.values())n!=null?s.abort(n):s.close()}});return Object.assign(Due(r),{push:r.push,end:r.end,return:r.return})}_handleIncoming(e){let{id:r,type:n}=e;if(wl.enabled&&wl.trace("incoming message",Kue(e)),e.type===ct.NEW_STREAM){let a=this._newReceiverStream({id:r,name:F(e.data instanceof Uint8Array?e.data:e.data.slice())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(a);return}let o=((n&1)===1?this._streams.initiators:this._streams.receivers).get(r);if(o==null){wl("missing stream %s",r);return}let s=this._init.maxStreamBufferSize??HNe;switch(n){case ct.MESSAGE_INITIATOR:case ct.MESSAGE_RECEIVER:if(o.source.readableLength>s){this._source.push({id:e.id,type:n===ct.MESSAGE_INITIATOR?ct.RESET_RECEIVER:ct.RESET_INITIATOR});let a=(0,m7.default)(new Error("Input buffer full - increase Mplex maxBufferSize to accomodate slow consumers"),"ERR_STREAM_INPUT_BUFFER_FULL");o.abort(a);return}o.source.push(e.data.slice());break;case ct.CLOSE_INITIATOR:case ct.CLOSE_RECEIVER:o.closeRead();break;case ct.RESET_INITIATOR:case ct.RESET_RECEIVER:o.reset();break;default:wl("unknown message type %s",n)}}};var y7=class{constructor(e={}){this.protocol="/mplex/6.7.0",this.init=e}createStreamMuxer(e,r={}){return new g7(e,{...r,...this.init})}};c();c();c();function ik(t,e={}){let r=Ro(t),n=gr.fromReader(r.reader,e),i={read:async o=>{let{value:s}=await r.reader.next(o);if(s==null)throw new Error("Value is null");return s},readLP:async()=>{let{value:o}=await n.next();if(o==null)throw new Error("Value is null");return o},readPB:async o=>{let s=await i.readLP();if(s==null)throw new Error("Value is null");let a=s instanceof Uint8Array?s:s.slice();return o.decode(a)},write:o=>{o instanceof Uint8Array?r.writer.push(o):r.writer.push(o.slice())},writeLP:o=>{i.write(Cr.single(o,e))},writePB:(o,s)=>{i.writeLP(s.encode(o))},pb:o=>({read:async()=>await i.readPB(o),write:s=>i.writePB(s,o)}),unwrap:()=>(r.rest(),r.stream)};return i}c();c();function ok(){let t=Sr(),e=!1;return{sink:async r=>{if(e)throw new Error("already piped");e=!0,t.resolve(r)},source:async function*(){yield*await t.promise}()}}function Vue(){let t=ok(),e=ok();return[{source:t.source,sink:e.sink},{source:e.source,sink:t.sink}]}c();var que=Boolean(globalThis.process?.env?.DUMP_SESSION_KEYS);c();var Sfe=E(Yue(),1),um=E(dfe(),1),I7=E(mfe(),1),_k=E(vfe(),1),xfe={hashSHA256(t){return(0,I7.hash)(t)},getHKDF(t,e){let i=new Sfe.HKDF(I7.SHA256,e,t).expand(96),o=i.slice(0,32),s=i.slice(32,64),a=i.slice(64,96);return[o,s,a]},generateX25519KeyPair(){let t=um.generateKeyPair();return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519KeyPairFromSeed(t){let e=um.generateKeyPairFromSeed(t);return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519SharedKey(t,e){return um.sharedKey(t,e)},chaCha20Poly1305Encrypt(t,e,r,n){return new _k.ChaCha20Poly1305(n).seal(e,t,r)},chaCha20Poly1305Decrypt(t,e,r,n){return new _k.ChaCha20Poly1305(n).open(e,t,r)}};c();function Tfe(t){return async function*(e){for await(let r of e)for(let n=0;n<r.length;n+=65519){let i=n+65519;i>r.length&&(i=r.length),yield t.encrypt(r.slice(n,i),t.session)}}}function Afe(t){return async function*(e){for await(let r of e)for(let n=0;n<r.length;n+=65535){let i=n+65535;i>r.length&&(i=r.length);let{plaintext:o,valid:s}=await t.decrypt(r.slice(n,i),t.session);if(!s)throw new Error("Failed to validate decrypted chunk");yield o}}}c();Pr();var rDe=t=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t),z3=(t,e,r)=>(e=e??rDe(2),new DataView(e.buffer,e.byteOffset,e.byteLength).setUint16(r??0,t,!1),e);z3.bytes=2;var H3=t=>{if(t.length<2)throw RangeError("Could not decode int16BE");return t instanceof Uint8Array?new DataView(t.buffer,t.byteOffset,t.byteLength).getUint16(0,!1):t.getUint16(0)};H3.bytes=2;function C7(t){return Pe([t.ne,t.ciphertext],t.ne.length+t.ciphertext.length)}function P7(t){return Pe([t.ne,t.ns,t.ciphertext],t.ne.length+t.ns.length+t.ciphertext.length)}function Ife(t){return Pe([t.ns,t.ciphertext],t.ns.length+t.ciphertext.length)}function fm(t){if(t.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:t.slice(0,32),ciphertext:t.slice(32,t.length),ns:new Uint8Array(0)}}function hm(t){if(t.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:t.slice(0,32),ns:t.slice(32,80),ciphertext:t.slice(80,t.length)}}function Cfe(t){if(t.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:t.slice(0,48),ciphertext:t.slice(48,t.length)}}c();c();c();Pr();Ae();c();var N7;(function(t){let e;(function(r){r.codec=()=>et({1:{name:"identityKey",codec:ve},2:{name:"identitySig",codec:ve},3:{name:"data",codec:ve}}),r.encode=n=>Je(n,r.codec()),r.decode=n=>Ze(n,r.codec())})(e=t.NoiseHandshakePayload||(t.NoiseHandshakePayload={}))})(N7||(N7={}));var Pfe=N7.NoiseHandshakePayload;async function Nfe(t,e,r){let n=await iDe(t,kfe(e)),i=r??new Uint8Array(0);if(t.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return nDe(t.publicKey,n,i)}function nDe(t,e,r){return Pfe.encode({identityKey:t,identitySig:e,data:r??new Uint8Array(0)})}async function iDe(t,e){if(t.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await Hn(t.privateKey)).sign(e)}async function bf(t){return await on(t.identityKey)}function _f(t){return Pfe.decode(t)}function kfe(t){let e=U("noise-libp2p-static-key:");return Pe([e,t],e.length+t.length)}async function oDe(t,e){return(await on(e)).equals(t)}async function vf(t,e,r){let n=e.identityKey;if(!await oDe(r,n))throw new Error("Peer ID doesn't match libp2p public key.");let i=kfe(t),o=await on(n);if(o.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(e.identitySig==null)throw new Error("Signature was missing from message");if(!await qi(o.publicKey).verify(i,e.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return o}function vl(t){return!(!(t instanceof Uint8Array)||t.length!==32)}c();Mr();Pr();c();Re();var st=C("libp2p:noise");var ps;que?ps=st:ps=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function k7(t){ps(`LOCAL_STATIC_PUBLIC_KEY ${F(t.publicKey,"hex")}`),ps(`LOCAL_STATIC_PRIVATE_KEY ${F(t.privateKey,"hex")}`)}function Sf(t){t?(ps(`LOCAL_PUBLIC_EPHEMERAL_KEY ${F(t.publicKey,"hex")}`),ps(`LOCAL_PRIVATE_EPHEMERAL_KEY ${F(t.privateKey,"hex")}`)):ps("Missing local ephemeral keys.")}function dm(t){ps(`REMOTE_STATIC_PUBLIC_KEY ${F(t,"hex")}`)}function Sl(t){ps(`REMOTE_EPHEMERAL_PUBLIC_KEY ${F(t,"hex")}`)}function D7(t){t.cs1&&t.cs2?(ps(`CIPHER_STATE_1 ${t.cs1.n} ${F(t.cs1.k,"hex")}`),ps(`CIPHER_STATE_2 ${t.cs2.n} ${F(t.cs2.k,"hex")}`)):ps("Missing cipher state.")}var sDe=0,Dfe=Number.MAX_SAFE_INTEGER,Ofe="Cipherstate has reached maximum n, a new handshake must be performed",pm=class{constructor(e){this.crypto=e}encryptWithAd(e,r,n){let i=this.encrypt(e.k,e.n,r,n);return this.setNonce(e,this.incrementNonce(e.n)),i}decryptWithAd(e,r,n){let{plaintext:i,valid:o}=this.decrypt(e.k,e.n,r,n);return this.setNonce(e,this.incrementNonce(e.n)),{plaintext:i,valid:o}}hasKey(e){return!this.isEmptyKey(e.k)}setNonce(e,r){e.n=r}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(e){let r=this.createEmptyKey();return Me(r,e)}incrementNonce(e){return e+1}nonceToBytes(e){let r=new Uint8Array(12);return new DataView(r.buffer,r.byteOffset,r.byteLength).setUint32(4,e,!0),r}encrypt(e,r,n,i){if(r>Dfe)throw new Error(Ofe);let o=this.nonceToBytes(r);return this.crypto.chaCha20Poly1305Encrypt(i,o,n,e)}encryptAndHash(e,r){let n;return this.hasKey(e.cs)?n=this.encryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,n),n}decrypt(e,r,n,i){if(r>Dfe)throw new Error(Ofe);let o=this.nonceToBytes(r),s=this.crypto.chaCha20Poly1305Decrypt(i,o,n,e);return s?{plaintext:s,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(e,r){let n,i=!0;return this.hasKey(e.cs)?{plaintext:n,valid:i}=this.decryptWithAd(e.cs,e.h,r):n=r,this.mixHash(e,r),{plaintext:n,valid:i}}dh(e,r){try{let n=this.crypto.generateX25519SharedKey(e,r);return n.length===32?n:n.slice(0,32)}catch(n){return st(n.message),new Uint8Array(32)}}mixHash(e,r){e.h=this.getHash(e.h,r)}getHash(e,r){return this.crypto.hashSHA256(Pe([e,r],e.length+r.length))}mixKey(e,r){let[n,i]=this.crypto.getHKDF(e.ck,r);e.cs=this.initializeKey(i),e.ck=n}initializeKey(e){return{k:e,n:sDe}}initializeSymmetric(e){let r=U(e,"utf-8"),n=this.hashProtocolName(r),i=n,o=this.createEmptyKey();return{cs:this.initializeKey(o),ck:i,h:n}}hashProtocolName(e){if(e.length<=32){let r=new Uint8Array(32);return r.set(e),r}else return this.getHash(e,new Uint8Array(0))}split(e){let[r,n]=this.crypto.getHKDF(e.ck,new Uint8Array(0)),i=this.initializeKey(r),o=this.initializeKey(n);return{cs1:i,cs2:o}}writeMessageRegular(e,r){let n=this.encryptWithAd(e,new Uint8Array(0),r),i=this.createEmptyKey(),o=new Uint8Array(0);return{ne:i,ns:o,ciphertext:n}}readMessageRegular(e,r){return this.decryptWithAd(e,new Uint8Array(0),r.ciphertext)}};var O7=class extends pm{initSession(e,r,n,i){let o=this.createEmptyKey(),s;return e?s=this.initializeInitiator(r,n,i,o):s=this.initializeResponder(r,n,i,o),{hs:s,i:e,mc:0}}sendMessage(e,r){let n;if(e.mc===0)n=this.writeMessageA(e.hs,r);else if(e.mc===1){let{messageBuffer:i,h:o,cs1:s,cs2:a}=this.writeMessageB(e.hs,r);n=i,e.h=o,e.cs1=s,e.cs2=a}else if(e.mc>1)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");n=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");n=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,n}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0&&({plaintext:n,valid:i}=this.readMessageA(e.hs,r)),e.mc===1){let{plaintext:o,valid:s,h:a,cs1:l,cs2:u}=this.readMessageB(e.hs,r);n=o,i=s,e.h=a,e.cs1=l,e.cs2=u}return e.mc++,{plaintext:n,valid:i}}writeMessageA(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let i=e.s.publicKey,o=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let s=this.encryptAndHash(e.ss,r);return{ne:n,ns:o,ciphertext:s}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let i=this.encryptAndHash(e.ss,r),o=this.createEmptyKey(),s={ne:n,ns:o,ciphertext:i},{cs1:a,cs2:l}=this.split(e.ss);return{messageBuffer:s,cs1:a,cs2:l,h:e.ss.h}}readMessageA(e,r){vl(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&n.length===32&&vl(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.s.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:o,valid:i&&s}}readMessageB(e,r){if(vl(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state should contain ephemeral key by now.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re)),this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:o,cs2:s}=this.split(e.ss);return{h:e.ss.h,valid:i,plaintext:n,cs1:o,cs2:s}}initializeInitiator(e,r,n,i){let o="Noise_IK_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e),this.mixHash(s,n);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,re:a,psk:i}}initializeResponder(e,r,n,i){let o="Noise_IK_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e),this.mixHash(s,r.publicKey);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,re:a,psk:i}}};c();var $3=class extends Error{constructor(e,r){super(r),this.initialMsg=e,this.name="FailedIKhandshake"}};var L7=class{constructor(e,r,n,i,o,s,a,l,u){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=o,this.connection=s,l&&(this.remotePeer=l),this.ik=u??new O7(i),this.session=this.ik.initSession(this.isInitiator,this.prologue,this.staticKeypair,a),this.remoteEarlyData=new Uint8Array}async stage0(){if(k7(this.session.hs.s),dm(this.session.hs.rs),this.isInitiator){st("IK Stage 0 - Initiator sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(P7(e)),st("IK Stage 0 - Initiator sent message."),Sf(this.session.hs.e)}else{st("IK Stage 0 - Responder receiving message...");let e=await this.connection.readLP();try{let r=hm(e.slice()),{plaintext:n,valid:i}=this.ik.recvMessage(this.session,r);if(!i)throw new Error("ik handshake stage 0 decryption validation fail");st("IK Stage 0 - Responder got message, going to verify payload.");let o=await _f(n);this.remotePeer=this.remotePeer||await bf(o),await vf(this.session.hs.rs,o,this.remotePeer),this.setRemoteEarlyData(o.data),st("IK Stage 0 - Responder successfully verified payload!"),Sl(this.session.hs.re)}catch(r){let n=r;throw st("Responder breaking up with IK handshake in stage 0."),new $3(e,`Error occurred while verifying initiator's signed payload: ${n.message}`)}}}async stage1(){if(this.isInitiator){st("IK Stage 1 - Initiator receiving message...");let e=(await this.connection.readLP()).slice(),r=fm(e),{plaintext:n,valid:i}=this.ik.recvMessage(this.session,r);st("IK Stage 1 - Initiator got message, going to verify payload.");try{if(!i)throw new Error("ik stage 1 decryption validation fail");let o=await _f(n);this.remotePeer=this.remotePeer||await bf(o),await vf(r.ns.slice(0,32),o,this.remotePeer),this.setRemoteEarlyData(o.data),st("IK Stage 1 - Initiator successfully verified payload!"),Sl(this.session.hs.re)}catch(o){let s=o;throw st("Initiator breaking up with IK handshake in stage 1."),new $3(e,`Error occurred while verifying responder's signed payload: ${s.message}`)}}else{st("IK Stage 1 - Responder sending message...");let e=this.ik.sendMessage(this.session,this.payload);this.connection.writeLP(C7(e)),st("IK Stage 1 - Responder sent message..."),Sf(this.session.hs.e)}D7(this.session)}decrypt(e,r){let n=this.getCS(r,!1);return this.ik.decryptWithAd(n,new Uint8Array(0),e)}encrypt(e,r){let n=this.getCS(r);return this.ik.encryptWithAd(n,new Uint8Array(0),e)}getLocalEphemeralKeys(){if(!this.session.hs.e)throw new Error("Ephemeral keys do not exist.");return this.session.hs.e}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new Error("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};c();c();var Ld=class extends Error{constructor(e="Unexpected Peer"){super(e),this.code=Ld.code}static get code(){return"ERR_UNEXPECTED_PEER"}},xl=class extends Error{constructor(e="Invalid crypto exchange"){super(e),this.code=xl.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}};c();var B7=class extends pm{initializeInitiator(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}initializeResponder(e,r,n,i){let o="Noise_XX_25519_ChaChaPoly_SHA256",s=this.initializeSymmetric(o);this.mixHash(s,e);let a=new Uint8Array(32);return{ss:s,s:r,rs:n,psk:i,re:a}}writeMessageA(e,r,n){let i=new Uint8Array(0);n!==void 0?e.e=n:e.e=this.crypto.generateX25519KeyPair();let o=e.e.publicKey;this.mixHash(e.ss,o);let s=this.encryptAndHash(e.ss,r);return{ne:o,ns:i,ciphertext:s}}writeMessageB(e,r){e.e=this.crypto.generateX25519KeyPair();let n=e.e.publicKey;this.mixHash(e.ss,n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let i=e.s.publicKey,o=this.encryptAndHash(e.ss,i);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let s=this.encryptAndHash(e.ss,r);return{ne:n,ns:o,ciphertext:s}}writeMessageC(e,r){let n=e.s.publicKey,i=this.encryptAndHash(e.ss,n);this.mixKey(e.ss,this.dh(e.s.privateKey,e.re));let o=this.encryptAndHash(e.ss,r),a={ne:this.createEmptyKey(),ns:i,ciphertext:o},{cs1:l,cs2:u}=this.split(e.ss);return{h:e.ss.h,messageBuffer:a,cs1:l,cs2:u}}readMessageA(e,r){return vl(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),this.decryptAndHash(e.ss,r.ciphertext)}readMessageB(e,r){if(vl(r.ne)&&(e.re=r.ne),this.mixHash(e.ss,e.re),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.re));let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);i&&n.length===32&&vl(n)&&(e.rs=n),this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext);return{plaintext:o,valid:i&&s}}readMessageC(e,r){let{plaintext:n,valid:i}=this.decryptAndHash(e.ss,r.ns);if(i&&n.length===32&&vl(n)&&(e.rs=n),!e.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(e.ss,this.dh(e.e.privateKey,e.rs));let{plaintext:o,valid:s}=this.decryptAndHash(e.ss,r.ciphertext),{cs1:a,cs2:l}=this.split(e.ss);return{h:e.ss.h,plaintext:o,valid:i&&s,cs1:a,cs2:l}}initSession(e,r,n){let i=this.createEmptyKey(),o=new Uint8Array(32),s;return e?s=this.initializeInitiator(r,n,o,i):s=this.initializeResponder(r,n,o,i),{hs:s,i:e,mc:0}}sendMessage(e,r,n){let i;if(e.mc===0)i=this.writeMessageA(e.hs,r,n);else if(e.mc===1)i=this.writeMessageB(e.hs,r);else if(e.mc===2){let{h:o,messageBuffer:s,cs1:a,cs2:l}=this.writeMessageC(e.hs,r);i=s,e.h=o,e.cs1=a,e.cs2=l}else if(e.mc>2)if(e.i){if(!e.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(e.cs1,r)}else{if(!e.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(e.cs2,r)}else throw new Error("Session invalid.");return e.mc++,i}recvMessage(e,r){let n=new Uint8Array(0),i=!1;if(e.mc===0)({plaintext:n,valid:i}=this.readMessageA(e.hs,r));else if(e.mc===1)({plaintext:n,valid:i}=this.readMessageB(e.hs,r));else if(e.mc===2){let{h:o,plaintext:s,valid:a,cs1:l,cs2:u}=this.readMessageC(e.hs,r);n=s,i=a,e.h=o,e.cs1=l,e.cs2=u}return e.mc++,{plaintext:n,valid:i}}};var mm=class{constructor(e,r,n,i,o,s,a,l){this.isInitiator=e,this.payload=r,this.prologue=n,this.staticKeypair=o,this.connection=s,a&&(this.remotePeer=a),this.xx=l??new B7(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair),this.remoteEarlyData=new Uint8Array(0)}async propose(){if(k7(this.session.hs.s),this.isInitiator){st("Stage 0 - Initiator starting to send first message.");let e=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(C7(e)),st("Stage 0 - Initiator finished sending first message."),Sf(this.session.hs.e)}else{st("Stage 0 - Responder waiting to receive first message...");let e=fm((await this.connection.readLP()).slice()),{valid:r}=this.xx.recvMessage(this.session,e);if(!r)throw new xl("xx handshake stage 0 validation fail");st("Stage 0 - Responder received first message."),Sl(this.session.hs.re)}}async exchange(){if(this.isInitiator){st("Stage 1 - Initiator waiting to receive first message from responder...");let e=hm((await this.connection.readLP()).slice()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new xl("xx handshake stage 1 validation fail");st("Stage 1 - Initiator received the message."),Sl(this.session.hs.re),dm(this.session.hs.rs),st("Initiator going to check remote's signature...");try{let i=await _f(r);this.remotePeer=this.remotePeer||await bf(i),this.remotePeer=await vf(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let o=i;throw new Ld(`Error occurred while verifying signed payload: ${o.message}`)}st("All good with the signature!")}else{st("Stage 1 - Responder sending out first message with signed payload and static key.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(P7(e)),st("Stage 1 - Responder sent the second handshake message with signed payload."),Sf(this.session.hs.e)}}async finish(){if(this.isInitiator){st("Stage 2 - Initiator sending third handshake message.");let e=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(Ife(e)),st("Stage 2 - Initiator sent message with signed payload.")}else{st("Stage 2 - Responder waiting for third handshake message...");let e=Cfe((await this.connection.readLP()).slice()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new xl("xx handshake stage 2 validation fail");st("Stage 2 - Responder received the message, finished handshake.");try{let i=await _f(r);this.remotePeer=this.remotePeer||await bf(i),await vf(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let o=i;throw new Ld(`Error occurred while verifying signed payload: ${o.message}`)}}D7(this.session)}encrypt(e,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),e)}decrypt(e,r){let n=this.getCS(r,!1);return this.xx.decryptWithAd(n,new Uint8Array(0),e)}getRemoteStaticKey(){return this.session.hs.rs}getCS(e,r=!0){if(!e.cs1||!e.cs2)throw new xl("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?e.cs1:e.cs2:r?e.cs2:e.cs1}setRemoteEarlyData(e){e&&(this.remoteEarlyData=e)}};c();var M7=class extends mm{constructor(e,r,n,i,o,s,a,l,u,f){super(e,r,n,i,o,s,l,f),u&&(this.ephemeralKeys=u),this.initialMsg=a}async propose(){if(this.isInitiator)this.xx.sendMessage(this.session,new Uint8Array(0),this.ephemeralKeys),st("XX Fallback Stage 0 - Initialized state as the first message was sent by initiator."),Sf(this.session.hs.e);else{st("XX Fallback Stage 0 - Responder decoding initial msg from IK.");let e=fm(this.initialMsg),{valid:r}=this.xx.recvMessage(this.session,{ne:e.ne,ns:new Uint8Array(0),ciphertext:new Uint8Array(0)});if(!r)throw new Error("xx fallback stage 0 decryption validation fail");st("XX Fallback Stage 0 - Responder used received message from IK."),Sl(this.session.hs.re)}}async exchange(){if(this.isInitiator){let e=hm(this.initialMsg),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,e);if(!n)throw new Error("xx fallback stage 1 decryption validation fail");st("XX Fallback Stage 1 - Initiator used received message from IK."),Sl(this.session.hs.re),dm(this.session.hs.rs),st("Initiator going to check remote's signature...");try{let i=await _f(r);this.remotePeer=this.remotePeer||await bf(i),await vf(this.session.hs.rs,i,this.remotePeer),this.setRemoteEarlyData(i.data)}catch(i){let o=i;throw new Error(`Error occurred while verifying signed payload from responder: ${o.message}`)}st("All good with the signature!")}else st("XX Fallback Stage 1 - Responder start"),await super.exchange(),st("XX Fallback Stage 1 - Responder end")}};c();var vk=class{constructor(){this.storage=new w3}store(e,r){this.storage.set(e,r)}load(e){return e?this.storage.get(e)??null:null}resetStorage(){this.storage.clear()}},U7=new vk;var F7=class{constructor(e,r,n=xfe){this.protocol="/noise",this.prologue=new Uint8Array(0),this.earlyData=r??new Uint8Array(0),this.useNoisePipes=!1,this.crypto=n,e?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(e):this.staticKeys=this.crypto.generateX25519KeyPair()}async secureOutbound(e,r,n){let i=ik(r,{lengthEncoder:z3,lengthDecoder:H3,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!0,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remoteEarlyData:o.remoteEarlyData,remotePeer:o.remotePeer}}async secureInbound(e,r,n){let i=ik(r,{lengthEncoder:z3,lengthDecoder:H3,maxDataLength:65535}),o=await this.performHandshake({connection:i,isInitiator:!1,localPeer:e,remotePeer:n});return{conn:await this.createSecureConnection(i,o),remoteEarlyData:o.remoteEarlyData,remotePeer:o.remotePeer}}async performHandshake(e){let r=await Nfe(e.localPeer,this.staticKeys.publicKey,this.earlyData),n=this.useNoisePipes;if(e.isInitiator&&U7.load(e.remotePeer)===null&&(n=!1),n){let{remotePeer:i,connection:o,isInitiator:s}=e,a=new L7(s,r,this.prologue,this.crypto,this.staticKeys,o,U7.load(e.remotePeer)??new Uint8Array(32),i);try{return await this.performIKHandshake(a)}catch(l){let u=l,f;return e.isInitiator&&(f=a.getLocalEphemeralKeys()),await this.performXXFallbackHandshake(e,r,u.initialMsg,f)}}else return await this.performXXHandshake(e,r)}async performXXFallbackHandshake(e,r,n,i){let{isInitiator:o,remotePeer:s,connection:a}=e,l=new M7(o,r,this.prologue,this.crypto,this.staticKeys,a,n,s,i);try{await l.propose(),await l.exchange(),await l.finish()}catch(u){let f=u;throw f.message=`Error occurred during XX Fallback handshake: ${f.message}`,st(f),f}return l}async performXXHandshake(e,r){let{isInitiator:n,remotePeer:i,connection:o}=e,s=new mm(n,r,this.prologue,this.crypto,this.staticKeys,o,i);try{await s.propose(),await s.exchange(),await s.finish(),this.useNoisePipes&&s.remotePeer&&U7.store(s.remotePeer,s.getRemoteStaticKey())}catch(a){if(a instanceof Error)throw a.message=`Error occurred during XX handshake: ${a.message}`,a}return s}async performIKHandshake(e){return await e.stage0(),await e.stage1(),e}async createSecureConnection(e,r){let[n,i]=Vue(),o=e.unwrap();return await Se(n,Tfe(r),Cr({lengthEncoder:z3}),o,gr({lengthDecoder:H3}),Afe(r),n),i}};c();var Lfe=new F7;var aDe=Ye.bind({ignoreUndefined:!0,concatArrays:!0});function G3({options:t={},peerId:e,multiaddrs:r=[],repo:n,keychainConfig:i={},config:o={}}){let{datastore:s}=n,a=cDe({options:t,config:o,datastore:s,keychainConfig:i,peerId:e,multiaddrs:r});return typeof t.libp2p=="function"?t.libp2p({libp2pOptions:a,options:t,config:o,datastore:s,peerId:e}):Xce(a)}function cDe({options:t,config:e,datastore:r,keychainConfig:n,peerId:i,multiaddrs:o}){let s=()=>{let d=(0,Qt.default)(e,"Pubsub.Router")||"gossipsub",m=Lte();if(!m[d])throw(0,Bfe.default)(new Error(`Router unavailable. Configure libp2p.modules.pubsub to use the ${d} router.`),"ERR_NOT_SUPPORTED");return m[d]},a={datastore:r,peerId:i},l={addresses:{listen:o.map(d=>d.toString()),announce:(0,Qt.default)(t,"addresses.announce",(0,Qt.default)(e,"Addresses.Announce",[])),noAnnounce:(0,Qt.default)(t,"addresses.noAnnounce",(0,Qt.default)(e,"Addresses.NoAnnounce",[]))},connectionManager:(0,Qt.default)(t,"connectionManager",{maxConnections:(0,Qt.default)(t,"config.Swarm.ConnMgr.HighWater",(0,Qt.default)(e,"Swarm.ConnMgr.HighWater")),minConnections:(0,Qt.default)(t,"config.Swarm.ConnMgr.LowWater",(0,Qt.default)(e,"Swarm.ConnMgr.LowWater"))}),keychain:n,identify:{host:{agentVersion:`js-ipfs/${Sh}`}},contentRouters:[],peerRouters:[],peerDiscovery:[],transports:[new h7({filter:f7})],streamMuxers:[new y7({maxStreamsPerConnection:1/0})],connectionEncryption:[Lfe],relay:{enabled:(0,Qt.default)(t,"relay.enabled",(0,Qt.default)(e,"relay.enabled",!0)),hop:{enabled:(0,Qt.default)(t,"relay.hop.enabled",(0,Qt.default)(e,"relay.hop.enabled",!1)),active:(0,Qt.default)(t,"relay.hop.active",(0,Qt.default)(e,"relay.hop.active",!1))}},nat:{enabled:!(0,Qt.default)(e,"Swarm.DisableNatPortMap",!1)}};(0,Qt.default)(t,"config.Pubsub.Enabled",(0,Qt.default)(e,"Pubsub.Enabled",!0))&&(l.pubsub=s()),(0,Qt.default)(e,"Routing.Type","dhtclient")!=="none"&&(l.dht=new c7({clientMode:(0,Qt.default)(e,"Routing.Type","dht")!=="dhtserver",kBucketSize:(0,Qt.default)(t,"dht.kBucketSize",20),validators:{ipns:Xp},selectors:{ipns:c6}}));let u=(0,Qt.default)(t,"config.Bootstrap",(0,Qt.default)(e,"Bootstrap",[]));u.length>0&&l.peerDiscovery?.push(new L3({list:u}));let f=(0,Qt.default)(t,"libp2p",void 0);typeof f=="function"&&(f=void 0);let h=aDe(a,qoe(),l,f),p=(0,Qt.default)(t,"config.Addresses.Delegates",(0,Qt.default)(e,"Addresses.Delegates",[]));if(p.length>0){let d=p[Math.floor(Math.random()*p.length)],m=new W(d).toOptions(),g={host:m.host,protocol:parseInt(m.port)===443?"https":"http",port:m.port},y=Jie(g);h.contentRouters?.push(new KE(y)),h.peerRouters?.push(new NE(y))}return(0,Qt.default)(t,"config.Discovery.MDNS.Enabled",(0,Qt.default)(e,"Discovery.MDNS.Enabled",!0))||(h.peerDiscovery=h.peerDiscovery?.filter(d=>d!=null&&d[Symbol.toStringTag]!=="@libp2p/mdns")),h}var Sk=E(V(),1);var Ufe=Ye.bind({ignoreUndefined:!0}),W3=C("ipfs:components:peer:storage"),gm=class{constructor(e,r,n,i,o){this.print=i,this.peerId=e,this.keychain=r,this.repo=n,this.print=i,this.isNew=o}static async start(e,r,n){let{repoAutoMigrate:i,repo:o,onMigrationProgress:s}=n,a=typeof o=="string"||o==null?iee(e,r,{path:o,autoMigrate:i,onMigrationProgress:s}):o,{peerId:l,keychain:u,isNew:f}=await lDe(e,a,n);return new gm(l,u,a,e,f)}},lDe=async(t,e,r)=>{if(!e.closed)return{...await Mfe(e,r),isNew:!1};try{return await e.open(),{...await Mfe(e,r),isNew:!1}}catch(n){if(n.code!==Fh)throw n;if(r.init&&r.init.allowNew===!1)throw new Ss("Initialization of new repos disabled by config, pass `config.init.isNew: true` to enable it");return{...await uDe(t,e,r),isNew:!0}}},uDe=async(t,e,r)=>{let n=r.init||{},i=await e.exists();if(W3("repo exists?",i),i===!0)throw new Error("repo already exists");let o=n.privateKey?await fDe(n.privateKey):await hDe(t,n),s=dDe(o);W3("peer identity: %s",s.PeerID);let a={...Ufe(Ffe(Oc(),n.profiles),r.config),Identity:s};await e.init(a),await e.open(),W3("repo opened");let l={pass:r.pass};try{l.dek=await e.config.get("Keychain.DEK")}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f}let u=await G3({options:void 0,multiaddrs:void 0,peerId:o,repo:e,config:a,keychainConfig:l});return u.keychain&&(await u.loadKeychain(),await e.config.set("Keychain",{DEK:u.keychain.init.dek})),{peerId:o,keychain:u.keychain}},fDe=async t=>{if(W3("using user-supplied private-key"),qo(t))return t;let e=U(t,"base64pad"),r=await Hn(e);return await on(r.public.bytes,r.bytes)},hDe=(t,{algorithm:e="Ed25519",bits:r=2048})=>{if(t("generating %s keypair...",e),e==="Ed25519")return T_();if(e==="RSA")return jce({bits:r});throw(0,Sk.default)(new Error("Unknown PeerId algorithm"),"ERR_UNKNOWN_PEER_ID_ALGORITHM")},dDe=t=>{if(t.privateKey==null)throw(0,Sk.default)(new Error("Private key missing"),"ERR_MISSING_PRIVATE_KEY");return{PeerID:t.toString(),PrivKey:F(t.privateKey,"base64pad")}},Mfe=async(t,e)=>{let r=e.config,n=e.init&&e.init.profiles||[],i=e.pass,o=await t.config.getAll(),s=pDe(Ffe(o,n),r);if(o!==s&&await t.config.replace(s),!s.Identity||!s.Identity.PrivKey)throw new yc("No private key was found in the config, please intialize the repo");let a=U(s.Identity.PrivKey,"base64pad"),l=await Hn(a),u=await on(l.public.bytes,l.bytes),f=await G3({options:void 0,multiaddrs:void 0,peerId:u,repo:t,config:s,keychainConfig:{pass:i,...s.Keychain}});return f.keychain&&await f.loadKeychain(),{peerId:u,keychain:f.keychain}},pDe=(t,e)=>e?Ufe(t,e):t,Ffe=(t,e)=>(e||[]).reduce((r,n)=>{let i=E0[n];if(!i)throw new Error(`Could not find profile with name '${n}'`);return W3("applying profile %s",n),i.transform(r)},t);c();c();c();c();c();te();zr();en();var rhe=E(Jfe(),1);c();var j3=E(ai(),1);function IDe(t){let e=new Uint8Array(t.reduce((n,i)=>n+j3.default.encodingLength(i),0)),r=0;for(let n of t)e=j3.encode(n,e,r),r+=j3.default.encodingLength(n);return e}var ehe=IDe;c();var Rk=E(Oi(),1);Mr();c();c();c();en();var Y3=class{constructor(e,r,n){this._refCounter=1,this.cid=e,this.priority=r||1,this.wantType=n}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(Oe)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(e){return this._refCounter===e._refCounter&&this.cid.equals(e.cid)&&this.priority===e.priority&&this.wantType===e.wantType}};en();c();var na=E(pa(),1),sc=na.default.Reader,Q3=na.default.Writer,Ht=na.default.util,Lt=na.default.roots["ipfs-bitswap"]||(na.default.roots["ipfs-bitswap"]={}),ko=Lt.Message=(()=>{function t(e){if(this.blocks=[],this.payload=[],this.blockPresences=[],e)for(var r=Object.keys(e),n=0;n<r.length;++n)e[r[n]]!=null&&(this[r[n]]=e[r[n]])}return t.prototype.wantlist=null,t.prototype.blocks=Ht.emptyArray,t.prototype.payload=Ht.emptyArray,t.prototype.blockPresences=Ht.emptyArray,t.prototype.pendingBytes=0,t.encode=function(r,n){if(n||(n=Q3.create()),r.wantlist!=null&&Object.hasOwnProperty.call(r,"wantlist")&&Lt.Message.Wantlist.encode(r.wantlist,n.uint32(10).fork()).ldelim(),r.blocks!=null&&r.blocks.length)for(var i=0;i<r.blocks.length;++i)n.uint32(18).bytes(r.blocks[i]);if(r.payload!=null&&r.payload.length)for(var i=0;i<r.payload.length;++i)Lt.Message.Block.encode(r.payload[i],n.uint32(26).fork()).ldelim();if(r.blockPresences!=null&&r.blockPresences.length)for(var i=0;i<r.blockPresences.length;++i)Lt.Message.BlockPresence.encode(r.blockPresences[i],n.uint32(34).fork()).ldelim();return r.pendingBytes!=null&&Object.hasOwnProperty.call(r,"pendingBytes")&&n.uint32(40).int32(r.pendingBytes),n},t.decode=function(r,n){r instanceof sc||(r=sc.create(r));for(var i=n===void 0?r.len:r.pos+n,o=new Lt.Message;r.pos<i;){var s=r.uint32();switch(s>>>3){case 1:o.wantlist=Lt.Message.Wantlist.decode(r,r.uint32());break;case 2:o.blocks&&o.blocks.length||(o.blocks=[]),o.blocks.push(r.bytes());break;case 3:o.payload&&o.payload.length||(o.payload=[]),o.payload.push(Lt.Message.Block.decode(r,r.uint32()));break;case 4:o.blockPresences&&o.blockPresences.length||(o.blockPresences=[]),o.blockPresences.push(Lt.Message.BlockPresence.decode(r,r.uint32()));break;case 5:o.pendingBytes=r.int32();break;default:r.skipType(s&7);break}}return o},t.fromObject=function(r){if(r instanceof Lt.Message)return r;var n=new Lt.Message;if(r.wantlist!=null){if(typeof r.wantlist!="object")throw TypeError(".Message.wantlist: object expected");n.wantlist=Lt.Message.Wantlist.fromObject(r.wantlist)}if(r.blocks){if(!Array.isArray(r.blocks))throw TypeError(".Message.blocks: array expected");n.blocks=[];for(var i=0;i<r.blocks.length;++i)typeof r.blocks[i]=="string"?Ht.base64.decode(r.blocks[i],n.blocks[i]=Ht.newBuffer(Ht.base64.length(r.blocks[i])),0):r.blocks[i].length&&(n.blocks[i]=r.blocks[i])}if(r.payload){if(!Array.isArray(r.payload))throw TypeError(".Message.payload: array expected");n.payload=[];for(var i=0;i<r.payload.length;++i){if(typeof r.payload[i]!="object")throw TypeError(".Message.payload: object expected");n.payload[i]=Lt.Message.Block.fromObject(r.payload[i])}}if(r.blockPresences){if(!Array.isArray(r.blockPresences))throw TypeError(".Message.blockPresences: array expected");n.blockPresences=[];for(var i=0;i<r.blockPresences.length;++i){if(typeof r.blockPresences[i]!="object")throw TypeError(".Message.blockPresences: object expected");n.blockPresences[i]=Lt.Message.BlockPresence.fromObject(r.blockPresences[i])}}return r.pendingBytes!=null&&(n.pendingBytes=r.pendingBytes|0),n},t.toObject=function(r,n){n||(n={});var i={};if((n.arrays||n.defaults)&&(i.blocks=[],i.payload=[],i.blockPresences=[]),n.defaults&&(i.wantlist=null,i.pendingBytes=0),r.wantlist!=null&&r.hasOwnProperty("wantlist")&&(i.wantlist=Lt.Message.Wantlist.toObject(r.wantlist,n)),r.blocks&&r.blocks.length){i.blocks=[];for(var o=0;o<r.blocks.length;++o)i.blocks[o]=n.bytes===String?Ht.base64.encode(r.blocks[o],0,r.blocks[o].length):n.bytes===Array?Array.prototype.slice.call(r.blocks[o]):r.blocks[o]}if(r.payload&&r.payload.length){i.payload=[];for(var o=0;o<r.payload.length;++o)i.payload[o]=Lt.Message.Block.toObject(r.payload[o],n)}if(r.blockPresences&&r.blockPresences.length){i.blockPresences=[];for(var o=0;o<r.blockPresences.length;++o)i.blockPresences[o]=Lt.Message.BlockPresence.toObject(r.blockPresences[o],n)}return r.pendingBytes!=null&&r.hasOwnProperty("pendingBytes")&&(i.pendingBytes=r.pendingBytes),i},t.prototype.toJSON=function(){return this.constructor.toObject(this,na.default.util.toJSONOptions)},t.Wantlist=function(){function e(r){if(this.entries=[],r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.entries=Ht.emptyArray,e.prototype.full=!1,e.encode=function(n,i){if(i||(i=Q3.create()),n.entries!=null&&n.entries.length)for(var o=0;o<n.entries.length;++o)Lt.Message.Wantlist.Entry.encode(n.entries[o],i.uint32(10).fork()).ldelim();return n.full!=null&&Object.hasOwnProperty.call(n,"full")&&i.uint32(16).bool(n.full),i},e.decode=function(n,i){n instanceof sc||(n=sc.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new Lt.Message.Wantlist;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.entries&&s.entries.length||(s.entries=[]),s.entries.push(Lt.Message.Wantlist.Entry.decode(n,n.uint32()));break;case 2:s.full=n.bool();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Lt.Message.Wantlist)return n;var i=new Lt.Message.Wantlist;if(n.entries){if(!Array.isArray(n.entries))throw TypeError(".Message.Wantlist.entries: array expected");i.entries=[];for(var o=0;o<n.entries.length;++o){if(typeof n.entries[o]!="object")throw TypeError(".Message.Wantlist.entries: object expected");i.entries[o]=Lt.Message.Wantlist.Entry.fromObject(n.entries[o])}}return n.full!=null&&(i.full=Boolean(n.full)),i},e.toObject=function(n,i){i||(i={});var o={};if((i.arrays||i.defaults)&&(o.entries=[]),i.defaults&&(o.full=!1),n.entries&&n.entries.length){o.entries=[];for(var s=0;s<n.entries.length;++s)o.entries[s]=Lt.Message.Wantlist.Entry.toObject(n.entries[s],i)}return n.full!=null&&n.hasOwnProperty("full")&&(o.full=n.full),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,na.default.util.toJSONOptions)},e.WantType=function(){let r={},n=Object.create(r);return n[r[0]="Block"]=0,n[r[1]="Have"]=1,n}(),e.Entry=function(){function r(n){if(n)for(var i=Object.keys(n),o=0;o<i.length;++o)n[i[o]]!=null&&(this[i[o]]=n[i[o]])}return r.prototype.block=Ht.newBuffer([]),r.prototype.priority=0,r.prototype.cancel=!1,r.prototype.wantType=0,r.prototype.sendDontHave=!1,r.encode=function(i,o){return o||(o=Q3.create()),i.block!=null&&Object.hasOwnProperty.call(i,"block")&&o.uint32(10).bytes(i.block),i.priority!=null&&Object.hasOwnProperty.call(i,"priority")&&o.uint32(16).int32(i.priority),i.cancel!=null&&Object.hasOwnProperty.call(i,"cancel")&&o.uint32(24).bool(i.cancel),i.wantType!=null&&Object.hasOwnProperty.call(i,"wantType")&&o.uint32(32).int32(i.wantType),i.sendDontHave!=null&&Object.hasOwnProperty.call(i,"sendDontHave")&&o.uint32(40).bool(i.sendDontHave),o},r.decode=function(i,o){i instanceof sc||(i=sc.create(i));for(var s=o===void 0?i.len:i.pos+o,a=new Lt.Message.Wantlist.Entry;i.pos<s;){var l=i.uint32();switch(l>>>3){case 1:a.block=i.bytes();break;case 2:a.priority=i.int32();break;case 3:a.cancel=i.bool();break;case 4:a.wantType=i.int32();break;case 5:a.sendDontHave=i.bool();break;default:i.skipType(l&7);break}}return a},r.fromObject=function(i){if(i instanceof Lt.Message.Wantlist.Entry)return i;var o=new Lt.Message.Wantlist.Entry;switch(i.block!=null&&(typeof i.block=="string"?Ht.base64.decode(i.block,o.block=Ht.newBuffer(Ht.base64.length(i.block)),0):i.block.length&&(o.block=i.block)),i.priority!=null&&(o.priority=i.priority|0),i.cancel!=null&&(o.cancel=Boolean(i.cancel)),i.wantType){case"Block":case 0:o.wantType=0;break;case"Have":case 1:o.wantType=1;break}return i.sendDontHave!=null&&(o.sendDontHave=Boolean(i.sendDontHave)),o},r.toObject=function(i,o){o||(o={});var s={};return o.defaults&&(o.bytes===String?s.block="":(s.block=[],o.bytes!==Array&&(s.block=Ht.newBuffer(s.block))),s.priority=0,s.cancel=!1,s.wantType=o.enums===String?"Block":0,s.sendDontHave=!1),i.block!=null&&i.hasOwnProperty("block")&&(s.block=o.bytes===String?Ht.base64.encode(i.block,0,i.block.length):o.bytes===Array?Array.prototype.slice.call(i.block):i.block),i.priority!=null&&i.hasOwnProperty("priority")&&(s.priority=i.priority),i.cancel!=null&&i.hasOwnProperty("cancel")&&(s.cancel=i.cancel),i.wantType!=null&&i.hasOwnProperty("wantType")&&(s.wantType=o.enums===String?Lt.Message.Wantlist.WantType[i.wantType]:i.wantType),i.sendDontHave!=null&&i.hasOwnProperty("sendDontHave")&&(s.sendDontHave=i.sendDontHave),s},r.prototype.toJSON=function(){return this.constructor.toObject(this,na.default.util.toJSONOptions)},r}(),e}(),t.Block=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.prefix=Ht.newBuffer([]),e.prototype.data=Ht.newBuffer([]),e.encode=function(n,i){return i||(i=Q3.create()),n.prefix!=null&&Object.hasOwnProperty.call(n,"prefix")&&i.uint32(10).bytes(n.prefix),n.data!=null&&Object.hasOwnProperty.call(n,"data")&&i.uint32(18).bytes(n.data),i},e.decode=function(n,i){n instanceof sc||(n=sc.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new Lt.Message.Block;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.prefix=n.bytes();break;case 2:s.data=n.bytes();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Lt.Message.Block)return n;var i=new Lt.Message.Block;return n.prefix!=null&&(typeof n.prefix=="string"?Ht.base64.decode(n.prefix,i.prefix=Ht.newBuffer(Ht.base64.length(n.prefix)),0):n.prefix.length&&(i.prefix=n.prefix)),n.data!=null&&(typeof n.data=="string"?Ht.base64.decode(n.data,i.data=Ht.newBuffer(Ht.base64.length(n.data)),0):n.data.length&&(i.data=n.data)),i},e.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.prefix="":(o.prefix=[],i.bytes!==Array&&(o.prefix=Ht.newBuffer(o.prefix))),i.bytes===String?o.data="":(o.data=[],i.bytes!==Array&&(o.data=Ht.newBuffer(o.data)))),n.prefix!=null&&n.hasOwnProperty("prefix")&&(o.prefix=i.bytes===String?Ht.base64.encode(n.prefix,0,n.prefix.length):i.bytes===Array?Array.prototype.slice.call(n.prefix):n.prefix),n.data!=null&&n.hasOwnProperty("data")&&(o.data=i.bytes===String?Ht.base64.encode(n.data,0,n.data.length):i.bytes===Array?Array.prototype.slice.call(n.data):n.data),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,na.default.util.toJSONOptions)},e}(),t.BlockPresenceType=function(){let e={},r=Object.create(e);return r[e[0]="Have"]=0,r[e[1]="DontHave"]=1,r}(),t.BlockPresence=function(){function e(r){if(r)for(var n=Object.keys(r),i=0;i<n.length;++i)r[n[i]]!=null&&(this[n[i]]=r[n[i]])}return e.prototype.cid=Ht.newBuffer([]),e.prototype.type=0,e.encode=function(n,i){return i||(i=Q3.create()),n.cid!=null&&Object.hasOwnProperty.call(n,"cid")&&i.uint32(10).bytes(n.cid),n.type!=null&&Object.hasOwnProperty.call(n,"type")&&i.uint32(16).int32(n.type),i},e.decode=function(n,i){n instanceof sc||(n=sc.create(n));for(var o=i===void 0?n.len:n.pos+i,s=new Lt.Message.BlockPresence;n.pos<o;){var a=n.uint32();switch(a>>>3){case 1:s.cid=n.bytes();break;case 2:s.type=n.int32();break;default:n.skipType(a&7);break}}return s},e.fromObject=function(n){if(n instanceof Lt.Message.BlockPresence)return n;var i=new Lt.Message.BlockPresence;switch(n.cid!=null&&(typeof n.cid=="string"?Ht.base64.decode(n.cid,i.cid=Ht.newBuffer(Ht.base64.length(n.cid)),0):n.cid.length&&(i.cid=n.cid)),n.type){case"Have":case 0:i.type=0;break;case"DontHave":case 1:i.type=1;break}return i},e.toObject=function(n,i){i||(i={});var o={};return i.defaults&&(i.bytes===String?o.cid="":(o.cid=[],i.bytes!==Array&&(o.cid=Ht.newBuffer(o.cid))),o.type=i.enums===String?"Have":0),n.cid!=null&&n.hasOwnProperty("cid")&&(o.cid=i.bytes===String?Ht.base64.encode(n.cid,0,n.cid.length):i.bytes===Array?Array.prototype.slice.call(n.cid):n.cid),n.type!=null&&n.hasOwnProperty("type")&&(o.type=i.enums===String?Lt.Message.BlockPresenceType[n.type]:n.type),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,na.default.util.toJSONOptions)},e}(),t})();var the={Block:ko.Wantlist.WantType.Block,Have:ko.Wantlist.WantType.Have},CDe=(t,e)=>Array.prototype.slice.call(e,0).sort((r,n)=>{let i=t(r),o=t(n);return i<o?-1:i>o?1:0}),ia=class{constructor(e,r){this.set=r?Nn({system:"ipfs",component:"bitswap",metric:"wantlist",metrics:r.metrics}):new Map,this._stats=e}get length(){return this.set.size}add(e,r,n){let i=e.toString(Oe),o=this.set.get(i);o?(o.inc(),o.priority=r,o.wantType===the.Have&&n===the.Block&&(o.wantType=n)):(this.set.set(i,new Y3(e,r,n)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(e){let r=e.toString(Oe),n=this.set.get(r);!n||(n.dec(),!n.hasRefs()&&(this.set.delete(r),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(e){this.set.has(e)&&this.set.delete(e)}forEach(e){return this.set.forEach(e)}entries(){return this.set.entries()}sortedEntries(){return new Map(CDe(e=>e[1].key,Array.from(this.set.entries())))}contains(e){let r=e.toString(Oe);return this.set.has(r)}get(e){let r=e.toString(Oe);return this.set.get(r)}};ia.Entry=Y3;en();var PDe=ia.Entry,xf=class{constructor(e,r,n,i,o){this.entry=new PDe(e,r,n),this.cancel=Boolean(i),this.sendDontHave=Boolean(o)}get cid(){return this.entry.cid}set cid(e){this.entry.cid=e}get priority(){return this.entry.priority}set priority(e){this.entry.priority=e}get wantType(){return this.entry.wantType}set wantType(e){this.entry.wantType=e}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(Oe)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(e){return this.cancel===e.cancel&&this.sendDontHave===e.sendDontHave&&this.wantType===e.wantType&&this.entry.equals(e.entry)}};var ms=(t,e)=>{let r=["bitswap"];return e&&r.push(e),t&&r.push(`${t.toString().slice(0,8)}`),Object.assign((0,Rk.default)(r.join(":")),{error:(0,Rk.default)(r.concat(["error"]).join(":"))})};var K7=(t,e)=>{if(t.size!==e.size)return!1;for(let[r,n]of t){let i=e.get(r);if(i===void 0||n instanceof Uint8Array&&i instanceof Uint8Array&&!Me(n,i)||n instanceof xf&&i instanceof xf&&!n.equals(i))return!1}return!0};var nhe=E(V(),1),Xt=class{constructor(e){this.full=e,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(e,r,n,i,o){n==null&&(n=Xt.WantType.Block);let s=e.toString(Oe),a=this.wantlist.get(s);a?(a.wantType===n&&(a.priority=r),i&&(a.cancel=Boolean(i)),o&&(a.sendDontHave=Boolean(o)),n===Xt.WantType.Block&&a.wantType===Xt.WantType.Have&&(a.wantType=n)):this.wantlist.set(s,new xf(e,r,n,i,o))}addBlock(e,r){let n=e.toString(Oe);this.blocks.set(n,r)}addHave(e){let r=e.toString(Oe);this.blockPresences.has(r)||this.blockPresences.set(r,Xt.BlockPresenceType.Have)}addDontHave(e){let r=e.toString(Oe);this.blockPresences.has(r)||this.blockPresences.set(r,Xt.BlockPresenceType.DontHave)}cancel(e){let r=e.toString(Oe);this.wantlist.delete(r),this.addEntry(e,0,Xt.WantType.Block,!0,!1)}setPendingBytes(e){this.pendingBytes=e}serializeToBitswap100(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:Boolean(r.cancel)})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return ko.encode(e).finish()}serializeToBitswap110(){let e={wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),wantType:r.wantType,cancel:Boolean(r.cancel),sendDontHave:Boolean(r.sendDontHave)})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(let[r,n]of this.blocks.entries()){let i=T.parse(r),o=i.version,s=i.code,a=i.multihash.code,l=i.multihash.digest.length,u=ehe([o,s,a,l]);e.payload.push(new ko.Block({prefix:u,data:n}))}for(let[r,n]of this.blockPresences)e.blockPresences.push(new ko.BlockPresence({cid:T.parse(r).bytes,type:n}));return this.pendingBytes>0&&(e.pendingBytes=this.pendingBytes),ko.encode(e).finish()}equals(e){return!(this.full!==e.full||this.pendingBytes!==e.pendingBytes||!K7(this.wantlist,e.wantlist)||!K7(this.blocks,e.blocks)||!K7(this.blockPresences,e.blockPresences))}get[Symbol.toStringTag](){let e=Array.from(this.wantlist.keys()),r=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${e}, blocks: ${r}>`}};Xt.deserialize=async(t,e)=>{let r=ko.decode(t),n=r.wantlist&&r.wantlist.full||!1,i=new Xt(n);return r.wantlist&&r.wantlist.entries&&r.wantlist.entries.forEach(o=>{if(!o.block)return;let s=T.decode(o.block);i.addEntry(s,o.priority||0,o.wantType,Boolean(o.cancel),Boolean(o.sendDontHave))}),r.blockPresences&&r.blockPresences.forEach(o=>{if(!o.cid)return;let s=T.decode(o.cid);o.type===Xt.BlockPresenceType.Have?i.addHave(s):i.addDontHave(s)}),r.blocks.length>0?(await Promise.all(r.blocks.map(async o=>{let s=await Be.digest(o),a=T.createV0(s);i.addBlock(a,o)})),i):(r.payload.length>0&&(await Promise.all(r.payload.map(async o=>{if(!o.prefix||!o.data)return;let s=(0,rhe.default)(o.prefix),a=s[0],l=s[1],u=s[2],f=u===Be.code?Be:e&&await e.getHasher(u);if(!f)throw(0,nhe.default)(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");let h=await f.digest(o.data),p=T.create(a,l,h);i.addBlock(p,o.data)})),i.setPendingBytes(r.pendingBytes)),i)};Xt.blockPresenceSize=t=>t.bytes.length+1;Xt.Entry=xf;Xt.WantType={Block:ko.Wantlist.WantType.Block,Have:ko.Wantlist.WantType.Have};Xt.BlockPresenceType={Have:ko.BlockPresenceType.Have,DontHave:ko.BlockPresenceType.DontHave};c();var ihe=Math.pow(2,31)-1,ohe=1e3,she=1;c();c();var ahe=NDe;function NDe(t,e,r){var n=null,i=null,o=function(){n&&(clearTimeout(n),i=null,n=null)},s=function(){var l=i;o(),l&&l()},a=function(){if(!e)return t.apply(this,arguments);var l=this,u=arguments,f=r&&!n;if(o(),i=function(){t.apply(l,u)},n=setTimeout(function(){if(n=null,!f){var h=i;return i=null,h()}},e),f)return i()};return a.cancel=o,a.flush=s,a}var V7=class{constructor(e,r,n){this.peerId=r,this.network=n,this.refcnt=1,this._entries=[],this._log=ms(e,"msgqueue"),this.sendEntries=ahe(this._sendEntries.bind(this),she)}addMessage(e){e.empty||this.send(e)}addEntries(e){this._entries=this._entries.concat(e),this.sendEntries()}_sendEntries(){if(!this._entries.length)return;let e=new Xt(!1);this._entries.forEach(r=>{r.cancel?e.cancel(r.cid):e.addEntry(r.cid,r.priority)}),this._entries=[],this.addMessage(e)}async send(e){try{await this.network.connectTo(this.peerId)}catch(r){this._log.error("cant connect to peer %s: %s",this.peerId.toString(),r.message);return}this._log("sending message to peer %s",this.peerId.toString()),this.network.sendMessage(this.peerId,e).catch(r=>{this._log.error("send error: %s",r.message)})}};en();var q7=class{constructor(e,r,n,i){this.peers=Nn({system:"ipfs",component:"bitswap",metric:"want-manager-peers",metrics:i.metrics}),this.wantlist=new ia(n,i),this.network=r,this._stats=n,this._peerId=e,this._log=ms(e,"want")}_addEntries(e,r,n){let i=e.map((o,s)=>new Xt.Entry(o,ihe-s,Xt.WantType.Block,r));i.forEach(o=>{o.cancel?n?this.wantlist.removeForce(o.cid.toString(Oe)):this.wantlist.remove(o.cid):(this._log("adding to wl"),this.wantlist.add(o.cid,o.priority))});for(let o of this.peers.values())o.addEntries(i)}_startPeerHandler(e){let r=this.peers.get(e.toString());if(r){r.refcnt++;return}r=new V7(this._peerId,e,this.network);let n=new Xt(!0);for(let i of this.wantlist.entries())n.addEntry(i[1].cid,i[1].priority);return r.addMessage(n),this.peers.set(e.toString(),r),r}_stopPeerHandler(e){let r=this.peers.get(e.toString());!r||(r.refcnt--,!(r.refcnt>0)&&this.peers.delete(e.toString()))}wantBlocks(e,r={}){this._addEntries(e,!1),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.cancelWants(e)})}unwantBlocks(e){this._log("unwant blocks: %s",e.length),this._addEntries(e,!0,!0)}cancelWants(e){this._log("cancel wants: %s",e.length),this._addEntries(e,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(e){this._startPeerHandler(e)}disconnected(e){this._stopPeerHandler(e)}start(){}stop(){this.peers.forEach(e=>this.disconnected(e.peerId))}};c();var Ak="/ipfs/bitswap/1.0.0",Ik="/ipfs/bitswap/1.1.0",Ck="/ipfs/bitswap/1.2.0",z7=class{constructor(e,r,n,i={}){this._log=ms(e.peerId,"network"),this._libp2p=e,this._bitswap=r,this._protocols=[Ak],i.b100Only||(this._protocols.unshift(Ik),this._protocols.unshift(Ck)),this._stats=n,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=i.hashLoader}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection);let e=i1({onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect});this._registrarId=await this._libp2p.registrar.register(this._protocols,e),await this._libp2p.peerStore.forEach(r=>{this._libp2p.getConnections(r.id).forEach(n=>this._onPeerConnect(n.remotePeer))})}async stop(){this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarId!=null&&this._libp2p.registrar.unregister(this._registrarId)}async _onConnection({protocol:e,stream:r,connection:n}){if(!!this._running){this._log("incoming new bitswap %s connection from %p",e,n.remotePeer);try{await Se(r,gr(),async i=>{for await(let o of i)try{let s=await Xt.deserialize(o.slice(),this._hashLoader);await this._bitswap._receiveMessage(n.remotePeer,s)}catch(s){this._bitswap._receiveError(s);break}})}catch(i){this._log(i)}}}_onPeerConnect(e){this._bitswap._onPeerConnected(e)}_onPeerDisconnect(e){this._bitswap._onPeerDisconnected(e)}findProviders(e,r={}){return this._libp2p.contentRouting.findProviders(e,r)}async findAndConnect(e,r){let n=[],i=0;for await(let o of this.findProviders(e,r))if(this._log(`connecting to provider ${o.id}`),n.push(this.connectTo(o.id,r).catch(s=>{this._log.error(s)})),i++,i===3)break;await Promise.all(n)}async provide(e,r){await this._libp2p.contentRouting.provide(e,r)}async sendMessage(e,r){if(!this._running)throw new Error("network isn't running");let n=e.toString();this._log("sendMessage to %s",n,r);let i=await this._libp2p.dial(e),{stream:o,protocol:s}=await i.newStream([Ck,Ik,Ak]),a;switch(s){case Ak:a=r.serializeToBitswap100();break;case Ik:case Ck:a=r.serializeToBitswap110();break;default:throw new Error("Unknown protocol: "+s)}DDe(o,a,this._log),this._updateSentStats(e,r.blocks)}async connectTo(e,r){if(!this._running)throw new Error("network isn't running");return this._libp2p.dial(e,r)}_updateSentStats(e,r){let n=e.toString();if(this._stats){for(let i of r.values())this._stats.push(n,"dataSent",i.length);this._stats.push(n,"blocksSent",r.size)}}};async function DDe(t,e,r){try{await Se([e],Cr(),t)}catch(n){r(n)}}c();te();en();c();var H7=class{constructor(e){this.partner=e,this.wantlist=new ia,this.exchangeCount=0,this.sentToPeer=new Map,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=e}receivedBytes(e){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=e}wants(e,r,n){this.wantlist.add(e,r,n)}cancelWant(e){this.wantlist.remove(e)}wantlistContains(e){return this.wantlist.get(e)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}};c();c();var X3=class extends Map{constructor(e,r){super(),this._cmp=r||this._defaultSort,this._keys=[];for(let[n,i]of e||[])this.set(n,i)}update(e){if(e<0||e>=this._keys.length)return;let r=this._keys[e];this._keys.splice(e,1);let n=this._find(r);this._keys.splice(n,0,r)}set(e,r){if(this.has(e)){let i=this.indexOf(e);this._keys.splice(i,1)}super.set(e,r);let n=this._find(e);return this._keys.splice(n,0,e),this}clear(){super.clear(),this._keys=[]}delete(e){if(!this.has(e))return!1;let r=this.indexOf(e);return this._keys.splice(r,1),super.delete(e)}indexOf(e){if(!this.has(e))return-1;let r=this._find(e);if(this._keys[r]===e)return r;for(let n=1;n<this._keys.length;n++){if(this._keys[r+n]===e)return r+n;if(this._keys[r-n]===e)return r-n}return-1}_find(e){let r=0,n=this._keys.length;for(;r<n;){let i=r+n>>>1,o=this._kCmp(this._keys[i],e);if(o<0)r=i+1;else if(o>0)n=i;else return i}return r}*keys(){for(let e of this._keys)yield e}*values(){for(let e of this._keys)yield this.get(e)}*entries(){for(let e of this._keys)yield[e,this.get(e)]}*[Symbol.iterator](){yield*this.entries()}forEach(e,r){if(!!e)for(let n of this._keys)e.apply(r,[[n,this.get(n)]])}_defaultSort(e,r){return e[0]<r[0]?-1:r[0]<e[0]?1:0}_kCmp(e,r){return this._cmp([e,this.get(e)],[r,this.get(r)])}};var ODe={hasNewInfo(){return!1},merge(){}},$7=class{constructor(e=ODe){this._taskMerger=e,this._byPeer=new X3([],G7.compare)}pushTasks(e,r){let n=this._byPeer.get(e.toString());n||(n=new G7(e,this._taskMerger)),n.pushTasks(r),this._byPeer.set(e.toString(),n)}popTasks(e){let r=this._head();if(r===void 0)return{tasks:[],pendingSize:0};let{tasks:n,pendingSize:i}=r.popTasks(e);if(n.length===0)return{tasks:n,pendingSize:i};let o=r.peerId;return r.isIdle()?this._byPeer.delete(o.toString()):this._byPeer.update(0),{peerId:o,tasks:n,pendingSize:i}}_head(){if(this._byPeer.size!==0)for(let[,e]of this._byPeer)return e}remove(e,r){let n=this._byPeer.get(r.toString());n&&n.remove(e)}tasksDone(e,r){let n=this._byPeer.get(e.toString());if(!n)return;let i=this._byPeer.indexOf(e.toString());for(let o of r)n.taskDone(o);this._byPeer.update(i)}},G7=class{constructor(e,r){this.peerId=e,this._taskMerger=r,this._activeTotalSize=0,this._pending=new Pk,this._active=new Set}pushTasks(e){for(let r of e)this._pushTask(r)}_pushTask(e){if(!this._taskHasMoreInfoThanActiveTasks(e))return;let r=this._pending.get(e.topic);if(r){e.priority>r.priority&&this._pending.updatePriority(e.topic,e.priority),this._taskMerger.merge(e,r);return}this._pending.add(e)}_taskHasMoreInfoThanActiveTasks(e){let r=[];for(let n of this._active)n.topic===e.topic&&r.push(n);return r.length===0?!0:this._taskMerger.hasNewInfo(e,r)}popTasks(e){let r=0,n=[],i=this._pending.tasks();for(let o=0;o<i.length&&r<e;o++){let s=i[o];n.push(s),r+=s.size,this._pending.delete(s.topic),this._activeTotalSize+=s.size,this._active.add(s)}return{tasks:n,pendingSize:this._pending.totalSize}}taskDone(e){this._active.has(e)&&(this._activeTotalSize-=e.size,this._active.delete(e))}remove(e){this._pending.delete(e)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(e,r){return e[1]._pending.length===0?1:r[1]._pending.length===0?-1:e[1]._activeTotalSize===r[1]._activeTotalSize?r[1]._pending.length-e[1]._pending.length:e[1]._activeTotalSize-r[1]._activeTotalSize}},Pk=class{constructor(){this._tasks=new X3([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((e,r)=>e+r.task.size,0)}get(e){return(this._tasks.get(e)||{}).task}add(e){this._tasks.set(e.topic,{created:Date.now(),task:e})}delete(e){this._tasks.delete(e)}tasks(){return[...this._tasks.values()].map(e=>e.task)}updatePriority(e,r){let n=this._tasks.get(e);if(!n)return;let i=this._tasks.indexOf(e);n.task.priority=r,this._tasks.update(i)}_compare(e,r){return e[1].task.priority===r[1].task.priority?e[1].created-r[1].created:r[1].task.priority-e[1].task.priority}};c();var che={hasNewInfo(t,e){let r=!1,n=!1;for(let i of e)i.data.haveBlock&&(r=!0),i.data.isWantBlock&&(n=!0);return!!(!n&&t.data.isWantBlock||!r&&t.data.haveBlock)},merge(t,e){let r=t.data,n=e.data;!n.haveBlock&&r.haveBlock&&(n.haveBlock=r.haveBlock,n.blockSize=r.blockSize),!n.isWantBlock&&r.isWantBlock&&(n.isWantBlock=!0,(!n.haveBlock||r.haveBlock)&&(n.haveBlock=r.haveBlock,e.size=t.size)),n.isWantBlock&&n.haveBlock&&(e.size=n.blockSize)}};var lhe=Xt.WantType,LDe=16*1024,BDe=1024,W7=class{constructor(e,r,n,i,o,s={}){this._log=ms(e,"engine"),this.blockstore=r,this.network=n,this._stats=i,this._opts=this._processOpts(s),this.ledgerMap=Nn({system:"ipfs",component:"bitswap",metric:"ledger-map",metrics:o.metrics}),this._running=!1,this._requestQueue=new $7(che)}_processOpts(e){return{maxSizeReplaceHasWithBlock:BDe,targetMessageSize:LDe,...e}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks()})}async _processTasks(){if(!this._running)return;let{peerId:e,tasks:r,pendingSize:n}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(r.length===0)return;let i=new Xt(!1);i.setPendingBytes(n);let o=[],s=new Map;for(let l of r){let u=T.parse(l.topic);l.data.haveBlock?l.data.isWantBlock?(o.push(u),s.set(l.topic,l.data)):i.addHave(u):i.addDontHave(u)}let a=await this._getBlocks(o);for(let[l,u]of s){let f=T.parse(l),h=a.get(l);h?i.addBlock(f,h):u.sendDontHave&&i.addDontHave(f)}if(i.empty){e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks();return}try{e&&await this.network.sendMessage(e,i);for(let[l,u]of a.entries())e&&this.messageSent(e,T.parse(l),u)}catch(l){this._log.error(l)}e&&this._requestQueue.tasksDone(e,r),this._scheduleProcessTasks()}wantlistForPeer(e){let r=e.toString(),n=this.ledgerMap.get(r);return n?n.wantlist.sortedEntries():new Map}ledgerForPeer(e){let r=e.toString(),n=this.ledgerMap.get(r);return n?{peer:n.partner,value:n.debtRatio(),sent:n.accounting.bytesSent,recv:n.accounting.bytesRecv,exchanged:n.exchangeCount}:null}peers(){return Array.from(this.ledgerMap.values()).map(e=>e.partner)}receivedBlocks(e){if(!!e.length){for(let r of this.ledgerMap.values())for(let n of e){let i=r.wantlistContains(n.cid);if(!i)continue;let o=n.data.length,s=this._sendAsBlock(i.wantType,o),a=o;s||(a=Xt.blockPresenceSize(i.cid)),this._requestQueue.pushTasks(r.partner,[{topic:i.cid.toString(Oe),priority:i.priority,size:a,data:{blockSize:o,isWantBlock:s,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(e,r){let n=this._findOrCreate(e);if(r.empty)return;if(r.full&&(n.wantlist=new ia),this._updateBlockAccounting(r.blocks,n),r.wantlist.size===0){this._scheduleProcessTasks();return}let i=[],o=[];r.wantlist.forEach(s=>{s.cancel?(n.cancelWant(s.cid),i.push(s.cid)):(n.wants(s.cid,s.priority,s.wantType),o.push(s))}),this._cancelWants(e,i),await this._addWants(e,o),this._scheduleProcessTasks()}_cancelWants(e,r){for(let n of r)this._requestQueue.remove(n.toString(Oe),e)}async _addWants(e,r){let n=await this._getBlockSizes(r.map(o=>o.cid)),i=[];for(let o of r){let s=o.cid.toString(Oe),a=n.get(s);if(a==null)o.sendDontHave&&i.push({topic:s,priority:o.priority,size:Xt.blockPresenceSize(o.cid),data:{isWantBlock:o.wantType===lhe.Block,blockSize:0,haveBlock:!1,sendDontHave:o.sendDontHave}});else{let l=this._sendAsBlock(o.wantType,a),u=a;l||(u=Xt.blockPresenceSize(o.cid)),i.push({topic:s,priority:o.priority,size:u,data:{isWantBlock:l,blockSize:a,haveBlock:!0,sendDontHave:o.sendDontHave}})}this._requestQueue.pushTasks(e,i)}}_sendAsBlock(e,r){return e===lhe.Block||r<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(e){let r=await this._getBlocks(e);return new Map([...r].map(([n,i])=>[n,i.length]))}async _getBlocks(e){let r=new Map;return await Promise.all(e.map(async n=>{try{let i=await this.blockstore.get(n);r.set(n.toString(Oe),i)}catch(i){i.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",n,i)}})),r}_updateBlockAccounting(e,r){for(let n of e.values())this._log("got block (%s bytes)",n.length),r.receivedBytes(n.length)}messageSent(e,r,n){let i=this._findOrCreate(e);i.sentBytes(n.length),i.wantlist.remove(r)}numBytesSentTo(e){return this._findOrCreate(e).accounting.bytesSent}numBytesReceivedFrom(e){return this._findOrCreate(e).accounting.bytesRecv}peerDisconnected(e){this.ledgerMap.delete(e.toString())}_findOrCreate(e){let r=e.toString(),n=this.ledgerMap.get(r);if(n)return n;let i=new H7(e);return this.ledgerMap.set(r,i),this._stats&&this._stats.push(r,"peerCount",1),i}start(){this._running=!0}stop(){this._running=!1}};c();var hhe=E(In(),1);Re();var uhe=t=>`unwant:${F(t.multihash.bytes,"base64")}`,fhe=t=>`block:${F(t.multihash.bytes,"base64")}`,j7=class extends hhe.EventEmitter{constructor(e){super(),this.setMaxListeners(ohe),this._log=ms(e,"notif")}hasBlock(e,r){let n=fhe(e);this._log(n),this.emit(n,r)}wantBlock(e,r={}){if(!e)throw new Error("Not a valid cid");let n=fhe(e),i=uhe(e);return this._log(`wantBlock:${e}`),new Promise((o,s)=>{let a=()=>{this.removeListener(n,l),s(new Error(`Block for ${e} unwanted`))},l=u=>{this.removeListener(i,a),o(u)};this.once(i,a),this.once(n,l),r&&r.signal&&r.signal.addEventListener("abort",()=>{this.removeListener(n,l),this.removeListener(i,a),s(new Error(`Want for ${e} aborted`))})})}unwantBlock(e){let r=uhe(e);this._log(r),this.emit(r)}};c();var whe=E(In(),1);c();var ghe=E(In(),1),Nk=E(mhe(),1),Z3=class extends ghe.EventEmitter{constructor(e,r){super(),this._options=r,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),e.forEach(n=>{this._stats[n]=BigInt(0),this._movingAverages[n]={},this._options.movingAverageIntervals.forEach(i=>{(this._movingAverages[n][i]=(0,Nk.default)(i)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._disabled=!0}stop(){this._timeout&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(e,r){this._enabled&&(this._queue.push([e,r,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){let e=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-e),0)}_update(){if(this._timeout=null,this._queue.length){let e;for(;this._queue.length;){let r=e=this._queue.shift();r&&this._applyOp(r)}e&&this._updateFrequency(e[2]),this.emit("update",this._stats)}}_updateFrequency(e){let r=e-this._frequencyLastTime;r&&Object.keys(this._stats).forEach(n=>{this._updateFrequencyFor(n,r,e)}),this._frequencyLastTime=e}_updateFrequencyFor(e,r,n){let i=this._frequencyAccumulators[e]||0;this._frequencyAccumulators[e]=0;let o=i/r*1e3,s=this._movingAverages[e];s||(s=this._movingAverages[e]={}),this._options.movingAverageIntervals.forEach(a=>{let l=s[a];l||(l=s[a]=(0,Nk.default)(a)),l.push(n,o)})}_applyOp(e){let r=e[0],n=e[1];if(typeof n!="number")throw new Error(`invalid increment number: ${n}`);Object.prototype.hasOwnProperty.call(this._stats,r)||(this._stats[r]=BigInt(0)),this._stats[r]=BigInt(this._stats[r])+BigInt(n),this._frequencyAccumulators[r]||(this._frequencyAccumulators[r]=0),this._frequencyAccumulators[r]+=n}};var yhe={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]},Y7=class extends whe.EventEmitter{constructor(e,r=[],n=yhe){super();let i=Object.assign({},yhe,n);if(typeof i.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof i.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=r,this._options=i,this._enabled=this._options.enabled,this._global=new Z3(r,i),this._global.on("update",o=>this.emit("update",o)),this._peers=Nn({system:"ipfs",component:"bitswap",metric:"stats-peers",metrics:e.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(let e of this._peers)e[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(e){let r=typeof e!="string"&&e.toString?e.toString():`${e}`;return this._peers.get(r)}push(e,r,n){if(this._enabled&&(this._global.push(r,n),e)){let i=this._peers.get(e);i||(i=new Z3(this._initialCounters,this._options),this._peers.set(e,i)),i.push(r,n)}}disconnected(e){let r=e.toString(),n=this._peers.get(r);n&&(n.stop(),this._peers.delete(r))}};var Ehe=E(Ui(),1);te();var UDe={statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},FDe=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"],Q7=class extends Va{constructor(e,r,n={}){super(),this._libp2p=e,this._log=ms(this.peerId),this._options=Object.assign({},UDe,n),this._stats=new Y7(e,FDe,{enabled:this._options.statsEnabled,computeThrottleTimeout:this._options.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:this._options.statsComputeThrottleMaxQueueSize}),this.network=new z7(e,this,this._stats,{hashLoader:n.hashLoader}),this.blockstore=r,this.engine=new W7(this.peerId,r,this.network,this._stats,e),this.wm=new q7(this.peerId,this.network,this._stats,e),this.notifications=new j7(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(e,r){try{await this.engine.messageReceived(e,r)}catch{this._log("failed to receive message",r)}if(r.blocks.size===0)return;let n=[];for(let[i,o]of r.blocks.entries()){let s=T.parse(i);n.push({wasWanted:this.wm.wantlist.contains(s),cid:s,data:o})}this.wm.cancelWants(n.filter(({wasWanted:i})=>i).map(({cid:i})=>i)),await Promise.all(n.map(({cid:i,wasWanted:o,data:s})=>this._handleReceivedBlock(e,i,s,o)))}async _handleReceivedBlock(e,r,n,i){this._log("received block");let o=await this.blockstore.has(r);this._updateReceiveCounters(e.toString(),r,n,o),i&&await this.put(r,n)}_updateReceiveCounters(e,r,n,i){this._stats.push(e,"blocksReceived",1),this._stats.push(e,"dataReceived",n.length),i&&(this._stats.push(e,"dupBlksReceived",1),this._stats.push(e,"dupDataReceived",n.length))}_receiveError(e){this._log.error("ReceiveError: %s",e.message)}_onPeerConnected(e){this.wm.connected(e)}_onPeerDisconnected(e){this.wm.disconnected(e),this.engine.peerDisconnected(e),this._stats.disconnected(e)}enableStats(){this._stats.enable()}disableStats(){this._stats.disable()}wantlistForPeer(e,r){return this.engine.wantlistForPeer(e)}ledgerForPeer(e){return this.engine.ledgerForPeer(e)}async get(e,r={}){let n=(l,u)=>(this.wm.wantBlocks([l],u),this.notifications.wantBlock(l,u)),i=!1,o=async(l,u)=>{try{return await this.blockstore.get(l,u)}catch(f){if(f.code!=="ERR_NOT_FOUND")throw f;return i||(i=!0,this.network.findAndConnect(l,u).catch(h=>this._log.error(h))),n(l,u)}},s=new AbortController,a=r.signal?(0,Ehe.anySignal)([r.signal,s.signal]):s.signal;try{return await Promise.race([this.notifications.wantBlock(e,{signal:a}),o(e,{signal:a})])}finally{s.abort()}}async*getMany(e,r={}){for await(let n of e)yield this.get(n,r)}unwant(e){let r=Array.isArray(e)?e:[e];this.wm.unwantBlocks(r),r.forEach(n=>this.notifications.unwantBlock(n))}cancelWants(e){this.wm.cancelWants(Array.isArray(e)?e:[e])}async put(e,r,n){await this.blockstore.put(e,r),this._sendHaveBlockNotifications(e,r)}async*putMany(e,r){for await(let{key:n,value:i}of this.blockstore.putMany(e,r))this._sendHaveBlockNotifications(n,i),yield{key:n,value:i}}_sendHaveBlockNotifications(e,r){this.notifications.hasBlock(e,r),this.engine.receivedBlocks([{cid:e,data:r}]),this.network.provide(e).catch(n=>{this._log.error("Failed to provide: %s",n.message)})}getWantlist(){return this.wm.wantlist.entries()}peers(){return this.engine.peers()}stat(){return this._stats}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this._stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}unwrap(){return this.blockstore}};var bhe=(t,e,r={})=>new Q7(t,e,r);var xhe=E(V(),1);c();c();var X7={};_t(X7,{abortedError:()=>KDe,notFoundError:()=>_he});c();var kk=E(V(),1);function _he(t){return t=t||new Error("Not Found"),(0,kk.default)(t,"ERR_NOT_FOUND")}function KDe(t){return t=t||new Error("Aborted"),(0,kk.default)(t,"ERR_ABORTED")}c();si();Fo();te();On();var cOt={...X7};var vhe=E(Dc(),1);var She=E(Hi(),1),Z7=class extends Va{constructor(e,r){super(),this.child=e,this.bitswap=r}open(){return this.child.open()}close(){return this.child.close()}unwrap(){return this.child}async put(e,r,n={}){await this.has(e)||(this.bitswap.isStarted()?await this.bitswap.put(e,r,n):await this.child.put(e,r,n))}async*putMany(e,r={}){let n=(0,She.default)(e,async({key:i})=>!await this.has(i));this.bitswap.isStarted()?yield*this.bitswap.putMany(n,r):yield*this.child.putMany(n,r)}async get(e,r={}){return!await this.has(e)&&this.bitswap.isStarted()?this.bitswap.get(e,r):this.child.get(e,r)}async*getMany(e,r={}){let n=Us(),i=Us();Promise.resolve().then(async()=>{for await(let o of e)!await this.has(o)&&this.bitswap.isStarted()?n.push(o):i.push(o);n.end(),i.end()}),yield*(0,vhe.default)(this.bitswap.getMany(n,r),this.child.getMany(i,r))}async delete(e,r){await this.child.delete(e,r)}async*deleteMany(e,r){yield*this.child.deleteMany(e,r)}async has(e,r={}){return this.child.has(e,r)}async*query(e,r={}){yield*this.child.query(e,r)}async*queryKeys(e,r={}){yield*this.child.queryKeys(e,r)}};var ym=class{constructor(e,r,n,i,o){this.peerId=e,this.libp2p=r,this.bitswap=n,this.repo=i,this.blockstore=o}static async start({peerId:e,repo:r,print:n,hashers:i,options:o}){r.closed&&await r.open();let s=await r.config.getAll(),a=await G3({options:o,repo:r,peerId:e,multiaddrs:VDe(e,s),config:s,keychainConfig:void 0});a.keychain&&await a.loadKeychain(),await a.start();for(let f of a.getMultiaddrs())n(`Swarm listening on ${f.toString()}`);let l=bhe(a,r.blocks,{statsEnabled:!0,hashLoader:i});await l.start();let u=new Z7(r.blocks,l);return r.blocks=u,r.pins.blockstore=u,new ym(e,a,l,r,u)}static async stop(e){e.repo.blocks=e.blockstore.unwrap(),e.repo.pins.blockstore=e.blockstore.unwrap(),await e.bitswap.stop(),await e.libp2p.stop()}},VDe=(t,e)=>{let r=t.toString(),n=[],i=e.Addresses&&e.Addresses.Swarm||[];for(let o of i){let s=new W(o);if(s.protoCodes().includes(qDe))throw(0,xhe.default)(new Error("websocket-star swarm addresses are not supported. See https://github.com/ipfs/js-ipfs/issues/2779"),"ERR_WEBSOCKET_STAR_SWARM_ADDR_NOT_SUPPORTED");let a=s.getPeerId();a&&a!==r&&(s=s.encapsulate(`/p2p/${r}`)),n.push(s)}return n},qDe=479;c();c();function Rhe({network:t}){async function e(r={}){let n=[],{libp2p:i}=await t.use(r);return await i.peerStore.forEach(o=>{n.push({id:o.id,addrs:o.addresses.map(s=>s.multiaddr)})}),n}return B(e)}c();function The({network:t}){async function e(r,n={}){let{libp2p:i}=await t.use(n);await i.dial(r,n)}return B(e)}c();function Ahe({network:t}){async function e(r,n={}){let{libp2p:i}=await t.use(n);await i.hangUp(r)}return B(e)}c();function Ihe({network:t}){async function e(r={}){let{libp2p:n}=await t.use(r);return n.getMultiaddrs()}return B(e)}c();function Che({network:t}){async function e(r={}){let{libp2p:n}=await t.use(r);if(r.verbose){let o=[];for(let s of n.getConnections()){let a={addr:s.remoteAddr,peer:s.remotePeer};(r.verbose||r.direction)&&(a.direction=s.stat.direction),r.verbose&&(a.muxer=s.stat.multiplexer,a.latency="n/a",a.streams=[]),o.push(a)}return o}let i=new Map;for(let o of n.getConnections()){let s={addr:o.remoteAddr,peer:o.remotePeer};i.set(o.remotePeer.toString(),s)}return Array.from(i.values())}return B(e)}var J7=class{constructor({network:e}){this.addrs=Rhe({network:e}),this.connect=The({network:e}),this.disconnect=Ahe({network:e}),this.localAddrs=Ihe({network:e}),this.peers=Che({network:e})}};c();var J3={success:!0,time:0,text:""};function Phe({network:t}){async function*e(r,n={}){let{libp2p:i}=await t.use();n.count=n.count||10;let o=await i.peerStore.get(r),s=o&&o.id;if(!s){yield{...J3,text:`Looking up peer ${r}`};let u=await i.peerRouting.findPeer(r);s=u&&u.id}if(!s)throw new Error("Peer was not found");yield{...J3,text:`PING ${s.toString()}`};let a=0,l=0;for(let u=0;u<n.count;u++)try{let f=await i.ping(s);l+=f,a++,yield{...J3,time:f}}catch(f){yield{...J3,success:!1,text:f.toString()}}if(a){let u=l/a;yield{...J3,text:`Average latency: ${u}ms`}}}return B(e)}c();var Rl=E(V(),1);te();en();M4();Pr();Ae();var Dk="/ipns/";function Nhe(t){t.startsWith(Dk)&&(t=t.substring(Dk.length));let e;if((t[0]==="1"||t[0]==="Q")&&(t=`z${t}`),t[0]==="z"&&(e=Oe.decode(t)),t[0]==="k"&&(e=fp.decode(t)),!e)throw new Error("Could not parse string");if(e[0]!==1&&e[1]!==114&&(e=Pe([[1,114],e])),e.length!==40)throw new Error("Incorrect length "+e.length);return Pe([U(Dk),e.subarray(2)])}function khe({network:t,repo:e,peerId:r}){let{get:n,put:i,findProvs:o,findPeer:s,provide:a,query:l}={async*get(u,f={}){let{libp2p:h}=await wm(t,r,f),p=u instanceof Uint8Array?u:Nhe(u);if(h.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*h.dht.get(p,f)},async*put(u,f,h){let{libp2p:p}=await wm(t,r,h),d=u instanceof Uint8Array?u:Nhe(u);if(p.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*p.dht.put(d,f)},async*findProvs(u,f={}){let{libp2p:h}=await wm(t,r,f);if(h.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*h.dht.findProviders(u,{signal:f.signal})},async*findPeer(u,f={}){let{libp2p:h}=await wm(t,r,f);if(h.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*h.dht.findPeer(u,{signal:f.signal})},async*provide(u,f={recursive:!1}){let{libp2p:h}=await wm(t,r,f);if(!await e.blocks.has(u))throw(0,Rl.default)(new Error("block(s) not found locally, cannot provide"),"ERR_BLOCK_NOT_FOUND");if(f.recursive)throw(0,Rl.default)(new Error("not implemented yet"),"ERR_NOT_IMPLEMENTED_YET");if(h.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*h.dht.provide(u)},async*query(u,f={}){let{libp2p:h}=await wm(t,r,f),p,d=T.asCID(u);if(d!=null?p=d.multihash.bytes:p=he(u.toString()).toBytes(),h.dht==null)throw(0,Rl.default)(new Error("dht not configured"),"ERR_DHT_NOT_CONFIGURED");yield*h.dht.getClosestPeers(p,f)}};return{get:B(n),put:B(i),findProvs:B(o),findPeer:B(s),provide:B(a),query:B(l)}}var wm=async(t,e,r)=>{let n=await t.use(r);if(n.libp2p.dht!=null)return n;{let i=async function*(){yield{from:e,name:"QUERY_ERROR",type:3,error:new Ss("dht not enabled")}};return{libp2p:{dht:{get:i,put:i,findProviders:i,findPeer:i,provide:i,getClosestPeers:i}}}}};c();var Dhe=E(V(),1);var Ohe=E(a6(),1);function Lhe({network:t,config:e}){let r=(0,Ohe.default)(e||{},"Pubsub.Enabled",!0),n={},i;return{subscribe:r?B(o):e4,unsubscribe:r?B(s):e4,publish:r?B(a):e4,ls:r?B(l):e4,peers:r?B(u):e4};async function o(f,h,p={}){let{libp2p:d}=await t.use(p);d.pubsub.subscribe(f),i==null&&(i=m=>{let g=m.detail;n[g.topic]&&n[g.topic].forEach(y=>{if(typeof y=="function"){y(g);return}y!=null&&y.handleEvent!=null&&y.handleEvent(g)})},d.pubsub.addEventListener("message",i)),h!=null&&(n[f]==null&&(n[f]=[]),n[f].push(h))}async function s(f,h,p={}){let{libp2p:d}=await t.use(p);h!=null&&n[f]!=null&&(n[f]=n[f].filter(m=>m!==h),n[f].length===0&&delete n[f]),typeof h!="function"&&delete n[f],n[f]==null&&d.pubsub.unsubscribe(f),Object.keys(n).length===0&&(d.pubsub.removeEventListener("message",i),i=void 0)}async function a(f,h,p={}){let{libp2p:d}=await t.use(p);if(!h)throw(0,Dhe.default)(new Error('argument "data" is required'),"ERR_ARG_REQUIRED");await d.pubsub.publish(f,h)}async function l(f={}){let{libp2p:h}=await t.use(f);return h.pubsub.getTopics()}async function u(f,h={}){let{libp2p:p}=await t.use(h);return p.pubsub.getSubscribers(f)}}var e4=async()=>{throw new Ss("pubsub not enabled")};var HDe=Ye.bind({ignoreUndefined:!0}),Rf=C("ipfs"),Ok=class{constructor({print:e,storage:r,codecs:n,options:i}){let{peerId:o,repo:s,keychain:a}=r,l=ui.create(ym),u=jW(i.preload),f=MU(),h=UU({network:l}),p=new p6(i),d=Object.values(F4);(i.ipld&&i.ipld.hashers?i.ipld.hashers:[]).forEach(Ge=>d.push(Ge)),this.hashers=new x1({hashers:d,loadHasher:i.ipld&&i.ipld.loadHasher});let m=Object.values(ya);(i.ipld&&i.ipld.bases?i.ipld.bases:[]).forEach(Ge=>m.push(Ge)),this.bases=new v1({bases:m,loadBase:i.ipld&&i.ipld.loadBase});let g=new pw({repo:s,codecs:n}),y=new B6({codecs:n,hashers:this.hashers,preload:u,repo:s}),w=new y6({dns:f,ipns:p,repo:s,codecs:n,peerId:o,isOnline:h,keychain:a,options:i}),b=zU({repo:s,codecs:n,bases:this.bases,name:w}),v=new A5({repo:s,codecs:n,hashers:this.hashers,preload:u}),S=Object.assign(Yq({repo:s,codecs:n,resolve:b,preload:u}),{local:Qq({repo:r.repo})}),{add:R,addAll:I,cat:A,get:L,ls:q}=new w5({preload:u,repo:s,options:i.EXPERIMENTAL,hashers:this.hashers}),G=Vj({repo:s,preload:u,hashers:this.hashers,options:i}),j=YW({files:G,preload:u,options:i.preload});this.preload=u,this.name=w,this.ipns=p,this.pin=g,this.resolve=b,this.block=y,this.refs=S,this.start=aU({network:l,peerId:o,repo:s,preload:u,ipns:p,mfsPreload:j,print:e,keychain:a,hashers:this.hashers,options:i}),this.stop=cU({network:l,preload:u,mfsPreload:j,ipns:p,repo:s}),this.dht=khe({network:l,repo:s,peerId:o}),this.pubsub=Lhe({network:l,config:i.config}),this.dns=f,this.isOnline=h,this.id=yW({network:l,peerId:o}),this.version=gW({repo:s}),this.bitswap=new E6({network:l}),this.bootstrap=new C6({repo:s}),this.config=EW({repo:s}),this.ping=Phe({network:l}),this.add=R,this.addAll=I,this.cat=A,this.get=L,this.ls=q,this.dag=v,this.files=G,this.key=new H5({keychain:a}),this.object=new G5({preload:u,codecs:n,repo:s}),this.repo=new j5({repo:s,hashers:this.hashers}),this.stats=new Y5({repo:s,network:l}),this.swarm=new J7({network:l}),Object.defineProperty(this,"libp2p",{get(){let Ge=l.try();return Ge?Ge.libp2p:void 0}});let se=()=>Promise.reject((0,ev.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")),re=async function*(){throw(0,ev.default)(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")};this.commands=se,this.diag={cmds:se,net:se,sys:se},this.log={level:se,ls:se,tail:re},this.mount=se,this.codecs=n}async init(){throw new vs}},$De=async t=>{let e=je({Data:new Qe({type:"directory"}).marshal(),Links:[]}),r=await t.block.put(e,{mhtype:"sha2-256",format:"dag-pb"});return await t.pin.add(r),r},GDe=()=>({start:!0,EXPERIMENTAL:{},preload:{enabled:!Bhe.isTest,addresses:["/dns4/node0.preload.ipfs.io/https","/dns4/node1.preload.ipfs.io/https","/dns4/node2.preload.ipfs.io/https","/dns4/node3.preload.ipfs.io/https"]}});async function Mhe(t={}){t=HDe(GDe(),t);let e=t.init||{},r={name:hn.name,code:hn.code,encode:u=>u,decode:u=>u},n=Object.values(K4);[Tt,mc,lp,zDe,r].concat(t.ipld&&t.ipld.codecs||[]).forEach(u=>n.push(u));let i=new S1({codecs:n,loadCodec:t.ipld&&t.ipld.loadCodec}),o=t.silent?Rf:console.log;Rf("creating repo");let s=await gm.start(o,i,t);Rf("getting repo config");let a=await s.repo.config.getAll(),l=new Ok({storage:s,print:o,codecs:i,options:{...t,config:a}});if(Rf("starting preload"),await l.preload.start(),Rf("starting storage"),l.ipns.startOffline(s),s.isNew&&!e.emptyRepo){let u=await $De(l);if(Rf("adding default assets"),await(l.addAll,void 0),Rf("initializing IPNS keyspace"),s.peerId.publicKey==null)throw(0,ev.default)(new Error("Public key missing"),"ERR_MISSING_PUBLIC_KEY");await l.ipns.initializeKeyspace(s.peerId,U(`/ipfs/${u}`))}return t.start!==!1&&(Rf("starting node"),await l.start()),l}var Uhe=E(VC(),1),Fhe=E(qC(),1),Khe=Mhe,Vhe=Uhe.default,qhe=Fhe.default;c();function zhe(){throw new Error("Not supported in browsers")}var WDe=Khe,jDe=Vhe,YDe=qhe,QDe=zhe;return cr(XDe);})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * bytes
 * Copyright(c) 2012-2014 TJ Holowaychuk
 * Copyright(c) 2015 Jed Watson
 * MIT Licensed
 */
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */
/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
/**
 * Timestamp for 64-bit time_t, nanosecond precision and strftime
 *
 * @author Yusuke Kawasaki
 * @license MIT
 * @see https://github.com/kawanet/timestamp-nano
 */
return Ipfs}));
